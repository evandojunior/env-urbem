<job>
  <name>BI_TCEMG_ARQ_ACOMP_MENSAL_JOB</name>
  <description/>
  <extended_description/>
  <job_version/>
  <job_status>0</job_status>
  <directory>&#x2f;TCE&#x2f;MG</directory>
  <created_user>-</created_user>
  <created_date>2017&#x2f;04&#x2f;04 14&#x3a;17&#x3a;24.036</created_date>
  <modified_user>-</modified_user>
  <modified_date>2017&#x2f;09&#x2f;06 15&#x3a;15&#x3a;45.374</modified_date>
    <parameters>
      <parameter>
        <name>CLIENTE_ID</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>CLIENTE_NOME</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>CLIENTE_UF</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>DB_HOST_NAME</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>DB_NAME</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>DB_PASSWORD</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>DB_PORT</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>DB_USER_NAME</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>EXERCIO</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>ID</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>JOB_NOME</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>MES</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>PERIODO_FINAL</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>PERIODO_INICIAL</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>REPROC_PRE_BALANCETE_EXERCICIO</name>
        <default_value/>
        <description/>
      </parameter>
    </parameters>
  <connection>
    <name>urbem</name>
    <server>&#x24;&#x7b;DB_HOST_NAME&#x7d;</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>&#x24;&#x7b;DB_NAME&#x7d;</database>
    <port>&#x24;&#x7b;DB_PORT&#x7d;</port>
    <username>&#x24;&#x7b;DB_USER_NAME&#x7d;</username>
    <password>&#x24;&#x7b;DB_PASSWORD&#x7d;</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>&#x24;&#x7b;DB_PORT&#x7d;</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
    <slaveservers>
    </slaveservers>
      <job-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_JOB</id>
          <enabled>Y</enabled>
          <name>ID_JOB</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>JOBNAME</id>
          <enabled>Y</enabled>
          <name>JOBNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>START_JOB_ENTRY</id>
          <enabled>N</enabled>
          <name>START_JOB_ENTRY</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </job-log-table>
      <jobentry-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>JOBNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>JOBENTRYNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>RESULT</id>
          <enabled>Y</enabled>
          <name>RESULT</name>
        </field>
        <field>
          <id>NR_RESULT_ROWS</id>
          <enabled>Y</enabled>
          <name>NR_RESULT_ROWS</name>
        </field>
        <field>
          <id>NR_RESULT_FILES</id>
          <enabled>Y</enabled>
          <name>NR_RESULT_FILES</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>COPY_NR</id>
          <enabled>N</enabled>
          <name>COPY_NR</name>
        </field>
      </jobentry-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
   <pass_batchid>N</pass_batchid>
   <shared_objects_file/>
  <entries>
    <entry>
      <name>START</name>
      <description/>
      <type>SPECIAL</type>
      <start>Y</start>
      <dummy>N</dummy>
      <repeat>N</repeat>
      <schedulerType>1</schedulerType>
      <intervalSeconds>10</intervalSeconds>
      <intervalMinutes>0</intervalMinutes>
      <hour>12</hour>
      <minutes>0</minutes>
      <weekDay>1</weekDay>
      <DayOfMonth>1</DayOfMonth>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>32</yloc>
    </entry>
    <entry>
      <name>Success</name>
      <description/>
      <type>SUCCESS</type>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>480</yloc>
    </entry>
    <entry>
      <name>SJ_020_ESS_UPD_STATUS_PROCESSANDO</name>
      <description/>
      <type>SQL</type>
      <sql>&#x2f;&#x2a;update prestacao_contas.fila_relatorio &#xd;&#xa;set &#xd;&#xa; status &#x3d; &#x27;PROCESSANDO&#x27;&#xd;&#xa;,relatorio_log &#x3d; 	&#x28;	&#xd;&#xa;						select json_agg&#x28;value&#x29; from &#x28;&#xd;&#xa;						select &#x2a; from json_array_elements&#x28;&#x28;select relatorio_log from prestacao_contas.fila_relatorio where id &#x3d; &#x24;&#x7b;ID&#x7d;&#x29;&#x3a;&#x3a;json&#x29; &#xd;&#xa;						union all&#xd;&#xa;						select &#x28;&#x27;&#x7b;&#x22;from&#x22;&#x3a;&#x22;ENVIADO&#x22;,&#x22;to&#x22;&#x3a;&#x22;PROCESSANDO&#x22;,&#x22;at&#x22;&#x3a;&#x22;&#x27; &#x7c;&#x7c; to_char&#x28;now&#x28;&#x29;,&#x27;yyyy-mm-dd HH24&#x3a;MI&#x3a;SS&#x27;&#x29; &#x7c;&#x7c;&#x27;&#x22;,&#x22;message&#x22;&#x3a;null&#x7d;&#x27;&#x29;&#x3a;&#x3a;json&#xd;&#xa;													&#x29; x &#xd;&#xa;					&#x29;&#xd;&#xa;where id &#x3d; &#x24;&#x7b;ID&#x7d;&#x3b;&#x2a;&#x2f;&#xd;&#xa;&#xd;&#xa;SELECT prestacao_contas.processa_status_processando&#x28;&#x24;&#x7b;ID&#x7d;&#x29;&#x3b;&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>urbem</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>288</yloc>
    </entry>
    <entry>
      <name>SJ_030_ESS_EXEC_FUNCTION</name>
      <description/>
      <type>SQL</type>
      <sql>SELECT prestacao_contas.tcemg_sicom_arq_acomp_mensal&#x28;&#x24;&#x7b;ID&#x7d;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>urbem</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>352</yloc>
    </entry>
    <entry>
      <name>SJ_040_ESS_UPD_STATUS_PRONTO</name>
      <description/>
      <type>SQL</type>
      <sql>&#x2f;&#x2a;update prestacao_contas.fila_relatorio &#xd;&#xa;set &#xd;&#xa; status &#x3d; &#x27;PRONTO&#x27;&#xd;&#xa;,data_resposta &#x3d; now&#x28;&#x29;&#x3a;&#x3a;timestamp&#x28;0&#x29;&#xd;&#xa;,relatorio_log &#x3d; 	&#x28;	&#xd;&#xa;						select json_agg&#x28;value&#x29; from &#x28;&#xd;&#xa;						select &#x2a; from json_array_elements&#x28;&#x28;select relatorio_log from prestacao_contas.fila_relatorio where id &#x3d; &#x24;&#x7b;ID&#x7d;&#x29;&#x3a;&#x3a;json&#x29; &#xd;&#xa;						union all&#xd;&#xa;						select &#x28;&#x27;&#x7b;&#x22;from&#x22;&#x3a;&#x22;PROCESSANDO&#x22;,&#x22;to&#x22;&#x3a;&#x22;PRONTO&#x22;,&#x22;at&#x22;&#x3a;&#x22;&#x27; &#x7c;&#x7c; to_char&#x28;now&#x28;&#x29;,&#x27;yyyy-mm-dd HH24&#x3a;MI&#x3a;SS&#x27;&#x29; &#x7c;&#x7c;&#x27;&#x22;,&#x22;message&#x22;&#x3a;null&#x7d;&#x27;&#x29;&#x3a;&#x3a;json&#xd;&#xa;													&#x29; x &#xd;&#xa;					&#x29;&#xd;&#xa;where id &#x3d; &#x24;&#x7b;ID&#x7d; and status &#x3d; &#x27;PROCESSANDO&#x27;&#x3b;&#x2a;&#x2f;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;SELECT prestacao_contas.processa_status_pronto&#x28;&#x24;&#x7b;ID&#x7d;&#x29;&#x3b;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>urbem</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>416</yloc>
    </entry>
    <entry>
      <name>SJ_010_ESS_CREATE_SCHEMA_FUNCTION</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;SET search_path &#x3d; &#x27;prestacao_contas&#x27;, pg_catalog&#x3b;&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION prestacao_contas.tcemg_sicom_arq_acomp_mensal&#x28;bigint&#x29;&#xd;&#xa; RETURNS text&#xd;&#xa; LANGUAGE plpgsql&#xd;&#xa;AS &#x24;function&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    inId ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stParametros 	VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stExercicio		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	StExercicio_ant VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;	&#xd;&#xa;	stMes			VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stEntidade		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stPeriodo		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;	&#xd;&#xa;	stDtinicio		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stDtfim			VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stArquivos 		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stSql     		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stSql2 			VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa; 	reRegistro       RECORD&#x3b;	&#xd;&#xa; 	stResultado		VARCHAR &#x3a;&#x3d; &#x27;ok&#x27;&#x3b;&#xd;&#xa; 	stError			VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	reRecPar		RECORD&#x3b; 	&#xd;&#xa;begin&#xd;&#xa;	&#xd;&#xa;	select &#xd;&#xa;		valor &#xd;&#xa;	into stParametros &#xd;&#xa;	from prestacao_contas.fila_relatorio &#xd;&#xa;	where id &#x3d; inId&#x3b;&#xd;&#xa;	&#xd;&#xa;	stSql &#x3a;&#x3d; &#x27;select &#x2a; from json_to_record&#x28;&#x27;&#x27;&#x27;&#x7c;&#x7c;stParametros&#x7c;&#x7c;&#x27;	&#x27;&#x27;&#x29;  as x&#x28;exercicio int, mes int, entidade text, tipo text, periodo text ,data_inicio text, data_fim text, arquivo text&#x29;&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;	FOR reRegistro IN EXECUTE stSql&#xd;&#xa;    LOOP		&#xd;&#xa;		stExercicio	&#x3a;&#x3d; reRegistro.exercicio&#x3b;&#xd;&#xa;		stMes		&#x3a;&#x3d; reRegistro.mes&#x3b;		&#xd;&#xa;    	stEntidade	&#x3a;&#x3d; reRegistro.entidade&#x3b;&#xd;&#xa;    	stPeriodo	&#x3a;&#x3d; reRegistro.periodo&#x3b;    	&#xd;&#xa;		stDtinicio	&#x3a;&#x3d; reRegistro.data_inicio&#x3b;		&#xd;&#xa;		stDtfim		&#x3a;&#x3d; reRegistro.data_fim&#x3b;	&#xd;&#xa;		stArquivos 	&#x3a;&#x3d; reRegistro.arquivo&#x3b;&#xd;&#xa;    END LOOP&#x3b;&#xd;&#xa;    &#xd;&#xa;    StExercicio_ant &#x3a;&#x3d; &#x28;&#x28;&#x28;StExercicio&#x3a;&#x3a;int&#x29;-1&#x29;&#x3a;&#x3a;varchar&#x29;&#x3b;&#xd;&#xa;    &#xd;&#xa;    CREATE TEMPORARY TABLE tmp_table_acomp &#x28;arquivo varchar&#x28;200&#x29;, content json&#x29;&#x3b;&#xd;&#xa;    &#xd;&#xa;    if strpos&#x28;stArquivos,&#x27;&#x22;AEX.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;	 	then&#xd;&#xa;&#xd;&#xa;			with aex10 as&#xd;&#xa;			&#x28;&#xd;&#xa;			  		 SELECT    tipo_registro&#xd;&#xa;                              , cod_reduzido_aex&#xd;&#xa;                              , cod_orgao&#xd;&#xa;                              , cod_ext&#xd;&#xa;                              , cod_fonte_recurso&#xd;&#xa;                              , categoria&#xd;&#xa;                              , dt_lancamento&#xd;&#xa;                              , dt_anulacao_ext&#xd;&#xa;                              , justificativa_anulacao&#xd;&#xa;                              , vl_anulacao&#xd;&#xa;                      FROM &#x28;&#xd;&#xa;                              SELECT&#xd;&#xa;                              10 AS tipo_registro&#xd;&#xa;                              , LPAD&#x28;TTE.cod_lote&#x7c;&#x7c;&#x27;&#x27;&#x7c;&#x7c;TTE.cod_entidade&#x7c;&#x7c;TTE.exercicio&#x7c;&#x7c;&#x28;TTE.cod_lote_estorno&#x2b;1&#x29;,15,&#x27;0&#x27;&#x29; AS cod_reduzido_aex&#xd;&#xa;                              , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;                              , CASE  WHEN &#x28;balancete_extmmaa.tipo_lancamento &#x3d; 1&#x29;&#xd;&#xa;                                            THEN CASE WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 1&#xd;&#xa;                                            THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;                                            WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 2&#xd;&#xa;                                            THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;                                            WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 3&#xd;&#xa;                                            THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;                                            WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 4&#xd;&#xa;                                            THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;                                            ELSE plano_analitica.cod_plano&#x3a;&#x3a;VARCHAR&#xd;&#xa;                                       END&#xd;&#xa;                                          WHEN &#x28;balancete_extmmaa.tipo_lancamento &#x3d; 4&#x29;&#xd;&#xa;                                          THEN CASE WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 1&#xd;&#xa;                                            THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;                                            WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 2&#xd;&#xa;                                            THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;                                            ELSE plano_analitica.cod_plano&#x3a;&#x3a;VARCHAR&#xd;&#xa;                                       END&#xd;&#xa;                                  ELSE plano_analitica.cod_plano&#x3a;&#x3a;VARCHAR&#xd;&#xa;                              END AS cod_ext&#xd;&#xa;                              , COALESCE&#x28;CPR.cod_recurso,&#x27;100&#x27;&#x29; AS cod_fonte_recurso&#xd;&#xa;                              , CASE WHEN TT.cod_tipo&#x3d;1 THEN&#xd;&#xa;                                  2&#xd;&#xa;                              ELSE&#xd;&#xa;                                  1&#xd;&#xa;                              END&#xd;&#xa;                              AS categoria&#xd;&#xa;                              , TO_CHAR&#x28;TT.dt_autenticacao,&#x27;ddmmyyyy&#x27;&#x29; AS dt_lancamento&#xd;&#xa;                              , TO_CHAR&#x28;TTE.dt_autenticacao,&#x27;ddmmyyyy&#x27;&#x29; AS dt_anulacao_ext&#xd;&#xa;                              , CASE WHEN TTE.observacao ILIKE &#x27;&#x27; OR TTE.observacao IS NULL&#xd;&#xa;                                     THEN &#x27;Anulacao Extra&#x27;&#xd;&#xa;                                     ELSE TTE.observacao&#xd;&#xa;                                 END AS justificativa_anulacao&#xd;&#xa;                              , CASE WHEN TTE.valor &#x3c; 0 THEN REPLACE&#x28;&#x28;TTE.valor &#x2a; -1&#x29;&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29;&#xd;&#xa;                                     ELSE REPLACE&#x28;TTE.valor&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29;&#xd;&#xa;                              END as vl_anulacao&#xd;&#xa;                              FROM tesouraria.transferencia AS TT&#xd;&#xa;                              JOIN tesouraria.transferencia_estornada AS TTE&#xd;&#xa;                                  ON TTE.cod_lote&#x3d;TT.cod_lote&#xd;&#xa;                                  AND TTE.exercicio&#x3d;TT.exercicio&#xd;&#xa;                                  AND TTE.tipo&#x3d;TT.tipo&#xd;&#xa;                                  AND TTE.cod_entidade&#x3d;TT.cod_entidade&#xd;&#xa;                              JOIN contabilidade.plano_analitica&#xd;&#xa;                                  ON plano_analitica.cod_plano &#x3d; TT.cod_plano_debito&#xd;&#xa;                                  AND plano_analitica.exercicio &#x3d; TT.exercicio&#xd;&#xa;                              JOIN tcemg.balancete_extmmaa&#xd;&#xa;                                  ON balancete_extmmaa.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;                                  AND balancete_extmmaa.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;                              JOIN contabilidade.plano_conta&#xd;&#xa;                                  ON plano_analitica.exercicio &#x3d; plano_conta.exercicio&#xd;&#xa;                                  AND plano_analitica.cod_conta &#x3d; plano_conta.cod_conta&#xd;&#xa;                              JOIN administracao.configuracao_entidade&#xd;&#xa;                                  ON configuracao_entidade.cod_entidade &#x3d; TT.cod_entidade&#xd;&#xa;                                  AND configuracao_entidade.exercicio &#x3d; TT.exercicio&#xd;&#xa;                                  AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;                                  AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;                              LEFT JOIN contabilidade.plano_recurso AS CPR&#xd;&#xa;                                  ON CPR.exercicio&#x3d;plano_analitica.exercicio&#xd;&#xa;                                  AND CPR.cod_plano&#x3d;plano_analitica.cod_plano&#xd;&#xa;                              JOIN contabilidade.lote&#xd;&#xa;                                  ON TT.exercicio &#x3d; lote.exercicio&#xd;&#xa;                                  AND TT.cod_entidade &#x3d; lote.cod_entidade&#xd;&#xa;                                  AND TT.tipo &#x3d; lote.tipo&#xd;&#xa;                                  AND TT.cod_lote &#x3d; lote.cod_lote&#xd;&#xa;                              WHERE balancete_extmmaa.exercicio  &#x3d; stExercicio &#xd;&#xa;                              &#xd;&#xa;                              AND TTE.dt_autenticacao BETWEEN TO_DATE&#x28; &#x27;01&#x27; &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; lpad&#x28;stMes&#x3a;&#x3a;varchar,2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27; &#x29; AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes&#x3a;&#x3a;varchar,2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;                              &#xd;&#xa;                              AND TT.cod_entidade IN  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;  &#xd;&#xa;                              AND TT.cod_tipo IN &#x28;1,2&#x29;   &#xd;&#xa;                          UNION&#xd;&#xa;                              SELECT&#xd;&#xa;                              10 AS tipo_registro&#xd;&#xa;                              , LPAD&#x28;TTE.cod_lote&#x7c;&#x7c;&#x27;&#x27;&#x7c;&#x7c;TTE.cod_entidade&#x7c;&#x7c;TTE.exercicio&#x7c;&#x7c;&#x28;TTE.cod_lote_estorno&#x2b;1&#x29;,15,&#x27;0&#x27;&#x29; AS cod_reduzido_aex&#xd;&#xa;                              , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;                              , CASE  WHEN &#x28;balancete_extmmaa.tipo_lancamento &#x3d; 1&#x29;&#xd;&#xa;                                            THEN CASE WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 1&#xd;&#xa;                                            THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;                                            WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 2&#xd;&#xa;                                            THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;                                            WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 3&#xd;&#xa;                                            THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;                                            WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 4&#xd;&#xa;                                            THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;                                            ELSE plano_analitica.cod_plano&#x3a;&#x3a;VARCHAR&#xd;&#xa;                                       END&#xd;&#xa;                                          WHEN &#x28;balancete_extmmaa.tipo_lancamento &#x3d; 4&#x29;&#xd;&#xa;                                          THEN CASE WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 1&#xd;&#xa;                                            THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;                                            WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 2&#xd;&#xa;                                            THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;                                            ELSE plano_analitica.cod_plano&#x3a;&#x3a;VARCHAR&#xd;&#xa;                                       END&#xd;&#xa;                                  ELSE plano_analitica.cod_plano&#x3a;&#x3a;VARCHAR&#xd;&#xa;                              END AS cod_ext&#xd;&#xa;                              , COALESCE&#x28;CPR.cod_recurso,&#x27;100&#x27;&#x29; AS cod_fonte_recurso&#xd;&#xa;                              , CASE WHEN TT.cod_tipo&#x3d;1 THEN&#xd;&#xa;                                  2&#xd;&#xa;                              ELSE&#xd;&#xa;                                  1&#xd;&#xa;                              END&#xd;&#xa;                              AS categoria&#xd;&#xa;                              , TO_CHAR&#x28;TT.dt_autenticacao,&#x27;ddmmyyyy&#x27;&#x29; AS dt_lancamento&#xd;&#xa;                              , TO_CHAR&#x28;TTE.dt_autenticacao,&#x27;ddmmyyyy&#x27;&#x29; AS dt_anulacao_ext&#xd;&#xa;                              , CASE WHEN TTE.observacao ILIKE &#x27;&#x27; OR TTE.observacao IS NULL&#xd;&#xa;                                     THEN &#x27;Anulacao Extra&#x27;&#xd;&#xa;                                     ELSE TTE.observacao&#xd;&#xa;                                 END AS justificativa_anulacao&#xd;&#xa;                              , CASE WHEN TTE.valor &#x3c; 0 THEN REPLACE&#x28;&#x28;TTE.valor &#x2a; -1&#x29;&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29;&#xd;&#xa;                                     ELSE REPLACE&#x28;TTE.valor&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29;&#xd;&#xa;                              END as vl_anulacao&#xd;&#xa;                              FROM tesouraria.transferencia AS TT&#xd;&#xa;                              JOIN tesouraria.transferencia_estornada AS TTE&#xd;&#xa;                                  ON TTE.cod_lote&#x3d;TT.cod_lote&#xd;&#xa;                                  AND TTE.exercicio&#x3d;TT.exercicio&#xd;&#xa;                                  AND TTE.tipo&#x3d;TT.tipo&#xd;&#xa;                                  AND TTE.cod_entidade&#x3d;TT.cod_entidade&#xd;&#xa;                              JOIN contabilidade.plano_analitica&#xd;&#xa;                                  ON plano_analitica.cod_plano &#x3d; TT.cod_plano_credito&#xd;&#xa;                                  AND plano_analitica.exercicio &#x3d; TT.exercicio&#xd;&#xa;                              JOIN tcemg.balancete_extmmaa&#xd;&#xa;                                  ON balancete_extmmaa.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;                                  AND balancete_extmmaa.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;                              JOIN contabilidade.plano_conta&#xd;&#xa;                                  ON plano_analitica.exercicio &#x3d; plano_conta.exercicio&#xd;&#xa;                                  AND plano_analitica.cod_conta &#x3d; plano_conta.cod_conta&#xd;&#xa;                              JOIN administracao.configuracao_entidade&#xd;&#xa;                                  ON configuracao_entidade.cod_entidade &#x3d; TT.cod_entidade&#xd;&#xa;                                  AND configuracao_entidade.exercicio &#x3d; TT.exercicio&#xd;&#xa;                                  AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;                                  AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;                              LEFT JOIN contabilidade.plano_recurso AS CPR&#xd;&#xa;                                  ON CPR.exercicio&#x3d;plano_analitica.exercicio&#xd;&#xa;                                  AND CPR.cod_plano&#x3d;plano_analitica.cod_plano&#xd;&#xa;                              JOIN contabilidade.lote&#xd;&#xa;                                  ON TT.exercicio &#x3d; lote.exercicio&#xd;&#xa;                                  AND TT.cod_entidade &#x3d; lote.cod_entidade&#xd;&#xa;                                  AND TT.tipo &#x3d; lote.tipo&#xd;&#xa;                                  AND TT.cod_lote &#x3d; lote.cod_lote&#xd;&#xa;                              WHERE balancete_extmmaa.exercicio  &#x3d; stExercicio &#xd;&#xa;                              &#xd;&#xa;                              AND TTE.dt_autenticacao BETWEEN TO_DATE&#x28; &#x27;01&#x27; &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; lpad&#x28;stMes&#x3a;&#x3a;varchar,2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27; &#x29; AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes&#x3a;&#x3a;varchar,2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;&#xd;&#xa;                              AND TT.cod_entidade IN  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29; &#xd;&#xa;                              AND TT.cod_tipo IN &#x28;1,2&#x29;    &#xd;&#xa;                      &#x29; AS resultado&#xd;&#xa;                      GROUP BY tipo_registro&#xd;&#xa;                              , cod_reduzido_aex&#xd;&#xa;                              , cod_orgao&#xd;&#xa;                              , cod_ext&#xd;&#xa;                              , cod_fonte_recurso&#xd;&#xa;                              , categoria&#xd;&#xa;                              , dt_lancamento&#xd;&#xa;                              , dt_anulacao_ext&#xd;&#xa;                              , justificativa_anulacao&#xd;&#xa;                              , vl_anulacao&#xd;&#xa;                      ORDER BY cod_reduzido_aex&#xd;&#xa;			&#x29;, &#xd;&#xa;			  aex11 as &#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT tipo_registro&#xd;&#xa;                      , cod_reduzido_aex&#xd;&#xa;                      , nro_op&#xd;&#xa;                      , dt_pagamento&#xd;&#xa;                      , nro_anulacao_op&#xd;&#xa;                      , dt_anulacao_op&#xd;&#xa;                      , vl_anulacao_op&#xd;&#xa;&#xd;&#xa;                      FROM &#x28;&#xd;&#xa;                              SELECT&#xd;&#xa;                              11 AS tipo_registro&#xd;&#xa;                              , LPAD&#x28;TTE.cod_lote&#x7c;&#x7c;&#x27;&#x27;&#x7c;&#x7c;TTE.cod_entidade&#x7c;&#x7c;TTE.exercicio&#x7c;&#x7c;&#x28;TTE.cod_lote_estorno&#x2b;1&#x29;,15,&#x27;0&#x27;&#x29; AS cod_reduzido_aex&#xd;&#xa;                              , tcemg.seq_num_op_extra&#x28;TT.exercicio,TT.cod_entidade,1,TT.cod_lote&#x29;&#x3a;&#x3a;varchar&#x7c;&#x7c;balancete_extmmaa.cod_plano&#x7c;&#x7c;TO_CHAR&#x28;lote.dt_lote, &#x27;ddmmyyyy&#x27;&#x29; AS nro_op&#xd;&#xa;                              , TO_CHAR&#x28;TT.dt_autenticacao, &#x27;ddmmyyyy&#x27;&#x29; AS dt_pagamento&#xd;&#xa;                              , balancete_extmmaa.cod_plano&#x7c;&#x7c;&#x27;&#x27;&#x7c;&#x7c;TT.cod_lote&#x7c;&#x7c;lancamento.sequencia AS nro_anulacao_op&#xd;&#xa;                              , TO_CHAR&#x28;TTE.dt_autenticacao,&#x27;ddmmyyyy&#x27;&#x29; AS dt_anulacao_op&#xd;&#xa;                              , CASE WHEN valor_lancamento.vl_lancamento &#x3c; 0 THEN REPLACE&#x28;&#x28;valor_lancamento.vl_lancamento &#x2a; -1&#x29;&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29;&#xd;&#xa;                                     ELSE REPLACE&#x28;valor_lancamento.vl_lancamento&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29;&#xd;&#xa;                              END AS vl_anulacao_op&#xd;&#xa;                              FROM tesouraria.transferencia AS TT&#xd;&#xa;                              JOIN tesouraria.transferencia_estornada AS TTE&#xd;&#xa;                                  ON TTE.cod_lote&#x3d;TT.cod_lote&#xd;&#xa;                                  AND TTE.exercicio&#x3d;TT.exercicio&#xd;&#xa;                                  AND TTE.tipo&#x3d;TT.tipo&#xd;&#xa;                                  AND TTE.cod_entidade&#x3d;TT.cod_entidade&#xd;&#xa;                              JOIN contabilidade.plano_analitica&#xd;&#xa;                                  ON plano_analitica.cod_plano &#x3d; TT.cod_plano_debito&#xd;&#xa;                                  AND plano_analitica.exercicio &#x3d; TT.exercicio&#xd;&#xa;                              JOIN tcemg.balancete_extmmaa&#xd;&#xa;                                  ON balancete_extmmaa.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;                                  AND balancete_extmmaa.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;                              JOIN contabilidade.plano_conta&#xd;&#xa;                                  ON plano_analitica.exercicio &#x3d; plano_conta.exercicio&#xd;&#xa;                                  AND plano_analitica.cod_conta &#x3d; plano_conta.cod_conta&#xd;&#xa;                              JOIN contabilidade.lote&#xd;&#xa;                                  ON TT.exercicio &#x3d; lote.exercicio&#xd;&#xa;                                  AND TT.cod_entidade &#x3d; lote.cod_entidade&#xd;&#xa;                                  AND TT.tipo &#x3d; lote.tipo&#xd;&#xa;                                  AND TT.cod_lote &#x3d; lote.cod_lote&#xd;&#xa;                              JOIN contabilidade.conta_debito&#xd;&#xa;                                  ON plano_analitica.exercicio &#x3d; conta_debito.exercicio&#xd;&#xa;                                  AND plano_analitica.cod_plano &#x3d; conta_debito.cod_plano&#xd;&#xa;                                  AND TT.cod_lote &#x3d; conta_debito.cod_lote&#xd;&#xa;                              JOIN contabilidade.valor_lancamento&#xd;&#xa;                                  ON conta_debito.exercicio &#x3d; valor_lancamento.exercicio&#xd;&#xa;                                  AND conta_debito.cod_entidade &#x3d; valor_lancamento.cod_entidade&#xd;&#xa;                                  AND conta_debito.tipo &#x3d; valor_lancamento.tipo&#xd;&#xa;                                  AND conta_debito.cod_lote &#x3d; valor_lancamento.cod_lote&#xd;&#xa;                                  AND conta_debito.sequencia &#x3d; valor_lancamento.sequencia&#xd;&#xa;                                  AND conta_debito.tipo_valor &#x3d; valor_lancamento.tipo_valor&#xd;&#xa;                                  AND conta_debito.tipo &#x3c;&#x3e; &#x27;I&#x27;&#xd;&#xa;                              JOIN contabilidade.lancamento&#xd;&#xa;                                  ON lancamento.exercicio&#x3d;valor_lancamento.exercicio&#xd;&#xa;                                  AND lancamento.cod_entidade&#x3d;valor_lancamento.cod_entidade&#xd;&#xa;                                  AND lancamento.tipo&#x3d;valor_lancamento.tipo&#xd;&#xa;                                  AND lancamento.cod_lote&#x3d;valor_lancamento.cod_lote&#xd;&#xa;                                  AND lancamento.sequencia&#x3d;valor_lancamento.sequencia&#xd;&#xa;                              WHERE balancete_extmmaa.exercicio  &#x3d; stExercicio &#xd;&#xa;                              &#xd;&#xa;                              AND TTE.dt_autenticacao BETWEEN TO_DATE&#x28; &#x27;01&#x27; &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; lpad&#x28;stMes&#x3a;&#x3a;varchar,2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27; &#x29; AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes&#x3a;&#x3a;varchar,2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;                              &#xd;&#xa;                              AND TT.cod_entidade IN  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;                              AND TT.cod_tipo IN &#x28;1,2&#x29;  &#xd;&#xa;                              UNION&#xd;&#xa;                              SELECT&#xd;&#xa;                              11 AS tipo_registro&#xd;&#xa;                              , LPAD&#x28;TTE.cod_lote&#x7c;&#x7c;&#x27;&#x27;&#x7c;&#x7c;TTE.cod_entidade&#x7c;&#x7c;TTE.exercicio&#x7c;&#x7c;&#x28;TTE.cod_lote_estorno&#x2b;1&#x29;,15,&#x27;0&#x27;&#x29; AS cod_reduzido_aex&#xd;&#xa;                              , tcemg.seq_num_op_extra&#x28;TT.exercicio,TT.cod_entidade,2,TT.cod_lote&#x29;&#x3a;&#x3a;varchar&#x7c;&#x7c;balancete_extmmaa.cod_plano&#x7c;&#x7c;TO_CHAR&#x28;lote.dt_lote, &#x27;ddmmyyyy&#x27;&#x29; AS nro_op&#xd;&#xa;                              , TO_CHAR&#x28;TT.dt_autenticacao, &#x27;ddmmyyyy&#x27;&#x29; AS dt_pagamento&#xd;&#xa;                              , balancete_extmmaa.cod_plano&#x7c;&#x7c;&#x27;&#x27;&#x7c;&#x7c;TT.cod_lote&#x7c;&#x7c;lancamento.sequencia AS nro_anulacao_op&#xd;&#xa;                              , TO_CHAR&#x28;TTE.dt_autenticacao,&#x27;ddmmyyyy&#x27;&#x29; AS dt_anulacao_op&#xd;&#xa;                              , CASE WHEN valor_lancamento.vl_lancamento &#x3c; 0 THEN REPLACE&#x28;&#x28;valor_lancamento.vl_lancamento &#x2a; -1&#x29;&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29;&#xd;&#xa;                                     ELSE REPLACE&#x28;valor_lancamento.vl_lancamento&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29;&#xd;&#xa;                              END AS vl_anulacao_op&#xd;&#xa;                              FROM tesouraria.transferencia AS TT&#xd;&#xa;                              JOIN tesouraria.transferencia_estornada AS TTE&#xd;&#xa;                                  ON TTE.cod_lote&#x3d;TT.cod_lote&#xd;&#xa;                                  AND TTE.exercicio&#x3d;TT.exercicio&#xd;&#xa;                                  AND TTE.tipo&#x3d;TT.tipo&#xd;&#xa;                                  AND TTE.cod_entidade&#x3d;TT.cod_entidade&#xd;&#xa;                              JOIN contabilidade.plano_analitica&#xd;&#xa;                                  ON plano_analitica.cod_plano &#x3d; TT.cod_plano_credito&#xd;&#xa;                                  AND plano_analitica.exercicio &#x3d; TT.exercicio&#xd;&#xa;                              JOIN tcemg.balancete_extmmaa&#xd;&#xa;                                  ON balancete_extmmaa.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;                                  AND balancete_extmmaa.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;                              JOIN contabilidade.plano_conta&#xd;&#xa;                                  ON plano_analitica.exercicio &#x3d; plano_conta.exercicio&#xd;&#xa;                                  AND plano_analitica.cod_conta &#x3d; plano_conta.cod_conta&#xd;&#xa;                              JOIN contabilidade.lote&#xd;&#xa;                                  ON TT.exercicio &#x3d; lote.exercicio&#xd;&#xa;                                  AND TT.cod_entidade &#x3d; lote.cod_entidade&#xd;&#xa;                                  AND TT.tipo &#x3d; lote.tipo&#xd;&#xa;                                  AND TT.cod_lote &#x3d; lote.cod_lote&#xd;&#xa;                              JOIN contabilidade.conta_credito&#xd;&#xa;                                  ON plano_analitica.exercicio &#x3d; conta_credito.exercicio&#xd;&#xa;                                  AND plano_analitica.cod_plano &#x3d; conta_credito.cod_plano&#xd;&#xa;                                  AND TT.cod_lote &#x3d; conta_credito.cod_lote&#xd;&#xa;                              JOIN contabilidade.valor_lancamento&#xd;&#xa;                                  ON conta_credito.exercicio &#x3d; valor_lancamento.exercicio&#xd;&#xa;                                  AND conta_credito.cod_entidade &#x3d; valor_lancamento.cod_entidade&#xd;&#xa;                                  AND conta_credito.tipo &#x3d; valor_lancamento.tipo&#xd;&#xa;                                  AND conta_credito.cod_lote &#x3d; valor_lancamento.cod_lote&#xd;&#xa;                                  AND conta_credito.sequencia &#x3d; valor_lancamento.sequencia&#xd;&#xa;                                  AND conta_credito.tipo_valor &#x3d; valor_lancamento.tipo_valor&#xd;&#xa;                                  AND conta_credito.tipo &#x3c;&#x3e; &#x27;I&#x27;&#xd;&#xa;                              JOIN contabilidade.lancamento&#xd;&#xa;                                  ON lancamento.exercicio&#x3d;valor_lancamento.exercicio&#xd;&#xa;                                  AND lancamento.cod_entidade&#x3d;valor_lancamento.cod_entidade&#xd;&#xa;                                  AND lancamento.tipo&#x3d;valor_lancamento.tipo&#xd;&#xa;                                  AND lancamento.cod_lote&#x3d;valor_lancamento.cod_lote&#xd;&#xa;                                  AND lancamento.sequencia&#x3d;valor_lancamento.sequencia&#xd;&#xa;                              WHERE balancete_extmmaa.exercicio  &#x3d; stExercicio &#xd;&#xa;                              &#xd;&#xa;                              AND TTE.dt_autenticacao BETWEEN TO_DATE&#x28; &#x27;01&#x27; &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; lpad&#x28;stMes&#x3a;&#x3a;varchar,2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27; &#x29; AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes&#x3a;&#x3a;varchar,2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;                              &#xd;&#xa;                              AND TT.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;                              AND TT.cod_tipo IN &#x28;1,2&#x29;   &#xd;&#xa;                      &#x29; AS resultado&#xd;&#xa;                      GROUP BY tipo_registro&#xd;&#xa;                              , cod_reduzido_aex&#xd;&#xa;                              , nro_op&#xd;&#xa;                              , dt_pagamento&#xd;&#xa;                              , nro_anulacao_op&#xd;&#xa;                              , dt_anulacao_op&#xd;&#xa;                              , vl_anulacao_op&#xd;&#xa;                      ORDER BY cod_reduzido_aex&#xd;&#xa;			&#x29;,&#xd;&#xa;			  aex_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					cod_reduzido_aex, &#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; cod_reduzido_aex&#x3a;&#x3a;int8&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_orgao, &#x27;&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; cod_ext&#x3a;&#x3a;int8&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_fonte_recurso&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;categoria&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;dt_lancamento, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;dt_anulacao_ext, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;justificativa_anulacao,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,500&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_anulacao,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;    &#xd;&#xa;					as d&#xd;&#xa;				from aex10  &#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					cod_reduzido_aex,&#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; cod_reduzido_aex&#x3a;&#x3a;int8&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; nro_op&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;dt_pagamento, &#x27;&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_anulacao_op,&#x27;&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;dt_anulacao_op, &#x27;&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_anulacao_op,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;     	&#xd;&#xa;					as d&#xd;&#xa;				from aex11	&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;AEX.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from aex_format order by cod_reduzido_aex,tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;    if strpos&#x28;stArquivos,&#x27;&#x22;ANL.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;        then&#xd;&#xa;            with anl10 as&#xd;&#xa;			&#x28;&#xd;&#xa;	 			 SELECT 10 AS tipo_registro&#xd;&#xa;		               , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;		               , CASE WHEN restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;		                       THEN CASE WHEN uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;		                                 THEN LPAD&#x28;LPAD&#x28;uniorcam.num_orgao_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;uniorcam.num_unidade_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                 ELSE LPAD&#x28;restos_pre_empenho.num_unidade&#x3a;&#x3a;VARCHAR,5,&#x27;0&#x27;&#x29;&#xd;&#xa;		                             END&#xd;&#xa;		                       ELSE LPAD&#x28;&#x28;LPAD&#x28;despesa.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;despesa.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;		                  END AS cod_unidade&#xd;&#xa;		               , empenho.cod_empenho AS num_empenho&#xd;&#xa;		               , TO_CHAR &#x28;empenho.dt_empenho, &#x27;ddmmyyyy&#x27;&#x29; AS dt_empenho&#xd;&#xa;		               , TO_CHAR&#x28;empenho_anulado.timestamp,&#x27;ddmmyyyy&#x27;&#x29; AS dt_anulacao&#xd;&#xa;		               , &#x28;empenho.exercicio&#x7c;&#x7c;LPAD&#x28;tc.numero_anulacao_empenho&#x28;empenho_anulado.exercicio, empenho_anulado.cod_entidade, empenho_anulado.cod_empenho, empenho_anulado.timestamp&#x29;&#x3a;&#x3a;VARCHAR, 18, &#x27;0&#x27;&#x29;&#x29;&#x3a;&#x3a;VARCHAR AS num_anulacao&#xd;&#xa;		               , 1 AS tipo_anulacao &#xd;&#xa;		               , empenho_anulado.motivo AS espc_anl_emp&#xd;&#xa;		               , SUM&#x28;valor_anulado&#x29; AS vl_anulado&#xd;&#xa;		            FROM &#x28;&#xd;&#xa;		                  SELECT empenho_anulado.exercicio&#xd;&#xa;		                       , empenho_anulado.cod_entidade&#xd;&#xa;		                       , empenho_anulado.cod_empenho&#xd;&#xa;		                       , empenho_anulado.timestamp&#xd;&#xa;		                       , empenho_anulado.motivo&#xd;&#xa;		                       , COALESCE&#x28;SUM&#x28;empenho_anulado_item.vl_anulado&#x29;,0.00&#x29; AS valor_anulado&#xd;&#xa;		                    FROM empenho.empenho_anulado&#xd;&#xa;		              INNER JOIN empenho.empenho_anulado_item&#xd;&#xa;		                      ON empenho_anulado_item.exercicio &#x3d; empenho_anulado.exercicio&#xd;&#xa;		                     AND empenho_anulado_item.cod_entidade &#x3d; empenho_anulado.cod_entidade&#xd;&#xa;		                     AND empenho_anulado_item.cod_empenho &#x3d; empenho_anulado.cod_empenho&#xd;&#xa;		                     AND empenho_anulado_item.timestamp &#x3d; empenho_anulado.timestamp&#xd;&#xa;		                GROUP BY empenho_anulado.exercicio&#xd;&#xa;		                       , empenho_anulado.cod_entidade&#xd;&#xa;		                       , empenho_anulado.cod_empenho&#xd;&#xa;		                       , empenho_anulado.timestamp&#xd;&#xa;		                 &#x29; AS empenho_anulado&#xd;&#xa;		      INNER JOIN empenho.empenho&#xd;&#xa;		              ON empenho_anulado.exercicio    &#x3d; empenho.exercicio&#xd;&#xa;		             AND empenho_anulado.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;		             AND empenho_anulado.cod_empenho  &#x3d; empenho.cod_empenho&#xd;&#xa;		      INNER JOIN empenho.pre_empenho&#xd;&#xa;		              ON pre_empenho.exercicio &#x3d; empenho.exercicio&#xd;&#xa;		             AND pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;		       LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;		              ON pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;		             AND pre_empenho_despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;		       LEFT JOIN empenho.restos_pre_empenho&#xd;&#xa;		              ON pre_empenho.cod_pre_empenho &#x3d; restos_pre_empenho.cod_pre_empenho&#xd;&#xa;		             AND pre_empenho.exercicio &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;		       LEFT JOIN tcemg.uniorcam&#xd;&#xa;		              ON uniorcam.num_unidade &#x3d; restos_pre_empenho.num_unidade&#xd;&#xa;		             AND uniorcam.num_orgao   &#x3d; restos_pre_empenho.num_orgao&#xd;&#xa;		             AND uniorcam.exercicio   &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;		             AND uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;		       LEFT JOIN orcamento.despesa&#xd;&#xa;		              ON despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;		             AND despesa.exercicio   &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;		     INNER JOIN administracao.configuracao_entidade&#xd;&#xa;		              ON configuracao_entidade.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;		             AND configuracao_entidade.exercicio    &#x3d; stExercicio  &#xd;&#xa;		             AND configuracao_entidade.cod_modulo   &#x3d; 55&#xd;&#xa;		             AND configuracao_entidade.parametro    &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;		           WHERE empenho_anulado.cod_entidade IN  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;  &#xd;&#xa;		             AND empenho.exercicio &#x3d; stExercicio    &#xd;&#xa;		             AND empenho_anulado.timestamp&#x3a;&#x3a;date BETWEEN TO_DATE&#x28;&#x27;01&#x27;&#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;		                                                     AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;&#xd;&#xa;		        GROUP BY tipo_registro&#xd;&#xa;		               , cod_orgao&#xd;&#xa;		               , cod_unidade&#xd;&#xa;		               , num_empenho&#xd;&#xa;		               , dt_empenho&#xd;&#xa;		               , dt_anulacao&#xd;&#xa;		               , num_anulacao&#xd;&#xa;		               , tipo_anulacao&#xd;&#xa;		               , espc_anl_emp&#xd;&#xa;		        ORDER BY num_empenho&#xd;&#xa;		               , num_anulacao&#xd;&#xa;			&#x29;, &#xd;&#xa;			  anl11 as &#xd;&#xa;			&#x28;&#xd;&#xa;		          SELECT 11 AS tipo_registro&#xd;&#xa;		               , CASE WHEN restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;		                       THEN CASE WHEN uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;		                                 THEN LPAD&#x28;LPAD&#x28;uniorcam.num_orgao_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;uniorcam.num_unidade_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                 ELSE LPAD&#x28;restos_pre_empenho.num_unidade&#x3a;&#x3a;VARCHAR,5,&#x27;0&#x27;&#x29;&#xd;&#xa;		                             END&#xd;&#xa;		                       ELSE LPAD&#x28;&#x28;LPAD&#x28;despesa.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;despesa.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;		                  END AS cod_unidade&#xd;&#xa;		               , empenho.cod_empenho AS num_empenho&#xd;&#xa;		               , empenho.exercicio&#x7c;&#x7c;LPAD&#x28;tc.numero_anulacao_empenho&#x28;empenho_anulado.exercicio, empenho_anulado.cod_entidade, empenho_anulado.cod_empenho, empenho_anulado.timestamp&#x29;&#x3a;&#x3a;VARCHAR, 18, &#x27;0&#x27;&#x29; AS num_anulacao&#xd;&#xa;		               , CASE WHEN restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;		                      THEN restos_pre_empenho.recurso&#xd;&#xa;		                      ELSE despesa.cod_recurso&#xd;&#xa;		                  END AS cod_fonte_recurso&#xd;&#xa;		               , SUM&#x28;valor_anulado&#x29; AS vl_anulacao_fonte&#xd;&#xa;		            FROM &#x28;&#xd;&#xa;		                  SELECT empenho_anulado.exercicio&#xd;&#xa;		                       , empenho_anulado.cod_entidade&#xd;&#xa;		                       , empenho_anulado.cod_empenho&#xd;&#xa;		                       , empenho_anulado.timestamp&#xd;&#xa;		                       , empenho_anulado.motivo&#xd;&#xa;		                       , COALESCE&#x28;SUM&#x28;empenho_anulado_item.vl_anulado&#x29;,0.00&#x29; AS valor_anulado&#xd;&#xa;		                    FROM empenho.empenho_anulado&#xd;&#xa;		              INNER JOIN empenho.empenho_anulado_item&#xd;&#xa;		                      ON empenho_anulado_item.exercicio &#x3d; empenho_anulado.exercicio&#xd;&#xa;		                     AND empenho_anulado_item.cod_entidade &#x3d; empenho_anulado.cod_entidade&#xd;&#xa;		                     AND empenho_anulado_item.cod_empenho &#x3d; empenho_anulado.cod_empenho&#xd;&#xa;		                     AND empenho_anulado_item.timestamp &#x3d; empenho_anulado.timestamp&#xd;&#xa;		                GROUP BY empenho_anulado.exercicio&#xd;&#xa;		                       , empenho_anulado.cod_entidade&#xd;&#xa;		                       , empenho_anulado.cod_empenho&#xd;&#xa;		                       , empenho_anulado.timestamp&#xd;&#xa;		                 &#x29; AS empenho_anulado&#xd;&#xa;		      INNER JOIN empenho.empenho&#xd;&#xa;		              ON empenho_anulado.exercicio    &#x3d; empenho.exercicio&#xd;&#xa;		             AND empenho_anulado.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;		             AND empenho_anulado.cod_empenho  &#x3d; empenho.cod_empenho&#xd;&#xa;		      INNER JOIN empenho.pre_empenho&#xd;&#xa;		              ON pre_empenho.exercicio &#x3d; empenho.exercicio&#xd;&#xa;		             AND pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;		       LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;		              ON pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;		             AND pre_empenho_despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;		       LEFT JOIN empenho.restos_pre_empenho&#xd;&#xa;		              ON pre_empenho.cod_pre_empenho &#x3d; restos_pre_empenho.cod_pre_empenho&#xd;&#xa;		             AND pre_empenho.exercicio &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;		       LEFT JOIN tcemg.uniorcam&#xd;&#xa;		              ON uniorcam.num_unidade &#x3d; restos_pre_empenho.num_unidade&#xd;&#xa;		             AND uniorcam.num_orgao   &#x3d; restos_pre_empenho.num_orgao&#xd;&#xa;		             AND uniorcam.exercicio   &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;		             AND uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;		       LEFT JOIN orcamento.despesa&#xd;&#xa;		              ON despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;		             AND despesa.exercicio   &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;		     INNER JOIN administracao.configuracao_entidade&#xd;&#xa;		              ON configuracao_entidade.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;		             AND configuracao_entidade.exercicio    &#x3d; stExercicio   &#xd;&#xa;		             AND configuracao_entidade.cod_modulo   &#x3d; 55&#xd;&#xa;		             AND configuracao_entidade.parametro    &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;		           WHERE empenho_anulado.cod_entidade IN  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;		             AND empenho.exercicio &#x3d; stExercicio   &#xd;&#xa;		             AND empenho_anulado.timestamp&#x3a;&#x3a;date BETWEEN TO_DATE&#x28;&#x27;01&#x27; &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;		                                                     AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c;&#x27;-&#x27;&#x7c;&#x7c; stMes &#x7c;&#x7c;&#x27;-&#x27;&#x7c;&#x7c;&#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;&#xd;&#xa;		        GROUP BY tipo_registro&#xd;&#xa;		               , cod_unidade&#xd;&#xa;		               , num_empenho&#xd;&#xa;		               , num_anulacao&#xd;&#xa;		               , cod_fonte_recurso&#xd;&#xa;		        ORDER BY num_empenho&#xd;&#xa;		               , num_anulacao&#xd;&#xa;			&#x29;,&#xd;&#xa;			  anl_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					cod_unidade, &#xd;&#xa;					num_empenho,&#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_orgao, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_unidade, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_empenho&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;dt_empenho, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;dt_anulacao,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_anulacao, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_anulacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;espc_anl_emp,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,200&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;vl_anulado&#x3a;&#x3a;varchar,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from anl10  &#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					cod_unidade,&#xd;&#xa;					num_empenho,&#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_unidade, &#x27;&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_empenho&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_anulacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_fonte_recurso&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;			&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;vl_anulacao_fonte&#x3a;&#x3a;varchar,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from anl11	&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;ANL.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from anl_format order by cod_unidade,num_empenho,tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;        &#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;    if strpos&#x28;stArquivos,&#x27;&#x22;CRONEM.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with cronem as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 10 AS tipo_registro&#xd;&#xa;	                         , LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;cronem.num_orgao,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;	                         , LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;cronem.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;cronem.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29; AS cod_unidade_sub&#xd;&#xa;	                         , cronem.valor AS vl_dot_mensal&#xd;&#xa;	                         , cronem.cod_grupo AS grupo_despesa&#xd;&#xa;	                         , cronem.periodo&#xd;&#xa;	                      FROM tcemg.cronograma_execucao_mensal_desembolso AS cronem&#xd;&#xa;	                     WHERE cronem.cod_entidade IN  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;  &#xd;&#xa;	                       AND cronem.exercicio &#x3d; stExercicio  &#xd;&#xa;	                       AND cronem.periodo &#x3d; stPeriodo&#x3a;&#x3a;int  &#xd;&#xa;	                  ORDER BY cod_orgao&#xd;&#xa;					       , cod_unidade_sub&#xd;&#xa;						   , grupo_despesa&#xd;&#xa;						   , periodo&#xd;&#xa;			&#x29;, &#xd;&#xa;			  cronem_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					cod_orgao, &#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_orgao, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_unidade_sub, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;grupo_despesa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;,1, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;vl_dot_mensal&#x3a;&#x3a;varchar,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from cronem  &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;CRONEM.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from cronem_format order by cod_orgao,tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;		&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;AOP.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then 			&#xd;&#xa;			with aop10 as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT &#x27;10&#x27; AS tiporegistro&#xd;&#xa;	                       , LPAD&#x28;ordem_pagamento.cod_ordem&#x3a;&#x3a;VARCHAR,7,&#x27;0&#x27;&#x29;&#x7c;&#x7c;ordem_pagamento.exercicio&#x7c;&#x7c;TO_CHAR&#x28;nlpa.timestamp_anulada,&#x27;hh24mi&#x27;&#x29; AS codreduzido&#xd;&#xa;	                       , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS codorgao&#xd;&#xa;	                       , CASE WHEN pre_empenho.cod_pre_empenho &#x3d; restos_pre_empenho.cod_pre_empenho AND pre_empenho.implantado &#x3d; &#x27;t&#x27;&#xd;&#xa;	                              THEN CASE WHEN uniorcam_restos_atual.num_orgao IS NOT NULL&#xd;&#xa;	                                        THEN LPAD&#x28;LPAD&#x28;uniorcam_restos_atual.num_orgao&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;uniorcam_restos_atual.num_unidade&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#xd;&#xa;	                                        ELSE LPAD&#x28;restos_pre_empenho.num_unidade&#x3a;&#x3a;VARCHAR,5,&#x27;0&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#xd;&#xa;	                                    END&#xd;&#xa;	                              ELSE LPAD&#x28;&#x28;lpad&#x28;despesa.num_orgao&#x3a;&#x3a;VARCHAR, 3, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;despesa.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x29;,5,&#x27;0&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#xd;&#xa;	                          END AS codunidadesub&#xd;&#xa;	                       , TO_CHAR&#x28;nlp.timestamp,&#x27;yyyymmddHH24MI&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;ordem_pagamento.cod_ordem&#x3a;&#x3a;VARCHAR,10,&#x27;0&#x27;&#x29; AS nroop &#xd;&#xa;	                       , TO_CHAR&#x28;nlp.timestamp,&#x27;ddmmyyyy&#x27;&#x29; AS dtpagamento&#xd;&#xa;	                       , TO_CHAR&#x28;nlpa.timestamp_anulada,&#x27;yyyymmddhh24MISS&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;ordem_pagamento.cod_ordem&#x3a;&#x3a;VARCHAR, 8, &#x27;0&#x27;&#x29; AS nroanulacaoop&#xd;&#xa;	                       , TO_CHAR&#x28;nlpa.timestamp_anulada,&#x27;ddmmyyyy&#x27;&#x29; AS dtanulacaoop&#xd;&#xa;	                       , CASE WHEN nlpa.observacao &#x3d; &#x27;&#x27;&#xd;&#xa;	                              THEN &#x27;Anula&#xe7;&#xe3;o de Pagamento&#x27;&#xd;&#xa;	                              ELSE nlpa.observacao&#xd;&#xa;	                          END AS justificativaanulacao&#xd;&#xa;	                       , SUM&#x28;COALESCE&#x28;nlpa.vl_anulado,0.00&#x29;&#x29; AS vlanulacaoop&#xd;&#xa;	                    FROM empenho.nota_liquidacao_paga AS nlp&#xd;&#xa;	              INNER JOIN empenho.nota_liquidacao_paga_anulada AS nlpa&#xd;&#xa;	                      ON nlpa.exercicio    &#x3d; nlp.exercicio&#xd;&#xa;	                     AND nlpa.cod_nota     &#x3d; nlp.cod_nota&#xd;&#xa;	                     AND nlpa.cod_entidade &#x3d; nlp.cod_entidade&#xd;&#xa;	                     AND nlpa.timestamp    &#x3d; nlp.timestamp&#xd;&#xa;	               LEFT JOIN empenho.pagamento_liquidacao_nota_liquidacao_paga AS plnlp&#xd;&#xa;	                      ON nlp.cod_entidade &#x3d; plnlp.cod_entidade&#xd;&#xa;	                     AND nlp.cod_nota     &#x3d; plnlp.cod_nota&#xd;&#xa;	                     AND nlp.exercicio    &#x3d; plnlp.exercicio_liquidacao&#xd;&#xa;	                     AND nlp.timestamp    &#x3d; plnlp.timestamp&#xd;&#xa;	               LEFT JOIN empenho.pagamento_liquidacao AS pl&#xd;&#xa;	                      ON pl.cod_entidade         &#x3d; plnlp.cod_entidade&#xd;&#xa;	                     AND pl.cod_nota             &#x3d; plnlp.cod_nota&#xd;&#xa;	                     AND pl.exercicio            &#x3d; plnlp.exercicio&#xd;&#xa;	                     AND pl.exercicio_liquidacao &#x3d; plnlp.exercicio_liquidacao&#xd;&#xa;	                     AND pl.cod_ordem            &#x3d; plnlp.cod_ordem&#xd;&#xa;	               LEFT JOIN empenho.nota_liquidacao AS nl&#xd;&#xa;	                      ON nl.exercicio    &#x3d; pl.exercicio_liquidacao&#xd;&#xa;	                     AND nl.cod_nota     &#x3d; pl.cod_nota&#xd;&#xa;	                     AND nl.cod_entidade &#x3d; pl.cod_entidade&#xd;&#xa;	               LEFT JOIN empenho.empenho&#xd;&#xa;	                      ON empenho.exercicio    &#x3d; nl.exercicio_empenho&#xd;&#xa;	                     AND empenho.cod_entidade &#x3d; nl.cod_entidade&#xd;&#xa;	                     AND empenho.cod_empenho  &#x3d; nl.cod_empenho&#xd;&#xa;	               LEFT JOIN administracao.configuracao_entidade&#xd;&#xa;	                      ON configuracao_entidade.cod_entidade &#x3d; nlp.cod_entidade&#xd;&#xa;	                     AND configuracao_entidade.exercicio    &#x3d;  stExercicio &#xd;&#xa;	                     AND configuracao_entidade.cod_modulo   &#x3d; 55&#xd;&#xa;	                     AND configuracao_entidade.parametro    &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	               LEFT JOIN empenho.ordem_pagamento&#xd;&#xa;	                      ON pl.exercicio    &#x3d; ordem_pagamento.exercicio&#xd;&#xa;	                     AND pl.cod_entidade &#x3d; ordem_pagamento.cod_entidade&#xd;&#xa;	                     AND pl.cod_ordem    &#x3d; ordem_pagamento.cod_ordem&#xd;&#xa;	               LEFT JOIN empenho.pre_empenho&#xd;&#xa;	                      ON pre_empenho.exercicio       &#x3d; empenho.exercicio&#xd;&#xa;	                     AND pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;	               LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;	                      ON pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                     AND pre_empenho_despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	               LEFT JOIN empenho.restos_pre_empenho&#xd;&#xa;	                      ON pre_empenho.cod_pre_empenho &#x3d; restos_pre_empenho.cod_pre_empenho&#xd;&#xa;	                     AND pre_empenho.exercicio &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;	               LEFT JOIN tcemg.uniorcam AS uniorcam_restos&#xd;&#xa;	                      ON uniorcam_restos.num_unidade &#x3d; restos_pre_empenho.num_unidade&#xd;&#xa;	                     AND uniorcam_restos.num_orgao   &#x3d; restos_pre_empenho.num_orgao&#xd;&#xa;	                     AND uniorcam_restos.exercicio   &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;	                     AND uniorcam_restos.num_orgao_atual IS NOT NULL&#xd;&#xa;	               LEFT JOIN tcemg.uniorcam AS uniorcam_restos_atual&#xd;&#xa;	                      ON uniorcam_restos_atual.num_unidade &#x3d; uniorcam_restos.num_unidade_atual&#xd;&#xa;	                     AND uniorcam_restos_atual.num_orgao   &#x3d; uniorcam_restos.num_orgao_atual&#xd;&#xa;	                     AND uniorcam_restos_atual.exercicio   &#x3d; stExercicio  &#xd;&#xa;	               LEFT JOIN orcamento.despesa&#xd;&#xa;	                      ON despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;	                     AND despesa.exercicio   &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;	                   WHERE nlpa.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;	                     AND TO_DATE&#x28;nlpa.timestamp_anulada&#x3a;&#x3a;varchar, &#x27;YYYY-MM-DD&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;  AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;	                GROUP BY tiporegistro&#xd;&#xa;	                       , codreduzido&#xd;&#xa;	                       , codorgao&#xd;&#xa;	                       , codunidadesub&#xd;&#xa;	                       , nroop&#xd;&#xa;	                       , dtpagamento&#xd;&#xa;	                       , nroanulacaoop&#xd;&#xa;	                       , dtanulacaoop&#xd;&#xa;	                       , justificativaanulacao&#xd;&#xa;	                ORDER BY nroop&#xd;&#xa;			&#x29;, &#xd;&#xa;			  aop11 as &#xd;&#xa;			&#x28;&#xd;&#xa;	                  SELECT &#x27;11&#x27; AS tiporegistro&#xd;&#xa;	                       , LPAD&#x28;ordem_pagamento.cod_ordem&#x3a;&#x3a;VARCHAR,7,&#x27;0&#x27;&#x29;&#x7c;&#x7c;ordem_pagamento.exercicio&#x7c;&#x7c;TO_CHAR&#x28;nlpa.timestamp_anulada,&#x27;hh24mi&#x27;&#x29; AS codreduzido &#xd;&#xa;	                       , CASE WHEN TO_CHAR&#x28;empenho.dt_empenho, &#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3c; 2015 AND TO_CHAR&#x28;nl.dt_liquidacao, &#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3c; 2015 AND TO_CHAR&#x28;plnlp.timestamp,&#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3d; 2015&#xd;&#xa;	                              THEN &#x27;3&#x27;&#xd;&#xa;	                              WHEN TO_CHAR&#x28;empenho.dt_empenho, &#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3c; 2015 AND TO_CHAR&#x28;nl.dt_liquidacao, &#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3d; 2015 AND TO_CHAR&#x28;plnlp.timestamp,&#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3d; 2015&#xd;&#xa;	                              THEN &#x27;4&#x27;&#xd;&#xa;	                              WHEN TO_CHAR&#x28;empenho.dt_empenho, &#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3d; 2015 AND TO_CHAR&#x28;nl.dt_liquidacao, &#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3d; 2015 AND TO_CHAR&#x28;plnlp.timestamp,&#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3d; 2015 AND conta_despesa.cod_estrutural ILIKE &#x27;4.6&#x25;&#x27;&#xd;&#xa;	                              THEN &#x27;2&#x27;&#xd;&#xa;	                              ELSE &#x27;1&#x27;&#xd;&#xa;	                          END AS tipopagamento&#xd;&#xa;	                       , empenho.cod_empenho AS nroempenho&#xd;&#xa;	                       , empenho.dt_empenho AS dtempenho&#xd;&#xa;	                       , TCEMG.numero_nota_liquidacao&#x28; stExercicio &#xd;&#xa;	                                                     , empenho.cod_entidade&#xd;&#xa;	                                                     , nl.cod_nota&#xd;&#xa;	                                                     , nl.exercicio_empenho&#xd;&#xa;	                                                     , empenho.cod_empenho&#xd;&#xa;	                         &#x29; AS nroliquidacao&#xd;&#xa;	                       , nl.dt_liquidacao AS dtliquidacao&#xd;&#xa;	                       , CASE WHEN restos_pre_empenho.recurso IS NOT NULL&#xd;&#xa;	                              THEN restos_pre_empenho.recurso&#xd;&#xa;	                              ELSE despesa.cod_recurso&#xd;&#xa;	                          END AS codfontrecurso&#xd;&#xa;	                       , SUM&#x28;COALESCE&#x28;nlpa.vl_anulado,0.00&#x29;&#x29; AS vlanulacaofonte&#xd;&#xa;	                    FROM empenho.nota_liquidacao_paga AS nlp&#xd;&#xa;	              INNER JOIN empenho.nota_liquidacao_paga_anulada AS nlpa&#xd;&#xa;	                      ON nlpa.exercicio    &#x3d; nlp.exercicio&#xd;&#xa;	                     AND nlpa.cod_nota     &#x3d; nlp.cod_nota&#xd;&#xa;	                     AND nlpa.cod_entidade &#x3d; nlp.cod_entidade&#xd;&#xa;	                     AND nlpa.timestamp    &#x3d; nlp.timestamp&#xd;&#xa;	               LEFT JOIN empenho.pagamento_liquidacao_nota_liquidacao_paga AS plnlp&#xd;&#xa;	                      ON nlp.cod_entidade &#x3d; plnlp.cod_entidade&#xd;&#xa;	                     AND nlp.cod_nota     &#x3d; plnlp.cod_nota&#xd;&#xa;	                     AND nlp.exercicio    &#x3d; plnlp.exercicio_liquidacao&#xd;&#xa;	                     AND nlp.timestamp    &#x3d; plnlp.timestamp&#xd;&#xa;	               LEFT JOIN empenho.pagamento_liquidacao AS pl&#xd;&#xa;	                      ON pl.cod_entidade         &#x3d; plnlp.cod_entidade&#xd;&#xa;	                     AND pl.cod_nota             &#x3d; plnlp.cod_nota&#xd;&#xa;	                     AND pl.exercicio            &#x3d; plnlp.exercicio&#xd;&#xa;	                     AND pl.exercicio_liquidacao &#x3d; plnlp.exercicio_liquidacao&#xd;&#xa;	                     AND pl.cod_ordem            &#x3d; plnlp.cod_ordem&#xd;&#xa;	               LEFT JOIN empenho.nota_liquidacao AS nl&#xd;&#xa;	                      ON nl.exercicio    &#x3d; pl.exercicio_liquidacao&#xd;&#xa;	                     AND nl.cod_nota     &#x3d; pl.cod_nota&#xd;&#xa;	                     AND nl.cod_entidade &#x3d; pl.cod_entidade&#xd;&#xa;	               LEFT JOIN empenho.empenho&#xd;&#xa;	                      ON empenho.exercicio    &#x3d; nl.exercicio_empenho&#xd;&#xa;	                     AND empenho.cod_entidade &#x3d; nl.cod_entidade&#xd;&#xa;	                     AND empenho.cod_empenho  &#x3d; nl.cod_empenho&#xd;&#xa;	               LEFT JOIN administracao.configuracao_entidade&#xd;&#xa;	                      ON configuracao_entidade.cod_entidade &#x3d; nlp.cod_entidade&#xd;&#xa;	                     AND configuracao_entidade.exercicio    &#x3d; stExercicio  &#xd;&#xa;	                     AND configuracao_entidade.cod_modulo   &#x3d; 55&#xd;&#xa;	                     AND configuracao_entidade.parametro    &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	               LEFT JOIN empenho.ordem_pagamento&#xd;&#xa;	                      ON pl.exercicio    &#x3d; ordem_pagamento.exercicio&#xd;&#xa;	                     AND pl.cod_entidade &#x3d; ordem_pagamento.cod_entidade&#xd;&#xa;	                     AND pl.cod_ordem    &#x3d; ordem_pagamento.cod_ordem&#xd;&#xa;	               LEFT JOIN empenho.pre_empenho&#xd;&#xa;	                      ON pre_empenho.exercicio       &#x3d; empenho.exercicio&#xd;&#xa;	                     AND pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;	               LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;	                      ON pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                     AND pre_empenho_despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	               LEFT JOIN empenho.restos_pre_empenho&#xd;&#xa;	                      ON pre_empenho.cod_pre_empenho &#x3d; restos_pre_empenho.cod_pre_empenho&#xd;&#xa;	                     AND pre_empenho.exercicio &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;	               LEFT JOIN tcemg.uniorcam AS uniorcam_restos&#xd;&#xa;	                      ON uniorcam_restos.num_unidade &#x3d; restos_pre_empenho.num_unidade&#xd;&#xa;	                     AND uniorcam_restos.num_orgao   &#x3d; restos_pre_empenho.num_orgao&#xd;&#xa;	                     AND uniorcam_restos.exercicio   &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;	                     AND uniorcam_restos.num_orgao_atual IS NOT NULL&#xd;&#xa;	               LEFT JOIN tcemg.uniorcam AS uniorcam_restos_atual&#xd;&#xa;	                      ON uniorcam_restos_atual.num_unidade &#x3d; uniorcam_restos.num_unidade_atual&#xd;&#xa;	                     AND uniorcam_restos_atual.num_orgao   &#x3d; uniorcam_restos.num_orgao_atual&#xd;&#xa;	                     AND uniorcam_restos_atual.exercicio   &#x3d; stExercicio  &#xd;&#xa;	               LEFT JOIN orcamento.despesa&#xd;&#xa;	                      ON despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;	                     AND despesa.exercicio   &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;	               LEFT JOIN orcamento.conta_despesa&#xd;&#xa;	                      ON conta_despesa.cod_conta &#x3d; pre_empenho_despesa.cod_conta&#xd;&#xa;	                     AND conta_despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;	                   WHERE nlpa.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;	                     AND TO_DATE&#x28;nlpa.timestamp_anulada&#x3a;&#x3a;varchar, &#x27;YYYY-MM-DD&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;	                GROUP BY tiporegistro&#xd;&#xa;	                       , codreduzido&#xd;&#xa;	                       , tipopagamento&#xd;&#xa;	                       , nroempenho&#xd;&#xa;	                       , dtempenho&#xd;&#xa;	                       , nroliquidacao&#xd;&#xa;	                       , dtliquidacao&#xd;&#xa;	                       , codfontrecurso&#xd;&#xa;	                ORDER BY codreduzido&#xd;&#xa;			&#x29;,&#xd;&#xa;			  aop_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;					tiporegistro&#x3a;&#x3a;varchar,&#xd;&#xa;					codreduzido, &#xd;&#xa;					tiporegistro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; codreduzido&#x3a;&#x3a;numeric&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codorgao, &#x27; &#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codunidadesub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; nroop&#x3a;&#x3a;numeric					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;dtpagamento&#x3a;&#x3a;varchar,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; nroanulacaoop&#x3a;&#x3a;numeric					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;dtanulacaoop, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;justificativaanulacao,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,500&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vlanulacaoop&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;     &#xd;&#xa;					as d&#xd;&#xa;				from aop10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					tiporegistro&#x3a;&#x3a;varchar,&#xd;&#xa;					codreduzido,&#xd;&#xa;					tiporegistro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; codreduzido&#x3a;&#x3a;numeric&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipopagamento, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; nroempenho&#x3a;&#x3a;numeric&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;to_char&#x28;dtempenho, &#x27;DDMMYYYY&#x27;&#x29;, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroliquidacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;		&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;to_char&#x28;dtliquidacao, &#x27;DDMMYYYY&#x27;&#x29;, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codfontrecurso&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,3,&#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vlanulacaofonte&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					as d&#xd;&#xa;				from aop11	&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;AOP.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from aop_format order by codreduzido desc,tiporegistro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;		&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;    if strpos&#x28;stArquivos,&#x27;&#x22;DCLRF.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then 			&#xd;&#xa;			with dclrf as&#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT exercicio&#xd;&#xa;		             , 10 AS tipo_registro&#xd;&#xa;		             , &#x27;02&#x27; AS cod_orgao&#xd;&#xa;		             , mes_referencia&#xd;&#xa;		             , REPLACE&#x28;valor_saldo_atual_concessoes_garantia&#x3a;&#x3a;VARCHAR, &#x27;.&#x27;,&#x27;,&#x27;&#x29; AS valor_saldo_atual_concessoes_garantia&#xd;&#xa;		             , REPLACE&#x28;receita_privatizacao&#x3a;&#x3a;VARCHAR, &#x27;.&#x27;,&#x27;,&#x27;&#x29; AS receita_privatizacao&#xd;&#xa;		             , REPLACE&#x28;valor_liquidado_incentivo_contribuinte&#x3a;&#x3a;VARCHAR, &#x27;.&#x27;,&#x27;,&#x27;&#x29; AS valor_liquidado_incentivo_contribuinte&#xd;&#xa;		             , REPLACE&#x28;valor_liquidado_incentivo_instituicao_financeira&#x3a;&#x3a;VARCHAR, &#x27;.&#x27;,&#x27;,&#x27;&#x29; AS valor_liquidado_incentivo_instituicao_financeira&#xd;&#xa;		             , REPLACE&#x28;valor_inscrito_rpnp_incentivo_contribuinte&#x3a;&#x3a;VARCHAR, &#x27;.&#x27;,&#x27;,&#x27;&#x29; AS valor_inscrito_rpnp_incentivo_contribuinte&#xd;&#xa;		             , REPLACE&#x28;valor_inscrito_rpnp_incentivo_instituicao_financeira&#x3a;&#x3a;VARCHAR, &#x27;.&#x27;,&#x27;,&#x27;&#x29; AS valor_inscrito_rpnp_incentivo_instituicao_financeira&#xd;&#xa;		             , REPLACE&#x28;valor_compromissado&#x3a;&#x3a;VARCHAR, &#x27;.&#x27;,&#x27;,&#x27;&#x29; AS valor_compromissado&#xd;&#xa;		             , REPLACE&#x28;valor_recursos_nao_aplicados&#x3a;&#x3a;VARCHAR, &#x27;.&#x27;,&#x27;,&#x27;&#x29; AS valor_recursos_nao_aplicados&#xd;&#xa;		          FROM tcemg.configuracao_arquivo_dclrf&#xd;&#xa;		         WHERE exercicio &#x3d; stExercicio   &#xd;&#xa;		           AND mes_referencia &#x3d;  stMes&#x3a;&#x3a;int   &#xd;&#xa;			&#x29;, &#xd;&#xa;			  dclrf_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					cod_orgao, &#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; cod_orgao&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; exercicio&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; mes_referencia&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; valor_saldo_atual_concessoes_garantia&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; receita_privatizacao&#x3a;&#x3a;varchar &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; valor_liquidado_incentivo_contribuinte&#x3a;&#x3a;varchar					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; valor_liquidado_incentivo_instituicao_financeira&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; valor_inscrito_rpnp_incentivo_contribuinte&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; valor_inscrito_rpnp_incentivo_instituicao_financeira&#x3a;&#x3a;varchar					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; valor_recursos_nao_aplicados&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; valor_compromissado&#x3a;&#x3a;varchar&#xd;&#xa;					as d&#xd;&#xa;				from dclrf&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;DCLRF.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d   ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from dclrf_format				&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;    if strpos&#x28;stArquivos,&#x27;&#x22;ARC.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with arc20 as&#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT tipo_registro&#xd;&#xa;					 , &#x27;20&#x27;&#x7c;&#x7c;cod_correcao AS cod_estorno&#xd;&#xa;					 , cod_orgao&#xd;&#xa;					 , deducao_receita&#xd;&#xa;					 , indentificador_deducao_reduzida AS identificador_deducao&#xd;&#xa;					 , natureza_receita_reduzida AS natureza_receita_estornada&#xd;&#xa;					 , &#x28; SELECT sem_acentos&#x28;descricao&#x29; as descricao&#xd;&#xa;							FROM orcamento.conta_receita&#xd;&#xa;						   WHERE REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;&#x3a;&#x3a;TEXT &#x3d; CASE&#xd;&#xa;													WHEN SUBSTR&#x28;natureza_receita_reduzida&#x3a;&#x3a;TEXT, 1, 1&#x29; &#x3d; &#x27;9&#x27; THEN RPAD&#x28;natureza_receita_reduzida&#x3a;&#x3a;TEXT, 15, &#x27;0&#x27;&#x29;&#xd;&#xa;													ELSE RPAD&#x28;natureza_receita_reduzida&#x3a;&#x3a;TEXT, 14, &#x27;0&#x27;&#x29; END&#xd;&#xa;							  AND exercicio &#x3d;  stExercicio   &#xd;&#xa;				        &#x29; AS especificacao_estornada&#xd;&#xa;				     , SUM&#x28;vl_reduzido_acrescido&#x29; AS vl_estornado&#xd;&#xa;				     , cod_correcao&#xd;&#xa;				 FROM &#x28;&#xd;&#xa;					SELECT 20 AS tipo_registro&#xd;&#xa;					    , receita.cod_receita&#xd;&#xa;					    , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;					    , CASE WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27; THEN 1&#xd;&#xa;							   ELSE 2&#xd;&#xa;					      END AS deducao_receita&#xd;&#xa;					    , valores_identificadores.cod_identificador AS indentificador_deducao_reduzida&#xd;&#xa;						, CASE&#xd;&#xa;							WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;								THEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29;&#x3a;&#x3a;integer&#xd;&#xa;			                ELSE&#xd;&#xa;								CASE&#xd;&#xa;									WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240101&#xd;&#xa;										OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240102&#xd;&#xa;										OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17219903&#xd;&#xa;										OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 19319902&#xd;&#xa;											THEN RPAD&#x28;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;, 8, &#x27;0&#x27;&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;									WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 24210100&#xd;&#xa;										THEN &#x27;24210101&#x27;&#xd;&#xa;			                    ELSE SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;			                    END&#xd;&#xa;			              END AS natureza_receita_reduzida&#xd;&#xa;					    , SUM&#x28;arrecadacao_receita.vl_arrecadacao&#x29; AS vl_reduzido_acrescido&#xd;&#xa;					    , CASE WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;									THEN receita.exercicio&#x7c;&#x7c;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29;&#x3a;&#x3a;integer&#xd;&#xa;								ELSE CASE&#xd;&#xa;										WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240101&#xd;&#xa;											OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240102&#xd;&#xa;											OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17219903&#xd;&#xa;											OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 19319902&#xd;&#xa;												THEN receita.exercicio&#x7c;&#x7c;RPAD&#x28;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;, 8, &#x27;0&#x27;&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;										WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 24210100&#xd;&#xa;											THEN receita.exercicio&#x7c;&#x7c;&#x27;24210101&#x27;&#xd;&#xa;										ELSE receita.exercicio&#x7c;&#x7c;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;										END&#xd;&#xa;			               END AS cod_correcao&#xd;&#xa;					 FROM orcamento.receita&#xd;&#xa;					INNER JOIN tesouraria.arrecadacao_receita&#xd;&#xa;						ON arrecadacao_receita.cod_receita &#x3d; receita.cod_receita&#xd;&#xa;					       AND arrecadacao_receita.exercicio   &#x3d; receita.exercicio&#xd;&#xa;					       AND arrecadacao_receita.timestamp_arrecadacao&#x3a;&#x3a;date BETWEEN TO_DATE&#x28; &#x27;01&#x27; &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27; &#x29; AND last_day&#x28;TO_DATE&#x28; stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;&#xd;&#xa;					INNER JOIN tesouraria.arrecadacao&#xd;&#xa;						ON arrecadacao.cod_arrecadacao       &#x3d; arrecadacao_receita.cod_arrecadacao&#xd;&#xa;					       AND arrecadacao.exercicio             &#x3d; arrecadacao_receita.exercicio&#xd;&#xa;					       AND arrecadacao.timestamp_arrecadacao &#x3d; arrecadacao_receita.timestamp_arrecadacao&#xd;&#xa;					       AND arrecadacao.devolucao             &#x3d; true&#xd;&#xa;					INNER JOIN administracao.configuracao_entidade&#xd;&#xa;						ON configuracao_entidade.cod_entidade &#x3d; receita.cod_entidade&#xd;&#xa;					       AND configuracao_entidade.exercicio    &#x3d; receita.exercicio&#xd;&#xa;					INNER JOIN orcamento.conta_receita&#xd;&#xa;						ON conta_receita.cod_conta &#x3d; receita.cod_conta&#xd;&#xa;					       AND conta_receita.exercicio &#x3d; receita.exercicio&#xd;&#xa;					LEFT JOIN tcemg.receita_indentificadores_peculiar_receita&#xd;&#xa;					       ON receita_indentificadores_peculiar_receita.exercicio   &#x3d; receita.exercicio&#xd;&#xa;					      AND receita_indentificadores_peculiar_receita.cod_receita &#x3d; receita.cod_receita&#xd;&#xa;					LEFT JOIN tcemg.valores_identificadores&#xd;&#xa;					       ON valores_identificadores.cod_identificador &#x3d; receita_indentificadores_peculiar_receita.cod_identificador&#xd;&#xa;					    WHERE receita.exercicio     &#x3d; stExercicio    &#xd;&#xa;					      AND receita.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;					      AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;					      AND configuracao_entidade.parametro  &#x3d; &#x27;tcemg_tipo_orgao_entidade_sicom&#x27;&#xd;&#xa;					 GROUP BY receita.cod_receita&#xd;&#xa;						, receita.exercicio&#xd;&#xa;						, cod_orgao&#xd;&#xa;						, deducao_receita&#xd;&#xa;						, indentificador_deducao_reduzida&#xd;&#xa;						, natureza_receita_reduzida&#xd;&#xa;						, cod_correcao&#xd;&#xa;					UNION&#xd;&#xa;					  SELECT 20 AS tipo_registro&#xd;&#xa;					       , receita.cod_receita&#xd;&#xa;					       , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;					       , CASE WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27; THEN 1&#xd;&#xa;								  ELSE 2&#xd;&#xa;							 END AS deducao_receita&#xd;&#xa;					       , valores_identificadores.cod_identificador AS indentificador_deducao_reduzida&#xd;&#xa;					       , CASE&#xd;&#xa;								WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;									THEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29;&#x3a;&#x3a;integer&#xd;&#xa;								ELSE&#xd;&#xa;									CASE&#xd;&#xa;										WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240101&#xd;&#xa;											OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240102&#xd;&#xa;											OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17219903&#xd;&#xa;											OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 19319902&#xd;&#xa;												THEN RPAD&#x28;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;, 8, &#x27;0&#x27;&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;										WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 24210100&#xd;&#xa;											THEN &#x27;24210101&#x27;&#xd;&#xa;									ELSE SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;									END&#xd;&#xa;							 END AS natureza_receita_reduzida&#xd;&#xa;					       , SUM&#x28;arrecadacao_estornada_receita.vl_estornado&#x29; AS vl_reduzido_acrescido&#xd;&#xa;					       , CASE WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;									THEN receita.exercicio&#x7c;&#x7c;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29;&#x3a;&#x3a;integer&#xd;&#xa;								ELSE CASE&#xd;&#xa;										WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240101&#xd;&#xa;											OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240102&#xd;&#xa;											OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17219903&#xd;&#xa;											OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 19319902&#xd;&#xa;												THEN receita.exercicio&#x7c;&#x7c;RPAD&#x28;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;, 8, &#x27;0&#x27;&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;										WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 24210100&#xd;&#xa;											THEN receita.exercicio&#x7c;&#x7c;&#x27;24210101&#x27;&#xd;&#xa;										ELSE receita.exercicio&#x7c;&#x7c;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;										END&#xd;&#xa;							 END AS cod_correcao&#xd;&#xa;					    FROM orcamento.receita&#xd;&#xa;				      INNER JOIN tesouraria.arrecadacao_receita&#xd;&#xa;					      ON arrecadacao_receita.cod_receita &#x3d; receita.cod_receita&#xd;&#xa;					     AND arrecadacao_receita.exercicio   &#x3d; receita.exercicio&#xd;&#xa;				      INNER JOIN tesouraria.arrecadacao_estornada_receita&#xd;&#xa;					      ON arrecadacao_estornada_receita.cod_arrecadacao       &#x3d; arrecadacao_receita.cod_arrecadacao&#xd;&#xa;					     AND arrecadacao_estornada_receita.cod_receita           &#x3d; arrecadacao_receita.cod_receita&#xd;&#xa;					     AND arrecadacao_estornada_receita.exercicio             &#x3d; arrecadacao_receita.exercicio&#xd;&#xa;					     AND arrecadacao_estornada_receita.timestamp_arrecadacao &#x3d; arrecadacao_receita.timestamp_arrecadacao&#xd;&#xa;					     AND arrecadacao_estornada_receita.timestamp_estornada&#x3a;&#x3a;date BETWEEN TO_DATE&#x28; &#x27;01&#x27; &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27; &#x29; AND last_day&#x28;TO_DATE&#x28; stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;&#xd;&#xa;				      INNER JOIN administracao.configuracao_entidade&#xd;&#xa;					      ON configuracao_entidade.cod_entidade &#x3d; receita.cod_entidade&#xd;&#xa;					     AND configuracao_entidade.exercicio    &#x3d; receita.exercicio&#xd;&#xa;				      INNER JOIN orcamento.conta_receita&#xd;&#xa;					      ON conta_receita.cod_conta &#x3d; receita.cod_conta&#xd;&#xa;					     AND conta_receita.exercicio &#x3d; receita.exercicio&#xd;&#xa;					     AND SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x21;&#x3d; &#x27;9&#x27;&#xd;&#xa;				       LEFT JOIN tcemg.receita_indentificadores_peculiar_receita&#xd;&#xa;					      ON receita_indentificadores_peculiar_receita.exercicio   &#x3d; receita.exercicio&#xd;&#xa;					     AND receita_indentificadores_peculiar_receita.cod_receita &#x3d; receita.cod_receita&#xd;&#xa;				       LEFT JOIN tcemg.valores_identificadores&#xd;&#xa;					      ON valores_identificadores.cod_identificador &#x3d; receita_indentificadores_peculiar_receita.cod_identificador&#xd;&#xa;					   WHERE receita.exercicio    &#x3d; stExercicio   &#xd;&#xa;					     AND receita.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;					     AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;					     AND configuracao_entidade.parametro  &#x3d; &#x27;tcemg_tipo_orgao_entidade_sicom&#x27;&#xd;&#xa;					   &#xd;&#xa;				      GROUP BY receita.cod_receita&#xd;&#xa;					      , receita.exercicio&#xd;&#xa;					      , cod_orgao&#xd;&#xa;					      , deducao_receita&#xd;&#xa;					      , indentificador_deducao_reduzida&#xd;&#xa;					      , natureza_receita_reduzida&#xd;&#xa;					      , cod_correcao&#xd;&#xa;					UNION&#xd;&#xa;					 SELECT 20 AS tipo_registro&#xd;&#xa;					      , receita.cod_receita&#xd;&#xa;					      , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;					      , CASE WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27; THEN 1&#xd;&#xa;								 ELSE 2&#xd;&#xa;							END AS deducao_receita&#xd;&#xa;					      , valores_identificadores.cod_identificador AS indentificador_deducao_reduzida&#xd;&#xa;					      , CASE&#xd;&#xa;								WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;									THEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29;&#x3a;&#x3a;integer&#xd;&#xa;								ELSE&#xd;&#xa;									CASE&#xd;&#xa;										WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240101&#xd;&#xa;											OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240102&#xd;&#xa;											OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17219903&#xd;&#xa;											OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 19319902&#xd;&#xa;												THEN RPAD&#x28;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;, 8, &#x27;0&#x27;&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;										WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 24210100&#xd;&#xa;										THEN &#x27;24210101&#x27;&#xd;&#xa;									ELSE SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;									END&#xd;&#xa;							END AS natureza_receita_reduzida&#xd;&#xa;					      , SUM&#x28;redutora.vl_deducao&#x29; AS vl_reduzido_acrescido&#xd;&#xa;					      , CASE WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;									THEN receita.exercicio&#x7c;&#x7c;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29;&#x3a;&#x3a;integer&#xd;&#xa;								ELSE CASE&#xd;&#xa;										WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240101&#xd;&#xa;											OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240102&#xd;&#xa;											OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17219903&#xd;&#xa;											OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 19319902&#xd;&#xa;												THEN receita.exercicio&#x7c;&#x7c;RPAD&#x28;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;, 8, &#x27;0&#x27;&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;										WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 24210100&#xd;&#xa;											THEN receita.exercicio&#x7c;&#x7c;&#x27;24210101&#x27;&#xd;&#xa;										ELSE receita.exercicio&#x7c;&#x7c;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;										END&#xd;&#xa;			               END AS cod_correcao&#xd;&#xa;					   FROM orcamento.receita&#xd;&#xa;					INNER JOIN &#x28;&#xd;&#xa;								SELECT tabela.cod_receita_dedutora&#xd;&#xa;									 , tabela.exercicio&#xd;&#xa;									 , SUM&#x28;tabela.vl_arrecadacao&#x29; AS vl_deducao&#xd;&#xa;								 FROM &#x28;&#xd;&#xa;									SELECT arrecadacao_receita_dedutora_estornada.cod_arrecadacao&#xd;&#xa;										 , arrecadacao_receita_dedutora_estornada.cod_receita_dedutora&#xd;&#xa;										 , arrecadacao_receita_dedutora_estornada.exercicio&#xd;&#xa;										 , arrecadacao_receita_dedutora_estornada.vl_estornado AS vl_arrecadacao&#xd;&#xa;									 FROM tesouraria.arrecadacao_receita_dedutora_estornada&#xd;&#xa;							        WHERE arrecadacao_receita_dedutora_estornada.timestamp_dedutora_estornada&#x3a;&#x3a;date BETWEEN TO_DATE&#x28; &#x27;01&#x27; &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27; &#x29;&#xd;&#xa;										AND last_day&#x28;TO_DATE&#x28; stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;&#xd;&#xa;								    &#x29; AS tabela&#xd;&#xa;						    GROUP BY tabela.cod_receita_dedutora&#xd;&#xa;									, tabela.exercicio&#xd;&#xa;									, tabela.vl_arrecadacao&#xd;&#xa;					      &#x29; AS redutora&#xd;&#xa;						ON redutora.cod_receita_dedutora &#x3d; receita.cod_receita&#xd;&#xa;					       AND redutora.exercicio            &#x3d; receita.exercicio&#xd;&#xa;					INNER JOIN administracao.configuracao_entidade&#xd;&#xa;						ON configuracao_entidade.cod_entidade &#x3d; receita.cod_entidade&#xd;&#xa;					       AND configuracao_entidade.exercicio    &#x3d; receita.exercicio&#xd;&#xa;					INNER JOIN orcamento.conta_receita&#xd;&#xa;						ON conta_receita.cod_conta &#x3d; receita.cod_conta&#xd;&#xa;					       AND conta_receita.exercicio &#x3d; receita.exercicio&#xd;&#xa;					       AND SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;					LEFT JOIN tcemg.receita_indentificadores_peculiar_receita&#xd;&#xa;					       ON receita_indentificadores_peculiar_receita.exercicio   &#x3d; receita.exercicio&#xd;&#xa;					      AND receita_indentificadores_peculiar_receita.cod_receita &#x3d; receita.cod_receita&#xd;&#xa;					LEFT JOIN tcemg.valores_identificadores&#xd;&#xa;					       ON valores_identificadores.cod_identificador &#x3d; receita_indentificadores_peculiar_receita.cod_identificador&#xd;&#xa;					    WHERE receita.exercicio    &#x3d; stExercicio  &#xd;&#xa;					      AND receita.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;					      AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;					      AND configuracao_entidade.parametro  &#x3d; &#x27;tcemg_tipo_orgao_entidade_sicom&#x27;&#xd;&#xa;					 GROUP BY tipo_registro&#xd;&#xa;						, receita.cod_receita&#xd;&#xa;						, cod_orgao&#xd;&#xa;						, deducao_receita&#xd;&#xa;						, indentificador_deducao_reduzida&#xd;&#xa;						, natureza_receita_reduzida&#xd;&#xa;						, cod_correcao&#xd;&#xa;				     &#x29; AS consulta&#xd;&#xa;			      GROUP BY tipo_registro&#xd;&#xa;				     , cod_orgao&#xd;&#xa;				     , deducao_receita&#xd;&#xa;				     , indentificador_deducao_reduzida&#xd;&#xa;				     , natureza_receita_reduzida&#xd;&#xa;				     , especificacao_estornada&#xd;&#xa;				     , cod_correcao&#xd;&#xa;			      ORDER BY consulta.natureza_receita_reduzida&#xd;&#xa;			&#x29;, &#xd;&#xa;			  arc21 as &#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT tipo_registro&#xd;&#xa;					     , &#x27;20&#x27;&#x7c;&#x7c;cod_correcao AS cod_estorno&#xd;&#xa;					     , SUM&#x28;vl_reduzido_acrescido&#x29; AS vl_estornado_fonte&#xd;&#xa;					     , cod_receita&#xd;&#xa;					     , cod_fonte_reduzida AS cod_fonte_estornada&#xd;&#xa;					     , cod_correcao&#xd;&#xa;					FROM &#x28;&#xd;&#xa;								SELECT 21 AS tipo_registro&#xd;&#xa;								    , receita.cod_receita&#xd;&#xa;								    , receita.cod_recurso AS cod_fonte_reduzida&#xd;&#xa;								    , SUM&#x28;valor_lancamento.vl_lancamento&#x29; AS vl_reduzido_acrescido&#xd;&#xa;								    , CASE WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;												THEN receita.exercicio&#x7c;&#x7c;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29;&#x3a;&#x3a;integer&#xd;&#xa;											ELSE CASE&#xd;&#xa;													WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240101&#xd;&#xa;														OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240102&#xd;&#xa;														OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17219903&#xd;&#xa;														OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 19319902&#xd;&#xa;															THEN receita.exercicio&#x7c;&#x7c;RPAD&#x28;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;, 8, &#x27;0&#x27;&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;													WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 24210100&#xd;&#xa;														THEN receita.exercicio&#x7c;&#x7c;&#x27;24210101&#x27;&#xd;&#xa;													ELSE receita.exercicio&#x7c;&#x7c;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;													END&#xd;&#xa;						               END AS cod_correcao&#xd;&#xa;								 FROM contabilidade.lancamento_receita&#xd;&#xa;							   INNER JOIN contabilidade.lancamento&#xd;&#xa;								   ON lancamento.exercicio    &#x3d; lancamento_receita.exercicio&#xd;&#xa;								  AND lancamento.cod_entidade &#x3d; lancamento_receita.cod_entidade&#xd;&#xa;								  AND lancamento.tipo         &#x3d; lancamento_receita.tipo&#xd;&#xa;								  AND lancamento.cod_lote     &#x3d; lancamento_receita.cod_lote&#xd;&#xa;								  AND lancamento.sequencia    &#x3d; lancamento_receita.sequencia&#xd;&#xa;							   INNER JOIN contabilidade.lote&#xd;&#xa;								   ON lancamento.exercicio    &#x3d; lote.exercicio&#xd;&#xa;								  AND lancamento.cod_entidade &#x3d; lote.cod_entidade&#xd;&#xa;								  AND lancamento.tipo         &#x3d; lote.tipo&#xd;&#xa;								  AND lancamento.cod_lote     &#x3d; lote.cod_lote&#xd;&#xa;							   INNER JOIN contabilidade.valor_lancamento&#xd;&#xa;								   ON lancamento.exercicio        &#x3d; valor_lancamento.exercicio&#xd;&#xa;								  AND lancamento.cod_entidade     &#x3d; valor_lancamento.cod_entidade&#xd;&#xa;								  AND lancamento.tipo             &#x3d; valor_lancamento.tipo&#xd;&#xa;								  AND lancamento.cod_lote         &#x3d; valor_lancamento.cod_lote&#xd;&#xa;								  AND lancamento.sequencia        &#x3d; valor_lancamento.sequencia&#xd;&#xa;								  AND valor_lancamento.tipo_valor &#x3d; &#x27;D&#x27;&#xd;&#xa;							   INNER JOIN orcamento.receita&#xd;&#xa;								   ON receita.cod_receita &#x3d; lancamento_receita.cod_receita&#xd;&#xa;								  AND receita.exercicio   &#x3d; lancamento_receita.exercicio&#xd;&#xa;							   INNER JOIN orcamento.conta_receita&#xd;&#xa;								   ON receita.cod_conta &#x3d; conta_receita.cod_conta&#xd;&#xa;								  AND receita.exercicio &#x3d; conta_receita.exercicio&#xd;&#xa;								  AND SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x21;&#x3d; &#x27;9&#x27;&#xd;&#xa;							    LEFT JOIN orcamento.recurso&#x28;stExercicio&#x29; as rec   &#xd;&#xa;								   ON rec.cod_recurso &#x3d; receita.cod_recurso&#xd;&#xa;								  AND rec.exercicio   &#x3d; receita.exercicio&#xd;&#xa;							        WHERE estorno &#x3d; true&#xd;&#xa;								  AND lote.dt_lote BETWEEN TO_DATE&#x28; &#x27;01&#x27; &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27; &#x29; AND last_day&#x28;TO_DATE&#x28; stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;&#xd;&#xa;								  AND receita.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;							     GROUP BY tipo_registro&#xd;&#xa;								    , receita.cod_receita&#xd;&#xa;								    , receita.exercicio&#xd;&#xa;								    , conta_receita.cod_estrutural&#xd;&#xa;								    , receita.cod_recurso&#xd;&#xa;								    , cod_correcao&#xd;&#xa;							    UNION&#xd;&#xa;								SELECT 21 AS tipo_registro&#xd;&#xa;								     , receita.cod_receita&#xd;&#xa;								     , receita.cod_recurso AS cod_fonte_reduzida&#xd;&#xa;								     , SUM&#x28;redutora.vl_deducao&#x29; AS vl_reduzido_acrescido&#xd;&#xa;								     , CASE WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;												THEN receita.exercicio&#x7c;&#x7c;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29;&#x3a;&#x3a;integer&#xd;&#xa;											ELSE CASE&#xd;&#xa;													WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240101&#xd;&#xa;														OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240102&#xd;&#xa;														OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17219903&#xd;&#xa;														OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 19319902&#xd;&#xa;															THEN receita.exercicio&#x7c;&#x7c;RPAD&#x28;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;, 8, &#x27;0&#x27;&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;													WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 24210100&#xd;&#xa;														THEN receita.exercicio&#x7c;&#x7c;&#x27;24210101&#x27;&#xd;&#xa;													ELSE receita.exercicio&#x7c;&#x7c;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;													END&#xd;&#xa;						               END AS cod_correcao&#xd;&#xa;								FROM orcamento.receita&#xd;&#xa;							  INNER JOIN &#x28;&#xd;&#xa;										SELECT tabela.cod_receita_dedutora&#xd;&#xa;											 , tabela.exercicio&#xd;&#xa;											 , SUM&#x28;tabela.vl_arrecadacao&#x29; AS vl_deducao&#xd;&#xa;						      			 FROM &#x28;&#xd;&#xa;											SELECT arrecadacao_receita_dedutora_estornada.cod_arrecadacao&#xd;&#xa;												, arrecadacao_receita_dedutora_estornada.cod_receita_dedutora&#xd;&#xa;												, arrecadacao_receita_dedutora_estornada.exercicio&#xd;&#xa;												, arrecadacao_receita_dedutora_estornada.vl_estornado AS vl_arrecadacao&#xd;&#xa;										    FROM tesouraria.arrecadacao_receita_dedutora_estornada&#xd;&#xa;										   WHERE arrecadacao_receita_dedutora_estornada.timestamp_dedutora_estornada&#x3a;&#x3a;date BETWEEN TO_DATE&#x28; &#x27;01&#x27; &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27; &#x29;&#xd;&#xa;												AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;&#xd;&#xa;									        &#x29; AS tabela&#xd;&#xa;									 GROUP BY tabela.cod_receita_dedutora&#xd;&#xa;											, tabela.exercicio&#xd;&#xa;											, tabela.vl_arrecadacao&#xd;&#xa;								     &#x29; AS redutora&#xd;&#xa;								    ON redutora.cod_receita_dedutora&#x3d;receita.cod_receita&#xd;&#xa;								   AND redutora.exercicio&#x3d;receita.exercicio&#xd;&#xa;							  INNER JOIN administracao.configuracao_entidade&#xd;&#xa;								  ON configuracao_entidade.cod_entidade &#x3d; receita.cod_entidade&#xd;&#xa;								 AND configuracao_entidade.exercicio    &#x3d; receita.exercicio&#xd;&#xa;							  INNER JOIN orcamento.conta_receita&#xd;&#xa;								  ON conta_receita.cod_conta &#x3d; receita.cod_conta&#xd;&#xa;								 AND conta_receita.exercicio &#x3d; receita.exercicio&#xd;&#xa;								 AND SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;							   LEFT JOIN tcemg.receita_indentificadores_peculiar_receita&#xd;&#xa;								  ON receita_indentificadores_peculiar_receita.exercicio &#x3d; receita.exercicio&#xd;&#xa;								 AND receita_indentificadores_peculiar_receita.cod_receita &#x3d; receita.cod_receita&#xd;&#xa;							   LEFT JOIN tcemg.valores_identificadores&#xd;&#xa;								  ON valores_identificadores.cod_identificador &#x3d; receita_indentificadores_peculiar_receita.cod_identificador&#xd;&#xa;							       WHERE receita.exercicio    &#x3d; stExercicio   &#xd;&#xa;								 AND receita.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;								 AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;								 AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_tipo_orgao_entidade_sicom&#x27;&#xd;&#xa;							    GROUP BY receita.cod_receita&#xd;&#xa;								   , receita.exercicio&#xd;&#xa;								   , conta_receita.cod_estrutural&#xd;&#xa;						 &#x29; AS consulta&#xd;&#xa;				    GROUP BY tipo_registro&#xd;&#xa;					   , cod_receita&#xd;&#xa;					   , cod_correcao&#xd;&#xa;					   , cod_fonte_reduzida&#xd;&#xa;				    ORDER BY consulta.cod_receita&#xd;&#xa;			&#x29;,&#xd;&#xa;			  arc_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					cod_estorno, &#xd;&#xa;					0 cod_fonte_estornada,&#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_orgao, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_estorno, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;deducao_receita&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 1, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;identificador_deducao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;,2, &#x27; &#x27;&#x29;   					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;replace&#x28;natureza_receita_estornada&#x3a;&#x3a;varchar, &#x27;.&#x27;, &#x27;&#x27;&#x29;,&#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;especificacao_estornada,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,100&#x29;,&#x27; &#x27;&#x29;  &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_estornado&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;    &#xd;&#xa;					as d&#xd;&#xa;				from arc20&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					cod_estorno,&#xd;&#xa;					cod_fonte_estornada,&#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_estorno, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_fonte_estornada&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 3, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_estornado_fonte&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from arc21  	&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;ARC.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from arc_format order by cod_estorno,cod_fonte_estornada, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;		&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;    if strpos&#x28;stArquivos,&#x27;&#x22;EMP.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with emp10 as&#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT DISTINCT ON&#x28;EE.cod_empenho&#x29;&#xd;&#xa;	                    10 AS tipo_registro&#xd;&#xa;	                    ,	&#x28;SELECT valor&#xd;&#xa;	                        FROM administracao.configuracao_entidade&#xd;&#xa;	                        WHERE exercicio&#x3d;EE.exercicio&#xd;&#xa;	                        AND parametro&#x3d;&#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                        AND cod_entidade&#x3d;EE.cod_entidade&#x29;&#xd;&#xa;	                    AS codOrgao&#xd;&#xa;	                    , LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;OD.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;OD.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29; AS codunidadesub&#xd;&#xa;	                    , &#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;OD.cod_funcao,2, &#x27;0&#x27;&#x29;&#x29; AS codfuncao&#xd;&#xa;	                    , LPAD&#x28;OD.cod_subfuncao&#x3a;&#x3a;varchar,3,&#x27;0&#x27;&#x29; AS codsubfuncao&#xd;&#xa;	                    ,	&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;&#x28;SELECT num_programa FROM ppa.programa&#xd;&#xa;	                        WHERE cod_programa&#x3d;OP.cod_programa AND ativo&#x3d;true LIMIT 1&#x29;,4, &#x27;0&#x27;&#x29;&#x29;&#x3a;&#x3a;VARCHAR&#xd;&#xa;	                    AS codprograma&#xd;&#xa;	                    , &#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;acao.num_acao,4, &#x27;0&#x27;&#x29;&#x29; AS idacao&#xd;&#xa;	                    , &#x27;&#x27;&#x3a;&#x3a;TEXT AS idsubacao&#xd;&#xa;	                    , &#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;REPLACE&#x28;OCD.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;,6, &#x27;&#x27;&#x29;&#x29; AS naturezadespesa&#xd;&#xa;	                    , CASE WHEN &#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;REPLACE&#x28;OCD.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;,6, &#x27;&#x27;&#x29;&#x29; &#x3d; &#x27;339031&#x27; OR&#xd;&#xa;	                                &#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;REPLACE&#x28;OCD.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;,6, &#x27;&#x27;&#x29;&#x29; &#x3d; &#x27;329091&#x27; OR&#xd;&#xa;	                                &#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;REPLACE&#x28;OCD.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;,6, &#x27;&#x27;&#x29;&#x29; &#x3d; &#x27;339049&#x27; OR&#xd;&#xa;	                                &#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;REPLACE&#x28;OCD.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;,6, &#x27;&#x27;&#x29;&#x29; &#x3d; &#x27;339041&#x27; OR&#xd;&#xa;	                                &#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;REPLACE&#x28;OCD.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;,6, &#x27;&#x27;&#x29;&#x29; &#x3d; &#x27;336041&#x27;&#xd;&#xa;	                           THEN &#x27;00&#x27;&#xd;&#xa;	                           ELSE&#xd;&#xa;	                               SUBSTR&#x28;REPLACE&#x28;OCD.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;,7,2&#x29;&#xd;&#xa;	                           END AS subelemento&#xd;&#xa;	                    , EE.cod_empenho AS nroempenho&#xd;&#xa;	                    , to_char&#x28;EE.dt_empenho, &#x27;ddmmyyyy&#x27;&#x29; AS dtempenho&#xd;&#xa;	                    ,   CASE WHEN ETE.nom_tipo &#x3d; &#x27;Ordin&#xe1;rio&#x27; THEN&#xd;&#xa;	                            1&#xd;&#xa;	                        WHEN ETE.nom_tipo &#x3d; &#x27;Estimado&#x27; THEN&#xd;&#xa;	                            2&#xd;&#xa;	                        WHEN ETE.nom_tipo &#x3d; &#x27;Global&#x27; THEN&#xd;&#xa;	                            3&#xd;&#xa;	                        ELSE&#xd;&#xa;	                            0&#xd;&#xa;	                        END&#xd;&#xa;	                    AS modalidadeempenho&#xd;&#xa;	                    ,   CASE WHEN &#x28;SUBSTR&#x28;REPLACE&#x28;OCD.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;,1,2&#x29;&#x3a;&#x3a;INTEGER&#x29;&#x3d;46 THEN&#xd;&#xa;	                            02&#xd;&#xa;	                        ELSE&#xd;&#xa;	                            01&#xd;&#xa;	                        END&#xd;&#xa;	                    AS tpempenho&#xd;&#xa;	                    , REPLACE&#x28;&#x28;	SELECT SUM&#x28;vl_total&#x29;&#x3a;&#x3a;TEXT&#xd;&#xa;	                                  FROM empenho.item_pre_empenho&#xd;&#xa;	                                  WHERE exercicio&#x3d;EPE.exercicio&#xd;&#xa;	                                  AND cod_pre_empenho&#x3d;EE.cod_pre_empenho&#x29;, &#x27;.&#x27;, &#x27;,&#x27;&#x29;&#xd;&#xa;	                    AS vlbruto&#xd;&#xa;	                    , regexp_replace&#x28;remove_acentos&#x28;REPLACE&#x28;&#x28;REPLACE&#x28;REPLACE&#x28;EPE.descricao,Chr&#x28;39&#x29;, &#x27;&#x27;&#x29;, Chr&#x28;10&#x29;, &#x27;&#x27;&#x29;&#x29;, Chr&#x28;13&#x29;, &#x27; &#x27;&#x29;&#x29;,&#x27;&#x5b;&#xba;&#x7c;&#xb0;&#x5d;&#x27;, &#x27;&#x27;, &#x27;gi&#x27;&#x29; AS especificacaoempenho&#xd;&#xa;	                    ,	CASE WHEN TCE.cod_contrato IS NOT NULL THEN&#xd;&#xa;	                            CASE WHEN TC.cod_modalidade_licitacao &#x3d; 5 OR TC.cod_modalidade_licitacao &#x3d; 6 THEN&#xd;&#xa;	                                3&#xd;&#xa;	                            ELSE&#xd;&#xa;	                                1&#xd;&#xa;	                            END&#xd;&#xa;	                        ELSE&#xd;&#xa;	                            2&#xd;&#xa;	                        END&#xd;&#xa;	                    AS despdeccontrato&#xd;&#xa;	                    ,   CASE WHEN TC.cod_modalidade_licitacao &#x3d; 5 OR TC.cod_modalidade_licitacao &#x3d; 6 THEN&#xd;&#xa;	                            &#x28;SELECT valor&#xd;&#xa;	                            FROM administracao.configuracao_entidade&#xd;&#xa;	                            WHERE exercicio&#x3d;TC.exercicio&#xd;&#xa;	                            AND parametro&#x3d;&#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                            AND cod_entidade&#x3d;TC.cod_entidade_modalidade&#x29;&#xd;&#xa;	                        ELSE&#xd;&#xa;	                            &#x27;&#x27;&#xd;&#xa;	                        END&#xd;&#xa;	                    AS codorgaorespcontrato&#xd;&#xa;	                    ,   CASE WHEN TCE.cod_contrato IS NOT NULL THEN&#xd;&#xa;	                            LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                        END&#xd;&#xa;	                    AS codunidadesubrespcontrato&#xd;&#xa;	                    ,   CASE WHEN TCE.cod_contrato IS NOT NULL THEN&#xd;&#xa;	                            &#x28;TC.exercicio&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.nro_contrato,8, &#x27;0&#x27;&#x29;&#x29;&#x29;&#xd;&#xa;	                        END&#xd;&#xa;	                    AS nrocontrato&#xd;&#xa;	                    ,   CASE WHEN TCE.cod_contrato IS NOT NULL THEN&#xd;&#xa;	                            to_char&#x28;TC.data_assinatura, &#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                        END&#xd;&#xa;	                    AS dataassinaturacontrato&#xd;&#xa;	                    ,   CASE WHEN TCE.cod_contrato IS NOT NULL THEN&#xd;&#xa;	                            &#x28;select nro_aditivo from tcemg.contrato_aditivo&#xd;&#xa;	                            where contrato_aditivo.cod_contrato&#x3d;TCE.cod_contrato&#xd;&#xa;	                            and contrato_aditivo.exercicio&#x3d;TCE.exercicio&#xd;&#xa;	                            and contrato_aditivo.cod_entidade&#x3d;TCE.cod_entidade order by nro_aditivo desc limit 1&#x29;&#xd;&#xa;	                        END&#xd;&#xa;	                    AS nrosequencialtermoaditivo&#xd;&#xa;	                    ,   CASE WHEN TCEMP.cod_convenio IS NOT NULL THEN&#xd;&#xa;	                            1&#xd;&#xa;	                        ELSE&#xd;&#xa;	                            2&#xd;&#xa;	                        END&#xd;&#xa;	                    AS despdecconvenio&#xd;&#xa;	                    ,   CASE WHEN TCEMP.cod_convenio IS NOT NULL THEN&#xd;&#xa;	                            &#x28;TCONV.exercicio&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TCONV.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TCONV.nro_convenio,24, &#x27;0&#x27;&#x29;&#x29;&#x29;&#xd;&#xa;	                        END&#xd;&#xa;	                    AS nroconvenio&#xd;&#xa;	                    ,   CASE WHEN TCEMP.cod_convenio IS NOT NULL THEN&#xd;&#xa;	                            to_char&#x28;TCONV.data_assinatura, &#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                        END&#xd;&#xa;	                    AS dataassinaturaconvenio&#xd;&#xa;	                    ,   CASE WHEN E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 5 THEN&#xd;&#xa;	                                1&#xd;&#xa;	                             ELSE&#xd;&#xa;	                                CASE WHEN C_CD.cod_compra_direta IS NOT NULL THEN&#xd;&#xa;	                                        1&#xd;&#xa;	                                     WHEN L_LIC.cod_licitacao IS NOT NULL THEN&#xd;&#xa;	                                        CASE WHEN L_LIC.cod_modalidade &#x3d; 8 OR L_LIC.cod_modalidade &#x3d; 9 THEN&#xd;&#xa;	                                                3&#xd;&#xa;	                                             WHEN L_LIC.cod_modalidade &#x3d; 11 THEN&#xd;&#xa;	                                                4&#xd;&#xa;	                                             ELSE&#xd;&#xa;	                                                2&#xd;&#xa;	                                        END&#xd;&#xa;	                                     WHEN E_AEVALOR.valor IS NOT NULL THEN&#xd;&#xa;	                                        CASE WHEN E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 5 OR E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 7 OR E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 15 THEN&#xd;&#xa;	                                                1&#xd;&#xa;	                                             WHEN E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 6 OR E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 13 THEN&#xd;&#xa;	                                                3&#xd;&#xa;	                                             WHEN E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 14 THEN&#xd;&#xa;	                                                4&#xd;&#xa;	                                             WHEN E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 3 THEN&#xd;&#xa;	                                                2&#xd;&#xa;	                                             ELSE&#xd;&#xa;	                                                2&#xd;&#xa;	                                        END&#xd;&#xa;	                                END&#xd;&#xa;	                        END AS despdeclicitacao&#xd;&#xa;	                    ,   &#x27;&#x27; AS codorgaoresplicit&#xd;&#xa;	                    ,   CASE WHEN C_CD.cod_compra_direta IS NULL THEN&#xd;&#xa;	                            CASE WHEN E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 5 THEN&#xd;&#xa;	                                    &#x27; &#x27;&#xd;&#xa;	                                 ELSE&#xd;&#xa;	                                    CASE WHEN L_LIC.cod_licitacao IS NOT NULL AND L_LIC.cod_modalidade NOT IN &#x28;11&#x29; THEN&#xd;&#xa;	                                            LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;L_LIC.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;L_LIC.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                                         WHEN E_AEVALOR.valor IS NOT NULL AND E_AEVALOR.valor&#x3a;&#x3a;INTEGER NOT IN&#x28;5,7,15&#x29; THEN&#xd;&#xa;	                                            LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;L_LIC_RegPreco.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;L_LIC_RegPreco.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                                         ELSE&#xd;&#xa;	                                            &#x27; &#x27;&#xd;&#xa;	                                    END&#xd;&#xa;	                            END&#xd;&#xa;	                        END AS codUnidadeSubRespLicit&#xd;&#xa;	                    ,   CASE WHEN C_CD.cod_compra_direta IS NULL THEN&#xd;&#xa;	                            CASE WHEN E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 5 THEN&#xd;&#xa;	                                    &#x27; &#x27;&#xd;&#xa;	                                 ELSE&#xd;&#xa;	                                    CASE WHEN L_LIC.cod_licitacao IS NOT NULL AND L_LIC.cod_modalidade NOT IN &#x28;11&#x29; THEN&#xd;&#xa;	                                            config_licitacao.num_licitacao&#xd;&#xa;	                                         WHEN E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 14 OR E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 4 THEN&#xd;&#xa;	                                            CASE WHEN RegPrecoLicitacao.exercicio IS NOT NULL THEN&#xd;&#xa;	                                                    RegPrecoLicitacao.num_licitacao&#xd;&#xa;	                                                 ELSE&#xd;&#xa;	                                                    arquivo_emp.exercicio_licitacao&#x3a;&#x3a;varchar&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;arquivo_emp.cod_entidade&#x3a;&#x3a;varchar,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;arquivo_emp.cod_modalidade&#x3a;&#x3a;varchar,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;arquivo_emp.cod_licitacao &#x3a;&#x3a;varchar,4, &#x27;0&#x27;&#x29;&#xd;&#xa;	                                            END&#xd;&#xa;	                                         WHEN E_AEVALOR.valor IS NOT NULL AND E_AEVALOR.valor&#x3a;&#x3a;INTEGER NOT IN&#x28;5,7,15&#x29; THEN&#xd;&#xa;	                                            arquivo_emp.exercicio_licitacao&#x3a;&#x3a;varchar&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;arquivo_emp.cod_entidade&#x3a;&#x3a;varchar,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;arquivo_emp.cod_modalidade&#x3a;&#x3a;varchar,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;arquivo_emp.cod_licitacao &#x3a;&#x3a;varchar,4, &#x27;0&#x27;&#x29;&#xd;&#xa;	                                    END&#xd;&#xa;	                            END&#xd;&#xa;	                        END AS nroProcessoLicitatorio&#xd;&#xa;	                    ,   CASE WHEN C_CD.cod_compra_direta IS NULL THEN&#xd;&#xa;	                            CASE WHEN E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 5 THEN&#xd;&#xa;	                                    &#x27; &#x27;&#xd;&#xa;	                                 ELSE&#xd;&#xa;	                                    CASE WHEN L_LIC.cod_licitacao IS NOT NULL AND L_LIC.cod_modalidade NOT IN &#x28;11&#x29; THEN&#xd;&#xa;	                                            config_licitacao.exercicio_licitacao&#xd;&#xa;	                                         WHEN E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 14 OR E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 4 THEN&#xd;&#xa;	                                            CASE WHEN RegPrecoLicitacao.exercicio IS NOT NULL THEN&#xd;&#xa;	                                                    RegPrecoLicitacao.exercicio&#xd;&#xa;	                                                 ELSE&#xd;&#xa;	                                                    arquivo_emp.exercicio_licitacao&#xd;&#xa;	                                            END&#xd;&#xa;	                                         WHEN E_AEVALOR.valor IS NOT NULL AND E_AEVALOR.valor&#x3a;&#x3a;INTEGER NOT IN&#x28;5,7,15&#x29; THEN&#xd;&#xa;	                                            arquivo_emp.exercicio_licitacao&#xd;&#xa;	                                    END&#xd;&#xa;	                            END&#xd;&#xa;	                        END AS exercicioProcessoLicitatorio&#xd;&#xa;	                    ,   CASE WHEN C_CD.cod_compra_direta IS NULL THEN&#xd;&#xa;	                            CASE WHEN E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 5 THEN&#xd;&#xa;	                                    &#x27;&#x27;&#xd;&#xa;	                                 ELSE&#xd;&#xa;	                                    CASE WHEN L_LIC.cod_modalidade &#x3d; 8 OR RegPrecoLicitacao.cod_modalidade &#x3d; 8 THEN&#xd;&#xa;	                                            &#x27;1&#x27;&#xd;&#xa;	                                         WHEN L_LIC.cod_modalidade &#x3d; 9 OR E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 6 OR E_AEVALOR.valor&#x3a;&#x3a;INTEGER &#x3d; 13 OR RegPrecoLicitacao.cod_modalidade &#x3d; 9 THEN&#xd;&#xa;	                                            &#x27;2&#x27;&#xd;&#xa;	                                         ELSE&#xd;&#xa;	                                            &#x27;&#x27;&#xd;&#xa;	                                    END&#xd;&#xa;	                            END&#xd;&#xa;	                        ELSE&#xd;&#xa;	                            &#x27;&#x27;&#xd;&#xa;	                        END AS tipoProcesso&#xd;&#xa;	                    ,   CASE WHEN uniorcam.cgm_ordenador IS NOT NULL THEN&#xd;&#xa;	                            &#x28;SELECT cpf FROM sw_cgm_pessoa_fisica WHERE numcgm&#x3d;uniorcam.cgm_ordenador&#x29;&#xd;&#xa;	                        ELSE&#xd;&#xa;	                            &#x27;&#x27;&#xd;&#xa;	                        END AS cpfOrdenador&#xd;&#xa;	                    ,   CASE WHEN C_CD.cod_compra_direta IS NULL THEN&#xd;&#xa;	                            CASE WHEN tipo_objeto.cod_tipo_objeto &#x3d; 1 THEN&#xd;&#xa;	                                    CASE WHEN &#x28;SUM&#x28;cotacao_fornecedor_item.vl_cotacao&#x29; &#x3e; 15000&#x29; THEN&#xd;&#xa;	                                            2&#xd;&#xa;	                                         ELSE&#xd;&#xa;	                                            99&#xd;&#xa;	                                    END&#xd;&#xa;	                                 WHEN tipo_objeto.cod_tipo_objeto &#x3d; 2 THEN&#xd;&#xa;	                                    CASE WHEN &#x28;SUM&#x28;cotacao_fornecedor_item.vl_cotacao&#x29; &#x3e; 8000&#x29; THEN&#xd;&#xa;	                                            1&#xd;&#xa;	                                         ELSE&#xd;&#xa;	                                            99&#xd;&#xa;	                                    END&#xd;&#xa;	                                 WHEN tipo_objeto.cod_tipo_objeto &#x3d; 3 THEN&#xd;&#xa;	                                    3&#xd;&#xa;	                                 WHEN tipo_objeto.cod_tipo_objeto &#x3d; 4 THEN&#xd;&#xa;	                                    3&#xd;&#xa;	                            END&#xd;&#xa;	                        END AS natureza_objeto&#xd;&#xa;	                    FROM empenho.empenho AS EE&#xd;&#xa;	                    LEFT JOIN empenho.empenho_anulado AS EEANUL&#xd;&#xa;	                    ON EEANUL.exercicio&#x3d;EE.exercicio&#xd;&#xa;	                    AND EEANUL.cod_entidade&#x3d;EE.cod_entidade&#xd;&#xa;	                    AND EEANUL.cod_empenho&#x3d;EE.cod_empenho&#xd;&#xa;	                    INNER JOIN empenho.pre_empenho AS EPE&#xd;&#xa;	                    ON EPE.cod_pre_empenho&#x3d;EE.cod_pre_empenho&#xd;&#xa;	                    AND EPE.exercicio&#x3d;EE.exercicio&#xd;&#xa;	                    INNER JOIN empenho.tipo_empenho AS ETE&#xd;&#xa;	                    ON ETE.cod_tipo&#x3d;EPE.cod_tipo&#xd;&#xa;	                    INNER JOIN empenho.pre_empenho_despesa AS EPED&#xd;&#xa;	                    ON EPED.cod_pre_empenho&#x3d;EPE.cod_pre_empenho&#xd;&#xa;	                    AND EPED.exercicio&#x3d;EPE.exercicio&#xd;&#xa;	                    INNER JOIN orcamento.despesa AS OD&#xd;&#xa;	                    ON OD.exercicio&#x3d;EPED.exercicio AND OD.cod_despesa&#x3d;EPED.cod_despesa&#xd;&#xa;	                    INNER JOIN orcamento.conta_despesa AS OCD&#xd;&#xa;	                    ON OCD.exercicio&#x3d;EPED.exercicio&#xd;&#xa;	                    AND OCD.cod_conta&#x3d;EPED.cod_conta&#xd;&#xa;	                    INNER JOIN orcamento.programa AS OP&#xd;&#xa;	                    ON OP.cod_programa&#x3d;OD.cod_programa&#xd;&#xa;	                    AND OP.exercicio&#x3d;OD.exercicio&#xd;&#xa;	                    INNER JOIN orcamento.despesa_acao AS ODA&#xd;&#xa;	                    ON ODA.cod_despesa&#x3d;OD.cod_despesa&#xd;&#xa;	                    AND ODA.exercicio_despesa&#x3d;OD.exercicio&#xd;&#xa;	                    JOIN orcamento.despesa_acao&#xd;&#xa;	                      ON despesa_acao.cod_despesa &#x3d; OD.cod_despesa&#xd;&#xa;	                     AND despesa_acao.exercicio_despesa &#x3d; OD.exercicio&#xd;&#xa;	                    JOIN ppa.acao&#xd;&#xa;	                      ON acao.cod_acao &#x3d; despesa_acao.cod_acao&#xd;&#xa;	                    LEFT JOIN tcemg.contrato_empenho AS TCE&#xd;&#xa;	                    ON TCE.exercicio&#x3d;EE.exercicio&#xd;&#xa;	                    AND TCE.cod_entidade&#x3d;EE.cod_entidade&#xd;&#xa;	                    AND TCE.cod_empenho&#x3d;EE.cod_empenho&#xd;&#xa;	                    LEFT JOIN tcemg.contrato AS TC&#xd;&#xa;	                    ON TCE.exercicio&#x3d;TC.exercicio&#xd;&#xa;	                    AND TCE.cod_entidade&#x3d;TC.cod_entidade&#xd;&#xa;	                    AND TCE.cod_contrato&#x3d;TC.cod_contrato&#xd;&#xa;	                    LEFT JOIN tcemg.convenio_empenho AS TCEMP&#xd;&#xa;	                    ON TCEMP.exercicio&#x3d;EE.exercicio&#xd;&#xa;	                    AND TCEMP.cod_entidade&#x3d;EE.cod_entidade&#xd;&#xa;	                    AND TCEMP.cod_empenho&#x3d;EE.cod_empenho&#xd;&#xa;	                    LEFT JOIN tcemg.convenio AS TCONV&#xd;&#xa;	                    ON TCEMP.exercicio&#x3d;TCONV.exercicio&#xd;&#xa;	                    AND TCEMP.cod_entidade&#x3d;TCONV.cod_entidade&#xd;&#xa;	                    AND TCEMP.cod_convenio&#x3d;TCONV.cod_convenio&#xd;&#xa;	                    LEFT JOIN tcemg.uniorcam&#xd;&#xa;	                    ON uniorcam.num_unidade&#x3d;OD.num_unidade&#xd;&#xa;	                    AND uniorcam.num_orgao&#x3d;OD.num_orgao&#xd;&#xa;	                    AND uniorcam.exercicio&#x3d;OD.exercicio&#xd;&#xa;	                    LEFT JOIN empenho.empenho_autorizacao AS E_EA&#xd;&#xa;	                    ON E_EA.exercicio&#x3d;EE.exercicio&#xd;&#xa;	                    AND E_EA.cod_entidade&#x3d;EE.cod_entidade&#xd;&#xa;	                    AND E_EA.cod_empenho&#x3d;EE.cod_empenho&#xd;&#xa;	                    LEFT JOIN empenho.autorizacao_empenho AS E_AE&#xd;&#xa;	                    ON E_AE.exercicio&#x3d;E_EA.exercicio&#xd;&#xa;	                    AND E_AE.cod_entidade&#x3d;E_EA.cod_entidade&#xd;&#xa;	                    AND E_AE.cod_autorizacao&#x3d;E_EA.cod_autorizacao&#xd;&#xa;	                    LEFT JOIN empenho.autorizacao_anulada AS E_AANUL&#xd;&#xa;	                    ON E_AANUL.cod_autorizacao&#x3d;E_AE.cod_autorizacao&#xd;&#xa;	                    AND E_AANUL.exercicio&#x3d;E_AE.exercicio&#xd;&#xa;	                    AND E_AANUL.cod_entidade&#x3d;E_AE.cod_entidade&#xd;&#xa;	                    LEFT JOIN empenho.item_pre_empenho_julgamento AS E_IPEJ&#xd;&#xa;	                    ON E_IPEJ.exercicio&#x3d;EPE.exercicio&#xd;&#xa;	                    AND E_IPEJ.cod_pre_empenho&#x3d;EPE.cod_pre_empenho&#xd;&#xa;	                    AND E_IPEJ.num_item&#x3d;&#x28;SELECT E_IPEJ.num_item&#xd;&#xa;	                            FROM empenho.item_pre_empenho_julgamento AS E_IPEJ&#xd;&#xa;	                            WHERE E_IPEJ.exercicio&#x3d;EPE.exercicio&#xd;&#xa;	                            AND E_IPEJ.cod_pre_empenho&#x3d;EPE.cod_pre_empenho LIMIT 1&#x29;&#xd;&#xa;	                    LEFT JOIN compras.julgamento_item AS C_JI&#xd;&#xa;	                    ON C_JI.cod_cotacao&#x3d;E_IPEJ.cod_cotacao&#xd;&#xa;	                    AND C_JI.exercicio&#x3d;E_IPEJ.exercicio&#xd;&#xa;	                    AND C_JI.cod_item&#x3d;E_IPEJ.cod_item&#xd;&#xa;	                    LEFT JOIN compras.mapa_cotacao AS C_MC&#xd;&#xa;	                    ON C_MC.cod_cotacao&#x3d;E_IPEJ.cod_cotacao&#xd;&#xa;	                    AND C_MC.exercicio_cotacao&#x3d;E_IPEJ.exercicio&#xd;&#xa;	                    LEFT JOIN compras.compra_direta AS C_CD&#xd;&#xa;	                    ON C_CD.exercicio_mapa&#x3d;C_MC.exercicio_mapa&#xd;&#xa;	                    AND C_CD.cod_mapa&#x3d;C_MC.cod_mapa&#xd;&#xa;	                    LEFT JOIN compras.compra_direta_anulacao as C_CDA&#xd;&#xa;	                    ON C_CDA.cod_compra_direta &#x3d;C_CD.cod_compra_direta&#xd;&#xa;	                    AND C_CDA.cod_modalidade&#x3d;C_CD.cod_modalidade&#xd;&#xa;	                    LEFT JOIN licitacao.licitacao AS L_LIC&#xd;&#xa;	                    ON L_LIC.exercicio_mapa&#x3d;C_MC.exercicio_mapa&#xd;&#xa;	                    AND L_LIC.cod_mapa&#x3d;C_MC.cod_mapa&#xd;&#xa;	                    LEFT JOIN compras.tipo_objeto&#xd;&#xa;	                      ON tipo_objeto.cod_tipo_objeto &#x3d; L_LIC.cod_tipo_objeto&#xd;&#xa;	                    LEFT JOIN &#x28;&#xd;&#xa;	                            SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;                &#xd;&#xa;	                                                                       VALUES &#x28;cod_licitacao        INTEGER&#xd;&#xa;	                                                                              ,cod_modalidade       INTEGER&#xd;&#xa;	                                                                              ,cod_entidade         INTEGER&#xd;&#xa;	                                                                              ,exercicio            CHAR&#x28;4&#x29;&#xd;&#xa;	                                                                              ,exercicio_licitacao  VARCHAR&#xd;&#xa;	                                                                              ,num_licitacao        TEXT &#x29;&#xd;&#xa;	                    &#x29; AS config_licitacao&#xd;&#xa;	                    ON config_licitacao.cod_entidade &#x3d; L_LIC.cod_entidade&#xd;&#xa;	                    AND config_licitacao.cod_licitacao &#x3d; L_LIC.cod_licitacao&#xd;&#xa;	                    AND config_licitacao.cod_modalidade &#x3d; L_LIC.cod_modalidade&#xd;&#xa;	                    AND config_licitacao.exercicio &#x3d; L_LIC.exercicio&#xd;&#xa;	                    LEFT JOIN compras.cotacao_fornecedor_item&#xd;&#xa;	                      ON C_JI.exercicio &#x3d; cotacao_fornecedor_item.exercicio&#xd;&#xa;	                     AND C_JI.cod_cotacao &#x3d; cotacao_fornecedor_item.cod_cotacao&#xd;&#xa;	                     AND C_JI.cod_item &#x3d; cotacao_fornecedor_item.cod_item&#xd;&#xa;	                     AND C_JI.cgm_fornecedor &#x3d; cotacao_fornecedor_item.cgm_fornecedor&#xd;&#xa;	                     AND C_JI.lote &#x3d; cotacao_fornecedor_item.lote&#xd;&#xa;	                    LEFT JOIN empenho.atributo_empenho_valor AS E_AEVALOR&#xd;&#xa;	                    ON E_AEVALOR.cod_pre_empenho&#x3d;EE.cod_pre_empenho&#xd;&#xa;	                    AND E_AEVALOR.valor&#x3d; &#x28;select valor from empenho.atributo_empenho_valor where cod_pre_empenho&#x3d;EE.cod_pre_empenho and atributo_empenho_valor.exercicio&#x3d;EE.exercicio AND atributo_empenho_valor.cod_atributo&#x3d;101 AND atributo_empenho_valor.cod_cadastro&#x3d;1 order by timestamp desc limit 1&#x29;&#xd;&#xa;	                    AND E_AEVALOR.exercicio&#x3d;EE.exercicio&#xd;&#xa;	                    AND E_AEVALOR.cod_atributo&#x3d;101&#xd;&#xa;	                    AND E_AEVALOR.cod_cadastro&#x3d;1&#xd;&#xa;	                    LEFT JOIN tcemg.empenho_registro_precos&#xd;&#xa;	                    ON empenho_registro_precos.cod_entidade_empenho &#x3d; EE.cod_entidade&#xd;&#xa;	                    AND empenho_registro_precos.cod_empenho         &#x3d; EE.cod_empenho&#xd;&#xa;	                    AND empenho_registro_precos.exercicio_empenho   &#x3d; EE.exercicio&#xd;&#xa;	                    LEFT JOIN tcemg.registro_precos AS RegPreco&#xd;&#xa;	                     ON RegPreco.numero_registro_precos &#x3d; empenho_registro_precos.numero_registro_precos&#xd;&#xa;	                    AND RegPreco.exercicio              &#x3d; empenho_registro_precos.exercicio&#xd;&#xa;	                    AND RegPreco.cod_entidade           &#x3d; empenho_registro_precos.cod_entidade&#xd;&#xa;	                    AND RegPreco.interno                &#x3d; empenho_registro_precos.interno&#xd;&#xa;	                    AND RegPreco.numcgm_gerenciador     &#x3d; empenho_registro_precos.numcgm_gerenciador&#xd;&#xa;	                    LEFT JOIN tcemg.registro_precos_orgao AS RegPrecoOrgao&#xd;&#xa;	                     ON RegPreco.numero_registro_precos &#x3d; RegPrecoOrgao.numero_registro_precos&#xd;&#xa;	                    AND RegPreco.exercicio              &#x3d; RegPrecoOrgao.exercicio_registro_precos&#xd;&#xa;	                    AND RegPreco.cod_entidade           &#x3d; RegPrecoOrgao.cod_entidade&#xd;&#xa;	                    AND RegPreco.interno                &#x3d; RegPrecoOrgao.interno&#xd;&#xa;	                    AND RegPreco.numcgm_gerenciador     &#x3d; RegPrecoOrgao.numcgm_gerenciador&#xd;&#xa;	                    LEFT JOIN tcemg.registro_precos_licitacao&#xd;&#xa;	                     ON RegPreco.cod_entidade           &#x3d; registro_precos_licitacao.cod_entidade&#xd;&#xa;	                    AND RegPreco.numero_registro_precos &#x3d; registro_precos_licitacao.numero_registro_precos&#xd;&#xa;	                    AND RegPreco.exercicio              &#x3d; registro_precos_licitacao.exercicio&#xd;&#xa;	                    AND RegPreco.interno                &#x3d; registro_precos_licitacao.interno&#xd;&#xa;	                    AND RegPreco.numcgm_gerenciador     &#x3d; registro_precos_licitacao.numcgm_gerenciador&#xd;&#xa;	                    LEFT JOIN &#x28;&#xd;&#xa;	                            SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;                &#xd;&#xa;	                                                                       VALUES &#x28;cod_licitacao        INTEGER&#xd;&#xa;	                                                                              ,cod_modalidade       INTEGER&#xd;&#xa;	                                                                              ,cod_entidade         INTEGER&#xd;&#xa;	                                                                              ,exercicio            CHAR&#x28;4&#x29;&#xd;&#xa;	                                                                              ,exercicio_licitacao  VARCHAR&#xd;&#xa;	                                                                              ,num_licitacao        TEXT &#x29;&#xd;&#xa;	                    &#x29;  AS RegPrecoLicitacao&#xd;&#xa;	                    ON RegPrecoLicitacao.cod_entidade    &#x3d; registro_precos_licitacao.cod_entidade_licitacao&#xd;&#xa;	                    AND RegPrecoLicitacao.cod_licitacao  &#x3d; registro_precos_licitacao.cod_licitacao&#xd;&#xa;	                    AND RegPrecoLicitacao.cod_modalidade &#x3d; registro_precos_licitacao.cod_modalidade&#xd;&#xa;	                    AND RegPrecoLicitacao.exercicio      &#x3d; registro_precos_licitacao.exercicio_licitacao&#xd;&#xa;	                    LEFT JOIN tcemg.arquivo_emp&#xd;&#xa;	                    ON  arquivo_emp.exercicio    &#x3d; EE.exercicio&#xd;&#xa;	                    AND arquivo_emp.cod_empenho  &#x3d; EE.cod_empenho&#xd;&#xa;	                    AND arquivo_emp.cod_entidade &#x3d; EE.cod_entidade&#xd;&#xa;	                    LEFT JOIN licitacao.licitacao AS L_LIC_RegPreco&#xd;&#xa;	                    ON &#x28;    L_LIC_RegPreco.cod_entidade   &#x3d; RegPrecoLicitacao.cod_entidade&#xd;&#xa;	                        AND L_LIC_RegPreco.cod_licitacao  &#x3d; RegPrecoLicitacao.cod_licitacao&#xd;&#xa;	                        AND L_LIC_RegPreco.cod_modalidade &#x3d; RegPrecoLicitacao.cod_modalidade&#xd;&#xa;	                        AND L_LIC_RegPreco.exercicio      &#x3d; RegPrecoLicitacao.exercicio&#xd;&#xa;	                       &#x29;&#xd;&#xa;	                    OR &#x28;    L_LIC_RegPreco.cod_entidade   &#x3d; arquivo_emp.cod_entidade&#xd;&#xa;	                        AND L_LIC_RegPreco.cod_licitacao  &#x3d; arquivo_emp.cod_licitacao&#xd;&#xa;	                        AND L_LIC_RegPreco.cod_modalidade &#x3d; arquivo_emp.cod_modalidade&#xd;&#xa;	                        AND L_LIC_RegPreco.exercicio      &#x3d; arquivo_emp.exercicio_licitacao&#xd;&#xa;	                       &#x29;&#xd;&#xa;	                    WHERE EE.exercicio&#x3d;  stExercicio                                                              &#xd;&#xa;	                    AND EE.dt_empenho BETWEEN TO_DATE&#x28;stDtInicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;  &#xd;&#xa;	                    AND EE.cod_entidade IN  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;       &#xd;&#xa;	                    GROUP BY codOrgao,codunidadesub,codfuncao,codsubfuncao,codprograma,idacao,naturezadespesa,subelemento,nroempenho,dtempenho,modalidadeempenho,tpempenho,vlbruto,especificacaoempenho,despdeccontrato,&#xd;&#xa;	                    codorgaorespcontrato,codunidadesubrespcontrato,nrocontrato,dataassinaturacontrato,nrosequencialtermoaditivo,despdecconvenio,nroconvenio,dataassinaturaconvenio,despdeclicitacao,nroProcessoLicitatorio, codorgaoresplicit,&#xd;&#xa;	                    tipoProcesso,cpfOrdenador,C_CD.cod_compra_direta,tipo_objeto.cod_tipo_objeto,L_LIC.exercicio, exercicioProcessoLicitatorio, codUnidadeSubRespLicit, config_licitacao.exercicio_licitacao, config_licitacao.num_licitacao&#xd;&#xa;			&#x29;, &#xd;&#xa;			  emp11 as &#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT DISTINCT ON&#x28;EE.cod_empenho&#x29;&#xd;&#xa;	                    11 AS tipo_Registro&#xd;&#xa;	                    , LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;OD.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;OD.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29; AS codunidadesub&#xd;&#xa;	                    , EE.cod_empenho AS nroempenho&#xd;&#xa;	                    , recurso.cod_fonte AS codFontRecursos&#xd;&#xa;	                    , REPLACE&#x28;empenho.fn_consultar_valor_empenhado&#x28;&#xd;&#xa;	                            EE.exercicio&#xd;&#xa;	                            ,EE.cod_empenho&#xd;&#xa;	                            ,EE.cod_entidade&#x29;&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29;&#xd;&#xa;	                    AS valorFonte&#xd;&#xa;	                    FROM empenho.empenho AS EE&#xd;&#xa;	                    LEFT JOIN empenho.empenho_anulado AS EEANUL&#xd;&#xa;	                    ON EEANUL.exercicio&#x3d;EE.exercicio&#xd;&#xa;	                    AND EEANUL.cod_entidade&#x3d;EE.cod_entidade&#xd;&#xa;	                    AND EEANUL.cod_empenho&#x3d;EE.cod_empenho&#xd;&#xa;	                    INNER JOIN empenho.pre_empenho AS EPE&#xd;&#xa;	                    ON EPE.cod_pre_empenho&#x3d;EE.cod_pre_empenho&#xd;&#xa;	                    AND EPE.exercicio&#x3d;EE.exercicio&#xd;&#xa;	                    INNER JOIN empenho.pre_empenho_despesa AS EPED&#xd;&#xa;	                    ON EPED.cod_pre_empenho&#x3d;EPE.cod_pre_empenho&#xd;&#xa;	                    AND EPED.exercicio&#x3d;EPE.exercicio&#xd;&#xa;	                    INNER JOIN orcamento.despesa AS OD&#xd;&#xa;	                    ON OD.exercicio&#x3d;EPED.exercicio AND OD.cod_despesa&#x3d;EPED.cod_despesa&#xd;&#xa;	                    INNER JOIN orcamento.recurso&#xd;&#xa;	                    ON recurso.exercicio&#x3d;OD.exercicio&#xd;&#xa;	                    AND recurso.cod_recurso&#x3d;OD.cod_recurso&#xd;&#xa;	                    WHERE EE.exercicio&#x3d;  stExercicio                                                             &#xd;&#xa;	                    AND EE.dt_empenho BETWEEN TO_DATE&#x28;stDtInicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; &#xd;&#xa;	                    AND EE.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;       &#xd;&#xa;	                    &#xd;&#xa;			&#x29;,&#xd;&#xa;			  emp12 as &#xd;&#xa;			&#x28;&#xd;&#xa;                SELECT &#x2a; FROM&#xd;&#xa;	                &#x28;&#xd;&#xa;	                    SELECT DISTINCT ON&#x28;EE.cod_empenho&#x29;&#xd;&#xa;					                    12 AS tipo_Registro&#xd;&#xa;					                    , LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;OD.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;OD.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29; AS codunidadesub&#xd;&#xa;					                    , EE.cod_empenho AS nroempenho&#xd;&#xa;					                    ,   CASE WHEN CGM_PJ.cnpj IS NOT NULL THEN&#xd;&#xa;					                                2&#xd;&#xa;					                             WHEN CGM_PF.cpf IS NOT NULL THEN&#xd;&#xa;					                                1&#xd;&#xa;					                             ELSE&#xd;&#xa;					                                2&#xd;&#xa;					                        END&#xd;&#xa;					                    AS tipoDocumento&#xd;&#xa;					                    ,   CASE WHEN CGM_PJ.cnpj IS NOT NULL THEN&#xd;&#xa;					                                CGM_PJ.cnpj&#xd;&#xa;					                            WHEN CGM_PF.cpf IS NOT NULL THEN&#xd;&#xa;					                                CGM_PF.cpf&#xd;&#xa;					                            else&#xd;&#xa;					                            	&#x27; &#x27;&#xd;&#xa;					                                &#xd;&#xa;					                        END&#xd;&#xa;					                    AS nroDocumento&#xd;&#xa;					                    ,   CASE WHEN SUBSTR&#x28;conta_despesa.cod_estrutural, 9, 2&#x29; IN &#x28;&#x27;01&#x27;,&#x27;03&#x27;,&#x27;04&#x27;,&#x27;05&#x27;,&#x27;09&#x27;,&#x27;11&#x27;,&#x27;16&#x27;,&#x27;48&#x27;,&#x27;94&#x27;&#x29; THEN&#xd;&#xa;					                            true&#xd;&#xa;					                        WHEN &#x27;&#x27;&#x7c;&#x7c;SUBSTR&#x28;conta_despesa.cod_estrutural, 9, 2&#x29;&#x7c;&#x7c;SUBSTR&#x28;conta_despesa.cod_estrutural, 12, 2&#x29; IN &#x28;&#x27;3626&#x27;,&#x27;3628&#x27;,&#x27;3699&#x27;&#x29; THEN&#xd;&#xa;					                            true&#xd;&#xa;					                        WHEN SUBSTR&#x28;conta_despesa.cod_estrutural, 0, 14&#x29; IN &#x28;&#x27;3.1.9.0.92.01&#x27;,&#x27;3.1.9.0.92.02&#x27;,&#x27;3.1.7.1.92.01&#x27;,&#x27;3.1.7.1.92.02&#x27;,&#xd;&#xa;					                        &#x27;3.1.9.1.92.01&#x27;,&#x27;3.1.9.1.92.02&#x27;,&#x27;3.3.9.0.36.07&#x27;&#x29; THEN&#xd;&#xa;					                            true&#xd;&#xa;					                        ELSE&#xd;&#xa;					                            false&#xd;&#xa;					                        END&#xd;&#xa;					                    AS folha&#xd;&#xa;			                       FROM empenho.empenho AS EE&#xd;&#xa;			                  LEFT JOIN empenho.empenho_anulado AS EEANUL&#xd;&#xa;			                         ON EEANUL.exercicio&#x3d;EE.exercicio&#xd;&#xa;			                        AND EEANUL.cod_entidade&#x3d;EE.cod_entidade&#xd;&#xa;			                        AND EEANUL.cod_empenho&#x3d;EE.cod_empenho&#xd;&#xa;			                 INNER JOIN empenho.pre_empenho AS EPE&#xd;&#xa;			                         ON EPE.cod_pre_empenho&#x3d;EE.cod_pre_empenho&#xd;&#xa;			                        AND EPE.exercicio&#x3d;EE.exercicio&#xd;&#xa;			                 INNER JOIN empenho.pre_empenho_despesa AS EPED&#xd;&#xa;			                         ON EPED.cod_pre_empenho&#x3d;EPE.cod_pre_empenho&#xd;&#xa;			                        AND EPED.exercicio&#x3d;EPE.exercicio&#xd;&#xa;			                 INNER JOIN orcamento.despesa AS OD&#xd;&#xa;			                         ON OD.exercicio&#x3d;EPED.exercicio &#xd;&#xa;								    AND OD.cod_despesa&#x3d;EPED.cod_despesa&#xd;&#xa;			                 INNER JOIN orcamento.conta_despesa&#xd;&#xa;			                         ON conta_despesa.exercicio&#x3d;OD.exercicio&#xd;&#xa;			                        AND conta_despesa.cod_conta&#x3d;OD.cod_conta&#xd;&#xa;			                  LEFT JOIN sw_cgm_pessoa_juridica AS CGM_PJ&#xd;&#xa;			                         ON CGM_PJ.numcgm&#x3d;EPE.cgm_beneficiario&#xd;&#xa;			                  LEFT JOIN sw_cgm_pessoa_fisica AS CGM_PF&#xd;&#xa;			                         ON CGM_PF.numcgm&#x3d;EPE.cgm_beneficiario&#xd;&#xa;			                  LEFT JOIN sw_cgm AS CGM&#xd;&#xa;			                         ON CGM.numcgm&#x3d;EPE.cgm_beneficiario&#xd;&#xa;			                      WHERE EE.exercicio&#x3d;  stExercicio                                                                        &#xd;&#xa;			                        AND EE.dt_empenho BETWEEN TO_DATE&#x28;stDtInicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;          &#xd;&#xa;			                        AND EE.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                &#xd;&#xa;	                &#x29; AS tabela&#xd;&#xa;			&#x29;,&#xd;&#xa;			  emp_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							nroempenho,   &#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codorgao, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codunidadesub, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codfuncao, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codsubfuncao, &#x27; &#x27;&#x29;  	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codprograma, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;idacao, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;idsubacao, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;naturezadespesa, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;subelemento, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroempenho, &#x27;0&#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;dtempenho, &#x27; &#x27;&#x29;   	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;modalidadeempenho, &#x27;0&#x27;&#x29;  	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tpempenho&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27;0&#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;vlbruto&#x3a;&#x3a;varchar, &#x27;0,00&#x27;&#x29;   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;especificacaoempenho,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,200&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;despdeccontrato&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;  &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codorgaorespcontrato&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2 , &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesubrespcontrato&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 5, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nrocontrato&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;		&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dataassinaturacontrato&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nrosequencialtermoaditivo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;  	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;despdecconvenio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroconvenio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dataassinaturaconvenio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;  &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;despdeclicitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codorgaoresplicit&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesubresplicit&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroprocessolicitatorio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;	 &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicioprocessolicitatorio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipoprocesso&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cpfordenador&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 11, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;natureza_objeto&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;     				&#xd;&#xa;					as d&#xd;&#xa;				from emp10&#xd;&#xa;				union all   &#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							nroempenho,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codunidadesub, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroempenho&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codfontrecursos&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;valorfonte&#x3a;&#x3a;varchar,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from emp11&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        nroempenho,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codunidadesub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroempenho&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipodocumento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nrodocumento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#xd;&#xa;					as d&#xd;&#xa;				from emp12&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;EMP.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from emp_format order by nroempenho,tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;    if strpos&#x28;stArquivos,&#x27;&#x22;CONV.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with conv10 as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 10 AS tipo_Registro&#xd;&#xa;	                     , &#x28;TC.exercicio&#x7c;&#x7c;&#x27;&#x27;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_convenio,9, &#x27;0&#x27;&#x29;&#x29;&#x29; AS codConvenio&#xd;&#xa;	                     , &#x28;SELECT valor&#xd;&#xa;	                          FROM administracao.configuracao_entidade&#xd;&#xa;	                         WHERE exercicio&#x3d;TC.exercicio&#xd;&#xa;	                           AND parametro&#x3d;&#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                           AND cod_entidade&#x3d;TC.cod_entidade&#x29; AS codOrgao&#xd;&#xa;	                     , TC.nro_convenio AS nroConvenio&#xd;&#xa;	                     , to_char&#x28;TC.data_assinatura, &#x27;ddmmyyyy&#x27;&#x29; AS dataAssinatura&#xd;&#xa;	                     , objeto.descricao AS objetoConvenio&#xd;&#xa;	                     , to_char&#x28;TC.data_inicio, &#x27;ddmmyyyy&#x27;&#x29; AS dataInicioVigencia&#xd;&#xa;	                     , to_char&#x28;TC.data_final, &#x27;ddmmyyyy&#x27;&#x29; AS dataFinalVigencia&#xd;&#xa;	                     , REPLACE&#x28;TC.vl_convenio&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29; AS vlConvenio&#xd;&#xa;	                     , REPLACE&#x28;TC.vl_contra_partida&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29; AS vlContrapartida&#xd;&#xa;	                  FROM tcemg.convenio AS TC&#xd;&#xa;	            INNER JOIN compras.objeto&#xd;&#xa;	                    ON objeto.cod_objeto&#x3d;TC.cod_objeto&#xd;&#xa;	                 WHERE TC.exercicio&#x3d; stEntidade                                                                               &#xd;&#xa;	                   AND TC.cod_entidade IN  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                    &#xd;&#xa;			           AND TC.data_inicio BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;  AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;             &#xd;&#xa;	              ORDER BY TC.cod_entidade&#xd;&#xa;	                     , TC.nro_convenio&#xd;&#xa;			&#x29;, &#xd;&#xa;			  conv11 as &#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 11 AS tipo_Registro&#xd;&#xa;	                         , &#x28;TC.exercicio&#x7c;&#x7c;&#x27;&#x27;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_convenio,9, &#x27;0&#x27;&#x29;&#x29;&#x29; AS codConvenio&#xd;&#xa;	                         , 2 AS tipoDocumento&#xd;&#xa;	                         , CGMPJ.cnpj AS nroDocumento&#xd;&#xa;	                         , CASE WHEN TCP.esfera &#x3d; &#x27;Federal&#x27; THEN&#xd;&#xa;	                             1&#xd;&#xa;	                           WHEN TCP.esfera &#x3d; &#x27;Estadual&#x27; THEN&#xd;&#xa;	                             2&#xd;&#xa;	                           WHEN TCP.esfera &#x3d; &#x27;Municipal&#x27; THEN&#xd;&#xa;	                             3&#xd;&#xa;	                           END AS esferaConcedente&#xd;&#xa;	                         , REPLACE&#x28;TCP.vl_concedido&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29; AS valorConcedido&#xd;&#xa;	                      FROM tcemg.convenio AS TC&#xd;&#xa;	                INNER JOIN tcemg.convenio_participante AS TCP&#xd;&#xa;	                        ON TCP.cod_convenio &#x3d; TC.cod_convenio&#xd;&#xa;	                       AND TCP.exercicio    &#x3d; TC.exercicio&#xd;&#xa;	                       AND TCP.cod_entidade &#x3d; TC.cod_entidade&#xd;&#xa;	                INNER JOIN sw_cgm_pessoa_juridica AS CGMPJ&#xd;&#xa;	                        ON CGMPJ.numcgm &#x3d; TCP.cgm_participante&#xd;&#xa;			     WHERE TC.exercicio &#x3d;  stExercicio                                                                                      &#xd;&#xa;	                       AND TC.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                       &#xd;&#xa;	                       AND TC.data_inicio BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;  AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;               &#xd;&#xa;	                  ORDER BY TC.cod_entidade&#xd;&#xa;	                          ,TC.nro_convenio&#xd;&#xa;			&#x29;,&#xd;&#xa;			  conv20 as &#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT 20 AS tipo_Registro&#xd;&#xa;					 , &#x28;SELECT valor&#xd;&#xa;					      FROM administracao.configuracao_entidade&#xd;&#xa;					     WHERE exercicio    &#x3d; TC.exercicio&#xd;&#xa;					       AND parametro    &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;					       AND cod_entidade &#x3d; TC.cod_entidade&#x29; AS codOrgao&#xd;&#xa;					 , TC.nro_convenio AS nroConvenio&#xd;&#xa;					 , TO_CHAR&#x28;TC.data_assinatura, &#x27;ddmmyyyy&#x27;&#x29; AS dataAssinatura&#xd;&#xa;					 , TCA.cod_aditivo AS nroAditivo&#xd;&#xa;					 , TCA.descricao AS dscAlteracao&#xd;&#xa;					 , TO_CHAR&#x28;TCA.data_assinatura, &#x27;ddmmyyyy&#x27;&#x29; AS dtAssinaturaAditivo&#xd;&#xa;					 , CASE WHEN TCA.data_final IS NOT NULL THEN&#xd;&#xa;					    TO_CHAR&#x28;TCA.data_final, &#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;					   ELSE&#xd;&#xa;					     TO_CHAR&#x28;TC.data_final, &#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;					   END AS dataVigencia&#xd;&#xa;					 , CASE WHEN TCA.vl_convenio &#x3e; 0 THEN&#xd;&#xa;					     REPLACE&#x28;TCA.vl_convenio&#x3a;&#x3a;VARCHAR, &#x27;.&#x27;, &#x27;,&#x27;&#x29;&#xd;&#xa;					   ELSE&#xd;&#xa;					     REPLACE&#x28;TC.vl_convenio&#x3a;&#x3a;VARCHAR, &#x27;.&#x27;, &#x27;,&#x27;&#x29;&#xd;&#xa;					   END AS valorAtualizado&#xd;&#xa;					 , CASE WHEN TCA.vl_contra &#x3e; 0 THEN&#xd;&#xa;					     REPLACE&#x28;TCA.vl_contra&#x3a;&#x3a;VARCHAR, &#x27;.&#x27;, &#x27;,&#x27;&#x29;&#xd;&#xa;					   ELSE&#xd;&#xa;					     REPLACE&#x28;TC.vl_contra_partida&#x3a;&#x3a;VARCHAR, &#x27;.&#x27;, &#x27;,&#x27;&#x29;&#xd;&#xa;					   END AS valorContra&#xd;&#xa;					 , &#x28;TC.exercicio&#x7c;&#x7c;&#x27;&#x27;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_convenio,9, &#x27;0&#x27;&#x29;&#x29;&#x29; AS codConvenio&#xd;&#xa;				      FROM tcemg.convenio AS TC&#xd;&#xa;				INNER JOIN tcemg.convenio_aditivo AS TCA&#xd;&#xa;					ON TCA.cod_convenio &#x3d; TC.cod_convenio&#xd;&#xa;				       AND TCA.exercicio    &#x3d; TC.exercicio&#xd;&#xa;				       AND TCA.cod_entidade &#x3d; TC.cod_entidade&#xd;&#xa;				     WHERE TC.exercicio &#x3d; stExercicio                                                                               &#xd;&#xa;				       AND TC.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                       &#xd;&#xa;				       AND TC.data_inicio BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                &#xd;&#xa;				  ORDER BY TC.cod_entidade&#xd;&#xa;					  ,TC.nro_convenio&#xd;&#xa;			&#x29;,&#xd;&#xa;			  conv_format as&#xd;&#xa;			&#x28;&#xd;&#xa;					select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							codconvenio,   &#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codconvenio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27;0&#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroconvenio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;dataassinatura&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;  	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;objetoconvenio,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,500&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;datainiciovigencia&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;datafinalvigencia&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;vlconvenio&#x3a;&#x3a;varchar, &#x27;0,00&#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;vlcontrapartida&#x3a;&#x3a;varchar, &#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from conv10&#xd;&#xa;				union all   &#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							codconvenio, &#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codconvenio, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipodocumento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;nrodocumento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 14, &#x27; &#x27;&#x29;			&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;esferaconcedente&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;valorconcedido&#x3a;&#x3a;varchar,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from conv11&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        codconvenio,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroconvenio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;dataassinatura&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;nroaditivo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,2,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;dscalteracao,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,500&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dtassinaturaaditivo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;datavigencia&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;valoratualizado&#x3a;&#x3a;varchar,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;valorcontra&#x3a;&#x3a;varchar,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#xd;&#xa;					as d&#xd;&#xa;				from conv20  &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;CONV.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from conv_format order by codconvenio,tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;	&#xd;&#xa;	&#xd;&#xa;    if strpos&#x28;stArquivos,&#x27;&#x22;CAIXA.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then	&#xd;&#xa;			with caixa10 as&#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT&#xd;&#xa;	                            10 AS tipo_registro&#xd;&#xa;	                            , LPAD&#x28;&#x27;02&#x27;,4,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;	                            , SUM&#x28;conta.vl_saldo_anterior&#x29; AS vl_saldo_inicial&#xd;&#xa;	                            , CASE WHEN SUM&#x28;conta.vl_saldo_atual&#x29; &#x3c; 0&#xd;&#xa;	                                   THEN SUM&#x28;conta.vl_saldo_atual&#x29; &#x2a; -1&#xd;&#xa;	                                   ELSE SUM&#x28;conta.vl_saldo_atual&#x29;&#xd;&#xa;	                              END AS vl_saldo_final&#xd;&#xa;	                    FROM &#x28;&#xd;&#xa;	                            SELECT&#xd;&#xa;	                                    cod_estrutural&#xd;&#xa;	                                  , nivel&#xd;&#xa;	                                  , nom_conta&#xd;&#xa;	                                  , cod_sistema&#xd;&#xa;	                                  , indicador_superavit&#xd;&#xa;	                                  , vl_saldo_anterior&#xd;&#xa;	                                  , vl_saldo_debitos&#xd;&#xa;	                                  , vl_saldo_creditos&#xd;&#xa;	                                  , vl_saldo_atual&#xd;&#xa;	                            FROM&#xd;&#xa;	                                 contabilidade.fn_rl_balancete_verificacao&#x28;stExercicio,   &#xd;&#xa;	                                                                           &#x27; cod_entidade IN  &#x28;&#x27; &#x7c;&#x7c; stEntidade &#x7c;&#x7c; &#x27;&#x29;&#x27;,            &#xd;&#xa;	                                                                           stDtinicio,                                            &#xd;&#xa;	                                                                           stDtfim,                                               &#xd;&#xa;	                                                                           &#x27;S&#x27;&#x3a;&#x3a;CHAR&#xd;&#xa;	                                                                        &#x29;&#xd;&#xa;	                                                                          AS retorno&#x28; cod_estrutural varchar&#xd;&#xa;	                                                                                      ,nivel integer&#xd;&#xa;	                                                                                      ,nom_conta varchar&#xd;&#xa;	                                                                                      ,cod_sistema integer&#xd;&#xa;	                                                                                      ,indicador_superavit char&#x28;12&#x29;&#xd;&#xa;	                                                                                      ,vl_saldo_anterior numeric&#xd;&#xa;	                                                                                      ,vl_saldo_debitos  numeric&#xd;&#xa;	                                                                                      ,vl_saldo_creditos numeric&#xd;&#xa;	                                                                                      ,vl_saldo_atual    numeric&#xd;&#xa;	                                                                                    &#x29;&#xd;&#xa;	                           WHERE cod_estrutural like &#x27;1.1.1.1.1.01&#x25;&#x27;&#xd;&#xa;	                        &#x29; as conta&#xd;&#xa;	                GROUP BY cod_orgao, tipo_registro&#xd;&#xa;			&#x29;, &#xd;&#xa;			  caixa11 as &#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT 			tipo_registro&#xd;&#xa;	                                    , replace&#x28;tabela.cod_estrutural,&#x27;.&#x27;,&#x27;&#x27;&#x29; AS cod_estrutural&#xd;&#xa;	                                    , cod_fonte_caixa&#xd;&#xa;	                                    , COALESCE&#x28;saldo.vl_saldo_inicial_fonte, 0.00&#x29; AS vl_saldo_inicial_fonte&#xd;&#xa;	                                    , COALESCE&#x28;saldo.vl_saldo_final_fonte, 0.00&#x29; AS vl_saldo_final_fonte&#xd;&#xa;	                    FROM &#x28; SELECT &#x27;11&#x27;&#x3a;&#x3a;int  AS  tipo_registro&#xd;&#xa;	                                , plano_conta.cod_estrutural&#xd;&#xa;	                                , plano_recurso.cod_recurso&#x3a;&#x3a;VARCHAR as  cod_fonte_caixa&#xd;&#xa;	                            FROM contabilidade.conta_debito&#xd;&#xa;	                      INNER JOIN contabilidade.valor_lancamento&#xd;&#xa;	                              ON valor_lancamento.cod_lote &#x3d; conta_debito.cod_lote&#xd;&#xa;	                             AND valor_lancamento.tipo &#x3d; conta_debito.tipo&#xd;&#xa;	                             AND valor_lancamento.sequencia &#x3d; conta_debito.sequencia&#xd;&#xa;	                             AND valor_lancamento.exercicio &#x3d; conta_debito.exercicio&#xd;&#xa;	                             AND valor_lancamento.tipo_valor &#x3d; conta_debito.tipo_valor&#xd;&#xa;	                             AND valor_lancamento.cod_entidade &#x3d; conta_debito.cod_entidade&#xd;&#xa;	                      INNER JOIN contabilidade.lancamento&#xd;&#xa;	                              ON lancamento.sequencia &#x3d; valor_lancamento.sequencia&#xd;&#xa;	                             AND lancamento.cod_lote &#x3d; valor_lancamento.cod_lote&#xd;&#xa;	                             AND lancamento.tipo &#x3d; valor_lancamento.tipo&#xd;&#xa;	                             AND lancamento.exercicio &#x3d; valor_lancamento.exercicio&#xd;&#xa;	                             AND lancamento.cod_entidade &#x3d; valor_lancamento.cod_entidade&#xd;&#xa;	                       LEFT JOIN contabilidade.lancamento_empenho&#xd;&#xa;	                              ON lancamento_empenho.exercicio    &#x3d; lancamento.exercicio&#xd;&#xa;	                             AND lancamento_empenho.tipo         &#x3d; lancamento.tipo&#xd;&#xa;	                             AND lancamento_empenho.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;	                             AND lancamento_empenho.cod_lote     &#x3d; lancamento.cod_lote&#xd;&#xa;	                             AND lancamento_empenho.sequencia    &#x3d; lancamento.sequencia&#xd;&#xa;	                      INNER JOIN contabilidade.lote&#xd;&#xa;	                              ON lote.cod_lote &#x3d; lancamento.cod_lote&#xd;&#xa;	                             AND lote.exercicio &#x3d; lancamento.exercicio&#xd;&#xa;	                             AND lote.tipo &#x3d; lancamento.tipo&#xd;&#xa;	                             AND lote.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;	                             AND lote.dt_lote BETWEEN TO_DATE &#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;  &#xd;&#xa;	                             AND lote.exercicio &#x3d;  stExercicio                                                             &#xd;&#xa;	                             AND lote.tipo &#x21;&#x3d; &#x27;I&#x27;&#xd;&#xa;	                      INNER JOIN contabilidade.plano_analitica&#xd;&#xa;	                              ON plano_analitica.cod_plano &#x3d; conta_debito.cod_plano&#xd;&#xa;	                             AND plano_analitica.exercicio &#x3d; conta_debito.exercicio&#xd;&#xa;	                      INNER JOIN contabilidade.plano_conta&#xd;&#xa;	                              ON plano_conta.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;	                             AND plano_conta.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;	                      INNER JOIN contabilidade.plano_recurso&#xd;&#xa;	                              ON plano_analitica.cod_plano &#x3d; plano_recurso.cod_plano&#xd;&#xa;	                             AND plano_analitica.exercicio &#x3d; plano_recurso.exercicio&#xd;&#xa;	                           WHERE conta_debito.exercicio &#x3d;  stExercicio                                                          &#xd;&#xa;	                             AND conta_debito.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;	                             AND plano_conta.cod_estrutural like  &#x27;1.1.1.1.1.01&#x25;&#x27;&#xd;&#xa;	                        GROUP BY tipo_registro&#xd;&#xa;	                               , plano_conta.cod_estrutural&#xd;&#xa;	                               , plano_recurso.cod_recurso&#xd;&#xa;			              UNION&#xd;&#xa;	                          SELECT &#x27;11&#x27;&#x3a;&#x3a;int  AS  tipo_registro&#xd;&#xa;	                                , plano_conta.cod_estrutural&#xd;&#xa;	                                , plano_recurso.cod_recurso&#x3a;&#x3a;VARCHAR as cod_fonte_caixa&#xd;&#xa;	                            FROM contabilidade.conta_credito&#xd;&#xa;	                      INNER JOIN contabilidade.valor_lancamento&#xd;&#xa;	                              ON valor_lancamento.cod_lote &#x3d; conta_credito.cod_lote&#xd;&#xa;	                             AND valor_lancamento.tipo &#x3d; conta_credito.tipo&#xd;&#xa;	                             AND valor_lancamento.sequencia &#x3d; conta_credito.sequencia&#xd;&#xa;	                             AND valor_lancamento.exercicio &#x3d; conta_credito.exercicio&#xd;&#xa;	                             AND valor_lancamento.tipo_valor &#x3d; conta_credito.tipo_valor&#xd;&#xa;	                             AND valor_lancamento.cod_entidade &#x3d; conta_credito.cod_entidade&#xd;&#xa;	                      INNER JOIN contabilidade.lancamento&#xd;&#xa;	                              ON lancamento.sequencia &#x3d; valor_lancamento.sequencia&#xd;&#xa;	                             AND lancamento.cod_lote &#x3d; valor_lancamento.cod_lote&#xd;&#xa;	                             AND lancamento.tipo &#x3d; valor_lancamento.tipo&#xd;&#xa;	                             AND lancamento.exercicio &#x3d; valor_lancamento.exercicio&#xd;&#xa;	                             AND lancamento.cod_entidade &#x3d; valor_lancamento.cod_entidade&#xd;&#xa;	                      INNER JOIN contabilidade.lote&#xd;&#xa;	                              ON lote.cod_lote &#x3d; lancamento.cod_lote&#xd;&#xa;	                             AND lote.exercicio &#x3d; lancamento.exercicio&#xd;&#xa;	                             AND lote.tipo &#x3d; lancamento.tipo&#xd;&#xa;	                             AND lote.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;	                             AND lote.dt_lote BETWEEN TO_DATE &#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;           &#xd;&#xa;	                             AND lote.exercicio &#x3d; stExercicio                                                                       &#xd;&#xa;	                             AND lote.tipo &#x21;&#x3d; &#x27;I&#x27;&#xd;&#xa;	                             AND lote.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;               &#xd;&#xa;	                       LEFT JOIN contabilidade.lancamento_empenho&#xd;&#xa;	                              ON lancamento_empenho.exercicio    &#x3d; lancamento.exercicio&#xd;&#xa;	                             AND lancamento_empenho.tipo         &#x3d; lancamento.tipo&#xd;&#xa;	                             AND lancamento_empenho.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;	                             AND lancamento_empenho.cod_lote     &#x3d; lancamento.cod_lote&#xd;&#xa;	                             AND lancamento_empenho.sequencia    &#x3d; lancamento.sequencia&#xd;&#xa;	                      INNER JOIN contabilidade.plano_analitica&#xd;&#xa;	                              ON plano_analitica.cod_plano &#x3d; conta_credito.cod_plano&#xd;&#xa;	                             AND plano_analitica.exercicio &#x3d; conta_credito.exercicio&#xd;&#xa;	                      INNER JOIN contabilidade.plano_conta&#xd;&#xa;	                              ON plano_conta.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;	                             AND plano_conta.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;	                      INNER JOIN contabilidade.plano_banco&#xd;&#xa;	                              ON plano_banco.cod_plano &#x3d; conta_credito.cod_plano&#xd;&#xa;	                             AND plano_banco.exercicio &#x3d; conta_credito.exercicio&#xd;&#xa;	                             AND plano_banco.cod_entidade IN  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;        &#xd;&#xa;	                      INNER JOIN contabilidade.plano_recurso&#xd;&#xa;	                              ON plano_analitica.cod_plano &#x3d; plano_recurso.cod_plano&#xd;&#xa;	                             AND plano_analitica.exercicio &#x3d; plano_recurso.exercicio&#xd;&#xa;	                           WHERE conta_credito.exercicio &#x3d; stExercicio                                                                &#xd;&#xa;	                             AND conta_credito.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;        &#xd;&#xa;	                             AND plano_conta.cod_estrutural like  &#x27;1.1.1.1.1.01&#x25;&#x27;&#xd;&#xa;	                        GROUP BY tipo_registro&#xd;&#xa;	                               , plano_conta.cod_estrutural&#xd;&#xa;	                               , plano_recurso.cod_recurso&#xd;&#xa;	                    &#x29; as tabela&#xd;&#xa;	                    LEFT JOIN &#x28;&#xd;&#xa;	                            SELECT cod_estrutural&#xd;&#xa;	                                     , SUM&#x28;vl_saldo_anterior&#x29; AS vl_saldo_inicial_fonte&#xd;&#xa;	                                     , CASE WHEN SUM&#x28;vl_saldo_atual&#x29; &#x3c; 0 THEN&#xd;&#xa;	                                        SUM&#x28;vl_saldo_atual&#x29; &#x2a; -1&#xd;&#xa;	                                    ELSE&#xd;&#xa;	                                        SUM&#x28;vl_saldo_atual&#x29;&#xd;&#xa;	                                    END AS vl_saldo_final_fonte&#xd;&#xa;	                            FROM&#xd;&#xa;	                                 contabilidade.fn_rl_balancete_verificacao&#x28;stExercicio,                                           &#xd;&#xa;	                                                                           &#x27; cod_entidade IN  &#x28;&#x27; &#x7c;&#x7c; stEntidade &#x7c;&#x7c; &#x27;&#x29;&#x27;,            &#xd;&#xa;	                                                                           stDtinicio,                                            &#xd;&#xa;	                                                                           stDtfim,                                               &#xd;&#xa;	                                                                           &#x27;A&#x27;&#x3a;&#x3a;CHAR&#xd;&#xa;	                                                                        &#x29;&#xd;&#xa;	                                                                          AS retorno&#x28; cod_estrutural varchar&#xd;&#xa;	                                                                                      ,nivel integer&#xd;&#xa;	                                                                                      ,nom_conta varchar&#xd;&#xa;	                                                                                      ,cod_sistema integer&#xd;&#xa;	                                                                                      ,indicador_superavit char&#x28;12&#x29;&#xd;&#xa;	                                                                                      ,vl_saldo_anterior numeric&#xd;&#xa;	                                                                                      ,vl_saldo_debitos  numeric&#xd;&#xa;	                                                                                      ,vl_saldo_creditos numeric&#xd;&#xa;	                                                                                      ,vl_saldo_atual    numeric&#xd;&#xa;	                                                                                    &#x29;&#xd;&#xa;	                           WHERE cod_estrutural like &#x27;1.1.1.1.1.01&#x25;&#x27;&#xd;&#xa;	                      GROUP BY cod_estrutural&#xd;&#xa;	                    &#x29; as saldo&#xd;&#xa;	                   ON saldo.cod_estrutural &#x3d; tabela.cod_estrutural&#xd;&#xa;			&#x29;,&#xd;&#xa;			  caixa12 as &#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT tipo_registro&#xd;&#xa;	                        , exercicio&#x7c;&#x7c;tipo_movimentacao&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;tipo_entr_saida&#x7c;&#x7c;cod_ctb_transf  as cod_reduzido&#xd;&#xa;	                        , cod_fonte_caixa&#xd;&#xa;	                        , tipo_movimentacao&#xd;&#xa;	                        , tipo_entr_saida&#xd;&#xa;	                        , descr_movimentacao&#xd;&#xa;	                        , SUM&#x28;valor_entr_saida&#x29; AS valor_entr_saida&#xd;&#xa;	                        , cod_estrutural&#xd;&#xa;	                        , cod_orgao&#xd;&#xa;	                        , exercicio&#xd;&#xa;	                        , cod_ctb_transf&#xd;&#xa;	                        , cod_fonte_ctb_transf&#xd;&#xa;	                    FROM &#x28; SELECT &#x27;12&#x27;&#x3a;&#x3a;int  AS  tipo_registro&#xd;&#xa;	                                , plano_recurso.cod_recurso&#x3a;&#x3a;VARCHAR AS cod_fonte_caixa&#xd;&#xa;	                                , conta_debito.tipo&#xd;&#xa;	                                , CASE  WHEN conta_debito.tipo_valor &#x3d; &#x27;D&#x27; THEN&#xd;&#xa;	                                            1&#x3a;&#x3a;integer&#xd;&#xa;	                                        WHEN conta_debito.tipo_valor &#x3d; &#x27;C&#x27; THEN&#xd;&#xa;	                                            2&#x3a;&#x3a;integer&#xd;&#xa;	                                  END AS tipo_movimentacao&#xd;&#xa;	                                , CASE  WHEN lote.tipo &#x3d; &#x27;A&#x27; THEN &#x27;01&#x27;&#xd;&#xa;	                                        WHEN lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 5 AND conta_debito.tipo_valor &#x3d; &#x27;D&#x27; THEN &#x27;03&#x27;&#xd;&#xa;	                                        WHEN lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 5 AND conta_debito.tipo_valor &#x3d; &#x27;C&#x27; THEN &#x27;04&#x27;&#xd;&#xa;	                                        WHEN lote.tipo &#x3d;&#x27;P&#x27;  AND conta_debito.tipo_valor &#x3d; &#x27;C&#x27;   THEN &#x27;06&#x27;&#xd;&#xa;	                                        WHEN lancamento_empenho.estorno &#x3d; true OR &#x28;conta_debito.cod_lote &#x3d; transferencia_estornada.cod_lote_estorno&#x29; THEN &#x27;08&#x27;&#xd;&#xa;	                                        WHEN lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 2 AND conta_debito.tipo_valor &#x3d; &#x27;D&#x27; THEN &#x27;10&#x27;&#xd;&#xa;	                                        WHEN lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 1 AND conta_debito.tipo_valor &#x3d; &#x27;C&#x27; THEN &#x27;10&#x27;&#xd;&#xa;	                                  END AS tipo_entr_saida&#xd;&#xa;	                                , CASE WHEN &#x28;lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 2 AND conta_debito.tipo_valor &#x3d; &#x27;D&#x27;&#x29; THEN &#x27;OUTROS&#x27;&#xd;&#xa;	                                       WHEN &#x28;lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 1 AND conta_debito.tipo_valor &#x3d; &#x27;C&#x27;&#x29; THEN &#x27;OUTROS&#x27;&#xd;&#xa;	                                  END AS descr_movimentacao&#xd;&#xa;	                                , COALESCE&#x28;SUM&#x28;valor_lancamento.vl_lancamento&#x29;,0.00&#x29; as valor_entr_saida&#xd;&#xa;	                                , replace&#x28;plano_conta.cod_estrutural,&#x27;.&#x27;,&#x27;&#x27;&#x29; AS cod_estrutural&#xd;&#xa;	                                , conta_debito.cod_entidade AS cod_orgao&#xd;&#xa;	                                , plano_analitica.exercicio&#xd;&#xa;	                                , CASE WHEN &#x28;lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 5&#x29; OR &#x28;lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 3&#x29; OR &#x28;lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 4&#x29; THEN&#xd;&#xa;	                                            cod_ctb_transferencia.cod_ctb_anterior&#x3a;&#x3a;VARCHAR&#xd;&#xa;	                                       ELSE &#x27; &#x27;&#xd;&#xa;	                                  END AS cod_ctb_transf&#xd;&#xa;	                                , CASE WHEN &#x28;lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 5&#x29; OR &#x28;lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 3&#x29; OR &#x28;lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 4&#x29; THEN&#xd;&#xa;	                                            &#x28;   SELECT plano_recurso.cod_recurso&#xd;&#xa;	                                                  FROM contabilidade.plano_conta&#xd;&#xa;	                                            INNER JOIN contabilidade.plano_analitica&#xd;&#xa;	                                                    ON plano_conta.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;	                                                   AND plano_conta.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;	                                            INNER JOIN contabilidade.plano_recurso&#xd;&#xa;	                                                    ON plano_recurso.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;	                                                   AND plano_recurso.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;	                                                WHERE plano_analitica.cod_plano &#x3d; transferencia.cod_plano_credito&#xd;&#xa;	                                                   AND plano_analitica.exercicio &#x3d; transferencia.exercicio&#xd;&#xa;	                                            &#x29; END&#x3a;&#x3a;VARCHAR AS cod_fonte_ctb_transf&#xd;&#xa;	                            FROM contabilidade.conta_debito&#xd;&#xa;	                      INNER JOIN contabilidade.valor_lancamento&#xd;&#xa;	                              ON valor_lancamento.cod_lote &#x3d; conta_debito.cod_lote&#xd;&#xa;	                             AND valor_lancamento.tipo &#x3d; conta_debito.tipo&#xd;&#xa;	                             AND valor_lancamento.sequencia &#x3d; conta_debito.sequencia&#xd;&#xa;	                             AND valor_lancamento.exercicio &#x3d; conta_debito.exercicio&#xd;&#xa;	                             AND valor_lancamento.tipo_valor &#x3d; conta_debito.tipo_valor&#xd;&#xa;	                             AND valor_lancamento.cod_entidade &#x3d; conta_debito.cod_entidade&#xd;&#xa;	                      INNER JOIN contabilidade.lancamento&#xd;&#xa;	                              ON lancamento.sequencia &#x3d; valor_lancamento.sequencia&#xd;&#xa;	                             AND lancamento.cod_lote &#x3d; valor_lancamento.cod_lote&#xd;&#xa;	                             AND lancamento.tipo &#x3d; valor_lancamento.tipo&#xd;&#xa;	                             AND lancamento.exercicio &#x3d; valor_lancamento.exercicio&#xd;&#xa;	                             AND lancamento.cod_entidade &#x3d; valor_lancamento.cod_entidade&#xd;&#xa;	                       LEFT JOIN contabilidade.lancamento_empenho&#xd;&#xa;	                              ON lancamento_empenho.exercicio    &#x3d; lancamento.exercicio&#xd;&#xa;	                             AND lancamento_empenho.tipo         &#x3d; lancamento.tipo&#xd;&#xa;	                             AND lancamento_empenho.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;	                             AND lancamento_empenho.cod_lote     &#x3d; lancamento.cod_lote&#xd;&#xa;	                             AND lancamento_empenho.sequencia    &#x3d; lancamento.sequencia&#xd;&#xa;	                      INNER JOIN contabilidade.lote&#xd;&#xa;	                              ON lote.cod_lote &#x3d; lancamento.cod_lote&#xd;&#xa;	                             AND lote.exercicio &#x3d; lancamento.exercicio&#xd;&#xa;	                             AND lote.tipo &#x3d; lancamento.tipo&#xd;&#xa;	                             AND lote.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;	                             AND lote.dt_lote BETWEEN TO_DATE &#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;             &#xd;&#xa;	                             AND lote.exercicio &#x3d; stExercicio                                                                         &#xd;&#xa;	                             AND lote.tipo &#x21;&#x3d; &#x27;I&#x27;&#xd;&#xa;	                      INNER JOIN contabilidade.plano_analitica&#xd;&#xa;	                              ON plano_analitica.cod_plano &#x3d; conta_debito.cod_plano&#xd;&#xa;	                             AND plano_analitica.exercicio &#x3d; conta_debito.exercicio&#xd;&#xa;	                      INNER JOIN contabilidade.plano_conta&#xd;&#xa;	                              ON plano_conta.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;	                             AND plano_conta.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;	                      INNER JOIN contabilidade.plano_recurso&#xd;&#xa;	                              ON plano_analitica.cod_plano &#x3d; plano_recurso.cod_plano&#xd;&#xa;	                             AND plano_analitica.exercicio &#x3d; plano_recurso.exercicio&#xd;&#xa;	                      INNER JOIN contabilidade.plano_banco&#xd;&#xa;	                              ON plano_banco.cod_plano &#x3d; conta_debito.cod_plano&#xd;&#xa;	                             AND plano_banco.exercicio &#x3d; conta_debito.exercicio&#xd;&#xa;	                             AND plano_banco.cod_entidade IN  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;          &#xd;&#xa;	                       LEFT JOIN tesouraria.transferencia&#xd;&#xa;	                              ON transferencia.exercicio &#x3d; lote.exercicio&#xd;&#xa;	                             AND transferencia.cod_entidade &#x3d; lote.cod_entidade&#xd;&#xa;	                             AND transferencia.tipo &#x3d; lote.tipo&#xd;&#xa;	                             AND transferencia.cod_lote &#x3d; lote.cod_lote&#xd;&#xa;	                       LEFT JOIN tesouraria.transferencia_estornada&#xd;&#xa;	                              ON transferencia_estornada.exercicio &#x3d; lote.exercicio&#xd;&#xa;	                             AND transferencia_estornada.cod_entidade &#x3d; lote.cod_entidade&#xd;&#xa;	                             AND transferencia_estornada.tipo &#x3d; lote.tipo&#xd;&#xa;	                             AND transferencia_estornada.cod_lote_estorno &#x3d; lote.cod_lote&#xd;&#xa;	                       LEFT JOIN &#x28; SELECT conta_debito.cod_lote&#xd;&#xa;	                                        , conta_debito.tipo&#xd;&#xa;	                                        , conta_debito.exercicio&#xd;&#xa;	                                        , conta_debito.cod_entidade&#xd;&#xa;	                                        , CASE WHEN &#x28;conta_bancaria.cod_ctb_anterior is null&#x29; THEN transferencia.cod_plano_credito&#xd;&#xa;	                                                                Else conta_bancaria.cod_ctb_anterior&#xd;&#xa;	                                                                END AS cod_ctb_anterior&#xd;&#xa;	                                        , transferencia.cod_plano_credito&#xd;&#xa;	                                        , transferencia.cod_plano_debito&#xd;&#xa;	                                        , conta_debito.sequencia&#xd;&#xa;	                                     FROM contabilidade.conta_debito&#xd;&#xa;	                               INNER JOIN contabilidade.lote AS lo&#xd;&#xa;	                                       ON conta_debito.cod_lote     &#x3d; lo.cod_lote&#xd;&#xa;	                                      AND conta_debito.tipo         &#x3d; lo.tipo&#xd;&#xa;	                                      AND conta_debito.exercicio    &#x3d; lo.exercicio&#xd;&#xa;	                                      AND conta_debito.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;	                               INNER JOIN tesouraria.transferencia&#xd;&#xa;	                                       ON transferencia.cod_plano_debito &#x3d; conta_debito.cod_plano&#xd;&#xa;	                                      AND lo.cod_lote &#x3d; transferencia.cod_lote&#xd;&#xa;	                                      AND transferencia.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;	                                      AND transferencia.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;	                                      AND transferencia.exercicio &#x3d; conta_debito.exercicio&#xd;&#xa;	                               INNER JOIN contabilidade.plano_analitica&#xd;&#xa;	                                       ON plano_analitica.cod_plano &#x3d; transferencia.cod_plano_credito&#xd;&#xa;	                                      AND plano_analitica.natureza_saldo &#x3d; &#x27;D&#x27;&#xd;&#xa;	                                      AND plano_analitica.exercicio &#x3d; conta_debito.exercicio&#xd;&#xa;	                                LEFT JOIN tcemg.conta_bancaria&#xd;&#xa;	                                       ON conta_bancaria.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;	                                      AND conta_bancaria.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;	                                   WHERE conta_debito.exercicio &#x3d; stExercicio                                                                &#xd;&#xa;	                                     AND conta_debito.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;        &#xd;&#xa;	                                     AND lo.dt_lote BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;               &#xd;&#xa;	                                     AND conta_debito.tipo         &#x3d; &#x27;T&#x27;&#xd;&#xa;	                                &#x29; AS cod_ctb_transferencia&#xd;&#xa;	                              ON cod_ctb_transferencia.exercicio &#x3d; conta_debito.exercicio&#xd;&#xa;	                             AND cod_ctb_transferencia.sequencia &#x3d; conta_debito.sequencia&#xd;&#xa;	                             AND cod_ctb_transferencia.cod_lote &#x3d; conta_debito.cod_lote&#xd;&#xa;	                             AND cod_ctb_transferencia.tipo &#x3d; conta_debito.tipo&#xd;&#xa;	                             AND cod_ctb_transferencia.cod_plano_debito &#x3d; conta_debito.cod_plano&#xd;&#xa;	                           WHERE conta_debito.exercicio &#x3d;  stExercicio                                                                       &#xd;&#xa;	                             AND conta_debito.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                &#xd;&#xa;	                             AND plano_conta.cod_estrutural like  &#x27;1.1.1.1.1.01&#x25;&#x27;&#xd;&#xa;	                        GROUP BY tipo_registro&#xd;&#xa;	                               , plano_recurso.cod_recurso&#xd;&#xa;	                               , conta_debito.tipo&#xd;&#xa;	                               , tipo_movimentacao&#xd;&#xa;	                               , tipo_entr_saida&#xd;&#xa;	                               , descr_movimentacao&#xd;&#xa;	                               , plano_conta.cod_estrutural&#xd;&#xa;	                               , cod_orgao&#xd;&#xa;	                               , plano_analitica.exercicio&#xd;&#xa;	                               , cod_ctb_transf&#xd;&#xa;	                               , cod_fonte_ctb_transf&#xd;&#xa;	                               , lote.tipo&#xd;&#xa;	              UNION&#xd;&#xa;	                          SELECT &#x27;12&#x27;&#x3a;&#x3a;int  AS  tipo_registro&#xd;&#xa;	                                , plano_recurso.cod_recurso&#x3a;&#x3a;VARCHAR AS cod_fonte_caixa&#xd;&#xa;	                                , conta_credito.tipo&#xd;&#xa;	                                , CASE WHEN conta_credito.tipo_valor &#x3d; &#x27;D&#x27; THEN&#xd;&#xa;	                                         1&#x3a;&#x3a;integer&#xd;&#xa;	                                         WHEN conta_credito.tipo_valor &#x3d; &#x27;C&#x27; THEN&#xd;&#xa;	                                         2&#x3a;&#x3a;integer&#xd;&#xa;	                                  END AS tipo_movimentacao&#xd;&#xa;	                                , CASE WHEN lote.tipo &#x3d; &#x27;A&#x27; AND lancamento_receita.estorno &#x21;&#x3d; &#x27;t&#x27; THEN &#x27;01&#x27;&#xd;&#xa;	                               WHEN lote.tipo &#x3d;&#x27;T&#x27; AND transferencia.cod_tipo &#x3d;5 AND conta_credito.tipo_valor &#x3d; &#x27;D&#x27; THEN &#x27;03&#x27;&#xd;&#xa;	                               WHEN lote.tipo &#x3d;&#x27;T&#x27; AND transferencia.cod_tipo &#x3d;5 AND conta_credito.tipo_valor &#x3d; &#x27;C&#x27; THEN &#x27;04&#x27;&#xd;&#xa;	                                       WHEN lote.tipo &#x3d;&#x27;P&#x27; AND conta_credito.tipo_valor &#x3d; &#x27;C&#x27;   THEN &#x27;06&#x27;&#xd;&#xa;	                                       WHEN lancamento_empenho.estorno &#x3d; true&#xd;&#xa;	                                         OR &#x28;conta_credito.cod_lote &#x3d; transferencia_estornada.cod_lote_estorno&#x29;&#xd;&#xa;	                                         OR &#x28;lancamento_receita.estorno &#x3d; &#x27;t&#x27;&#x29; THEN &#x27;08&#x27;&#xd;&#xa;	                                       WHEN lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 2 AND conta_credito.tipo_valor &#x3d; &#x27;D&#x27; THEN &#x27;10&#x27;&#xd;&#xa;	                                       WHEN lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 1 AND conta_credito.tipo_valor &#x3d; &#x27;C&#x27; THEN &#x27;10&#x27;&#xd;&#xa;	                                  END AS tipo_entr_saida&#xd;&#xa;	                                , CASE WHEN &#x28;lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 2 AND conta_credito.tipo_valor &#x3d; &#x27;D&#x27;&#x29; THEN &#x27;OUTROS&#x27;&#xd;&#xa;	                                       WHEN &#x28;lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 1 AND conta_credito.tipo_valor &#x3d; &#x27;C&#x27;&#x29; THEN &#x27;OUTROS&#x27;&#xd;&#xa;	                                  END AS descr_movimentacao&#xd;&#xa;	                                , COALESCE&#x28;SUM&#x28;valor_lancamento.vl_lancamento&#x29;,0.00&#x29; &#x2a; -1 as valor_entr_saida&#xd;&#xa;	                                , replace&#x28;plano_conta.cod_estrutural,&#x27;.&#x27;,&#x27;&#x27;&#x29; AS cod_estrutural&#xd;&#xa;	                                , conta_credito.cod_entidade AS cod_orgao&#xd;&#xa;	                                , plano_analitica.exercicio&#xd;&#xa;	                                , CASE WHEN &#x28;lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 5&#x29; OR &#x28;lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 3&#x29; OR &#x28;lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 4&#x29; THEN&#xd;&#xa;	                                            cod_ctb_transferencia.cod_ctb_anterior&#x3a;&#x3a;VARCHAR&#xd;&#xa;	                                      ELSE &#x27; &#x27;&#xd;&#xa;	                                  END AS cod_ctb_transf&#xd;&#xa;	                                , CASE WHEN &#x28;lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 5&#x29; OR &#x28;lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 3&#x29; OR &#x28;lote.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 4&#x29; THEN&#xd;&#xa;	                                    &#x28;   SELECT plano_recurso.cod_recurso&#xd;&#xa;	                                          FROM contabilidade.plano_conta&#xd;&#xa;	                                    INNER JOIN contabilidade.plano_analitica&#xd;&#xa;	                                            ON plano_conta.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;	                                           AND plano_conta.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;	                                    INNER JOIN contabilidade.plano_recurso&#xd;&#xa;	                                            ON plano_recurso.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;	                                           AND plano_recurso.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;	                                         WHERE plano_analitica.cod_plano &#x3d; transferencia.cod_plano_credito&#xd;&#xa;	                                           AND plano_analitica.exercicio &#x3d; transferencia.exercicio&#xd;&#xa;	                                    &#x29; END&#x3a;&#x3a;VARCHAR AS cod_fonte_ctb_transf&#xd;&#xa;	                            FROM contabilidade.conta_credito&#xd;&#xa;	                      INNER JOIN contabilidade.valor_lancamento&#xd;&#xa;	                              ON valor_lancamento.cod_lote &#x3d; conta_credito.cod_lote&#xd;&#xa;	                             AND valor_lancamento.tipo &#x3d; conta_credito.tipo&#xd;&#xa;	                             AND valor_lancamento.sequencia &#x3d; conta_credito.sequencia&#xd;&#xa;	                             AND valor_lancamento.exercicio &#x3d; conta_credito.exercicio&#xd;&#xa;	                             AND valor_lancamento.tipo_valor &#x3d; conta_credito.tipo_valor&#xd;&#xa;	                             AND valor_lancamento.cod_entidade &#x3d; conta_credito.cod_entidade&#xd;&#xa;	                      INNER JOIN contabilidade.lancamento&#xd;&#xa;	                              ON lancamento.sequencia &#x3d; valor_lancamento.sequencia&#xd;&#xa;	                             AND lancamento.cod_lote &#x3d; valor_lancamento.cod_lote&#xd;&#xa;	                             AND lancamento.tipo &#x3d; valor_lancamento.tipo&#xd;&#xa;	                             AND lancamento.exercicio &#x3d; valor_lancamento.exercicio&#xd;&#xa;	                             AND lancamento.cod_entidade &#x3d; valor_lancamento.cod_entidade&#xd;&#xa;	                      INNER JOIN contabilidade.lote&#xd;&#xa;	                              ON lote.cod_lote &#x3d; lancamento.cod_lote&#xd;&#xa;	                             AND lote.exercicio &#x3d; lancamento.exercicio&#xd;&#xa;	                             AND lote.tipo &#x3d; lancamento.tipo&#xd;&#xa;	                             AND lote.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;	                             AND lote.dt_lote BETWEEN TO_DATE &#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                  &#xd;&#xa;	                             AND lote.exercicio &#x3d; stExercicio                                                                              &#xd;&#xa;	                             AND lote.tipo &#x21;&#x3d; &#x27;I&#x27;&#xd;&#xa;	                             AND lote.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                      &#xd;&#xa;	                       LEFT JOIN contabilidade.lancamento_empenho&#xd;&#xa;	                              ON lancamento_empenho.exercicio    &#x3d; lancamento.exercicio&#xd;&#xa;	                             AND lancamento_empenho.tipo         &#x3d; lancamento.tipo&#xd;&#xa;	                             AND lancamento_empenho.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;	                             AND lancamento_empenho.cod_lote     &#x3d; lancamento.cod_lote&#xd;&#xa;	                             AND lancamento_empenho.sequencia    &#x3d; lancamento.sequencia&#xd;&#xa;	                      INNER JOIN contabilidade.plano_analitica&#xd;&#xa;	                              ON plano_analitica.cod_plano &#x3d; conta_credito.cod_plano&#xd;&#xa;	                             AND plano_analitica.exercicio &#x3d; conta_credito.exercicio&#xd;&#xa;	                      INNER JOIN contabilidade.plano_conta&#xd;&#xa;	                              ON plano_conta.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;	                             AND plano_conta.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;	                      INNER JOIN contabilidade.plano_banco&#xd;&#xa;	                              ON plano_banco.cod_plano &#x3d; conta_credito.cod_plano&#xd;&#xa;	                             AND plano_banco.exercicio &#x3d; conta_credito.exercicio&#xd;&#xa;	                             AND plano_banco.cod_entidade IN  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;               &#xd;&#xa;	                      INNER JOIN contabilidade.plano_recurso&#xd;&#xa;	                              ON plano_analitica.cod_plano &#x3d; plano_recurso.cod_plano&#xd;&#xa;	                             AND plano_analitica.exercicio &#x3d; plano_recurso.exercicio&#xd;&#xa;	                       LEFT JOIN tesouraria.transferencia&#xd;&#xa;	                              ON transferencia.exercicio &#x3d; lote.exercicio&#xd;&#xa;	                             AND transferencia.cod_entidade &#x3d; lote.cod_entidade&#xd;&#xa;	                             AND transferencia.tipo &#x3d; lote.tipo&#xd;&#xa;	                             AND transferencia.cod_lote &#x3d; lote.cod_lote&#xd;&#xa;	                       LEFT JOIN tesouraria.transferencia_estornada&#xd;&#xa;	                              ON transferencia_estornada.exercicio &#x3d; lote.exercicio&#xd;&#xa;	                             AND transferencia_estornada.cod_entidade &#x3d; lote.cod_entidade&#xd;&#xa;	                             AND transferencia_estornada.tipo &#x3d; lote.tipo&#xd;&#xa;	                             AND transferencia_estornada.cod_lote_estorno &#x3d; lote.cod_lote&#xd;&#xa;	                       LEFT JOIN contabilidade.lancamento_receita&#xd;&#xa;	                              ON lancamento_receita.exercicio &#x3d; lancamento.exercicio&#xd;&#xa;	                             AND lancamento_receita.sequencia&#x3d; lancamento.sequencia&#xd;&#xa;	                             AND lancamento_receita.cod_lote &#x3d; lancamento.cod_lote&#xd;&#xa;	                             AND lancamento_receita.tipo &#x3d; lancamento.tipo&#xd;&#xa;	                             AND lancamento_receita.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;	                       LEFT JOIN &#x28; SELECT conta_credito.cod_lote&#xd;&#xa;	                                        , conta_credito.tipo&#xd;&#xa;	                                        , conta_credito.exercicio&#xd;&#xa;	                                        , conta_credito.cod_entidade&#xd;&#xa;	                                        , CASE WHEN &#x28;conta_bancaria.cod_ctb_anterior is null&#x29; THEN transferencia.cod_plano_debito&#xd;&#xa;	                                                                Else conta_bancaria.cod_ctb_anterior&#xd;&#xa;	                                                                END AS cod_ctb_anterior&#xd;&#xa;	                                        , transferencia.cod_plano_credito&#xd;&#xa;	                                        , transferencia.cod_plano_debito&#xd;&#xa;	                                        , conta_credito.sequencia&#xd;&#xa;	                                     FROM contabilidade.conta_credito&#xd;&#xa;	                               INNER JOIN contabilidade.lote AS lo&#xd;&#xa;	                                       ON conta_credito.cod_lote     &#x3d; lo.cod_lote&#xd;&#xa;	                                      AND conta_credito.tipo         &#x3d; lo.tipo&#xd;&#xa;	                                      AND conta_credito.exercicio    &#x3d; lo.exercicio&#xd;&#xa;	                                      AND conta_credito.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;	                               INNER JOIN tesouraria.transferencia&#xd;&#xa;	                                       ON transferencia.cod_plano_credito &#x3d; conta_credito.cod_plano&#xd;&#xa;	                                      AND lo.cod_lote &#x3d; transferencia.cod_lote&#xd;&#xa;	                                      AND transferencia.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;	                                      AND transferencia.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;	                                      AND transferencia.exercicio &#x3d; conta_credito.exercicio&#xd;&#xa;	                               INNER JOIN contabilidade.plano_analitica&#xd;&#xa;	                                       ON plano_analitica.cod_plano &#x3d; transferencia.cod_plano_debito&#xd;&#xa;	                                      AND plano_analitica.natureza_saldo &#x3d; &#x27;D&#x27;&#xd;&#xa;	                                      AND plano_analitica.exercicio &#x3d; conta_credito.exercicio&#xd;&#xa;	                                LEFT JOIN tcemg.conta_bancaria&#xd;&#xa;	                                       ON conta_bancaria.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;	                                      AND conta_bancaria.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;	                                   WHERE conta_credito.exercicio &#x3d; stExercicio                                                                  &#xd;&#xa;	                                     AND conta_credito.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;          &#xd;&#xa;	                                     AND lo.dt_lote BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                  &#xd;&#xa;	                                     AND conta_credito.tipo         &#x3d; &#x27;T&#x27;&#xd;&#xa;	                                &#x29; AS cod_ctb_transferencia&#xd;&#xa;	                              ON cod_ctb_transferencia.exercicio &#x3d; conta_credito.exercicio&#xd;&#xa;	                             AND cod_ctb_transferencia.sequencia &#x3d; conta_credito.sequencia&#xd;&#xa;	                             AND cod_ctb_transferencia.cod_lote  &#x3d; conta_credito.cod_lote&#xd;&#xa;	                             AND cod_ctb_transferencia.tipo &#x3d; conta_credito.tipo&#xd;&#xa;	                             AND cod_ctb_transferencia.cod_plano_credito &#x3d; conta_credito.cod_plano&#xd;&#xa;	                           WHERE conta_credito.exercicio &#x3d; stExercicio                                                            &#xd;&#xa;	                             AND conta_credito.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;	                             AND plano_conta.cod_estrutural like  &#x27;1.1.1.1.1.01&#x25;&#x27;&#xd;&#xa;	                        GROUP BY tipo_registro&#xd;&#xa;	                               , plano_recurso.cod_recurso&#xd;&#xa;	                               , conta_credito.tipo&#xd;&#xa;	                               , tipo_movimentacao&#xd;&#xa;	                               , tipo_entr_saida&#xd;&#xa;	                               , descr_movimentacao&#xd;&#xa;	                               , plano_conta.cod_estrutural&#xd;&#xa;	                               , cod_orgao&#xd;&#xa;	                               , plano_analitica.exercicio&#xd;&#xa;	                               , cod_ctb_transf&#xd;&#xa;	                               , cod_fonte_ctb_transf&#xd;&#xa;	                               , lote.tipo&#xd;&#xa;	                    &#x29; as tabela&#xd;&#xa;	            GROUP BY tipo_registro&#xd;&#xa;	                   , cod_fonte_caixa&#xd;&#xa;	                   , tipo_movimentacao&#xd;&#xa;	                   , tipo_entr_saida&#xd;&#xa;	                   , descr_movimentacao&#xd;&#xa;	                   , cod_estrutural&#xd;&#xa;	                   , cod_orgao&#xd;&#xa;	                   , exercicio&#xd;&#xa;	                   , cod_ctb_transf&#xd;&#xa;	                   , cod_fonte_ctb_transf&#xd;&#xa;			&#x29;,&#xd;&#xa;  		      caixa13 as &#xd;&#xa;			&#x28;&#xd;&#xa;	              SELECT c.tipo_registro&#xd;&#xa;	                   , exercicio&#x7c;&#x7c;tipo_movimentacao&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;tipo_entr_saida as cod_reduzido&#xd;&#xa;	                   , c.e_deducao_de_receita&#xd;&#xa;	                   , c.identificador_deducao&#xd;&#xa;	                   , c.natureza_receita&#xd;&#xa;	                   , c.cod_orgao&#xd;&#xa;	                   , ABS&#x28;c.vlr_receita_cont&#x29; AS vlr_receita_cont&#xd;&#xa;	                   , c.cod_estrutural&#xd;&#xa;	                FROM &#x28; SELECT &#x27;13&#x27;&#x3a;&#x3a;int  AS  tipo_registro&#xd;&#xa;	                            , CASE WHEN &#x28;substr&#x28;conta_receita.cod_estrutural,1,1&#x29; &#x3d; &#x27;9&#x27;&#x29; THEN &#x27;1&#x27;&#x3a;&#x3a;INTEGER&#xd;&#xa;	                                   ELSE &#x27;2&#x27;&#x3a;&#x3a;INTEGER&#xd;&#xa;	                              END AS e_deducao_de_receita&#xd;&#xa;	                            , CASE WHEN receita_indentificadores_peculiar_receita.cod_identificador&#x3a;&#x3a;TEXT is null THEN &#x27; &#x27;&#xd;&#xa;	                                   ELSE  receita_indentificadores_peculiar_receita.cod_identificador&#x3a;&#x3a;TEXT&#xd;&#xa;	                               END AS identificador_deducao&#xd;&#xa;	                            , SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29; AS natureza_receita&#xd;&#xa;	                            , SUM&#x28;vl.vl_lancamento&#x29; as vlr_receita_cont&#xd;&#xa;	                            , plano_banco.cod_entidade as cod_orgao&#xd;&#xa;	                            , REPLACE&#x28;pc.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29; as cod_estrutural&#xd;&#xa;	                            , lo.tipo&#xd;&#xa;	                            , CASE WHEN conta_debito.tipo_valor &#x3d; &#x27;D&#x27; THEN 1&#x3a;&#x3a;integer&#xd;&#xa;	                                   WHEN conta_debito.tipo_valor &#x3d; &#x27;C&#x27; THEN 2&#x3a;&#x3a;integer&#xd;&#xa;	                               END AS tipo_movimentacao&#xd;&#xa;	                            , CASE WHEN lo.tipo &#x3d; &#x27;A&#x27; THEN &#x27;01&#x27;&#xd;&#xa;	                              END AS tipo_entr_saida&#xd;&#xa;	     			    , pa.exercicio&#xd;&#xa;	                         FROM contabilidade.plano_conta AS pc&#xd;&#xa;	                   INNER JOIN contabilidade.plano_analitica AS pa&#xd;&#xa;	                           ON pc.cod_conta &#x3d; pa.cod_conta&#xd;&#xa;	                          AND pc.exercicio &#x3d; pa.exercicio&#xd;&#xa;	                   INNER JOIN contabilidade.plano_banco&#xd;&#xa;	                           ON plano_banco.cod_plano &#x3d; pa.cod_plano&#xd;&#xa;	                          AND plano_banco.exercicio &#x3d; pa.exercicio&#xd;&#xa;	                   INNER JOIN monetario.agencia&#xd;&#xa;	                           ON agencia.cod_banco   &#x3d; plano_banco.cod_banco&#xd;&#xa;	                          AND agencia.cod_agencia &#x3d; plano_banco.cod_agencia&#xd;&#xa;	                   INNER JOIN monetario.banco&#xd;&#xa;	                           ON banco.cod_banco &#x3d; plano_banco.cod_banco&#xd;&#xa;	                    LEFT JOIN tcemg.conta_bancaria&#xd;&#xa;			           ON conta_bancaria.cod_conta &#x3d; pc.cod_conta&#xd;&#xa;		                  AND conta_bancaria.exercicio &#x3d; pc.exercicio&#xd;&#xa;	                   INNER JOIN contabilidade.conta_debito&#xd;&#xa;	                           ON pa.cod_plano &#x3d; conta_debito.cod_plano&#xd;&#xa;	                          AND pa.exercicio &#x3d; conta_debito.exercicio&#xd;&#xa;	                   INNER JOIN contabilidade.valor_lancamento AS vl&#xd;&#xa;	                           ON conta_debito.cod_lote     &#x3d; vl.cod_lote&#xd;&#xa;	                          AND conta_debito.tipo         &#x3d; vl.tipo&#xd;&#xa;	                          AND conta_debito.sequencia    &#x3d; vl.sequencia&#xd;&#xa;	                          AND conta_debito.exercicio    &#x3d; vl.exercicio&#xd;&#xa;	                          AND conta_debito.tipo_valor   &#x3d; vl.tipo_valor&#xd;&#xa;	                          AND conta_debito.cod_entidade &#x3d; vl.cod_entidade&#xd;&#xa;	                   INNER JOIN contabilidade.lancamento&#xd;&#xa;	                           ON lancamento.exercicio    &#x3d; vl.exercicio&#xd;&#xa;	                          AND lancamento.cod_entidade &#x3d; vl.cod_entidade&#xd;&#xa;	                          AND lancamento.tipo         &#x3d; vl.tipo&#xd;&#xa;	                          AND lancamento.cod_lote     &#x3d; vl.cod_lote&#xd;&#xa;	                          AND lancamento.sequencia    &#x3d; vl.sequencia&#xd;&#xa;	                    LEFT JOIN contabilidade.lancamento_receita&#xd;&#xa;	                           ON lancamento_receita.exercicio    &#x3d; lancamento.exercicio&#xd;&#xa;	                          AND lancamento_receita.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;	                          AND lancamento_receita.tipo         &#x3d; lancamento.tipo&#xd;&#xa;	                          AND lancamento_receita.cod_lote     &#x3d; lancamento.cod_lote&#xd;&#xa;	                          AND lancamento_receita.sequencia    &#x3d; lancamento.sequencia&#xd;&#xa;	                   INNER JOIN contabilidade.lote AS lo&#xd;&#xa;	                           ON vl.cod_lote     &#x3d; lo.cod_lote&#xd;&#xa;	                          AND vl.tipo         &#x3d; lo.tipo&#xd;&#xa;	                          AND vl.exercicio    &#x3d; lo.exercicio&#xd;&#xa;	                          AND vl.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;	                          AND lo.tipo &#x3d; &#x27;A&#x27;&#xd;&#xa;	                    LEFT JOIN orcamento.receita&#xd;&#xa;	                           ON receita.cod_receita &#x3d; lancamento_receita.cod_receita&#xd;&#xa;	                          AND receita.exercicio   &#x3d; lancamento_receita.exercicio&#xd;&#xa;	                    LEFT JOIN contabilidade.plano_recurso&#xd;&#xa;	                           ON pa.cod_plano &#x3d; plano_recurso.cod_plano&#xd;&#xa;	                          AND pa.exercicio &#x3d; plano_recurso.exercicio&#xd;&#xa;	                    LEFT JOIN orcamento.recurso&#xd;&#xa;	                           ON recurso.exercicio   &#x3d; plano_recurso.exercicio&#xd;&#xa;	                          AND recurso.cod_recurso &#x3d; plano_recurso.cod_recurso&#xd;&#xa;	                    LEFT JOIN contabilidade.lancamento_empenho&#xd;&#xa;	                           ON lancamento_empenho.exercicio    &#x3d; lancamento.exercicio&#xd;&#xa;	                          AND lancamento_empenho.tipo         &#x3d; lancamento.tipo&#xd;&#xa;	                          AND lancamento_empenho.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;	                          AND lancamento_empenho.cod_lote     &#x3d; lancamento.cod_lote&#xd;&#xa;	                          AND lancamento_empenho.sequencia    &#x3d; lancamento.sequencia&#xd;&#xa;	                    LEFT JOIN orcamento.conta_receita&#xd;&#xa;	                           ON conta_receita.exercicio &#x3d; receita.exercicio&#xd;&#xa;	                          AND conta_receita.cod_conta &#x3d; receita.cod_conta&#xd;&#xa;	                    LEFT JOIN tcemg.receita_indentificadores_peculiar_receita&#xd;&#xa;	                           ON receita_indentificadores_peculiar_receita.exercicio   &#x3d; receita.exercicio&#xd;&#xa;	                          AND receita_indentificadores_peculiar_receita.cod_receita &#x3d; receita.cod_conta&#xd;&#xa;	                        WHERE pc.exercicio &#x3d; stExercicio                                                                            &#xd;&#xa;	                          AND plano_banco.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;           &#xd;&#xa;	                          AND lo.dt_lote BETWEEN TO_DATE &#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                &#xd;&#xa;	                          AND pc.cod_estrutural like  &#x27;1.1.1.1.1.01&#x25;&#x27;&#xd;&#xa;	                     GROUP BY 2,3,4,6,7,8,9,11&#xd;&#xa;	                    &#x29; AS c&#xd;&#xa;	             GROUP BY c.tipo_registro&#xd;&#xa;	                    , c.cod_estrutural&#xd;&#xa;			    , c.e_deducao_de_receita&#xd;&#xa;			    , c.identificador_deducao&#xd;&#xa;			    , c.natureza_receita&#xd;&#xa;			    , c.cod_orgao&#xd;&#xa;			    , c.tipo&#xd;&#xa;			    , c.vlr_receita_cont&#xd;&#xa;			    , tipo_movimentacao&#xd;&#xa;			    , tipo_entr_saida&#xd;&#xa;			    , exercicio&#xd;&#xa;	             ORDER BY cod_reduzido&#xd;&#xa;			&#x29;,&#xd;&#xa;			  caixa_format as&#xd;&#xa;			&#x28;&#xd;&#xa;					select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							&#x27;0&#x27; as cod_estrutural,   &#xd;&#xa;							cod_orgao&#x3a;&#x3a;int,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;substring&#x28;cod_orgao&#x3a;&#x3a;varchar, 3,2&#x29;, &#x27; &#x27;&#x29;, 2, &#x27;0&#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_saldo_inicial&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_saldo_final&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from caixa10&#xd;&#xa;				union all   &#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_estrutural, &#xd;&#xa;							9 as  cod_orgao,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_fonte_caixa&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_saldo_inicial_fonte&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_saldo_final_fonte&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from caixa11&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        cod_estrutural,&#xd;&#xa;					        cod_orgao,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;trim&#x28;cod_reduzido&#x3a;&#x3a;varchar&#x29;, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_fonte_caixa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;,3,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_movimentacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipo_entr_saida&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,2,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;descr_movimentacao,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;valor_entr_saida&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;cod_ctb_transf&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_fonte_ctb_transf&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 3,&#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from caixa12&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        cod_estrutural,&#xd;&#xa;					        cod_orgao,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_reduzido&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;e_deducao_de_receita&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;identificador_deducao, &#x27; &#x27;&#x29;, 2,  &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;natureza_receita&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,8,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vlr_receita_cont&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from caixa13&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;CAIXA.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from caixa_format order by cod_estrutural,tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;    if strpos&#x28;stArquivos,&#x27;&#x22;AOC.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then					&#xd;&#xa;			with aoc10 as&#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT&#xd;&#xa;	                            tipo_registro&#xd;&#xa;	                            ,tabela.cod_entidade AS codorgao&#xd;&#xa;	                            ,tabela.num_norma AS nrodecreto&#xd;&#xa;	                            ,tabela.data AS datadecreto&#xd;&#xa;	                        FROM &#x28;&#xd;&#xa;	                           SELECT&#xd;&#xa;	                                &#x27;10&#x27;&#x3a;&#x3a;text AS tipo_registro&#xd;&#xa;	                                ,CASE WHEN EXTRACT&#x28;MONTH FROM suplementacao.dt_suplementacao&#x29; &#x3c;&#x3e; EXTRACT&#x28;MONTH FROM norma.dt_assinatura&#x29; THEN&#xd;&#xa;	                                            TO_CHAR&#x28;suplementacao.dt_suplementacao,&#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                                      ELSE	TO_CHAR&#x28;norma.dt_assinatura,&#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                                 END AS data&#xd;&#xa;	                                ,norma.nom_norma&#x7c;&#x7c;&#x27; &#x27;&#x7c;&#x7c;norma.num_norma&#x7c;&#x7c;&#x27;&#x2f;&#x27;&#x7c;&#x7c;norma.exercicio   as fundamentacao&#xd;&#xa;	                                ,REPLACE&#x28;norma.num_norma,&#x27;.&#x27;,&#x27;&#x27;&#x29;AS num_norma&#xd;&#xa;	                                ,tipo_transferencia.nom_tipo as tipo_suplementacao&#xd;&#xa;	                                ,tipo_transferencia.cod_tipo&#xd;&#xa;	                                ,suplementacao_suplementada.valor&#xd;&#xa;	                                ,despesa.cod_entidade&#xd;&#xa;	                                ,CASE&#xd;&#xa;	                                   WHEN suplementacao_anulada.cod_suplementacao IS NOT NULL THEN &#x27;anulada&#x27;&#xd;&#xa;	                                   ELSE &#x27;valida&#x27;&#xd;&#xa;	                                END as situacao&#xd;&#xa;	                            FROM orcamento.suplementacao&#xd;&#xa;	                        LEFT JOIN orcamento.suplementacao_anulada&#xd;&#xa;	                              ON suplementacao.exercicio          &#x3d; suplementacao_anulada.exercicio&#xd;&#xa;	                             AND suplementacao.cod_suplementacao  &#x3d; suplementacao_anulada.cod_suplementacao&#xd;&#xa;	                        JOIN contabilidade.tipo_transferencia&#xd;&#xa;	                               ON tipo_transferencia.cod_tipo  &#x3d; suplementacao.cod_tipo&#xd;&#xa;	                              AND tipo_transferencia.exercicio &#x3d; suplementacao.exercicio&#xd;&#xa;	                        JOIN orcamento.suplementacao_suplementada&#xd;&#xa;	                              ON suplementacao.cod_suplementacao  &#x3d; suplementacao_suplementada.cod_suplementacao&#xd;&#xa;	                             AND suplementacao.exercicio          &#x3d; suplementacao_suplementada.exercicio&#xd;&#xa;	                        JOIN orcamento.despesa&#xd;&#xa;	                              ON suplementacao_suplementada.cod_despesa &#x3d; despesa.cod_despesa&#xd;&#xa;	                             AND suplementacao_suplementada.exercicio   &#x3d; despesa.exercicio&#xd;&#xa;	                        JOIN contabilidade.transferencia_despesa&#xd;&#xa;	                              ON transferencia_despesa.cod_tipo          &#x3d; suplementacao.cod_tipo&#xd;&#xa;	                             AND transferencia_despesa.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;	                             AND transferencia_despesa.exercicio         &#x3d; suplementacao.exercicio&#xd;&#xa;	                             AND transferencia_despesa.cod_tipo          &#x3c;&#x3e; 16&#xd;&#xa;	                        JOIN normas.norma&#xd;&#xa;	                             ON suplementacao.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;	                        LEFT JOIN tcemg.norma_detalhe&#xd;&#xa;	                                ON norma_detalhe.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;	                        WHERE suplementacao.exercicio          &#x3d;  stExercicio                                                          &#xd;&#xa;	                        AND suplementacao.dt_suplementacao &#x3e;&#x3d; to_date&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                         &#xd;&#xa;	                        AND suplementacao.dt_suplementacao &#x3c;&#x3d; to_date&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                            &#xd;&#xa;	                        AND transferencia_despesa.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;      &#xd;&#xa;	                    &#x29; AS tabela&#xd;&#xa;	                    WHERE&#xd;&#xa;	                        tabela.situacao &#x3d; &#x27;valida&#x27;&#xd;&#xa;	                    GROUP BY&#xd;&#xa;	                        tipo_registro,&#xd;&#xa;	                        codorgao,&#xd;&#xa;	                        nrodecreto,&#xd;&#xa;	                        datadecreto&#xd;&#xa;	                    ORDER BY&#xd;&#xa;	                        tabela.num_norma&#xd;&#xa;			&#x29;, &#xd;&#xa;			  aoc11 as &#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT&#xd;&#xa;	                        &#x27;11&#x27; AS tipo_registro,&#xd;&#xa;	                        LPAD&#x28;tabela.num_norma&#x7c;&#x7c;tabela.cod_tipo, 8,&#x27;0&#x27; &#x29; as codreduzidodecreto,&#xd;&#xa;	                        tabela.num_norma AS nrodecreto,&#xd;&#xa;	                        CASE WHEN tabela.tipo_lei_alteracao_orcamentaria &#x3d; 5 THEN &#x27;11&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 1 THEN &#x27;01&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 2 THEN &#x27;01&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 3 THEN &#x27;01&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 4 THEN &#x27;01&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 5 THEN &#x27;01&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 6 THEN &#x27;02&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 7 THEN &#x27;02&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 8 THEN &#x27;02&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 9 THEN &#x27;02&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 10 THEN &#x27;02&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 11 THEN &#x27;04&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 12 THEN &#x27;10&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 13 THEN &#x27;08&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 14 THEN &#x27;09&#x27;&#xd;&#xa;	                        END AS tipodecretoalteracao,&#xd;&#xa;	                        SUM&#x28;coalesce&#x28;tabela.valor, 0.00&#x29;&#x29; AS valoraberto&#xd;&#xa;	                   FROM &#x28;&#xd;&#xa;	                       SELECT&#xd;&#xa;	                            CASE WHEN EXTRACT&#x28;MONTH FROM suplementacao.dt_suplementacao&#x29; &#x3c;&#x3e; EXTRACT&#x28;MONTH FROM norma.dt_assinatura&#x29; THEN&#xd;&#xa;	                                        TO_CHAR&#x28;suplementacao.dt_suplementacao,&#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                                 ELSE	TO_CHAR&#x28;norma.dt_assinatura,&#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                            END AS data,&#xd;&#xa;	                            REPLACE&#x28;norma.num_norma,&#x27;.&#x27;,&#x27;&#x27;&#x29;AS num_norma,&#xd;&#xa;	                            tipo_transferencia.nom_tipo as tipo_suplementacao,&#xd;&#xa;	                            norma_detalhe.tipo_lei_alteracao_orcamentaria,&#xd;&#xa;	                            suplementacao.cod_tipo,&#xd;&#xa;	                            suplementacao_suplementada.valor,&#xd;&#xa;	                            despesa.cod_entidade,&#xd;&#xa;	                            suplementacao.cod_suplementacao,&#xd;&#xa;	                            suplementacao.exercicio,&#xd;&#xa;	                            CASE WHEN suplementacao_anulada.cod_suplementacao IS NOT NULL&#xd;&#xa;	                                THEN &#x27;anulada&#x27;&#xd;&#xa;	                                ELSE &#x27;valida&#x27;&#xd;&#xa;	                            END as situacao&#xd;&#xa;	                        FROM orcamento.suplementacao&#xd;&#xa;	                   LEFT JOIN orcamento.suplementacao_anulada&#xd;&#xa;	                          ON suplementacao.exercicio          &#x3d; suplementacao_anulada.exercicio&#xd;&#xa;	                         AND suplementacao.cod_suplementacao  &#x3d; suplementacao_anulada.cod_suplementacao&#xd;&#xa;	                   INNER JOIN contabilidade.tipo_transferencia&#xd;&#xa;	                           ON tipo_transferencia.cod_tipo  &#x3d; suplementacao.cod_tipo&#xd;&#xa;	                          AND tipo_transferencia.exercicio &#x3d; suplementacao.exercicio&#xd;&#xa;	                  INNER JOIN orcamento.suplementacao_suplementada&#xd;&#xa;	                          ON suplementacao.cod_suplementacao  &#x3d; suplementacao_suplementada.cod_suplementacao&#xd;&#xa;	                         AND suplementacao.exercicio          &#x3d; suplementacao_suplementada.exercicio&#xd;&#xa;	                  INNER JOIN orcamento.despesa&#xd;&#xa;	                          ON suplementacao_suplementada.cod_despesa &#x3d; despesa.cod_despesa&#xd;&#xa;	                         AND suplementacao_suplementada.exercicio   &#x3d; despesa.exercicio&#xd;&#xa;	                  INNER JOIN contabilidade.transferencia_despesa&#xd;&#xa;	                         ON transferencia_despesa.cod_tipo          &#x3d; suplementacao.cod_tipo&#xd;&#xa;	                        AND transferencia_despesa.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;	                        AND transferencia_despesa.exercicio         &#x3d; suplementacao.exercicio&#xd;&#xa;	                        AND transferencia_despesa.cod_tipo          &#x3c;&#x3e; 16&#xd;&#xa;	                  INNER JOIN normas.norma&#xd;&#xa;	                         ON suplementacao.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;	                   LEFT JOIN tcemg.norma_detalhe&#xd;&#xa;	                         ON norma_detalhe.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;	                       WHERE suplementacao.exercicio         &#x3d; stExercicio                                                            &#xd;&#xa;	                         AND suplementacao.dt_suplementacao &#x3e;&#x3d; to_date&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                       &#xd;&#xa;	                         AND suplementacao.dt_suplementacao &#x3c;&#x3d; to_date&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                          &#xd;&#xa; 	                         AND transferencia_despesa.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;	                    &#x29; AS tabela&#xd;&#xa;	                   WHERE&#xd;&#xa;	                       tabela.situacao &#x3d; &#x27;valida&#x27;&#xd;&#xa;	                    GROUP BY&#xd;&#xa;	                        tipo_registro,&#xd;&#xa;	                        codreduzidodecreto,&#xd;&#xa;	                        nrodecreto,&#xd;&#xa;	                        tipodecretoalteracao&#xd;&#xa;	                    ORDER BY&#xd;&#xa;	                        tabela.num_norma&#xd;&#xa;			&#x29;,&#xd;&#xa;			  aoc12 as &#xd;&#xa;			&#x28;&#xd;&#xa;							SELECT&#xd;&#xa;	                            &#x27;12&#x27; AS tipo_registro&#xd;&#xa;	                            ,LPAD&#x28;tabela.num_norma&#x7c;&#x7c;tabela.cod_tipo, 8,&#x27;0&#x27; &#x29; as codreduzidodecreto&#xd;&#xa;	                            ,&#x28; SELECT DISTINCT atributo_norma_valor.valor&#xd;&#xa;	                                            FROM normas.atributo_norma_valor&#xd;&#xa;	                                      INNER JOIN normas.atributo_tipo_norma&#xd;&#xa;	                                              ON atributo_tipo_norma.cod_tipo_norma &#x3d; atributo_norma_valor.cod_tipo_norma&#xd;&#xa;	                                             AND atributo_tipo_norma.cod_modulo     &#x3d; atributo_norma_valor.cod_modulo&#xd;&#xa;	                                             AND atributo_tipo_norma.cod_cadastro   &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;	                                             AND atributo_tipo_norma.cod_atributo   &#x3d; atributo_norma_valor.cod_atributo&#xd;&#xa;	                                      INNER JOIN administracao.atributo_dinamico&#xd;&#xa;	                                              ON atributo_dinamico.cod_modulo     &#x3d; atributo_tipo_norma.cod_modulo&#xd;&#xa;	                                             AND atributo_dinamico.cod_cadastro   &#x3d; atributo_tipo_norma.cod_cadastro&#xd;&#xa;	                                             AND atributo_dinamico.cod_atributo   &#x3d; atributo_tipo_norma.cod_atributo&#xd;&#xa;	                                           WHERE atributo_tipo_norma.ativo &#x3d; TRUE&#xd;&#xa;	                                             AND atributo_dinamico.cod_atributo &#x3d; 103&#xd;&#xa;	                                             AND atributo_norma_valor.cod_norma &#x3d; tabela.cod_norma&#xd;&#xa;	                                             AND atributo_norma_valor.timestamp &#x3d; &#x28; SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;	                                                                                      FROM normas.atributo_norma_valor AS anv&#xd;&#xa;	                                                                                     WHERE cod_norma &#x3d; atributo_norma_valor.cod_norma&#xd;&#xa;	                                                                                       AND cod_cadastro &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;	                                                                                       AND cod_modulo &#x3d;  atributo_norma_valor.cod_modulo&#xd;&#xa;	                                                                                       AND cod_atributo &#x3d;  atributo_norma_valor.cod_atributo&#xd;&#xa;	                                                                                       AND atributo_dinamico.cod_atributo &#x3d; 103 &#x29;&#xd;&#xa;	                            &#x29; AS nroleialteracao&#xd;&#xa;	                            ,REPLACE&#x28;&#x28;SELECT valor FROM normas.atributo_norma_valor WHERE cod_norma &#x3d; tabela.cod_norma AND cod_atributo &#x3d; 104 ORDER BY timestamp DESC LIMIT 1&#x29;, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29; AS dataleialteracao&#xd;&#xa;	                            , SUBSTR&#x28;descricao,0,4&#x29; as tpleiorigdecreto&#xd;&#xa;	                            , tipo_lei_alteracao_orcamentaria as tipoleialteracao&#xd;&#xa;	                            , SUM&#x28;valor&#x29; as valorabertolei&#xd;&#xa;	                        FROM &#x28;&#xd;&#xa;	                           SELECT&#xd;&#xa;	                                CASE WHEN EXTRACT&#x28;MONTH FROM suplementacao.dt_suplementacao&#x29; &#x3c;&#x3e; EXTRACT&#x28;MONTH FROM norma.dt_assinatura&#x29; THEN&#xd;&#xa;	                                            TO_CHAR&#x28;suplementacao.dt_suplementacao,&#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                                     ELSE	TO_CHAR&#x28;norma.dt_assinatura,&#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                                 END AS data&#xd;&#xa;	                                ,REPLACE&#x28;norma.num_norma,&#x27;.&#x27;,&#x27;&#x27;&#x29;AS num_norma&#xd;&#xa;	                                ,norma.cod_norma&#xd;&#xa;	                                ,tipo_transferencia.nom_tipo as tipo_suplementacao&#xd;&#xa;	                                ,tipo_transferencia.cod_tipo&#xd;&#xa;	                                ,suplementacao_suplementada.valor&#xd;&#xa;	                                ,despesa.cod_entidade&#xd;&#xa;	                                ,suplementacao.cod_suplementacao&#xd;&#xa;	                                ,suplementacao.exercicio&#xd;&#xa;	                                ,CASE&#xd;&#xa;	                                   WHEN suplementacao_anulada.cod_suplementacao IS NOT NULL THEN &#x27;anulada&#x27;&#xd;&#xa;	                                   ELSE &#x27;valida&#x27;&#xd;&#xa;	                                END as situacao&#xd;&#xa;	                                ,tipo_lei_origem_decreto.descricao&#xd;&#xa;	                                ,norma_detalhe.tipo_lei_alteracao_orcamentaria&#xd;&#xa;	                            FROM orcamento.suplementacao&#xd;&#xa;	                        LEFT JOIN orcamento.suplementacao_anulada&#xd;&#xa;	                              ON suplementacao.exercicio          &#x3d; suplementacao_anulada.exercicio&#xd;&#xa;	                             AND suplementacao.cod_suplementacao  &#x3d; suplementacao_anulada.cod_suplementacao&#xd;&#xa;	                        JOIN contabilidade.tipo_transferencia&#xd;&#xa;	                               ON tipo_transferencia.cod_tipo  &#x3d; suplementacao.cod_tipo&#xd;&#xa;	                              AND tipo_transferencia.exercicio &#x3d; suplementacao.exercicio&#xd;&#xa;	                        JOIN orcamento.suplementacao_suplementada&#xd;&#xa;	                              ON suplementacao.cod_suplementacao  &#x3d; suplementacao_suplementada.cod_suplementacao&#xd;&#xa;	                             AND suplementacao.exercicio          &#x3d; suplementacao_suplementada.exercicio&#xd;&#xa;	                        JOIN orcamento.despesa&#xd;&#xa;	                              ON suplementacao_suplementada.cod_despesa &#x3d; despesa.cod_despesa&#xd;&#xa;	                             AND suplementacao_suplementada.exercicio   &#x3d; despesa.exercicio&#xd;&#xa;	                        JOIN contabilidade.transferencia_despesa&#xd;&#xa;	                             ON transferencia_despesa.cod_tipo          &#x3d; suplementacao.cod_tipo&#xd;&#xa;	                            AND transferencia_despesa.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;	                            AND transferencia_despesa.exercicio         &#x3d; suplementacao.exercicio&#xd;&#xa;	                            AND transferencia_despesa.cod_tipo          &#x3c;&#x3e; 16&#xd;&#xa;	                        JOIN normas.norma&#xd;&#xa;	                             ON suplementacao.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;	                        JOIN tcemg.norma_detalhe&#xd;&#xa;	                            ON norma_detalhe.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;	                   LEFT JOIN tcemg.tipo_lei_origem_decreto&#xd;&#xa;	                          ON  tipo_lei_origem_decreto.cod_tipo_lei &#x3d; norma_detalhe.tipo_lei_origem_decreto&#xd;&#xa;	                        WHERE suplementacao.exercicio          &#x3d; stExercicio                                                                    &#xd;&#xa;	                        AND suplementacao.dt_suplementacao &#x3e;&#x3d; to_date&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                                  &#xd;&#xa;	                        AND suplementacao.dt_suplementacao &#x3c;&#x3d; to_date&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                                     &#xd;&#xa;	                        AND transferencia_despesa.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;               &#xd;&#xa;	                    &#x29; AS tabela&#xd;&#xa;	                    WHERE&#xd;&#xa;	                        tabela.situacao &#x3d; &#x27;valida&#x27;&#xd;&#xa;	                    GROUP BY&#xd;&#xa;	                        tabela.num_norma&#xd;&#xa;	                        ,nroleialteracao&#xd;&#xa;	                        ,dataleialteracao&#xd;&#xa;	                        ,codreduzidodecreto&#xd;&#xa;	                        ,descricao&#xd;&#xa;	                        ,tipo_lei_alteracao_orcamentaria&#xd;&#xa;	                    ORDER BY&#xd;&#xa;	                        tabela.num_norma&#xd;&#xa;			&#x29;,&#xd;&#xa;  		      aoc13 as &#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT&#xd;&#xa;	                        &#x27;13&#x27; AS tipo_registro,&#xd;&#xa;	                        LPAD&#x28;tabela.num_norma&#x7c;&#x7c;tabela.cod_tipo, 8,&#x27;0&#x27; &#x29; as codreduzidodecreto,&#xd;&#xa;	                        CASE WHEN tabela.cod_tipo &#x3d; 1 THEN &#x27;03&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 2 THEN &#x27;04&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 4 THEN &#x27;02&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 5 THEN &#x27;01&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 6 THEN &#x27;03&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 7 THEN &#x27;04&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 9 THEN &#x27;02&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 10 THEN &#x27;01&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 11 THEN &#x27;98&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 12 THEN &#x27;98&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 13 THEN &#x27;98&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 14 THEN &#x27;98&#x27;&#xd;&#xa;	                             WHEN tabela.cod_tipo &#x3d; 15 THEN &#x27;98&#x27;&#xd;&#xa;	                        END AS origemrecalteracao,&#xd;&#xa;	                        SUM&#x28;coalesce&#x28;tabela.valor,0.00&#x29;&#x29; AS valorabertoorigem&#xd;&#xa;	                   FROM &#x28;&#xd;&#xa;	                       SELECT&#xd;&#xa;	                            CASE WHEN EXTRACT&#x28;MONTH FROM suplementacao.dt_suplementacao&#x29; &#x3c;&#x3e; EXTRACT&#x28;MONTH FROM norma.dt_assinatura&#x29; THEN&#xd;&#xa;	                                        TO_CHAR&#x28;suplementacao.dt_suplementacao,&#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                                 ELSE	TO_CHAR&#x28;norma.dt_assinatura,&#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                            END AS data,&#xd;&#xa;	                            REPLACE&#x28;norma.num_norma,&#x27;.&#x27;,&#x27;&#x27;&#x29;AS num_norma,&#xd;&#xa;	                            norma.cod_norma,&#xd;&#xa;	                            tipo_transferencia.nom_tipo as tipo_suplementacao,&#xd;&#xa;	                            suplementacao.cod_tipo,&#xd;&#xa;	                            suplementacao_suplementada.valor,&#xd;&#xa;	                            despesa.cod_entidade,&#xd;&#xa;	                            suplementacao.cod_suplementacao,&#xd;&#xa;	                            suplementacao.exercicio,&#xd;&#xa;	                            CASE&#xd;&#xa;	                               WHEN suplementacao_anulada.cod_suplementacao IS NOT NULL THEN &#x27;anulada&#x27;&#xd;&#xa;	                               ELSE &#x27;valida&#x27;&#xd;&#xa;	                            END as situacao&#xd;&#xa;	                        FROM orcamento.suplementacao&#xd;&#xa;	                   LEFT JOIN orcamento.suplementacao_anulada&#xd;&#xa;	                          ON suplementacao.exercicio          &#x3d; suplementacao_anulada.exercicio&#xd;&#xa;	                         AND suplementacao.cod_suplementacao  &#x3d; suplementacao_anulada.cod_suplementacao&#xd;&#xa;	                   INNER JOIN contabilidade.tipo_transferencia&#xd;&#xa;	                           ON tipo_transferencia.cod_tipo  &#x3d; suplementacao.cod_tipo&#xd;&#xa;	                          AND tipo_transferencia.exercicio &#x3d; suplementacao.exercicio&#xd;&#xa;	                  INNER JOIN orcamento.suplementacao_suplementada&#xd;&#xa;	                          ON suplementacao.cod_suplementacao  &#x3d; suplementacao_suplementada.cod_suplementacao&#xd;&#xa;	                         AND suplementacao.exercicio          &#x3d; suplementacao_suplementada.exercicio&#xd;&#xa;	                  INNER JOIN orcamento.despesa&#xd;&#xa;	                          ON suplementacao_suplementada.cod_despesa &#x3d; despesa.cod_despesa&#xd;&#xa;	                         AND suplementacao_suplementada.exercicio   &#x3d; despesa.exercicio&#xd;&#xa;	                  INNER JOIN contabilidade.transferencia_despesa&#xd;&#xa;	                         ON transferencia_despesa.cod_tipo          &#x3d; suplementacao.cod_tipo&#xd;&#xa;	                        AND transferencia_despesa.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;	                        AND transferencia_despesa.exercicio         &#x3d; suplementacao.exercicio&#xd;&#xa;	                        AND transferencia_despesa.cod_tipo          &#x3c;&#x3e; 16&#xd;&#xa;	                  INNER JOIN normas.norma&#xd;&#xa;	                         ON suplementacao.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;	                       WHERE suplementacao.exercicio          &#x3d; stExercicio                                                           &#xd;&#xa;	                         AND suplementacao.dt_suplementacao &#x3e;&#x3d; to_date&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                       &#xd;&#xa;	                         AND suplementacao.dt_suplementacao &#x3c;&#x3d; to_date&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                          &#xd;&#xa;	                         AND transferencia_despesa.cod_entidade IN  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;	                    &#x29; AS tabela&#xd;&#xa;	                   WHERE&#xd;&#xa;	                       tabela.situacao &#x3d; &#x27;valida&#x27;&#xd;&#xa;	                    GROUP BY&#xd;&#xa;	                        tabela.num_norma&#xd;&#xa;	                      , origemrecalteracao&#xd;&#xa;	                      , codreduzidodecreto&#xd;&#xa;	                    ORDER BY&#xd;&#xa;	                        tabela.num_norma&#xd;&#xa;			&#x29;, &#xd;&#xa;  		      aoc14 as &#xd;&#xa;			&#x28;&#xd;&#xa;							SELECT&#xd;&#xa;	                            tabela.dt_suplementacao&#xd;&#xa;	                            ,&#x27;14&#x27; AS tipo_registro&#xd;&#xa;	                            ,LPAD&#x28;tabela.num_norma&#x7c;&#x7c;tabela.cod_tipo, 8,&#x27;0&#x27; &#x29; as codreduzidodecreto&#xd;&#xa;	                            , origemrecalteracao as origemrecalteracao&#xd;&#xa;	                            ,LPAD&#x28;&#x28;SELECT valor FROM administracao.configuracao_entidade WHERE exercicio &#x3d; stExercicio AND cod_entidade &#x3d; tabela.cod_entidade AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#x29;, 2, &#x27;0&#x27;&#x29; AS codorgao&#xd;&#xa;	                            ,LPAD&#x28;lpad&#x28;tabela.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;tabela.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS codunidadesub&#xd;&#xa;	                            ,tabela.cod_funcao AS codfuncao&#xd;&#xa;	                            ,tabela.cod_subfuncao AS codsubfuncao&#xd;&#xa;	                            ,tabela.cod_programa AS codprograma&#xd;&#xa;	                            ,tabela.cod_acao AS idacao&#xd;&#xa;	                            ,&#x27;&#x27; AS idsubacao&#xd;&#xa;	                            ,tabela.cod_recurso AS codfontrecurso&#xd;&#xa;	                            , CASE WHEN SUBSTR&#x28;REPLACE&#x28;tabela.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29; &#x3d; &#x27;339009&#x27; OR SUBSTR&#x28;REPLACE&#x28;tabela.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29; &#x3d; &#x27;339005&#x27;&#xd;&#xa;	                                    THEN&#xd;&#xa;	                                        &#x27;319005&#x27;&#xd;&#xa;	                                    ELSE&#xd;&#xa;	                                    CASE WHEN SUBSTR&#x28;REPLACE&#x28;tabela.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29; &#x3d; &#x27;339013&#x27;&#xd;&#xa;	                                        THEN&#xd;&#xa;	                                            &#x27;319013&#x27;&#xd;&#xa;	                                        ELSE&#xd;&#xa;	                                            SUBSTR&#x28;REPLACE&#x28;tabela.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;&#x3a;&#x3a;VARCHAR&#xd;&#xa;	                                    END&#xd;&#xa;	                            END AS naturezadespesa&#xd;&#xa;	                            ,&#x27;1&#x27; AS tipoalteracao&#xd;&#xa;	                            ,SUM&#x28;tabela.vl_suplementada&#x29; AS vlacrescimoreducao&#xd;&#xa;	                   FROM &#x28;&#xd;&#xa;	                       SELECT&#xd;&#xa;	                             CASE WHEN EXTRACT&#x28;MONTH FROM suplementacao.dt_suplementacao&#x29; &#x3c;&#x3e; EXTRACT&#x28;MONTH FROM norma.dt_assinatura&#x29; THEN&#xd;&#xa;	                                        TO_CHAR&#x28;suplementacao.dt_suplementacao,&#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                                  ELSE	TO_CHAR&#x28;norma.dt_assinatura,&#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                             END AS data&#xd;&#xa;	                            ,norma.nom_norma&#x7c;&#x7c;&#x27; &#x27;&#x7c;&#x7c;REPLACE&#x28;norma.num_norma,&#x27;.&#x27;,&#x27;&#x27;&#x29;&#x7c;&#x7c;&#x27;&#x2f;&#x27;&#x7c;&#x7c;norma.exercicio as fundamentacao&#xd;&#xa;	                            ,REPLACE&#x28;norma.num_norma,&#x27;.&#x27;,&#x27;&#x27;&#x29;AS num_norma&#xd;&#xa;	                            ,norma.cod_norma&#xd;&#xa;	                            ,tipo_transferencia.nom_tipo as tipo_suplementacao&#xd;&#xa;	                            ,tipo_transferencia.cod_tipo&#xd;&#xa;	                            ,despesa.cod_entidade&#xd;&#xa;	                            ,suplementacao.cod_suplementacao&#xd;&#xa;	                            ,suplementacao.exercicio&#xd;&#xa;	                            ,suplementacao.dt_suplementacao&#xd;&#xa;	                            ,CASE WHEN suplementacao.cod_tipo &#x3d; 1 THEN &#x27;03&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 2 THEN &#x27;04&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 4 THEN &#x27;02&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 5 THEN &#x27;01&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 6 THEN &#x27;03&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 7 THEN &#x27;04&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 9 THEN &#x27;02&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 10 THEN &#x27;01&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 11 THEN &#x27;98&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 12 THEN &#x27;98&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 13 THEN &#x27;98&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 14 THEN &#x27;98&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 15 THEN &#x27;98&#x27;&#xd;&#xa;	                            END AS origemrecalteracao&#xd;&#xa;	                            ,uniorcam.num_orgao&#xd;&#xa;	                            ,uniorcam.num_unidade&#xd;&#xa;	                            ,funcao.cod_funcao&#xd;&#xa;	                            ,subfuncao.cod_subfuncao&#xd;&#xa;	                            ,ppa.programa.num_programa AS cod_programa&#xd;&#xa;	                            ,ppa.acao.num_acao AS cod_acao&#xd;&#xa;	                            ,recurso.cod_recurso&#xd;&#xa;	                            ,conta_despesa.cod_estrutural&#xd;&#xa;	                            ,suplementacao_suplementada.valor AS vl_suplementada&#xd;&#xa;	                            ,CASE WHEN suplementacao_anulada.cod_suplementacao IS NOT NULL THEN&#xd;&#xa;	                                        &#x27;anulada&#x27;&#xd;&#xa;	                                    ELSE&#xd;&#xa;	                                        &#x27;valida&#x27;&#xd;&#xa;	                             END as situacao&#xd;&#xa;	                        FROM orcamento.suplementacao&#xd;&#xa;	                   LEFT JOIN orcamento.suplementacao_anulada&#xd;&#xa;	                          ON suplementacao.exercicio          &#x3d; suplementacao_anulada.exercicio&#xd;&#xa;	                         AND suplementacao.cod_suplementacao  &#x3d; suplementacao_anulada.cod_suplementacao&#xd;&#xa;	                   INNER JOIN contabilidade.tipo_transferencia&#xd;&#xa;	                           ON tipo_transferencia.cod_tipo  &#x3d; suplementacao.cod_tipo&#xd;&#xa;	                          AND tipo_transferencia.exercicio &#x3d; suplementacao.exercicio&#xd;&#xa;	                  INNER JOIN orcamento.suplementacao_suplementada&#xd;&#xa;	                          ON suplementacao_suplementada.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;	                         AND suplementacao_suplementada.exercicio         &#x3d; suplementacao.exercicio&#xd;&#xa;	                  INNER JOIN orcamento.despesa&#xd;&#xa;	                          ON despesa.cod_despesa &#x3d; suplementacao_suplementada.cod_despesa&#xd;&#xa;	                         AND despesa.exercicio   &#x3d; suplementacao_suplementada.exercicio&#xd;&#xa;	                  INNER JOIN orcamento.conta_despesa&#xd;&#xa;	                          ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;	                         AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;	                  INNER JOIN contabilidade.transferencia_despesa&#xd;&#xa;	                          ON transferencia_despesa.cod_tipo          &#x3d; suplementacao.cod_tipo&#xd;&#xa;	                         AND transferencia_despesa.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;	                         AND transferencia_despesa.exercicio         &#x3d; suplementacao.exercicio&#xd;&#xa;	                         AND transferencia_despesa.cod_tipo  &#x3c;&#x3e; 16&#xd;&#xa;	                  INNER JOIN normas.norma&#xd;&#xa;	                         ON suplementacao.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;	                  INNER JOIN orcamento.unidade&#xd;&#xa;	                          ON unidade.exercicio   &#x3d; despesa.exercicio&#xd;&#xa;	                         AND unidade.num_unidade &#x3d; despesa.num_unidade&#xd;&#xa;	                         AND unidade.num_orgao   &#x3d; despesa.num_orgao&#xd;&#xa;	                  INNER JOIN tcemg.uniorcam&#xd;&#xa;	                          ON uniorcam.num_unidade &#x3d; unidade.num_unidade&#xd;&#xa;	                         AND uniorcam.num_orgao   &#x3d; unidade.num_orgao&#xd;&#xa;	                         AND uniorcam.exercicio   &#x3d; unidade.exercicio&#xd;&#xa;	                  INNER JOIN orcamento.funcao&#xd;&#xa;	                          ON funcao.exercicio  &#x3d; despesa.exercicio&#xd;&#xa;	                         AND funcao.cod_funcao &#x3d; despesa.cod_funcao&#xd;&#xa;	                  INNER JOIN orcamento.subfuncao&#xd;&#xa;	                          ON subfuncao.exercicio     &#x3d; despesa.exercicio&#xd;&#xa;	                         AND subfuncao.cod_subfuncao &#x3d; despesa.cod_subfuncao&#xd;&#xa;	                  INNER JOIN orcamento.programa&#xd;&#xa;	                          ON orcamento.programa.exercicio    &#x3d; despesa.exercicio&#xd;&#xa;	                         AND orcamento.programa.cod_programa &#x3d; despesa.cod_programa&#xd;&#xa;	                  INNER JOIN orcamento.programa_ppa_programa&#xd;&#xa;	                          ON programa_ppa_programa.cod_programa &#x3d; orcamento.programa.cod_programa&#xd;&#xa;	                         AND programa_ppa_programa.exercicio    &#x3d; orcamento.programa.exercicio&#xd;&#xa;	                  INNER JOIN ppa.programa&#xd;&#xa;	                          ON ppa.programa.cod_programa &#x3d; programa_ppa_programa.cod_programa_ppa&#xd;&#xa;	                  INNER JOIN orcamento.pao&#xd;&#xa;	                          ON despesa.num_pao   &#x3d; pao.num_pao&#xd;&#xa;	                         AND despesa.exercicio &#x3d; pao.exercicio&#xd;&#xa;	                 INNER JOIN orcamento.pao_ppa_acao&#xd;&#xa;	                         ON pao_ppa_acao.num_pao   &#x3d; pao.num_pao&#xd;&#xa;	                        AND pao_ppa_acao.exercicio &#x3d; pao.exercicio&#xd;&#xa;	                  INNER JOIN ppa.acao&#xd;&#xa;	                          ON acao.cod_acao &#x3d; pao_ppa_acao.cod_acao&#xd;&#xa;	                  INNER JOIN orcamento.recurso&#xd;&#xa;	                          ON recurso.exercicio   &#x3d; despesa.exercicio&#xd;&#xa;	                         AND recurso.cod_recurso &#x3d; despesa.cod_recurso&#xd;&#xa;	                       WHERE suplementacao.exercicio &#x3d; stExercicio                                                            &#xd;&#xa;	                         AND suplementacao.dt_suplementacao &#x3e;&#x3d; to_date&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                               &#xd;&#xa;	                         AND suplementacao.dt_suplementacao &#x3c;&#x3d; to_date&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                  &#xd;&#xa;	                         AND despesa.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;          &#xd;&#xa;	                    &#x29; AS tabela&#xd;&#xa;	                   WHERE&#xd;&#xa;	                       tabela.situacao &#x3d; &#x27;valida&#x27;&#xd;&#xa;	                    GROUP BY&#xd;&#xa;	                        dt_suplementacao&#xd;&#xa;	                        ,codreduzidodecreto&#xd;&#xa;	                        ,origemrecAlteracao&#xd;&#xa;	                        ,num_norma&#xd;&#xa;	                        ,codorgao&#xd;&#xa;	                        ,codunidadesub&#xd;&#xa;	                        ,codfuncao&#xd;&#xa;	                        ,codsubfuncao&#xd;&#xa;	                        ,codprograma&#xd;&#xa;	                        ,idacao&#xd;&#xa;	                        ,idsubacao&#xd;&#xa;	                        ,codfontrecurso&#xd;&#xa;	                        ,naturezadespesa&#xd;&#xa;	                        ,tipoalteracao&#xd;&#xa;	                        ,situacao&#xd;&#xa;	                  UNION&#xd;&#xa;	                       SELECT&#xd;&#xa;	                        tabela.dt_suplementacao&#xd;&#xa;	                        ,&#x27;14&#x27; AS tipo_registro&#xd;&#xa;	                        ,LPAD&#x28;tabela.num_norma&#x7c;&#x7c;tabela.cod_tipo, 8,&#x27;0&#x27; &#x29; as codreduzidodecreto&#xd;&#xa;	                        , origemrecalteracao as origemrecalteracao&#xd;&#xa;	                        ,LPAD&#x28;&#x28;SELECT valor FROM administracao.configuracao_entidade WHERE exercicio &#x3d; stExercicio AND cod_entidade &#x3d; tabela.cod_entidade AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#x29;, 2, &#x27;0&#x27;&#x29; AS codorgao&#xd;&#xa;	                        ,LPAD&#x28;lpad&#x28;tabela.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;tabela.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS codunidadesub&#xd;&#xa;	                        ,tabela.cod_funcao AS codfuncao&#xd;&#xa;	                        ,tabela.cod_subfuncao AS codsubfuncao&#xd;&#xa;	                        ,tabela.cod_programa AS codprograma&#xd;&#xa;	                        ,tabela.cod_acao AS idacao&#xd;&#xa;	                        ,&#x27;&#x27; AS idsubacao&#xd;&#xa;	                        ,tabela.cod_recurso AS codfontrecurso&#xd;&#xa;	                        , CASE WHEN SUBSTR&#x28;REPLACE&#x28;tabela.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29; &#x3d; &#x27;339009&#x27; OR SUBSTR&#x28;REPLACE&#x28;tabela.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29; &#x3d; &#x27;339005&#x27;&#xd;&#xa;	                                    THEN&#xd;&#xa;	                                        &#x27;319005&#x27;&#xd;&#xa;	                                    ELSE&#xd;&#xa;	                                    CASE WHEN SUBSTR&#x28;REPLACE&#x28;tabela.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29; &#x3d; &#x27;339013&#x27;&#xd;&#xa;	                                        THEN&#xd;&#xa;	                                            &#x27;319013&#x27;&#xd;&#xa;	                                        ELSE&#xd;&#xa;	                                            SUBSTR&#x28;REPLACE&#x28;tabela.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;&#x3a;&#x3a;VARCHAR&#xd;&#xa;	                                    END&#xd;&#xa;	                            END AS naturezadespesa&#xd;&#xa;	                        ,&#x27;2&#x27; AS tipoalteracao&#xd;&#xa;	                        ,SUM&#x28;tabela.vl_reducao&#x29; AS vlacrescimoreducao&#xd;&#xa;&#xd;&#xa;	                   FROM &#x28;&#xd;&#xa;	                       SELECT&#xd;&#xa;	                             CASE WHEN EXTRACT&#x28;MONTH FROM suplementacao.dt_suplementacao&#x29; &#x3c;&#x3e; EXTRACT&#x28;MONTH FROM norma.dt_assinatura&#x29; THEN&#xd;&#xa;	                                        TO_CHAR&#x28;suplementacao.dt_suplementacao,&#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                                  ELSE	TO_CHAR&#x28;norma.dt_assinatura,&#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                             END AS data&#xd;&#xa;	                            ,norma.nom_norma&#x7c;&#x7c;&#x27; &#x27;&#x7c;&#x7c;REPLACE&#x28;norma.num_norma,&#x27;.&#x27;,&#x27;&#x27;&#x29;&#x7c;&#x7c;&#x27;&#x2f;&#x27;&#x7c;&#x7c;norma.exercicio as fundamentacao&#xd;&#xa;	                            ,REPLACE&#x28;norma.num_norma,&#x27;.&#x27;,&#x27;&#x27;&#x29;AS num_norma&#xd;&#xa;	                            ,norma.cod_norma&#xd;&#xa;	                            ,tipo_transferencia.nom_tipo as tipo_suplementacao&#xd;&#xa;	                            ,tipo_transferencia.cod_tipo&#xd;&#xa;	                            ,despesa.cod_entidade&#xd;&#xa;	                            ,suplementacao.cod_suplementacao&#xd;&#xa;	                            ,suplementacao.exercicio&#xd;&#xa;	                            ,suplementacao.dt_suplementacao&#xd;&#xa;	                            ,CASE WHEN suplementacao.cod_tipo &#x3d; 1 THEN &#x27;03&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 2 THEN &#x27;04&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 4 THEN &#x27;02&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 5 THEN &#x27;01&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 6 THEN &#x27;03&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 7 THEN &#x27;04&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 9 THEN &#x27;02&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 10 THEN &#x27;01&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 11 THEN &#x27;98&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 12 THEN &#x27;98&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 13 THEN &#x27;98&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 14 THEN &#x27;98&#x27;&#xd;&#xa;	                               WHEN suplementacao.cod_tipo &#x3d; 15 THEN &#x27;98&#x27;&#xd;&#xa;	                            END AS origemrecalteracao&#xd;&#xa;	                            ,uniorcam.num_orgao&#xd;&#xa;	                            ,uniorcam.num_unidade&#xd;&#xa;	                            ,funcao.cod_funcao&#xd;&#xa;	                            ,subfuncao.cod_subfuncao&#xd;&#xa;	                            ,ppa.programa.num_programa AS cod_programa&#xd;&#xa;	                            ,ppa.acao.num_acao AS cod_acao&#xd;&#xa;	                            ,recurso.cod_recurso&#xd;&#xa;	                            ,conta_despesa.cod_estrutural&#xd;&#xa;	                            ,suplementacao_reducao.valor AS vl_reducao&#xd;&#xa;	                            ,despesa.cod_despesa&#xd;&#xa;	                            ,CASE WHEN suplementacao_anulada.cod_suplementacao IS NOT NULL THEN&#xd;&#xa;	                                        &#x27;anulada&#x27;&#xd;&#xa;	                                    ELSE&#xd;&#xa;	                                        &#x27;valida&#x27;&#xd;&#xa;	                             END as situacao&#xd;&#xa;	                        FROM orcamento.suplementacao&#xd;&#xa;	                   LEFT JOIN orcamento.suplementacao_anulada&#xd;&#xa;	                          ON suplementacao.exercicio          &#x3d; suplementacao_anulada.exercicio&#xd;&#xa;	                         AND suplementacao.cod_suplementacao  &#x3d; suplementacao_anulada.cod_suplementacao&#xd;&#xa;	                   INNER JOIN contabilidade.tipo_transferencia&#xd;&#xa;	                           ON tipo_transferencia.cod_tipo  &#x3d; suplementacao.cod_tipo&#xd;&#xa;	                          AND tipo_transferencia.exercicio &#x3d; suplementacao.exercicio&#xd;&#xa;	                  INNER JOIN orcamento.suplementacao_reducao&#xd;&#xa;	                          ON suplementacao_reducao.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;	                         AND suplementacao_reducao.exercicio         &#x3d; suplementacao.exercicio&#xd;&#xa;	                  INNER JOIN orcamento.despesa&#xd;&#xa;	                          ON despesa.cod_despesa &#x3d; suplementacao_reducao.cod_despesa&#xd;&#xa;	                         AND despesa.exercicio   &#x3d; suplementacao_reducao.exercicio&#xd;&#xa;	                  INNER JOIN orcamento.conta_despesa&#xd;&#xa;	                          ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;	                         AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;	                  INNER JOIN contabilidade.transferencia_despesa&#xd;&#xa;	                          ON transferencia_despesa.cod_tipo          &#x3d; suplementacao.cod_tipo&#xd;&#xa;	                         AND transferencia_despesa.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;	                         AND transferencia_despesa.exercicio         &#x3d; suplementacao.exercicio&#xd;&#xa;	                         AND transferencia_despesa.cod_tipo          &#x3c;&#x3e; 16&#xd;&#xa;	                  INNER JOIN normas.norma&#xd;&#xa;	                         ON suplementacao.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;	                  INNER JOIN orcamento.unidade&#xd;&#xa;	                          ON unidade.exercicio   &#x3d; despesa.exercicio&#xd;&#xa;	                         AND unidade.num_unidade &#x3d; despesa.num_unidade&#xd;&#xa;	                         AND unidade.num_orgao   &#x3d; despesa.num_orgao&#xd;&#xa;	                  INNER JOIN tcemg.uniorcam&#xd;&#xa;	                          ON uniorcam.num_unidade &#x3d; unidade.num_unidade&#xd;&#xa;	                         AND uniorcam.num_orgao   &#x3d; unidade.num_orgao&#xd;&#xa;	                         AND uniorcam.exercicio   &#x3d; unidade.exercicio&#xd;&#xa;	                  INNER JOIN orcamento.funcao&#xd;&#xa;	                          ON funcao.exercicio  &#x3d; despesa.exercicio&#xd;&#xa;	                         AND funcao.cod_funcao &#x3d; despesa.cod_funcao&#xd;&#xa;	                  INNER JOIN orcamento.subfuncao&#xd;&#xa;	                          ON subfuncao.exercicio     &#x3d; despesa.exercicio&#xd;&#xa;	                         AND subfuncao.cod_subfuncao &#x3d; despesa.cod_subfuncao&#xd;&#xa;	                  INNER JOIN orcamento.programa&#xd;&#xa;	                          ON programa.exercicio    &#x3d; despesa.exercicio&#xd;&#xa;	                         AND programa.cod_programa &#x3d; despesa.cod_programa&#xd;&#xa;	                  INNER JOIN orcamento.programa_ppa_programa&#xd;&#xa;	                          ON programa_ppa_programa.exercicio    &#x3d; despesa.exercicio&#xd;&#xa;	                         AND programa_ppa_programa.cod_programa &#x3d; despesa.cod_programa&#xd;&#xa;	                  INNER JOIN ppa.programa&#xd;&#xa;	                         ON ppa.programa.cod_programa &#x3d; programa_ppa_programa.cod_programa_ppa&#xd;&#xa;	                  INNER JOIN orcamento.despesa_acao&#xd;&#xa;	                          ON despesa_acao.exercicio_despesa  &#x3d; despesa.exercicio&#xd;&#xa;	                         AND despesa_acao.cod_despesa        &#x3d; despesa.cod_despesa&#xd;&#xa;	                 INNER JOIN orcamento.pao&#xd;&#xa;	                         ON despesa.num_pao   &#x3d; pao.num_pao&#xd;&#xa;	                        AND despesa.exercicio &#x3d; pao.exercicio&#xd;&#xa;	                 INNER JOIN orcamento.pao_ppa_acao&#xd;&#xa;	                         ON pao_ppa_acao.num_pao   &#x3d; pao.num_pao&#xd;&#xa;	                        AND pao_ppa_acao.exercicio &#x3d; pao.exercicio&#xd;&#xa;	                 INNER JOIN ppa.acao&#xd;&#xa;	                         ON acao.cod_acao &#x3d; pao_ppa_acao.cod_acao&#xd;&#xa;	                  INNER JOIN orcamento.recurso&#xd;&#xa;	                          ON recurso.exercicio   &#x3d; despesa.exercicio&#xd;&#xa;	                         AND recurso.cod_recurso &#x3d; despesa.cod_recurso&#xd;&#xa;	                       WHERE suplementacao.exercicio &#x3d; stExercicio                                                              &#xd;&#xa;	                         AND suplementacao.dt_suplementacao &#x3e;&#x3d; to_date&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                 &#xd;&#xa;	                         AND suplementacao.dt_suplementacao &#x3c;&#x3d; to_date&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                    &#xd;&#xa;	                         AND despesa.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;            &#xd;&#xa;	                    &#x29; AS tabela&#xd;&#xa;	                   WHERE&#xd;&#xa;	                       tabela.situacao &#x3d; &#x27;valida&#x27;&#xd;&#xa;	                    GROUP BY&#xd;&#xa;	                        dt_suplementacao&#xd;&#xa;	                        ,codreduzidodecreto&#xd;&#xa;	                        ,origemrecAlteracao&#xd;&#xa;	                        ,num_norma&#xd;&#xa;	                        ,codorgao&#xd;&#xa;	                        ,codunidadesub&#xd;&#xa;	                        ,codfuncao&#xd;&#xa;	                        ,codsubfuncao&#xd;&#xa;	                        ,codprograma&#xd;&#xa;	                        ,idacao&#xd;&#xa;	                        ,idsubacao&#xd;&#xa;	                        ,codfontrecurso&#xd;&#xa;	                        ,naturezadespesa&#xd;&#xa;	                        ,tipoalteracao&#xd;&#xa;	                        ,situacao&#xd;&#xa;			&#x29;,  &#xd;&#xa;			  aoc_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							nrodecreto&#x3a;&#x3a;bigint as nrodecreto,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; nrodecreto&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;datadecreto&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from aoc10&#xd;&#xa;				union all   &#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							nrodecreto&#x3a;&#x3a;bigint as nrodecreto,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codreduzidodecreto&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nrodecreto, &#x27; &#x27;&#x29;&#x3a;&#x3a;int&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipodecretoalteracao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;valoraberto&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from aoc11&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        &#x28;substring&#x28;codreduzidodecreto,1,7&#x29;&#x3a;&#x3a;bigint&#x29; as nrodecreto,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codreduzidodecreto&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroleialteracao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dataleialteracao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tpleiorigdecreto&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipoleialteracao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,1,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;valorabertolei&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from aoc12  &#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        &#x28;substring&#x28;codreduzidodecreto,1,7&#x29;&#x3a;&#x3a;bigint&#x29; as nrodecreto,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codreduzidodecreto&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;origemrecalteracao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29; ,2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;valorabertoorigem&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from aoc13      &#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        &#x28;substring&#x28;codreduzidodecreto,1,7&#x29;&#x3a;&#x3a;bigint&#x29; as nrodecreto,&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codreduzidodecreto&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;origemrecalteracao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipoalteracao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2,  &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesub&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codfuncao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2,  &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codsubfuncao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 3,  &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codprograma&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4,  &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;idacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4,  &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;idsubacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4,  &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;naturezadespesa&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 6,  &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codfontrecurso&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3,  &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vlacrescimoreducao&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from aoc14       &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;AOC.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from aoc_format order by nrodecreto,tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;    if strpos&#x28;stArquivos,&#x27;&#x22;ALQ.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then					&#xd;&#xa;			with alq10 as&#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT  10 AS tipo_registro&#xd;&#xa;			            ,   tcemg.seq_cod_red_alq&#x28;empenho.exercicio, empenho.cod_entidade,empenho.cod_empenho&#x29; as cod_reduzido&#xd;&#xa;			                    ,   orgao_sicom.valor AS cod_orgao&#xd;&#xa;			                    ,   CASE WHEN pre_empenho.implantado &#x3d; &#x27;t&#x27; THEN&#xd;&#xa;			                             CASE WHEN &#x28; uniorcam.num_orgao_atual IS NOT NULL&#x29;&#xd;&#xa;			                                  THEN LPAD&#x28;LPAD&#x28;uniorcam.num_orgao_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;uniorcam.num_unidade_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;			                                  ELSE LPAD&#x28;restos_pre_empenho.num_unidade&#x3a;&#x3a;VARCHAR,5,&#x27;0&#x27;&#x29;&#xd;&#xa;			                              END&#xd;&#xa;			                             ELSE LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;despesa_empenho.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;despesa_empenho.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;			                         END AS codunidadesub&#xd;&#xa;			                    ,   empenho.cod_empenho AS num_empenho&#xd;&#xa;			                    ,   to_char&#x28;empenho.dt_empenho,&#x27;ddmmyyyy&#x27;&#x29; as dt_empenho&#xd;&#xa;			                    ,   to_char&#x28;nota_liquidacao.dt_liquidacao,&#x27;ddmmyyyy&#x27;&#x29; as dt_liquidacao&#xd;&#xa;			                    ,   TCEMG.numero_nota_liquidacao&#x28;stExercicio,&#xd;&#xa;			                                                                 empenho.cod_entidade,&#xd;&#xa;			                                                                 nota_liquidacao.cod_nota,&#xd;&#xa;			                                                                 nota_liquidacao.exercicio_empenho,&#xd;&#xa;			                                                                 empenho.cod_empenho&#xd;&#xa;			                                                    &#x29; AS num_liquidacao&#xd;&#xa;			                    ,   to_char&#x28;nota_liquidacao_item_anulado.timestamp,&#x27;ddmmyyyy&#x27;&#x29; as dt_anulacao&#xd;&#xa;			                    ,   TCEMG.numero_anulacao_liquidacao&#x28;stExercicio,pre_empenho.exercicio,empenho.cod_entidade,nota_liquidacao.cod_nota,nota_liquidacao_item_anulado.timestamp&#x29;  AS  num_anulacao&#xd;&#xa;			                    ,   CASE WHEN empenho.exercicio &#x3d; &#x27;2015&#x27;&#xd;&#xa;			                                 THEN 1&#xd;&#xa;			                                 ELSE 2&#xd;&#xa;			                           END AS tipo_liquidacao&#xd;&#xa;			                    ,   &#x27;Anulacao Liquidacao&#x27; AS justificativa_anulacao&#xd;&#xa;			                    ,   SUM&#x28;nota_liquidacao_item_anulado.vl_anulado&#x29; as vl_anulado&#xd;&#xa;			                FROM empenho.empenho&#xd;&#xa;			                JOIN empenho.nota_liquidacao&#xd;&#xa;			                  ON nota_liquidacao.exercicio_empenho &#x3d; empenho.exercicio&#xd;&#xa;			                 AND nota_liquidacao.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;			                 AND nota_liquidacao.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;			                JOIN empenho.nota_liquidacao_item_anulado&#xd;&#xa;			                  ON nota_liquidacao_item_anulado.exercicio &#x3d; nota_liquidacao.exercicio&#xd;&#xa;			                 AND nota_liquidacao_item_anulado.cod_entidade &#x3d; nota_liquidacao.cod_entidade&#xd;&#xa;			                 AND nota_liquidacao_item_anulado.cod_nota &#x3d; nota_liquidacao.cod_nota&#xd;&#xa;			           LEFT JOIN empenho.pre_empenho&#xd;&#xa;			                  ON pre_empenho.exercicio &#x3d; empenho.exercicio&#xd;&#xa;			                 AND pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;			           LEFT JOIN empenho.restos_pre_empenho&#xd;&#xa;			                  ON restos_pre_empenho.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;			                 AND restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;			                JOIN &#x28;SELECT valor&#x3a;&#x3a;integer&#xd;&#xa;			                             , configuracao_entidade.exercicio&#xd;&#xa;			                             , configuracao_entidade.cod_entidade&#xd;&#xa;			                          FROM tcemg.orgao&#xd;&#xa;			                    INNER JOIN administracao.configuracao_entidade&#xd;&#xa;			                            ON configuracao_entidade.valor&#x3a;&#x3a;integer &#x3d; orgao.num_orgao&#xd;&#xa;			                         WHERE configuracao_entidade.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;        &#xd;&#xa;			                           AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			                      &#x29;  AS orgao_sicom&#xd;&#xa;			                  ON orgao_sicom.exercicio &#x3d; stExercicio          &#xd;&#xa;			                 AND orgao_sicom.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;			       LEFT JOIN tcemg.uniorcam&#xd;&#xa;			          ON uniorcam.num_unidade &#x3d; restos_pre_empenho.num_unidade&#xd;&#xa;			         AND uniorcam.exercicio &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;			         AND uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;			           LEFT JOIN &#x28;SELECT  pre_empenho_despesa.cod_despesa&#xd;&#xa;			                            , pre_empenho_despesa.cod_pre_empenho&#xd;&#xa;			                            , pre_empenho_despesa.exercicio&#xd;&#xa;			                            , despesa.num_orgao&#xd;&#xa;			                            , despesa.num_unidade&#xd;&#xa;			                        FROM empenho.pre_empenho_despesa&#xd;&#xa;			                        JOIN orcamento.despesa&#xd;&#xa;			                          ON despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;			                         AND despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;			            &#x29; AS despesa_empenho&#xd;&#xa;			          ON  pre_empenho.exercicio &#x3d; despesa_empenho.exercicio&#xd;&#xa;			         AND pre_empenho.cod_pre_empenho &#x3d; despesa_empenho.cod_pre_empenho&#xd;&#xa;			               WHERE TO_DATE&#x28;nota_liquidacao_item_anulado.timestamp&#x3a;&#x3a;varchar, &#x27;yyyy-mm-dd&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;  &#xd;&#xa;			                 AND nota_liquidacao_item_anulado.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;			                 AND nota_liquidacao.exercicio &#x3d; stExercicio         &#xd;&#xa;			            GROUP BY pre_empenho.implantado&#xd;&#xa;			                   , pre_empenho.exercicio&#xd;&#xa;			                   , restos_pre_empenho.num_orgao&#xd;&#xa;			                   , despesa_empenho.num_orgao&#xd;&#xa;			                   , orgao_sicom.valor&#xd;&#xa;			                   , restos_pre_empenho.num_unidade&#xd;&#xa;			                   , despesa_empenho.num_unidade&#xd;&#xa;			                   , empenho.cod_empenho&#xd;&#xa;			                   , empenho.dt_empenho&#xd;&#xa;			                   , nota_liquidacao.dt_liquidacao&#xd;&#xa;			                   , empenho.cod_entidade&#xd;&#xa;			                   , nota_liquidacao.cod_nota&#xd;&#xa;			                   , nota_liquidacao.exercicio_empenho&#xd;&#xa;			                   , nota_liquidacao_item_anulado.timestamp&#xd;&#xa;			                   , empenho.exercicio&#xd;&#xa;			           , codunidadesub&#xd;&#xa;			        ORDER BY num_empenho&#xd;&#xa;			&#x29;, &#xd;&#xa;			  alq11 as &#xd;&#xa;			&#x28;&#xd;&#xa;		             SELECT  11 AS tipo_registro&#xd;&#xa;			            , tcemg.seq_cod_red_alq&#x28;empenho.exercicio, empenho.cod_entidade,empenho.cod_empenho&#x29; as cod_reduzido&#xd;&#xa;			                    , CASE WHEN restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;			                           THEN restos_pre_empenho.recurso&#x3a;&#x3a;VARCHAR&#xd;&#xa;			                           ELSE COALESCE&#x28;recurso.cod_fonte, &#x27;100&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#xd;&#xa;			                       END AS cod_fonte_recurso&#xd;&#xa;			                    , empenho.cod_empenho as num_empenho&#xd;&#xa;			                    , empenho.exercicio, empenho.cod_entidade,empenho.cod_empenho&#xd;&#xa;			                    , SUM&#x28;nota_liquidacao_item_anulado.vl_anulado&#x29; as vl_anulado_fonte&#xd;&#xa;			                    , TCEMG.numero_anulacao_liquidacao&#x28;stExercicio,pre_empenho.exercicio,empenho.cod_entidade,nota_liquidacao.cod_nota,nota_liquidacao_item_anulado.timestamp&#x29;  AS  num_anulacao&#xd;&#xa;			            , TCEMG.numero_nota_liquidacao&#x28;stExercicio,&#xd;&#xa;			                                                                 empenho.cod_entidade,&#xd;&#xa;			                                                                 nota_liquidacao.cod_nota,&#xd;&#xa;			                                                                 nota_liquidacao.exercicio_empenho,&#xd;&#xa;			                                                                 empenho.cod_empenho&#xd;&#xa;			                                                    &#x29; AS num_liquidacao&#xd;&#xa;			                FROM  empenho.empenho&#xd;&#xa;			                JOIN  empenho.nota_liquidacao&#xd;&#xa;			                  ON  nota_liquidacao.exercicio_empenho &#x3d; empenho.exercicio&#xd;&#xa;			                 AND  nota_liquidacao.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;			                 AND  nota_liquidacao.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;			                JOIN  empenho.nota_liquidacao_item_anulado&#xd;&#xa;			                  ON  nota_liquidacao_item_anulado.exercicio &#x3d; nota_liquidacao.exercicio&#xd;&#xa;			                 AND  nota_liquidacao_item_anulado.cod_entidade &#x3d; nota_liquidacao.cod_entidade&#xd;&#xa;			                 AND  nota_liquidacao_item_anulado.cod_nota &#x3d; nota_liquidacao.cod_nota&#xd;&#xa;			                JOIN  empenho.pre_empenho&#xd;&#xa;			                  ON  pre_empenho.exercicio &#x3d; empenho.exercicio&#xd;&#xa;			                 AND  pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;			           LEFT JOIN  empenho.restos_pre_empenho&#xd;&#xa;			                  ON  restos_pre_empenho.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;			                 AND  restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;			           LEFT JOIN &#x28;SELECT  despesa.cod_entidade&#xd;&#xa;			                            , despesa.exercicio&#xd;&#xa;			                            , despesa.cod_recurso&#xd;&#xa;			                            , conta_despesa.cod_estrutural&#xd;&#xa;			                            , pre_empenho_despesa.cod_pre_empenho&#xd;&#xa;			                        FROM empenho.pre_empenho_despesa&#xd;&#xa;			                        JOIN orcamento.despesa&#xd;&#xa;			                          ON despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;			                         AND despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;			                        JOIN orcamento.conta_despesa&#xd;&#xa;			                          ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;			                         AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;			                     &#x29; AS despesa&#xd;&#xa;			                  ON despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;			                 AND despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;			                 AND despesa.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;			                  OR  despesa.cod_pre_empenho &#x3d; restos_pre_empenho.cod_pre_empenho&#xd;&#xa;			           LEFT JOIN  orcamento.recurso&#xd;&#xa;			                  ON  recurso.exercicio &#x3d; despesa.exercicio&#xd;&#xa;			                 AND  recurso.cod_recurso &#x3d; despesa.cod_recurso&#xd;&#xa;			               WHERE  TO_DATE&#x28;nota_liquidacao_item_anulado.timestamp&#x3a;&#x3a;varchar, &#x27;yyyy-mm-dd&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;			                 AND  nota_liquidacao_item_anulado.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;        &#xd;&#xa;			                 AND nota_liquidacao.exercicio &#x3d; stExercicio             &#xd;&#xa;			                GROUP BY 1,2,3,4,5,6,7,num_liquidacao, num_anulacao&#xd;&#xa;			&#x29;,&#xd;&#xa;			  alq12 as &#xd;&#xa;			&#x28;&#xd;&#xa;	                  SELECT 12 AS tipo_registro&#xd;&#xa;	                       , tcemg.seq_cod_red_alq&#x28;empenho.exercicio, empenho.cod_entidade,empenho.cod_empenho&#x29; as cod_reduzido&#xd;&#xa;	                       , SUBSTR&#x28;TO_CHAR&#x28;nota_liquidacao_item_anulado.timestamp,&#x27;ddmmyyyy&#x27;&#x29;,3,2&#x29; AS mes_competencia&#xd;&#xa;	                       , SUBSTR&#x28;TO_CHAR&#x28;nota_liquidacao_item_anulado.timestamp,&#x27;ddmmyyyy&#x27;&#x29;,5,8&#x29; AS exercicio_competencia&#xd;&#xa;	                       , SUM&#x28;nota_liquidacao_item_anulado.vl_anulado&#x29; AS vl_anulado_dsp_exercicio_ant&#xd;&#xa;	                       , empenho.cod_empenho as num_empenho&#xd;&#xa;	                       , TCEMG.numero_nota_liquidacao&#x28;stExercicio, empenho.cod_entidade, nota_liquidacao.cod_nota, nota_liquidacao.exercicio_empenho, empenho.cod_empenho &#x29; AS num_liquidacao&#xd;&#xa;	                       , TCEMG.numero_anulacao_liquidacao&#x28;stExercicio,pre_empenho.exercicio,empenho.cod_entidade,nota_liquidacao.cod_nota,nota_liquidacao_item_anulado.timestamp&#x29;  AS  num_anulacao&#xd;&#xa;	                    FROM empenho.empenho&#xd;&#xa;	              INNER JOIN empenho.nota_liquidacao&#xd;&#xa;	                      ON nota_liquidacao.exercicio_empenho &#x3d; empenho.exercicio&#xd;&#xa;	                     AND nota_liquidacao.cod_entidade      &#x3d; empenho.cod_entidade&#xd;&#xa;	                     AND nota_liquidacao.cod_empenho       &#x3d; empenho.cod_empenho&#xd;&#xa;	              INNER JOIN empenho.nota_liquidacao_item_anulado&#xd;&#xa;	                      ON nota_liquidacao_item_anulado.exercicio &#x3d; nota_liquidacao.exercicio&#xd;&#xa;	                     AND nota_liquidacao_item_anulado.cod_entidade &#x3d; nota_liquidacao.cod_entidade&#xd;&#xa;	                     AND nota_liquidacao_item_anulado.cod_nota &#x3d; nota_liquidacao.cod_nota&#xd;&#xa;	              INNER JOIN empenho.pre_empenho&#xd;&#xa;	                      ON pre_empenho.exercicio &#x3d; empenho.exercicio&#xd;&#xa;	                     AND pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;	               LEFT JOIN &#x28;&#xd;&#xa;	                          SELECT restos_pre_empenho.exercicio&#xd;&#xa;	                               , restos_pre_empenho.cod_pre_empenho&#xd;&#xa;	                               , substring&#x28;restos_pre_empenho.cod_estrutural from 6 for 2&#x29; AS elemento&#xd;&#xa;	                            FROM empenho.restos_pre_empenho&#xd;&#xa;	                           WHERE substring&#x28;restos_pre_empenho.cod_estrutural from 6 for 2&#x29;&#x3a;&#x3a;INTEGER IN &#x28;91,92&#x29;&#xd;&#xa;	                             AND substring&#x28;restos_pre_empenho.cod_estrutural from 2 for 1&#x29;&#x3a;&#x3a;INTEGER IN &#x28;1&#x29;&#xd;&#xa;	                         &#x29; AS restos_pre_empenho&#xd;&#xa;	                      ON restos_pre_empenho.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                     AND restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	               LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;	                      ON pre_empenho_despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                     AND pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	               LEFT JOIN &#x28;&#xd;&#xa;	                          SELECT pre_empenho_despesa.cod_pre_empenho&#xd;&#xa;	                               , pre_empenho_despesa.exercicio&#xd;&#xa;	                               , despesa.cod_entidade&#xd;&#xa;	                               , substring&#x28;conta_despesa.cod_estrutural from 9 for 2&#x29; AS elemento&#xd;&#xa;	                            FROM empenho.pre_empenho_despesa&#xd;&#xa;	                      INNER JOIN orcamento.despesa&#xd;&#xa;	                              ON despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;	                             AND despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;	                      INNER JOIN orcamento.conta_despesa&#xd;&#xa;	                              ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;	                             AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;	                           WHERE substring&#x28;conta_despesa.cod_estrutural from 9 for 2&#x29;&#x3a;&#x3a;INTEGER IN &#x28;91,92&#x29;&#xd;&#xa;	                             AND substring&#x28;conta_despesa.cod_estrutural from 3 for 1&#x29;&#x3a;&#x3a;INTEGER IN &#x28;1&#x29;&#xd;&#xa;	                        &#x29; AS despesa&#xd;&#xa;	                      ON despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                     AND despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                     AND despesa.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;	                   WHERE TO_DATE&#x28;nota_liquidacao_item_anulado.timestamp&#x3a;&#x3a;VARCHAR, &#x27;yyyy-mm-dd&#x27;&#x29; BETWEEN TO_DATE&#x28;&#x27;01&#x2f;02&#x2f;2015&#x27;,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; and TO_DATE&#x28;&#x27;28&#x2f;02&#x2f;2015&#x27;,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;	                     AND nota_liquidacao_item_anulado.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;	                     AND &#x28; despesa.elemento IS NOT NULL OR restos_pre_empenho.elemento IS NOT NULL &#x29;&#xd;&#xa;	                     AND nota_liquidacao.exercicio &#x3d; stExercicio          &#xd;&#xa;	                GROUP BY tipo_registro&#xd;&#xa;	                       , cod_reduzido&#xd;&#xa;	                       , mes_competencia&#xd;&#xa;	                       , exercicio_competencia&#xd;&#xa;	                       , num_empenho&#xd;&#xa;	                       , num_liquidacao&#xd;&#xa;	                       , num_anulacao&#xd;&#xa;			&#x29;,&#xd;&#xa;			  alq_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_reduzido,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_reduzido&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_empenho&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_empenho&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_liquidacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_liquidacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_anulacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_anulacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipo_liquidacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 1, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;justificativa_anulacao&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,500&#x29;,&#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_anulado&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;      &#xd;&#xa;					as d&#xd;&#xa;				from alq10&#xd;&#xa;				union all   &#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_reduzido,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_reduzido&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_fonte_recurso&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_anulado_fonte&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from alq11&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        cod_reduzido,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_reduzido&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;mes_competencia&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_competencia&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_anulado_dsp_exercicio_ant&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from alq12   &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;ALQ.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from alq_format order by cod_reduzido,tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;	&#xd;&#xa;&#xd;&#xa;    if strpos&#x28;stArquivos,&#x27;&#x22;CVC.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with cvc10 as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT registro10.tipo_registro,	registro10.cod_orgao,	registro10.num_orgao,&#xd;&#xa;						registro10.num_unidade,			registro10.exercicio,	registro10.cod_unidade_sub,&#xd;&#xa;						registro10.cod_veiculo,			registro10.tipo_veiculo, registro10.subtipo_veiculo,&#xd;&#xa;						registro10.descricao,			registro10.marca,		registro10.modelo,&#xd;&#xa;						registro10.ano_fabricacao,		registro10.placa,		registro10.chassi,&#xd;&#xa;						registro10.numero_renavam,		registro10.numero_serie,registro10.situacao_veiculo,&#xd;&#xa;						registro10.tipo_documento,		registro10.nro_documento, registro10.tipo_deslocamento,&#xd;&#xa;						arquivo_cvc.mes&#xd;&#xa;			              FROM &#x28;&#xd;&#xa;			                          SELECT 10 AS tipo_registro&#xd;&#xa;			                               , LPAD&#x28;configuracao_entidade.valor,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;			                               , CASE WHEN descricao_veiculo.num_orgao IS NOT NULL AND descricao_veiculo.num_unidade IS NOT NULL&#xd;&#xa;			                                      THEN descricao_veiculo.num_orgao&#xd;&#xa;			                                      WHEN descricao_veiculo_locado.cod_orgao IS NOT NULL AND descricao_veiculo_locado.cod_unidade IS NOT NULL&#xd;&#xa;			                                      THEN descricao_veiculo_locado.cod_orgao&#xd;&#xa;			                                      WHEN descricao_veiculo_cessao.cod_orgao IS NOT NULL AND descricao_veiculo_cessao.cod_unidade IS NOT NULL&#xd;&#xa;			                                      THEN descricao_veiculo_cessao.cod_orgao&#xd;&#xa;			                                      ELSE 0&#xd;&#xa;			                                  END AS num_orgao&#xd;&#xa;			                               , CASE WHEN descricao_veiculo.num_orgao IS NOT NULL AND descricao_veiculo.num_unidade IS NOT NULL&#xd;&#xa;			                                      THEN descricao_veiculo.num_unidade&#xd;&#xa;			                                      WHEN descricao_veiculo_locado.cod_orgao IS NOT NULL AND descricao_veiculo_locado.cod_unidade IS NOT NULL&#xd;&#xa;			                                      THEN descricao_veiculo_locado.cod_unidade&#xd;&#xa;			                                      WHEN descricao_veiculo_cessao.cod_orgao IS NOT NULL AND descricao_veiculo_cessao.cod_unidade IS NOT NULL&#xd;&#xa;			                                      THEN descricao_veiculo_cessao.cod_unidade&#xd;&#xa;			                                      ELSE 0&#xd;&#xa;			                                  END AS num_unidade&#xd;&#xa;			                               , CASE WHEN descricao_veiculo.num_orgao IS NOT NULL AND descricao_veiculo.num_unidade IS NOT NULL&#xd;&#xa;			                                      THEN descricao_veiculo.exercicio&#xd;&#xa;			                                      WHEN descricao_veiculo_locado.cod_orgao IS NOT NULL AND descricao_veiculo_locado.cod_unidade IS NOT NULL&#xd;&#xa;			                                      THEN descricao_veiculo_locado.exercicio_locacao&#xd;&#xa;			                                      WHEN descricao_veiculo_cessao.cod_orgao IS NOT NULL AND descricao_veiculo_cessao.cod_unidade IS NOT NULL&#xd;&#xa;			                                      THEN descricao_veiculo_cessao.exercicio_cessao&#xd;&#xa;			                                      ELSE &#x27;0&#x27;&#xd;&#xa;			                                  END AS exercicio&#xd;&#xa;			                               , CASE WHEN &#x28;descricao_veiculo.num_orgao IS NOT NULL AND descricao_veiculo.num_unidade IS NOT NULL&#x29;&#xd;&#xa;			                                      THEN LPAD&#x28;LPAD&#x28;descricao_veiculo.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;descricao_veiculo.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;			                                      WHEN descricao_veiculo_locado.cod_orgao IS NOT NULL AND descricao_veiculo_locado.cod_unidade IS NOT NULL&#xd;&#xa;			                                      THEN LPAD&#x28;LPAD&#x28;descricao_veiculo_locado.cod_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;descricao_veiculo_locado.cod_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;			                                      WHEN descricao_veiculo_cessao.cod_orgao IS NOT NULL AND descricao_veiculo_cessao.cod_unidade IS NOT NULL&#xd;&#xa;			                                      THEN LPAD&#x28;LPAD&#x28;descricao_veiculo_cessao.cod_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;descricao_veiculo_cessao.cod_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;			                                      ELSE LPAD&#x28;&#x27;0&#x27;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;			                                  END AS cod_unidade_sub&#xd;&#xa;			                               , veiculo.cod_veiculo&#xd;&#xa;			                               , tipo_veiculo_vinculo.cod_tipo_tce AS tipo_veiculo&#xd;&#xa;			                               , tipo_veiculo_vinculo.cod_subtipo_tce AS subtipo_veiculo&#xd;&#xa;			                               , CASE WHEN veiculo_propriedade.proprio IS TRUE&#xd;&#xa;			                                      THEN descricao_veiculo.descricao&#xd;&#xa;			                                      ELSE modelo.nom_modelo &#x7c;&#x7c; &#x27; &#x27; &#x7c;&#x7c; veiculo.ano_fabricacao &#x7c;&#x7c; &#x27; &#x7c; COR &#x3a; &#x27; &#x7c;&#x7c; veiculo.cor &#x7c;&#x7c; &#x27; &#x7c; PLACA &#x3a; &#x27; &#x7c;&#x7c; veiculo.placa&#xd;&#xa;			                                  END AS descricao&#xd;&#xa;			                               , marca.nom_marca AS marca&#xd;&#xa;			                               , modelo.nom_modelo AS modelo&#xd;&#xa;			                               , veiculo.ano_fabricacao&#xd;&#xa;			                               , CASE WHEN tipo_veiculo_vinculo.cod_tipo_tce &#x3d; 3&#xd;&#xa;			                                      THEN SUBSTR&#x28;veiculo.placa, 1, 3&#x29; &#x7c;&#x7c; &#x27; &#x27; &#x7c;&#x7c; SUBSTR&#x28;veiculo.placa, 4, 4&#x29;&#xd;&#xa;			                                      ELSE &#x27;&#x27;&#x3a;&#x3a;VARCHAR&#xd;&#xa;			                                  END AS placa&#xd;&#xa;			                               , CASE WHEN tipo_veiculo_vinculo.cod_tipo_tce &#x3d; 3&#xd;&#xa;			                                      THEN veiculo.chassi&#xd;&#xa;			                                      ELSE &#x27;&#x27;&#x3a;&#x3a;VARCHAR&#xd;&#xa;			                                  END AS chassi&#xd;&#xa;			                               , CASE WHEN tipo_veiculo_vinculo.cod_tipo_tce &#x3d; 3&#xd;&#xa;			                                      THEN veiculo.num_certificado&#xd;&#xa;			                                      ELSE &#x27;&#x27;&#x3a;&#x3a;VARCHAR&#xd;&#xa;			                                  END AS numero_renavam&#xd;&#xa;			                               , &#x27;&#x27; AS numero_serie&#xd;&#xa;			                               , CASE WHEN descricao_veiculo_locado.cod_veiculo IS NOT NULL&#xd;&#xa;			                                      THEN descricao_veiculo_locado.situacao_veiculo&#xd;&#xa;			                                      WHEN descricao_veiculo_cessao.cod_veiculo IS NOT NULL&#xd;&#xa;			                                      THEN descricao_veiculo_cessao.situacao_veiculo&#xd;&#xa;			                                      WHEN descricao_veiculo.cod_veiculo IS NOT NULL&#xd;&#xa;			                                      THEN descricao_veiculo.situacao_veiculo&#xd;&#xa;			                                      ELSE &#x27;0&#x27;&#xd;&#xa;			                                  END AS situacao_veiculo&#xd;&#xa;			                               , CASE WHEN descricao_veiculo.cod_veiculo IS NOT NULL&#xd;&#xa;			                                      THEN &#x27; &#x27;&#xd;&#xa;			                                      ELSE &#x27;2&#x27;&#xd;&#xa;			                                  END AS tipo_documento&#xd;&#xa;			                               , CASE WHEN descricao_veiculo_locado.cod_veiculo IS NOT NULL&#xd;&#xa;			                                      THEN descricao_veiculo_locado.cnpj&#xd;&#xa;			                                      WHEN descricao_veiculo_cessao.cod_veiculo IS NOT NULL&#xd;&#xa;			                                      THEN descricao_veiculo_cessao.cnpj&#xd;&#xa;			                                      ELSE &#x27; &#x27;&#xd;&#xa;			                                  END AS nro_documento&#xd;&#xa;			                               , 01 AS tipo_deslocamento&#xd;&#xa;			                            FROM frota.veiculo&#xd;&#xa;			                      INNER JOIN frota.modelo&#xd;&#xa;			                              ON modelo.cod_modelo &#x3d; veiculo.cod_modelo&#xd;&#xa;			                             AND modelo.cod_marca &#x3d; veiculo.cod_marca&#xd;&#xa;			                       LEFT JOIN frota.marca&#xd;&#xa;			                              ON marca.cod_marca &#x3d; modelo.cod_marca&#xd;&#xa;			                      INNER JOIN tcemg.tipo_veiculo_vinculo&#xd;&#xa;			                              ON tipo_veiculo_vinculo.cod_tipo &#x3d; veiculo.cod_tipo_veiculo&#xd;&#xa;			                      INNER JOIN frota.veiculo_propriedade&#xd;&#xa;			                              ON veiculo_propriedade.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;			                             AND veiculo_propriedade.timestamp &#x3d; &#x28; SELECT MAX&#x28;vp.timestamp&#x29;&#xd;&#xa;			                                                                       FROM frota.veiculo_propriedade as vp&#xd;&#xa;			                                                                      WHERE vp.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo &#x29;&#xd;&#xa;			                       LEFT JOIN &#x28; SELECT bem.descricao&#xd;&#xa;			                                        , bem.cod_bem&#xd;&#xa;			                                        , bem_comprado.num_orgao&#xd;&#xa;			                                        , bem_comprado.num_unidade&#xd;&#xa;			                                        , bem_comprado.exercicio&#xd;&#xa;			                                        , veiculo_propriedade.cod_veiculo&#xd;&#xa;			                                        , MAX&#x28;veiculo_propriedade.timestamp&#x29; AS timestamp&#xd;&#xa;			                                        , bem_comprado.cod_entidade&#xd;&#xa;			                                        , bem.dt_aquisicao&#xd;&#xa;			                                        , &#x27;01&#x27;&#x3a;&#x3a;VARCHAR AS situacao_veiculo&#xd;&#xa;			                                     FROM frota.veiculo&#xd;&#xa;			                               INNER JOIN frota.veiculo_propriedade&#xd;&#xa;			                                       ON veiculo_propriedade.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;			                                      AND veiculo_propriedade.proprio &#x3d; true&#xd;&#xa;			                               INNER JOIN frota.proprio&#xd;&#xa;			                                       ON proprio.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;			                                      AND proprio.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;			                               INNER JOIN patrimonio.bem&#xd;&#xa;			                                       ON bem.cod_bem &#x3d; proprio.cod_bem&#xd;&#xa;			                               INNER JOIN patrimonio.bem_comprado&#xd;&#xa;			                                       ON bem_comprado.cod_bem &#x3d; bem.cod_bem&#xd;&#xa;			                                 GROUP BY bem.descricao&#xd;&#xa;			                                        , veiculo_propriedade.cod_veiculo&#xd;&#xa;			                                        , bem.cod_bem&#xd;&#xa;			                                        , bem_comprado.cod_entidade&#xd;&#xa;			                                        , bem_comprado.num_orgao&#xd;&#xa;			                                        , bem_comprado.num_unidade&#xd;&#xa;			                                        , bem_comprado.exercicio&#xd;&#xa;			                                        , veiculo.dt_aquisicao&#xd;&#xa;			                                         &#x29; AS descricao_veiculo&#xd;&#xa;			                             ON  descricao_veiculo.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;			                            AND descricao_veiculo.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;			                      LEFT JOIN &#x28; SELECT CASE WHEN veiculo_uniorcam.num_orgao IS NOT NULL AND veiculo_uniorcam.num_unidade IS NOT NULL&#xd;&#xa;			                                               THEN veiculo_uniorcam.num_orgao&#xd;&#xa;			                                               ELSE despesa.num_orgao&#xd;&#xa;			                                           END AS cod_orgao&#xd;&#xa;			                                        , CASE WHEN veiculo_uniorcam.num_orgao IS NOT NULL AND veiculo_uniorcam.num_unidade IS NOT NULL&#xd;&#xa;			                                               THEN veiculo_uniorcam.num_unidade&#xd;&#xa;			                                               ELSE despesa.num_unidade&#xd;&#xa;			                                           END AS cod_unidade&#xd;&#xa;			                                        , CASE WHEN veiculo_uniorcam.num_orgao IS NOT NULL AND veiculo_uniorcam.num_unidade IS NOT NULL&#xd;&#xa;			                                               THEN veiculo_uniorcam.exercicio&#xd;&#xa;			                                               ELSE despesa.exercicio&#xd;&#xa;			                                           END AS exercicio_locacao&#xd;&#xa;			                                        , veiculo_propriedade.cod_veiculo&#xd;&#xa;			                                        , MAX&#x28;veiculo_propriedade.timestamp&#x29; AS timestamp&#xd;&#xa;			                                        , veiculo_locacao.cod_entidade&#xd;&#xa;			                                        , veiculo_locacao.dt_inicio&#xd;&#xa;			                                        , veiculo_locacao.dt_termino&#xd;&#xa;			                                        , sw_cgm_pessoa_juridica.cnpj&#xd;&#xa;			                                        , &#x27;02&#x27;&#x3a;&#x3a;VARCHAR AS situacao_veiculo&#xd;&#xa;			                                     FROM frota.veiculo&#xd;&#xa;			                               INNER JOIN frota.veiculo_propriedade&#xd;&#xa;			                                       ON veiculo_propriedade.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;			                                      AND veiculo_propriedade.proprio &#x3d; false&#xd;&#xa;			                               INNER JOIN frota.terceiros&#xd;&#xa;			                                       ON terceiros.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;			                                      AND terceiros.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;			                                LEFT JOIN frota.veiculo_locacao&#xd;&#xa;			                                       ON veiculo_locacao.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;			                                LEFT JOIN patrimonio.veiculo_uniorcam&#xd;&#xa;			                                       ON veiculo.cod_veiculo &#x3d; veiculo_uniorcam.cod_veiculo&#xd;&#xa;			                                LEFT JOIN empenho.empenho&#xd;&#xa;			                                       ON empenho.exercicio    &#x3d; veiculo_locacao.exercicio&#xd;&#xa;			                                      AND empenho.cod_entidade &#x3d; veiculo_locacao.cod_entidade&#xd;&#xa;			                                      AND empenho.cod_empenho  &#x3d; veiculo_locacao.cod_empenho&#xd;&#xa;			                                LEFT JOIN empenho.pre_empenho&#xd;&#xa;			                                       ON pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;			                                      AND pre_empenho.exercicio       &#x3d; empenho.exercicio&#xd;&#xa;			                                LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;			                                       ON pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;			                                      AND pre_empenho_despesa.exercicio       &#x3d; pre_empenho.exercicio&#xd;&#xa;			                                LEFT JOIN orcamento.despesa&#xd;&#xa;			                                       ON despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;			                                      AND despesa.exercicio  &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;			                                LEFT JOIN sw_cgm_pessoa_juridica&#xd;&#xa;			                                       ON sw_cgm_pessoa_juridica.numcgm &#x3d; veiculo_locacao.cgm_locatario&#xd;&#xa;			                                 GROUP BY cod_unidade&#xd;&#xa;			                                        , cod_orgao&#xd;&#xa;			                                        , veiculo_propriedade.cod_veiculo&#xd;&#xa;			                                        , veiculo_locacao.cod_entidade&#xd;&#xa;			                                        , veiculo_uniorcam.cod_veiculo&#xd;&#xa;			                                        , veiculo_locacao.dt_inicio&#xd;&#xa;			                                        , veiculo_locacao.dt_termino&#xd;&#xa;			                                        , exercicio_locacao&#xd;&#xa;			                                        , sw_cgm_pessoa_juridica.cnpj&#xd;&#xa;			                                         &#x29; AS descricao_veiculo_locado&#xd;&#xa;			                                ON  descricao_veiculo_locado.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;			                               AND  descricao_veiculo_locado.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;			                       LEFT JOIN &#x28; SELECT veiculo_uniorcam.num_orgao AS cod_orgao&#xd;&#xa;			                                        , veiculo_uniorcam.num_unidade AS cod_unidade&#xd;&#xa;			                                        , veiculo_uniorcam.exercicio AS exercicio_cessao&#xd;&#xa;			                                        , veiculo_propriedade.cod_veiculo&#xd;&#xa;			                                        , MAX&#x28;veiculo_propriedade.timestamp&#x29; AS timestamp&#xd;&#xa;			                                        , veiculo_cessao.dt_inicio&#xd;&#xa;			                                        , veiculo_cessao.dt_termino&#xd;&#xa;			                                        , sw_cgm_pessoa_juridica.cnpj&#xd;&#xa;			                                        , &#x27;03&#x27;&#x3a;&#x3a;VARCHAR AS situacao_veiculo&#xd;&#xa;			                                     FROM frota.veiculo&#xd;&#xa;			                               INNER JOIN frota.veiculo_propriedade&#xd;&#xa;			                                       ON veiculo_propriedade.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;			                                      AND veiculo_propriedade.proprio &#x3d; false&#xd;&#xa;			                               INNER JOIN frota.terceiros&#xd;&#xa;			                                       ON terceiros.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;			                                      AND terceiros.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;			                                LEFT JOIN frota.veiculo_cessao&#xd;&#xa;			                                       ON veiculo_cessao.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;			                                LEFT JOIN patrimonio.veiculo_uniorcam&#xd;&#xa;			                                       ON veiculo.cod_veiculo &#x3d; veiculo_uniorcam.cod_veiculo&#xd;&#xa;			                                LEFT JOIN sw_cgm_pessoa_juridica&#xd;&#xa;			                                       ON sw_cgm_pessoa_juridica.numcgm &#x3d; veiculo_cessao.cgm_cedente&#xd;&#xa;			                                 GROUP BY cod_unidade&#xd;&#xa;			                                        , cod_orgao&#xd;&#xa;			                                        , veiculo_propriedade.cod_veiculo&#xd;&#xa;			                                        , veiculo_uniorcam.cod_veiculo&#xd;&#xa;			                                        , veiculo_cessao.dt_inicio&#xd;&#xa;			                                        , veiculo_cessao.dt_termino&#xd;&#xa;			                                        , exercicio_cessao&#xd;&#xa;			                                        , sw_cgm_pessoa_juridica.cnpj&#xd;&#xa;			                                &#x29; AS descricao_veiculo_cessao&#xd;&#xa;			                             ON descricao_veiculo_cessao.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;			                            AND descricao_veiculo_cessao.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;			                     INNER JOIN administracao.configuracao_entidade&#xd;&#xa;			                             ON configuracao_entidade.parametro    &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			                            AND configuracao_entidade.cod_modulo   &#x3d; 55&#xd;&#xa;			                            AND configuracao_entidade.exercicio    &#x3d; stExercicio        &#xd;&#xa;			                            AND configuracao_entidade.cod_entidade in &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;  &#xd;&#xa;			                          WHERE descricao_veiculo.dt_aquisicao     BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;			                             OR descricao_veiculo_locado.dt_inicio BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;			                             OR descricao_veiculo_cessao.dt_inicio BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;			                       ORDER BY veiculo.cod_veiculo&#xd;&#xa;			                    &#x29; AS registro10&#xd;&#xa;			            LEFT JOIN tcemg.arquivo_cvc&#xd;&#xa;			                   ON registro10.num_unidade &#x3d; arquivo_cvc.num_unidade&#xd;&#xa;			                  AND registro10.num_orgao   &#x3d; arquivo_cvc.num_orgao&#xd;&#xa;			                  AND registro10.exercicio   &#x3d; arquivo_cvc.exercicio&#xd;&#xa;			                  AND registro10.cod_veiculo &#x3d; arquivo_cvc.cod_veiculo&#xd;&#xa;			                WHERE arquivo_cvc.mes &#x3d; TO_CHAR&#x28;TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;,&#x27;mm&#x27;&#x29;&#xd;&#xa;			                  AND arquivo_cvc.cod_veiculo IS NOT NULL&#xd;&#xa;		&#xd;&#xa;			             ORDER BY registro10.cod_veiculo&#xd;&#xa;			&#x29;, &#xd;&#xa;			  cvc20 as &#xd;&#xa;			&#x28;&#xd;&#xa;				    SELECT 20 AS tipo_registro&#xd;&#xa;	                       , LPAD&#x28;configuracao_entidade.valor,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;	                       , CASE WHEN &#x28;descricao_veiculo.num_orgao IS NOT NULL AND descricao_veiculo.num_unidade IS NOT NULL&#x29;&#xd;&#xa;	                              THEN LPAD&#x28;LPAD&#x28;descricao_veiculo.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;descricao_veiculo.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                              WHEN descricao_veiculo_locado.cod_orgao IS NOT NULL AND descricao_veiculo_locado.cod_unidade IS NOT NULL&#xd;&#xa;	                              THEN LPAD&#x28;LPAD&#x28;descricao_veiculo_locado.cod_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;descricao_veiculo_locado.cod_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                              WHEN descricao_veiculo_cessao.cod_orgao IS NOT NULL AND descricao_veiculo_cessao.cod_unidade IS NOT NULL&#xd;&#xa;	                              THEN LPAD&#x28;LPAD&#x28;descricao_veiculo_cessao.cod_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;descricao_veiculo_cessao.cod_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                              ELSE LPAD&#x28;&#x27;0&#x27;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                          END AS cod_unidade_sub&#xd;&#xa;	                       , manutencao.cod_veiculo&#xd;&#xa;	                       , CASE WHEN &#x28;manutencao.cod_manutencao &#x3d; manutencao_empenho.cod_manutencao AND manutencao.exercicio &#x3d; manutencao_empenho.exercicio&#x29;&#xd;&#xa;	                              THEN CASE WHEN posto.interno IS TRUE&#xd;&#xa;	                                        THEN 1&#xd;&#xa;	                                        ELSE 2&#xd;&#xa;	                                    END&#xd;&#xa;	                              ELSE 1&#xd;&#xa;	                          END AS origem_gasto&#xd;&#xa;	                       , CASE WHEN &#x28;restos_pre_empenho.num_orgao IS NOT NULL AND restos_pre_empenho.num_unidade IS NOT NULL&#x29;&#xd;&#xa;	                              THEN LPAD&#x28;LPAD&#x28;restos_pre_empenho.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;restos_pre_empenho.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                              WHEN despesa.num_orgao IS NOT NULL AND despesa.num_unidade IS NOT NULL&#xd;&#xa;	                              THEN LPAD&#x28;LPAD&#x28;despesa.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;despesa.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                              ELSE &#x27;&#x27;&#xd;&#xa;	                          END AS cod_unidade_subempenho&#xd;&#xa;	                       , manutencao_empenho.cod_empenho AS nro_empenho&#xd;&#xa;	                       , TO_CHAR&#x28;empenho.dt_empenho&#x3a;&#x3a;timestamp,&#x27;ddmmyyyy&#x27;&#x29; AS dt_empenho&#xd;&#xa;	                       , COALESCE&#x28;&#x28;SELECT COALESCE &#x28;km,0&#x29; AS km&#xd;&#xa;	                                     FROM frota.manutencao AS kmini&#xd;&#xa;	                                     &#xd;&#xa;	                                    WHERE kmini.dt_manutencao BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;	                                      AND kmini.cod_veiculo    &#x3d; manutencao.cod_veiculo&#xd;&#xa;	                                      AND km &#x3e; 0&#xd;&#xa;	                                 ORDER BY km ASC LIMIT 1&#xd;&#xa;	                                  &#x29;,0&#x29; AS marcacao_inicial&#xd;&#xa;	                       , COALESCE&#x28;&#x28;SELECT  coalesce&#x28;km,0&#x29; AS km&#xd;&#xa;	                                     FROM frota.manutencao kmfim&#xd;&#xa;	                                    WHERE kmfim.dt_manutencao BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;	                                      AND kmfim.cod_veiculo    &#x3d; manutencao.cod_veiculo&#xd;&#xa;	                                      AND km &#x3e; 0&#xd;&#xa;	                                 ORDER BY km DESC LIMIT 1&#xd;&#xa;	                                  &#x29;,0&#x29; marcacao_final&#xd;&#xa;	                       , CASE item.cod_tipo&#xd;&#xa;	                              WHEN 2 THEN 08&#xd;&#xa;	                              WHEN 3 THEN 09&#xd;&#xa;	                              WHEN 4 THEN 99&#xd;&#xa;	                              ELSE item.cod_tipo&#xd;&#xa;	                          END AS tipo_gasto&#xd;&#xa;	                        , TRIM&#x28;REPLACE&#x28;TO_CHAR&#x28;manutencao_item.quantidade, &#x27;999999999.9999&#x27;&#x29;,&#x27;.&#x27;,&#x27;,&#x27;&#x29;&#x29; AS qtde_utilizada&#xd;&#xa;	                        , manutencao_item.valor AS vl_gasto&#xd;&#xa;	                        , CASE WHEN &#x28;item.cod_tipo &#x3d; 2&#xd;&#xa;	                                  OR item.cod_tipo &#x3d; 3&#xd;&#xa;	                                  OR item.cod_tipo &#x3d; 4&#x29;&#xd;&#xa;	                               THEN catalogo_item.descricao_resumida&#xd;&#xa;	                               ELSE &#x27;&#x27;&#xd;&#xa;	                           END AS dsc_pecas_servicos&#xd;&#xa;	                        , 2 AS atestado_controle&#xd;&#xa;	                    FROM frota.manutencao&#xd;&#xa;	              INNER JOIN frota.veiculo&#xd;&#xa;	                      ON veiculo.cod_veiculo &#x3d; manutencao.cod_veiculo&#xd;&#xa;	              INNER JOIN frota.manutencao_item&#xd;&#xa;	                      ON manutencao_item.exercicio      &#x3d; manutencao.exercicio&#xd;&#xa;	                     AND manutencao_item.cod_manutencao &#x3d; manutencao.cod_manutencao&#xd;&#xa;	              INNER JOIN frota.item&#xd;&#xa;	                      ON item.cod_item &#x3d; manutencao_item.cod_item&#xd;&#xa;	               LEFT JOIN almoxarifado.catalogo_item&#xd;&#xa;	                      ON catalogo_item.cod_item &#x3d; manutencao_item.cod_item&#xd;&#xa;	               LEFT JOIN frota.efetivacao&#xd;&#xa;	                      ON efetivacao.cod_manutencao &#x3d; manutencao.cod_manutencao&#xd;&#xa;	                     AND manutencao.exercicio      &#x3d; efetivacao.exercicio_manutencao&#xd;&#xa;	               LEFT JOIN frota.autorizacao&#xd;&#xa;	                      ON autorizacao.cod_autorizacao &#x3d; efetivacao.cod_autorizacao&#xd;&#xa;	                     AND autorizacao.exercicio       &#x3d; efetivacao.exercicio_autorizacao&#xd;&#xa;	               LEFT JOIN frota.posto&#xd;&#xa;	                      ON posto.cgm_posto &#x3d; autorizacao.cgm_fornecedor&#xd;&#xa;	               LEFT JOIN frota.manutencao_empenho&#xd;&#xa;	                      ON manutencao.cod_manutencao &#x3d; manutencao_empenho.cod_manutencao&#xd;&#xa;	                     AND manutencao.exercicio      &#x3d; manutencao_empenho.exercicio&#xd;&#xa;	               LEFT JOIN empenho.empenho&#xd;&#xa;	                      ON manutencao_empenho.cod_entidade      &#x3d; empenho.cod_entidade&#xd;&#xa;	                     AND manutencao_empenho.cod_empenho       &#x3d; empenho.cod_empenho&#xd;&#xa;	                     AND manutencao_empenho.exercicio_empenho &#x3d; empenho.exercicio&#xd;&#xa;	               LEFT JOIN empenho.pre_empenho&#xd;&#xa;	                      ON pre_empenho.exercicio       &#x3d; empenho.exercicio&#xd;&#xa;	                     AND pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;	               LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;	                      ON pre_empenho_despesa.exercicio       &#x3d; empenho.exercicio&#xd;&#xa;	                     AND pre_empenho_despesa.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;	               LEFT JOIN orcamento.despesa&#xd;&#xa;	                      ON despesa.exercicio   &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;	                     AND despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;	               LEFT JOIN empenho.restos_pre_empenho&#xd;&#xa;	                      ON restos_pre_empenho.exercicio       &#x3d; empenho.exercicio&#xd;&#xa;	                     AND restos_pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;	              INNER JOIN frota.veiculo_propriedade&#xd;&#xa;	                      ON veiculo_propriedade.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                     AND veiculo_propriedade.timestamp &#x3d; &#x28; SELECT MAX&#x28;vp.timestamp&#x29;&#xd;&#xa;	                                                             FROM frota.veiculo_propriedade as vp&#xd;&#xa;	                                                            WHERE vp.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo &#x29;&#xd;&#xa;	               LEFT JOIN &#x28; SELECT bem.descricao&#xd;&#xa;	                                , bem.cod_bem&#xd;&#xa;	                                , bem_comprado.num_orgao&#xd;&#xa;	                                , bem_comprado.num_unidade&#xd;&#xa;	                                , bem_comprado.exercicio&#xd;&#xa;	                                , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                                , MAX&#x28;veiculo_propriedade.timestamp&#x29; AS timestamp&#xd;&#xa;	                                , bem_comprado.cod_entidade&#xd;&#xa;	                                , bem.dt_aquisicao&#xd;&#xa;	                                , &#x27;01&#x27;&#x3a;&#x3a;VARCHAR AS situacao_veiculo&#xd;&#xa;	                             FROM frota.veiculo&#xd;&#xa;	                       INNER JOIN frota.veiculo_propriedade&#xd;&#xa;	                               ON veiculo_propriedade.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                              AND veiculo_propriedade.proprio &#x3d; true&#xd;&#xa;	                       INNER JOIN frota.proprio&#xd;&#xa;	                               ON proprio.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                              AND proprio.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	                       INNER JOIN patrimonio.bem&#xd;&#xa;	                               ON bem.cod_bem &#x3d; proprio.cod_bem&#xd;&#xa;	                       INNER JOIN patrimonio.bem_comprado&#xd;&#xa;	                               ON bem_comprado.cod_bem &#x3d; bem.cod_bem&#xd;&#xa;	                         GROUP BY bem.descricao&#xd;&#xa;	                                , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                                , bem.cod_bem&#xd;&#xa;	                                , bem_comprado.cod_entidade&#xd;&#xa;	                                , bem_comprado.num_orgao&#xd;&#xa;	                                , bem_comprado.num_unidade&#xd;&#xa;	                                , bem_comprado.exercicio&#xd;&#xa;	                                , veiculo.dt_aquisicao&#xd;&#xa;	                                 &#x29; AS descricao_veiculo&#xd;&#xa;	                     ON  descricao_veiculo.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                    AND descricao_veiculo.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	              LEFT JOIN &#x28; SELECT CASE WHEN veiculo_uniorcam.num_orgao IS NOT NULL AND veiculo_uniorcam.num_unidade IS NOT NULL&#xd;&#xa;	                                       THEN veiculo_uniorcam.num_orgao&#xd;&#xa;	                                       ELSE despesa.num_orgao&#xd;&#xa;	                                   END AS cod_orgao&#xd;&#xa;	                                , CASE WHEN veiculo_uniorcam.num_orgao IS NOT NULL AND veiculo_uniorcam.num_unidade IS NOT NULL&#xd;&#xa;	                                       THEN veiculo_uniorcam.num_unidade&#xd;&#xa;	                                       ELSE despesa.num_unidade&#xd;&#xa;	                                   END AS cod_unidade&#xd;&#xa;	                                , CASE WHEN veiculo_uniorcam.num_orgao IS NOT NULL AND veiculo_uniorcam.num_unidade IS NOT NULL&#xd;&#xa;	                                       THEN veiculo_uniorcam.exercicio&#xd;&#xa;	                                       ELSE despesa.exercicio&#xd;&#xa;	                                   END AS exercicio_locacao&#xd;&#xa;	                                , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                                , MAX&#x28;veiculo_propriedade.timestamp&#x29; AS timestamp&#xd;&#xa;	                                , veiculo_locacao.cod_entidade&#xd;&#xa;	                                , veiculo_locacao.dt_inicio&#xd;&#xa;	                                , veiculo_locacao.dt_termino&#xd;&#xa;	                                , &#x27;02&#x27;&#x3a;&#x3a;VARCHAR AS situacao_veiculo&#xd;&#xa;	                             FROM frota.veiculo&#xd;&#xa;	                       INNER JOIN frota.veiculo_propriedade&#xd;&#xa;	                               ON veiculo_propriedade.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                              AND veiculo_propriedade.proprio &#x3d; false&#xd;&#xa;	                       INNER JOIN frota.terceiros&#xd;&#xa;	                               ON terceiros.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                              AND terceiros.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	                        LEFT JOIN frota.veiculo_locacao&#xd;&#xa;	                               ON veiculo_locacao.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                        LEFT JOIN patrimonio.veiculo_uniorcam&#xd;&#xa;	                               ON veiculo.cod_veiculo &#x3d; veiculo_uniorcam.cod_veiculo&#xd;&#xa;	                        LEFT JOIN empenho.empenho&#xd;&#xa;	                               ON empenho.exercicio    &#x3d; veiculo_locacao.exercicio&#xd;&#xa;	                              AND empenho.cod_entidade &#x3d; veiculo_locacao.cod_entidade&#xd;&#xa;	                              AND empenho.cod_empenho  &#x3d; veiculo_locacao.cod_empenho&#xd;&#xa;	                        LEFT JOIN empenho.pre_empenho&#xd;&#xa;	                               ON pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;	                              AND pre_empenho.exercicio       &#x3d; empenho.exercicio&#xd;&#xa;	                        LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;	                               ON pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                              AND pre_empenho_despesa.exercicio       &#x3d; pre_empenho.exercicio&#xd;&#xa;	                        LEFT JOIN orcamento.despesa&#xd;&#xa;	                               ON despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;	                              AND despesa.exercicio  &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;	                         GROUP BY cod_unidade&#xd;&#xa;	                                , cod_orgao&#xd;&#xa;	                                , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                                , veiculo_locacao.cod_entidade&#xd;&#xa;	                                , veiculo_uniorcam.cod_veiculo&#xd;&#xa;	                                , veiculo_locacao.dt_inicio&#xd;&#xa;	                                , veiculo_locacao.dt_termino&#xd;&#xa;	                                , exercicio_locacao&#xd;&#xa;	                                 &#x29; AS descricao_veiculo_locado&#xd;&#xa;	                        ON  descricao_veiculo_locado.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                       AND  descricao_veiculo_locado.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	               LEFT JOIN &#x28; SELECT veiculo_uniorcam.num_orgao AS cod_orgao&#xd;&#xa;	                                , veiculo_uniorcam.num_unidade AS cod_unidade&#xd;&#xa;	                                , veiculo_uniorcam.exercicio AS exercicio_cessao&#xd;&#xa;	                                , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                                , MAX&#x28;veiculo_propriedade.timestamp&#x29; AS timestamp&#xd;&#xa;	                                , veiculo_cessao.dt_inicio&#xd;&#xa;	                                , veiculo_cessao.dt_termino&#xd;&#xa;	                                , &#x27;03&#x27;&#x3a;&#x3a;VARCHAR AS situacao_veiculo&#xd;&#xa;	                             FROM frota.veiculo&#xd;&#xa;	                       INNER JOIN frota.veiculo_propriedade&#xd;&#xa;	                               ON veiculo_propriedade.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                              AND veiculo_propriedade.proprio &#x3d; false&#xd;&#xa;	                       INNER JOIN frota.terceiros&#xd;&#xa;	                               ON terceiros.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                              AND terceiros.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	                        LEFT JOIN frota.veiculo_cessao&#xd;&#xa;	                               ON veiculo_cessao.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                        LEFT JOIN patrimonio.veiculo_uniorcam&#xd;&#xa;	                               ON veiculo.cod_veiculo &#x3d; veiculo_uniorcam.cod_veiculo&#xd;&#xa;	                         GROUP BY cod_unidade&#xd;&#xa;	                                , cod_orgao&#xd;&#xa;	                                , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                                , veiculo_uniorcam.cod_veiculo&#xd;&#xa;	                                , veiculo_cessao.dt_inicio&#xd;&#xa;	                                , veiculo_cessao.dt_termino&#xd;&#xa;	                                , exercicio_cessao&#xd;&#xa;	                        &#x29; AS descricao_veiculo_cessao&#xd;&#xa;	                     ON descricao_veiculo_cessao.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                    AND descricao_veiculo_cessao.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	             INNER JOIN administracao.configuracao_entidade&#xd;&#xa;	                     ON configuracao_entidade.parametro    &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                    AND configuracao_entidade.cod_modulo   &#x3d; 55&#xd;&#xa;	                    AND configuracao_entidade.exercicio    &#x3d; stExercicio            &#xd;&#xa;	                    AND configuracao_entidade.cod_entidade in &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;	                   WHERE manutencao.dt_manutencao BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;	                                                      AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;	                     AND manutencao.exercicio &#x3d; stExercicio                         &#xd;&#xa;	                     AND empenho.dt_empenho &#x3c;&#x3d; TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;	                GROUP BY tipo_registro&#xd;&#xa;	                       , LPAD&#x28;configuracao_entidade.valor,2,&#x27;0&#x27;&#x29;&#xd;&#xa;	                       , cod_unidade_sub&#xd;&#xa;	                       , manutencao.cod_veiculo&#xd;&#xa;	                       , origem_gasto&#xd;&#xa;	                       , cod_unidade_subempenho&#xd;&#xa;	                       , nro_empenho&#xd;&#xa;	                       , empenho.dt_empenho&#xd;&#xa;	                       , tipo_gasto&#xd;&#xa;	                       , qtde_utilizada&#xd;&#xa;	                       , vl_gasto&#xd;&#xa;	                       , dsc_pecas_servicos&#xd;&#xa;	                       , marcacao_inicial&#xd;&#xa;	                       , marcacao_final&#xd;&#xa;	                ORDER BY manutencao.cod_veiculo&#xd;&#xa;	                       , cod_unidade_subempenho&#xd;&#xa;	                       , nro_empenho&#xd;&#xa;			&#x29;,&#xd;&#xa;			  cvc30 as &#xd;&#xa;			&#x28;&#xd;&#xa;              SELECT 30 AS tipo_registro&#xd;&#xa;	                   , LPAD&#x28;configuracao_entidade.valor,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;	                   , CASE WHEN &#x28;descricao_veiculo.num_orgao IS NOT NULL AND descricao_veiculo.num_unidade IS NOT NULL&#x29;&#xd;&#xa;	                          THEN LPAD&#x28;LPAD&#x28;descricao_veiculo.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;descricao_veiculo.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                          WHEN descricao_veiculo_locado.cod_orgao IS NOT NULL AND descricao_veiculo_locado.cod_unidade IS NOT NULL&#xd;&#xa;	                          THEN LPAD&#x28;LPAD&#x28;descricao_veiculo_locado.cod_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;descricao_veiculo_locado.cod_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                          WHEN descricao_veiculo_cessao.cod_orgao IS NOT NULL AND descricao_veiculo_cessao.cod_unidade IS NOT NULL&#xd;&#xa;	                          THEN LPAD&#x28;LPAD&#x28;descricao_veiculo_cessao.cod_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;descricao_veiculo_cessao.cod_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                          ELSE LPAD&#x28;&#x27;0&#x27;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                      END AS cod_unidade_sub&#xd;&#xa;	                   , transporte_escolar.cod_veiculo&#xd;&#xa;	                   , sw_cgm.nom_cgm as nome_estabelecimento&#xd;&#xa;	                   , sw_cgm.bairro as localidade&#xd;&#xa;	                   , transporte_escolar.dias_rodados as qtde_dias_rodados&#xd;&#xa;	                   , transporte_escolar.distancia as distacia_estabelecimento&#xd;&#xa;	                   , transporte_escolar.passageiros as numero_passageiros&#xd;&#xa;	                   , transporte_escolar.cod_turno as turnos&#xd;&#xa;	                FROM frota.transporte_escolar&#xd;&#xa;	          INNER JOIN frota.veiculo&#xd;&#xa;	                  ON veiculo.cod_veiculo &#x3d; transporte_escolar.cod_veiculo&#xd;&#xa;	          INNER JOIN sw_cgm&#xd;&#xa;	                  ON sw_cgm.numcgm &#x3d; transporte_escolar.cgm_escola&#xd;&#xa;	          INNER JOIN frota.veiculo_propriedade&#xd;&#xa;	                  ON veiculo_propriedade.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                 AND veiculo_propriedade.timestamp &#x3d; &#x28; SELECT MAX&#x28;vp.timestamp&#x29;&#xd;&#xa;	                                                         FROM frota.veiculo_propriedade as vp&#xd;&#xa;	                                                        WHERE vp.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo &#x29;&#xd;&#xa;	           LEFT JOIN &#x28; SELECT bem.descricao&#xd;&#xa;	                            , bem.cod_bem&#xd;&#xa;	                            , bem_comprado.num_orgao&#xd;&#xa;	                            , bem_comprado.num_unidade&#xd;&#xa;	                            , bem_comprado.exercicio&#xd;&#xa;	                            , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                            , MAX&#x28;veiculo_propriedade.timestamp&#x29; AS timestamp&#xd;&#xa;	                            , bem_comprado.cod_entidade&#xd;&#xa;	                            , bem.dt_aquisicao&#xd;&#xa;	                            , &#x27;01&#x27;&#x3a;&#x3a;VARCHAR AS situacao_veiculo&#xd;&#xa;	                         FROM frota.veiculo&#xd;&#xa;	                   INNER JOIN frota.veiculo_propriedade&#xd;&#xa;	                           ON veiculo_propriedade.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                          AND veiculo_propriedade.proprio &#x3d; true&#xd;&#xa;	                   INNER JOIN frota.proprio&#xd;&#xa;	                           ON proprio.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                          AND proprio.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	                   INNER JOIN patrimonio.bem&#xd;&#xa;	                           ON bem.cod_bem &#x3d; proprio.cod_bem&#xd;&#xa;	                   INNER JOIN patrimonio.bem_comprado&#xd;&#xa;	                           ON bem_comprado.cod_bem &#x3d; bem.cod_bem&#xd;&#xa;	                     GROUP BY bem.descricao&#xd;&#xa;	                            , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                            , bem.cod_bem&#xd;&#xa;	                            , bem_comprado.cod_entidade&#xd;&#xa;	                            , bem_comprado.num_orgao&#xd;&#xa;	                            , bem_comprado.num_unidade&#xd;&#xa;	                            , bem_comprado.exercicio&#xd;&#xa;	                            , veiculo.dt_aquisicao&#xd;&#xa;	                             &#x29; AS descricao_veiculo&#xd;&#xa;	                 ON  descricao_veiculo.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                AND descricao_veiculo.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	          LEFT JOIN &#x28; SELECT CASE WHEN veiculo_uniorcam.num_orgao IS NOT NULL AND veiculo_uniorcam.num_unidade IS NOT NULL&#xd;&#xa;	                                   THEN veiculo_uniorcam.num_orgao&#xd;&#xa;	                                   ELSE despesa.num_orgao&#xd;&#xa;	                               END AS cod_orgao&#xd;&#xa;	                            , CASE WHEN veiculo_uniorcam.num_orgao IS NOT NULL AND veiculo_uniorcam.num_unidade IS NOT NULL&#xd;&#xa;	                                   THEN veiculo_uniorcam.num_unidade&#xd;&#xa;	                                   ELSE despesa.num_unidade&#xd;&#xa;	                               END AS cod_unidade&#xd;&#xa;	                            , CASE WHEN veiculo_uniorcam.num_orgao IS NOT NULL AND veiculo_uniorcam.num_unidade IS NOT NULL&#xd;&#xa;	                                   THEN veiculo_uniorcam.exercicio&#xd;&#xa;	                                   ELSE despesa.exercicio&#xd;&#xa;	                               END AS exercicio_locacao&#xd;&#xa;	                            , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                            , MAX&#x28;veiculo_propriedade.timestamp&#x29; AS timestamp&#xd;&#xa;	                            , veiculo_locacao.cod_entidade&#xd;&#xa;	                            , veiculo_locacao.dt_inicio&#xd;&#xa;	                            , veiculo_locacao.dt_termino&#xd;&#xa;	                            , &#x27;02&#x27;&#x3a;&#x3a;VARCHAR AS situacao_veiculo&#xd;&#xa;	                         FROM frota.veiculo&#xd;&#xa;	                   INNER JOIN frota.veiculo_propriedade&#xd;&#xa;	                           ON veiculo_propriedade.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                          AND veiculo_propriedade.proprio &#x3d; false&#xd;&#xa;	                   INNER JOIN frota.terceiros&#xd;&#xa;	                           ON terceiros.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                          AND terceiros.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	                   INNER JOIN frota.veiculo_locacao&#xd;&#xa;	                           ON veiculo_locacao.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                    LEFT JOIN patrimonio.veiculo_uniorcam&#xd;&#xa;	                           ON veiculo.cod_veiculo &#x3d; veiculo_uniorcam.cod_veiculo&#xd;&#xa;	                    LEFT JOIN empenho.empenho&#xd;&#xa;	                           ON empenho.exercicio    &#x3d; veiculo_locacao.exercicio&#xd;&#xa;	                          AND empenho.cod_entidade &#x3d; veiculo_locacao.cod_entidade&#xd;&#xa;	                          AND empenho.cod_empenho  &#x3d; veiculo_locacao.cod_empenho&#xd;&#xa;	                    LEFT JOIN empenho.pre_empenho&#xd;&#xa;	                           ON pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;	                          AND pre_empenho.exercicio       &#x3d; empenho.exercicio&#xd;&#xa;	                    LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;	                           ON pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                          AND pre_empenho_despesa.exercicio       &#x3d; pre_empenho.exercicio&#xd;&#xa;	                    LEFT JOIN orcamento.despesa&#xd;&#xa;	                           ON despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;	                          AND despesa.exercicio  &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;	                     GROUP BY cod_unidade&#xd;&#xa;	                            , cod_orgao&#xd;&#xa;	                            , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                            , veiculo_locacao.cod_entidade&#xd;&#xa;	                            , veiculo_uniorcam.cod_veiculo&#xd;&#xa;	                            , veiculo_locacao.dt_inicio&#xd;&#xa;	                            , veiculo_locacao.dt_termino&#xd;&#xa;	                            , exercicio_locacao&#xd;&#xa;	                             &#x29; AS descricao_veiculo_locado&#xd;&#xa;	                    ON  descricao_veiculo_locado.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                   AND  descricao_veiculo_locado.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	           LEFT JOIN &#x28; SELECT veiculo_uniorcam.num_orgao AS cod_orgao&#xd;&#xa;	                            , veiculo_uniorcam.num_unidade AS cod_unidade&#xd;&#xa;	                            , veiculo_uniorcam.exercicio AS exercicio_cessao&#xd;&#xa;	                            , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                            , MAX&#x28;veiculo_propriedade.timestamp&#x29; AS timestamp&#xd;&#xa;	                            , veiculo_cessao.dt_inicio&#xd;&#xa;	                            , veiculo_cessao.dt_termino&#xd;&#xa;	                            , &#x27;03&#x27;&#x3a;&#x3a;VARCHAR AS situacao_veiculo&#xd;&#xa;	                         FROM frota.veiculo&#xd;&#xa;	                   INNER JOIN frota.veiculo_propriedade&#xd;&#xa;	                           ON veiculo_propriedade.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                          AND veiculo_propriedade.proprio &#x3d; false&#xd;&#xa;	                   INNER JOIN frota.terceiros&#xd;&#xa;	                           ON terceiros.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                          AND terceiros.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	                   INNER JOIN frota.veiculo_cessao&#xd;&#xa;	                           ON veiculo_cessao.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                    LEFT JOIN patrimonio.veiculo_uniorcam&#xd;&#xa;	                           ON veiculo.cod_veiculo &#x3d; veiculo_uniorcam.cod_veiculo&#xd;&#xa;	                     GROUP BY cod_unidade&#xd;&#xa;	                            , cod_orgao&#xd;&#xa;	                            , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                            , veiculo_uniorcam.cod_veiculo&#xd;&#xa;	                            , veiculo_cessao.dt_inicio&#xd;&#xa;	                            , veiculo_cessao.dt_termino&#xd;&#xa;	                            , exercicio_cessao&#xd;&#xa;	                    &#x29; AS descricao_veiculo_cessao&#xd;&#xa;	                 ON descricao_veiculo_cessao.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                AND descricao_veiculo_cessao.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	         INNER JOIN administracao.configuracao_entidade&#xd;&#xa;	                 ON configuracao_entidade.parametro    &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                AND configuracao_entidade.cod_modulo   &#x3d; 55&#xd;&#xa;	                AND configuracao_entidade.exercicio    &#x3d; stExercicio                &#xd;&#xa;	                AND configuracao_entidade.cod_entidade in &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;	               WHERE transporte_escolar.mes &#x3d; TO_CHAR&#x28;TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;,&#x27;mm&#x27;&#x29;&#x3a;&#x3a;INTEGER    &#xd;&#xa;	                 AND transporte_escolar.exercicio &#x3d; stExercicio                   &#xd;&#xa;	            GROUP BY tipo_registro&#xd;&#xa;	                   , configuracao_entidade.valor&#xd;&#xa;	                   , cod_unidade_sub&#xd;&#xa;	                   , transporte_escolar.cod_veiculo&#xd;&#xa;	                   , nome_estabelecimento&#xd;&#xa;	                   , localidade&#xd;&#xa;	                   , qtde_dias_rodados&#xd;&#xa;	                   , distacia_estabelecimento&#xd;&#xa;	                   , numero_passageiros&#xd;&#xa;	                   , turnos&#xd;&#xa;			&#x29;,&#xd;&#xa;  		      cvc40 as &#xd;&#xa;			&#x28;&#xd;&#xa;				  SELECT 40 AS tipo_registro&#xd;&#xa;	                   , LPAD&#x28;configuracao_entidade.valor,2,&#x27;0&#x27;&#x29; AS uniorcam_cod_orgao&#xd;&#xa;	                   , CASE WHEN &#x28;descricao_veiculo.num_orgao IS NOT NULL AND descricao_veiculo.num_unidade IS NOT NULL&#x29;&#xd;&#xa;	                          THEN LPAD&#x28;LPAD&#x28;descricao_veiculo.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;descricao_veiculo.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                          WHEN descricao_veiculo_locado.cod_orgao IS NOT NULL AND descricao_veiculo_locado.cod_unidade IS NOT NULL&#xd;&#xa;	                          THEN LPAD&#x28;LPAD&#x28;descricao_veiculo_locado.cod_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;descricao_veiculo_locado.cod_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                          WHEN descricao_veiculo_cessao.cod_orgao IS NOT NULL AND descricao_veiculo_cessao.cod_unidade IS NOT NULL&#xd;&#xa;	                          THEN LPAD&#x28;LPAD&#x28;descricao_veiculo_cessao.cod_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;descricao_veiculo_cessao.cod_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                          ELSE LPAD&#x28;&#x27;0&#x27;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                      END AS cod_unidade_sub&#xd;&#xa;	                   , veiculo_baixado.cod_veiculo&#xd;&#xa;	                   , veiculo_baixado.cod_tipo_baixa AS cod_tipo&#xd;&#xa;	                   , CASE WHEN &#x28;veiculo_baixado.cod_tipo_baixa &#x3d; 99&#x29;&#xd;&#xa;	                          THEN TRIM&#x28;veiculo_baixado.motivo&#x29;&#xd;&#xa;	                          ELSE &#x27;&#x27;&#xd;&#xa;	                      END AS descbaixa&#xd;&#xa;	                   , TO_CHAR&#x28;veiculo_baixado.dt_baixa,&#x27;ddmmyyyy&#x27;&#x29; AS dt_baixa&#xd;&#xa;	                FROM frota.veiculo_baixado&#xd;&#xa;	          INNER JOIN frota.veiculo&#xd;&#xa;	                  ON veiculo.cod_veiculo &#x3d; veiculo_baixado.cod_veiculo&#xd;&#xa;	          INNER JOIN frota.veiculo_propriedade&#xd;&#xa;	                  ON veiculo_propriedade.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                 AND veiculo_propriedade.timestamp &#x3d; &#x28; SELECT MAX&#x28;vp.timestamp&#x29;&#xd;&#xa;	                                                         FROM frota.veiculo_propriedade as vp&#xd;&#xa;	                                                        WHERE vp.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo &#x29;&#xd;&#xa;	           LEFT JOIN &#x28; SELECT bem.descricao&#xd;&#xa;	                            , bem.cod_bem&#xd;&#xa;	                            , bem_comprado.num_orgao&#xd;&#xa;	                            , bem_comprado.num_unidade&#xd;&#xa;	                            , bem_comprado.exercicio&#xd;&#xa;	                            , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                            , MAX&#x28;veiculo_propriedade.timestamp&#x29; AS timestamp&#xd;&#xa;	                            , bem_comprado.cod_entidade&#xd;&#xa;	                            , bem.dt_aquisicao&#xd;&#xa;	                            , &#x27;01&#x27;&#x3a;&#x3a;VARCHAR AS situacao_veiculo&#xd;&#xa;	                         FROM frota.veiculo&#xd;&#xa;	                   INNER JOIN frota.veiculo_propriedade&#xd;&#xa;	                           ON veiculo_propriedade.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                          AND veiculo_propriedade.proprio &#x3d; true&#xd;&#xa;	                   INNER JOIN frota.proprio&#xd;&#xa;	                           ON proprio.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                          AND proprio.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	                   INNER JOIN patrimonio.bem&#xd;&#xa;	                           ON bem.cod_bem &#x3d; proprio.cod_bem&#xd;&#xa;	                   INNER JOIN patrimonio.bem_comprado&#xd;&#xa;	                           ON bem_comprado.cod_bem &#x3d; bem.cod_bem&#xd;&#xa;	                     GROUP BY bem.descricao&#xd;&#xa;	                            , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                            , bem.cod_bem&#xd;&#xa;	                            , bem_comprado.cod_entidade&#xd;&#xa;	                            , bem_comprado.num_orgao&#xd;&#xa;	                            , bem_comprado.num_unidade&#xd;&#xa;	                            , bem_comprado.exercicio&#xd;&#xa;	                            , veiculo.dt_aquisicao&#xd;&#xa;	                             &#x29; AS descricao_veiculo&#xd;&#xa;	                 ON  descricao_veiculo.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                AND descricao_veiculo.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	          LEFT JOIN &#x28; SELECT CASE WHEN veiculo_uniorcam.num_orgao IS NOT NULL AND veiculo_uniorcam.num_unidade IS NOT NULL&#xd;&#xa;	                                   THEN veiculo_uniorcam.num_orgao&#xd;&#xa;	                                   ELSE despesa.num_orgao&#xd;&#xa;	                               END AS cod_orgao&#xd;&#xa;	                            , CASE WHEN veiculo_uniorcam.num_orgao IS NOT NULL AND veiculo_uniorcam.num_unidade IS NOT NULL&#xd;&#xa;	                                   THEN veiculo_uniorcam.num_unidade&#xd;&#xa;	                                   ELSE despesa.num_unidade&#xd;&#xa;	                               END AS cod_unidade&#xd;&#xa;	                            , CASE WHEN veiculo_uniorcam.num_orgao IS NOT NULL AND veiculo_uniorcam.num_unidade IS NOT NULL&#xd;&#xa;	                                   THEN veiculo_uniorcam.exercicio&#xd;&#xa;	                                   ELSE despesa.exercicio&#xd;&#xa;	                               END AS exercicio_locacao&#xd;&#xa;	                            , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                            , MAX&#x28;veiculo_propriedade.timestamp&#x29; AS timestamp&#xd;&#xa;	                            , veiculo_locacao.cod_entidade&#xd;&#xa;	                            , veiculo_locacao.dt_inicio&#xd;&#xa;	                            , veiculo_locacao.dt_termino&#xd;&#xa;	                            , &#x27;02&#x27;&#x3a;&#x3a;VARCHAR AS situacao_veiculo&#xd;&#xa;	                         FROM frota.veiculo&#xd;&#xa;	                   INNER JOIN frota.veiculo_propriedade&#xd;&#xa;	                           ON veiculo_propriedade.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                          AND veiculo_propriedade.proprio &#x3d; false&#xd;&#xa;	                   INNER JOIN frota.terceiros&#xd;&#xa;	                           ON terceiros.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                          AND terceiros.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	                   INNER JOIN frota.veiculo_locacao&#xd;&#xa;	                           ON veiculo_locacao.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                    LEFT JOIN patrimonio.veiculo_uniorcam&#xd;&#xa;	                           ON veiculo.cod_veiculo &#x3d; veiculo_uniorcam.cod_veiculo&#xd;&#xa;	                    LEFT JOIN empenho.empenho&#xd;&#xa;	                           ON empenho.exercicio    &#x3d; veiculo_locacao.exercicio&#xd;&#xa;	                          AND empenho.cod_entidade &#x3d; veiculo_locacao.cod_entidade&#xd;&#xa;	                          AND empenho.cod_empenho  &#x3d; veiculo_locacao.cod_empenho&#xd;&#xa;	                    LEFT JOIN empenho.pre_empenho&#xd;&#xa;	                           ON pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;	                          AND pre_empenho.exercicio       &#x3d; empenho.exercicio&#xd;&#xa;	                    LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;	                           ON pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                          AND pre_empenho_despesa.exercicio       &#x3d; pre_empenho.exercicio&#xd;&#xa;	                    LEFT JOIN orcamento.despesa&#xd;&#xa;	                           ON despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;	                          AND despesa.exercicio  &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;	                     GROUP BY cod_unidade&#xd;&#xa;	                            , cod_orgao&#xd;&#xa;	                            , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                            , veiculo_locacao.cod_entidade&#xd;&#xa;	                            , veiculo_uniorcam.cod_veiculo&#xd;&#xa;	                            , veiculo_locacao.dt_inicio&#xd;&#xa;	                            , veiculo_locacao.dt_termino&#xd;&#xa;	                            , exercicio_locacao&#xd;&#xa;	                             &#x29; AS descricao_veiculo_locado&#xd;&#xa;	                    ON  descricao_veiculo_locado.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                   AND  descricao_veiculo_locado.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	           LEFT JOIN &#x28; SELECT veiculo_uniorcam.num_orgao AS cod_orgao&#xd;&#xa;	                            , veiculo_uniorcam.num_unidade AS cod_unidade&#xd;&#xa;	                            , veiculo_uniorcam.exercicio AS exercicio_cessao&#xd;&#xa;	                            , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                            , MAX&#x28;veiculo_propriedade.timestamp&#x29; AS timestamp&#xd;&#xa;	                            , veiculo_cessao.dt_inicio&#xd;&#xa;	                            , veiculo_cessao.dt_termino&#xd;&#xa;	                            , &#x27;03&#x27;&#x3a;&#x3a;VARCHAR AS situacao_veiculo&#xd;&#xa;	                         FROM frota.veiculo&#xd;&#xa;	                   INNER JOIN frota.veiculo_propriedade&#xd;&#xa;	                           ON veiculo_propriedade.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                          AND veiculo_propriedade.proprio &#x3d; false&#xd;&#xa;	                   INNER JOIN frota.terceiros&#xd;&#xa;	                           ON terceiros.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                          AND terceiros.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	                   INNER JOIN frota.veiculo_cessao&#xd;&#xa;	                           ON veiculo_cessao.cod_veiculo &#x3d; veiculo.cod_veiculo&#xd;&#xa;	                    LEFT JOIN patrimonio.veiculo_uniorcam&#xd;&#xa;	                           ON veiculo.cod_veiculo &#x3d; veiculo_uniorcam.cod_veiculo&#xd;&#xa;	                     GROUP BY cod_unidade&#xd;&#xa;	                            , cod_orgao&#xd;&#xa;	                            , veiculo_propriedade.cod_veiculo&#xd;&#xa;	                            , veiculo_uniorcam.cod_veiculo&#xd;&#xa;	                            , veiculo_cessao.dt_inicio&#xd;&#xa;	                            , veiculo_cessao.dt_termino&#xd;&#xa;	                            , exercicio_cessao&#xd;&#xa;	                    &#x29; AS descricao_veiculo_cessao&#xd;&#xa;	                 ON descricao_veiculo_cessao.cod_veiculo &#x3d; veiculo_propriedade.cod_veiculo&#xd;&#xa;	                AND descricao_veiculo_cessao.timestamp &#x3d; veiculo_propriedade.timestamp&#xd;&#xa;	         INNER JOIN administracao.configuracao_entidade&#xd;&#xa;	                 ON configuracao_entidade.parametro    &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                AND configuracao_entidade.cod_modulo   &#x3d; 55&#xd;&#xa;	                AND configuracao_entidade.exercicio    &#x3d; stExercicio                           &#xd;&#xa;	                AND configuracao_entidade.cod_entidade in &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;      &#xd;&#xa;	              WHERE veiculo_baixado.dt_baixa BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;	                 OR descricao_veiculo_locado.dt_termino BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;	                 OR descricao_veiculo_cessao.dt_termino BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;	           GROUP BY tipo_registro&#xd;&#xa;	                  , uniorcam_cod_orgao&#xd;&#xa;	                  , cod_unidade_sub&#xd;&#xa;	                  , veiculo_baixado.cod_veiculo&#xd;&#xa;	                  , cod_tipo&#xd;&#xa;	                  , descbaixa&#xd;&#xa;	                  , dt_baixa&#xd;&#xa;			&#x29;,&#xd;&#xa;			  cvc_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_veiculo,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_sub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_veiculo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipo_veiculo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;subtipo_veiculo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;descricao,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,100&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;marca,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;modelo,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;ano_fabricacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;placa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;chassi&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;numero_renavam&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;numero_serie&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;situacao_veiculo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_documento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipo_deslocamento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;					&#xd;&#xa;					as d&#xd;&#xa;				from cvc10&#xd;&#xa;				union all   &#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_veiculo,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_sub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_veiculo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;origem_gasto, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_subempenho&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_empenho&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_empenho&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; trim&#x28;to_char&#x28;coalesce&#x28;marcacao_inicial, &#x27;0&#x27;&#x29; , &#x27;999999&#x27;&#x29;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; trim&#x28;to_char&#x28;coalesce&#x28;marcacao_final, &#x27;0&#x27;&#x29; , &#x27;999999&#x27;&#x29;&#x29; 					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipo_gasto&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29; ,2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;qtde_utilizada&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_gasto&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;dsc_pecas_servicos,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;atestado_controle&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,1, &#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from cvc20&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        cod_veiculo,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_sub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_veiculo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 10, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;nome_estabelecimento,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,250&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;localidade,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,250&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;qtde_dias_rodados&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;distacia_estabelecimento&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;numero_passageiros&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;turnos&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from cvc30&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        cod_veiculo,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;uniorcam_cod_orgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_sub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_veiculo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,10, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_tipo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;descbaixa,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_baixa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,8, &#x27; &#x27;&#x29;					&#xd;&#xa;					as d&#xd;&#xa;				from cvc40  &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;CVC.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from cvc_format order by tipo_registro,cod_veiculo&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;	&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;CONTRATOS.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then				&#xd;&#xa;			with contratos10 as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 10 as tipo_Registro,&#xd;&#xa;	                    &#x28;TC.exercicio&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.nro_contrato,9, &#x27;0&#x27;&#x29;&#x29;&#x29; AS codContrato,&#xd;&#xa;	                    &#x28;SELECT valor FROM administracao.configuracao_entidade&#xd;&#xa;	                                   WHERE exercicio&#x3d;TC.exercicio&#xd;&#xa;	                                   AND parametro&#x3d;&#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                                   AND cod_entidade&#x3d;TC.cod_entidade&#x29;&#xd;&#xa;	                    AS codOrgao,&#xd;&#xa;	                    LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29; AS codUnidadeSub,&#xd;&#xa;	                    TC.nro_contrato AS nroContrato,&#xd;&#xa;	                    TC.exercicio AS exercicioContrato,&#xd;&#xa;	                    to_char&#x28;TC.data_assinatura, &#x27;ddmmyyyy&#x27;&#x29; AS dataAssinatura,&#xd;&#xa;	                    TC.cod_modalidade_licitacao AS contDecLicitacao,&#xd;&#xa;	                    CASE WHEN TC.cod_modalidade_licitacao&#x3d;5 OR TC.cod_modalidade_licitacao&#x3d;6 THEN&#xd;&#xa;	                            &#x28;SELECT valor FROM administracao.configuracao_entidade&#xd;&#xa;	                            WHERE exercicio&#x3d;TC.exercicio&#xd;&#xa;	                            AND parametro&#x3d;&#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                            AND cod_entidade&#x3d;TC.cod_entidade_modalidade&#x29;&#xd;&#xa;	                    ELSE&#xd;&#xa;	                            &#x27;&#x27;&#xd;&#xa;	                    END AS codOrgaoResp,&#xd;&#xa;	                    CASE WHEN TC.cod_modalidade_licitacao&#x3d;5 OR TC.cod_modalidade_licitacao&#x3d;6 THEN&#xd;&#xa;	                            LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.num_orgao_modalidade,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.num_unidade_modalidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                    ELSE&#xd;&#xa;	                            LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                    END AS codUnidadeSubResp,&#xd;&#xa;	                    TC.nro_processo AS nroProcesso,&#xd;&#xa;	                    TC.exercicio_processo AS exercicioProcesso,&#xd;&#xa;	                    CASE WHEN TC.cod_modalidade_licitacao&#x3d;3 OR TC.cod_modalidade_licitacao&#x3d;6 THEN&#xd;&#xa;	                            TC.cod_tipo_processo&#x3a;&#x3a;TEXT&#xd;&#xa;	                    ELSE&#xd;&#xa;	                            &#x27;&#x27;&#xd;&#xa;	                    END AS tipoProcesso,&#xd;&#xa;	                    TC.cod_objeto AS naturezaObjeto,&#xd;&#xa;	                    TC.objeto_contrato AS objetoContrato,&#xd;&#xa;	                    TC.cod_instrumento AS tipoInstrumento,&#xd;&#xa;	                    to_char&#x28;TC.data_inicio, &#x27;ddmmyyyy&#x27;&#x29; AS dataInicioVigencia,&#xd;&#xa;	                    to_char&#x28;TC.data_final, &#x27;ddmmyyyy&#x27;&#x29; AS dataFinalVigencia,&#xd;&#xa;	                    REPLACE&#x28;TC.vl_contrato&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29; AS vlContrato,&#xd;&#xa;	                    TC.fornecimento AS formaFornecimento,&#xd;&#xa;	                    TC.pagamento AS formaPagamento,&#xd;&#xa;	                    TC.execucao AS prazoExecucao,&#xd;&#xa;	                    TC.multa AS multaRescisoria,&#xd;&#xa;	                    TC.multa_inadimplemento,&#xd;&#xa;	                    TC.cod_garantia AS garantia,&#xd;&#xa;	                    &#x28;SELECT cpf FROM sw_cgm_pessoa_fisica WHERE numcgm&#x3d;TC.cgm_signatario&#x29; AS cpfSignatarioContratante,&#xd;&#xa;	                    to_char&#x28;TC.data_publicacao, &#x27;ddmmyyyy&#x27;&#x29; AS dataPublicacao,&#xd;&#xa;	                    sw_cgm.nom_cgm AS veiculoDivulgacao&#xd;&#xa;	                    FROM tcemg.contrato AS TC&#xd;&#xa;	                    INNER JOIN sw_cgm&#xd;&#xa;	                    ON sw_cgm.numcgm &#x3d; TC.numcgm_publicidade&#xd;&#xa;	                    WHERE TC.exercicio&#x3d; stExercicio                                           &#xd;&#xa;	                    AND &#x28;TC.data_inicio &#x3c;&#x3d; TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;	                        OR&#xd;&#xa;	                        TC.data_inicio BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;	                        &#x29;&#xd;&#xa;	                    AND &#x28;TC.data_final &#x3e;&#x3d; TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;	                        OR&#xd;&#xa;	                        TC.data_final BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;    &#xd;&#xa;	                        &#x29;&#xd;&#xa;	                    AND TC.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                &#xd;&#xa;	                    ORDER BY TC.nro_contrato, TC.cod_entidade&#xd;&#xa;			&#x29;, &#xd;&#xa;			  contratos11 as &#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT 11 as tipo_Registro,&#xd;&#xa;	                    &#x28;TC.exercicio&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.nro_contrato,9, &#x27;0&#x27;&#x29;&#x29;&#x29; AS codContrato,&#xd;&#xa;	                    EITEM.cod_item AS codItem,&#xd;&#xa;	                    REPLACE&#x28;ROUND&#x28;EITEM.quantidade, 4&#x29;&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29; AS quantidadeItem,&#xd;&#xa;	                    REPLACE&#x28;ROUND&#x28;&#x28;EITEM.vl_total&#x2f;EITEM.quantidade&#x29;, 4&#x29;&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29; AS valorUnitarioItem&#xd;&#xa;	                    FROM tcemg.contrato AS TC&#xd;&#xa;	                    INNER JOIN tcemg.contrato_empenho AS TCE&#xd;&#xa;	                    ON TCE.cod_contrato&#x3d;TC.cod_contrato&#xd;&#xa;	                    AND TCE.exercicio&#x3d;TC.exercicio&#xd;&#xa;	                    AND TCE.cod_entidade&#x3d;TC.cod_entidade&#xd;&#xa;	                    INNER JOIN empenho.empenho AS EE&#xd;&#xa;	                    ON EE.exercicio&#x3d;TCE.exercicio_empenho&#xd;&#xa;	                    AND EE.cod_entidade&#x3d;TCE.cod_entidade&#xd;&#xa;	                    AND EE.cod_empenho&#x3d;TCE.cod_empenho&#xd;&#xa;	                    INNER JOIN empenho.item_pre_empenho AS EITEM&#xd;&#xa;	                    ON EITEM.cod_pre_empenho&#x3d;EE.cod_pre_empenho&#xd;&#xa;	                    AND EITEM.exercicio&#x3d;EE.exercicio&#xd;&#xa;	                    WHERE TC.exercicio&#x3d;  stExercicio                  &#xd;&#xa;	                    AND &#x28;TC.data_inicio &#x3c;&#x3d; TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;	                        OR&#xd;&#xa;	                        TC.data_inicio BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;	                        &#x29;&#xd;&#xa;	                    AND &#x28;TC.data_final &#x3e;&#x3d; TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                       &#xd;&#xa;	                        OR&#xd;&#xa;	                        TC.data_final BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;       &#xd;&#xa;	                        &#x29;&#xd;&#xa;	                    AND TC.cod_entidade IN  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                    &#xd;&#xa;	                    AND TC.cod_objeto&#x21;&#x3d;4 AND TC.cod_objeto&#x21;&#x3d;5&#xd;&#xa;	                    ORDER BY TC.nro_contrato, TC.cod_entidade&#xd;&#xa;			&#x29;,&#xd;&#xa;			  contratos12 as &#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT 12 as tipo_Registro,&#xd;&#xa;	                    &#x28;TC.exercicio&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.nro_contrato,9, &#x27;0&#x27;&#x29;&#x29;&#x29; AS codContrato,&#xd;&#xa;	                            &#x28;SELECT valor FROM administracao.configuracao_entidade&#xd;&#xa;	                            WHERE exercicio&#x3d;TC.exercicio&#xd;&#xa;	                            AND parametro&#x3d;&#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                            AND cod_entidade&#x3d;TC.cod_entidade&#x29;&#xd;&#xa;	                    AS codOrgao,&#xd;&#xa;	                    LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29; AS codUnidadeSub,&#xd;&#xa;	                    LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;OD.cod_funcao,2, &#x27;0&#x27;&#x29; AS codfuncao,&#xd;&#xa;	                    OD.cod_subfuncao AS codsubfuncao,&#xd;&#xa;	                    &#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;	&#x28;SELECT num_programa FROM ppa.programa&#xd;&#xa;	                                    WHERE cod_programa&#x3d;OP.cod_programa AND ativo&#x3d;true LIMIT 1&#x29;,4, &#x27;0&#x27;&#x29;&#x29;&#xd;&#xa;	                    AS codprograma,&#xd;&#xa;	                    &#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;ACAO.num_acao,4, &#x27;0&#x27;&#x29;&#x29; AS idacao,&#xd;&#xa;	                    &#x27;&#x27;&#x3a;&#x3a;TEXT AS idsubacao,&#xd;&#xa;	                    &#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;REPLACE&#x28;OCD.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;,6, &#x27;&#x27;&#x29;&#x29; AS naturezadespesa,&#xd;&#xa;	                    recurso.cod_fonte AS codFontRecursos,&#xd;&#xa;	                    REPLACE&#x28;empenho.fn_consultar_valor_empenhado&#x28;&#xd;&#xa;	                            EE.exercicio&#xd;&#xa;	                            ,EE.cod_empenho&#xd;&#xa;	                            ,EE.cod_entidade&#x29;&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29;&#xd;&#xa;	                    AS vlRecurso&#xd;&#xa;	                    FROM tcemg.contrato AS TC&#xd;&#xa;	                    INNER JOIN tcemg.contrato_empenho AS TCE&#xd;&#xa;	                    ON TCE.cod_contrato&#x3d;TC.cod_contrato&#xd;&#xa;	                    AND TCE.exercicio&#x3d;TC.exercicio&#xd;&#xa;	                    AND TCE.cod_entidade&#x3d;TC.cod_entidade&#xd;&#xa;	                    INNER JOIN empenho.empenho AS EE&#xd;&#xa;	                    ON EE.exercicio&#x3d;TCE.exercicio_empenho&#xd;&#xa;	                    AND EE.cod_entidade&#x3d;TCE.cod_entidade&#xd;&#xa;	                    AND EE.cod_empenho&#x3d;TCE.cod_empenho&#xd;&#xa;	                    INNER JOIN empenho.pre_empenho AS EPE&#xd;&#xa;	                    ON EPE.cod_pre_empenho&#x3d;EE.cod_pre_empenho&#xd;&#xa;	                    AND EPE.exercicio&#x3d;EE.exercicio&#xd;&#xa;	                    INNER JOIN empenho.pre_empenho_despesa AS EPED&#xd;&#xa;	                    ON EPED.cod_pre_empenho&#x3d;EPE.cod_pre_empenho&#xd;&#xa;	                    AND EPED.exercicio&#x3d;EPE.exercicio&#xd;&#xa;	                    INNER JOIN orcamento.conta_despesa AS OCD&#xd;&#xa;	                    ON OCD.exercicio&#x3d;EPED.exercicio&#xd;&#xa;	                    AND OCD.cod_conta&#x3d;EPED.cod_conta&#xd;&#xa;	                    INNER JOIN orcamento.despesa AS OD&#xd;&#xa;	                    ON OD.exercicio&#x3d;EPED.exercicio AND OD.cod_despesa&#x3d;EPED.cod_despesa&#xd;&#xa;	                    INNER JOIN orcamento.programa AS OP&#xd;&#xa;	                    ON OP.cod_programa&#x3d;OD.cod_programa&#xd;&#xa;	                    AND OP.exercicio&#x3d;OD.exercicio&#xd;&#xa;	                    INNER JOIN orcamento.despesa_acao AS ODA&#xd;&#xa;	                    ON ODA.cod_despesa&#x3d;OD.cod_despesa&#xd;&#xa;	                    AND ODA.exercicio_despesa&#x3d;OD.exercicio&#xd;&#xa;	                    INNER JOIN ppa.acao AS ACAO&#xd;&#xa;	                    ON ACAO.cod_acao&#x3d;ODA.cod_acao&#xd;&#xa;	                    INNER JOIN orcamento.recurso&#xd;&#xa;	                    ON recurso.exercicio&#x3d;OD.exercicio&#xd;&#xa;	                    AND recurso.cod_recurso&#x3d;OD.cod_recurso&#xd;&#xa;	                    WHERE TC.exercicio&#x3d;  stExercicio            &#xd;&#xa;	                    AND &#x28;TC.data_inicio &#x3c;&#x3d; TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;	                        OR&#xd;&#xa;	                        TC.data_inicio BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;    &#xd;&#xa;	                        &#x29;&#xd;&#xa;	                    AND &#x28;TC.data_final &#x3e;&#x3d; TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;	                        OR&#xd;&#xa;	                        TC.data_final BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;       &#xd;&#xa;	                        &#x29;&#xd;&#xa;	                    AND TC.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;         &#xd;&#xa;	                    AND TC.cod_objeto&#x21;&#x3d;4 AND TC.cod_objeto&#x21;&#x3d;5&#xd;&#xa;	                    ORDER BY TC.nro_contrato, TC.cod_entidade&#xd;&#xa;			&#x29;,&#xd;&#xa;  		      contratos13 as &#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 13 as tipo_Registro,&#xd;&#xa;	                    &#x28;TC.exercicio&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.nro_contrato,9, &#x27;0&#x27;&#x29;&#x29;&#x29; AS codContrato,&#xd;&#xa;	                    CASE WHEN CGM.cod_pais&#x21;&#x3d;1 THEN&#xd;&#xa;	                            3&#xd;&#xa;	                    WHEN CGMPJ.cnpj IS NOT NULL THEN&#xd;&#xa;	                            2&#xd;&#xa;	                    ELSE&#xd;&#xa;	                            1&#xd;&#xa;	                    END AS tipoDocumento,&#xd;&#xa;	                    CASE WHEN CGMPJ.cnpj IS NOT NULL THEN&#xd;&#xa;	                            CGMPJ.cnpj&#xd;&#xa;	                    ELSE&#xd;&#xa;	                            CGMPF.cpf&#xd;&#xa;	                    END AS nroDocumento,&#xd;&#xa;	                    &#x28;SELECT cpf FROM sw_cgm_pessoa_fisica WHERE numcgm &#x3d; TCF.cgm_representante&#x29; AS cpfRepresentanteLegal&#xd;&#xa;	                    FROM tcemg.contrato AS TC&#xd;&#xa;	                    INNER JOIN tcemg.contrato_fornecedor AS TCF&#xd;&#xa;	                    ON TCF.cod_contrato&#x3d;TC.cod_contrato&#xd;&#xa;	                    AND TCF.exercicio&#x3d;TC.exercicio&#xd;&#xa;	                    AND TCF.cod_entidade&#x3d;TC.cod_entidade&#xd;&#xa;	                    LEFT JOIN sw_cgm_pessoa_juridica AS CGMPJ&#xd;&#xa;	                    ON CGMPJ.numcgm&#x3d;TCF.cgm_fornecedor&#xd;&#xa;	                    LEFT JOIN sw_cgm_pessoa_fisica AS CGMPF&#xd;&#xa;	                    ON CGMPF.numcgm&#x3d;TCF.cgm_fornecedor&#xd;&#xa;	                    INNER JOIN sw_cgm AS CGM&#xd;&#xa;	                    ON CGM.numcgm&#x3d;TCF.cgm_fornecedor&#xd;&#xa;	                    WHERE TC.exercicio&#x3d;  stExercicio                            &#xd;&#xa;	                    AND &#x28;TC.data_inicio &#x3c;&#x3d; TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;	                        OR&#xd;&#xa;	                        TC.data_inicio BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;&#x27;28&#x2f;02&#x2f;2015&#x27;,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;    &#xd;&#xa;	                        &#x29;&#xd;&#xa;	                    AND &#x28;TC.data_final &#x3e;&#x3d; TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;           &#xd;&#xa;	                        OR&#xd;&#xa;	                        TC.data_final BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;       &#xd;&#xa;	                        &#x29;&#xd;&#xa;	                    AND TC.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;	                    ORDER BY TC.nro_contrato, TC.cod_entidade&#xd;&#xa;			&#x29;,&#xd;&#xa;			  contratos20 as &#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 20 as tipo_Registro,&#xd;&#xa;	                    &#x28;TC.exercicio&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.nro_contrato,9, &#x27;0&#x27;&#x29;&#x29;&#x29; AS codContrato,&#xd;&#xa;	                    &#x28;TCA.exercicio&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TCA.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#xd;&#xa;	                    &#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TCA.nro_aditivo,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_contrato,3, &#x27;0&#x27;&#x29;&#x29;&#xd;&#xa;	                    &#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;RIGHT &#x28;TC.exercicio, 2&#x29;&#x29;&#x29; AS codAditivo,&#xd;&#xa;	                    &#x28;SELECT valor FROM administracao.configuracao_entidade&#xd;&#xa;	                                   WHERE exercicio&#x3d;TCA.exercicio&#xd;&#xa;	                                   AND parametro&#x3d;&#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                                   AND cod_entidade&#x3d;TCA.cod_entidade&#x29;&#xd;&#xa;	                    AS codOrgao,&#xd;&#xa;	                    LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TCA.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TCA.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29; AS codUnidadeSub,&#xd;&#xa;	                    TC.nro_contrato AS nroContrato,&#xd;&#xa;	                    to_char&#x28;TC.data_assinatura, &#x27;ddmmyyyy&#x27;&#x29; AS dataAssinaturaContrato,&#xd;&#xa;	                    TCA.nro_aditivo AS nroAditivo,&#xd;&#xa;	                    to_char&#x28;TCA.data_assinatura, &#x27;ddmmyyyy&#x27;&#x29; AS dataAssinaturaAditivo,&#xd;&#xa;	                    TCA.cod_tipo_valor AS alteracaoValor,&#xd;&#xa;	                    LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TCA.cod_tipo_aditivo,2, &#x27;0&#x27;&#x29; AS tipoTermoAditivo,&#xd;&#xa;	                    TCA.descricao AS dscAlteracao,&#xd;&#xa;	                    to_char&#x28;TCA.data_termino, &#x27;ddmmyyyy&#x27;&#x29; AS novaDataTermino,&#xd;&#xa;	                    REPLACE&#x28;TCA.valor&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29; AS valorAditivo,&#xd;&#xa;	                    to_char&#x28;TCA.data_publicacao, &#x27;ddmmyyyy&#x27;&#x29; AS dataPublicacao,&#xd;&#xa;	                    sw_cgm.nom_cgm AS veiculoDivulgacao&#xd;&#xa;	                    FROM tcemg.contrato AS TC&#xd;&#xa;	                    INNER JOIN tcemg.contrato_aditivo AS TCA&#xd;&#xa;	                    ON TCA.cod_contrato&#x3d;TC.cod_contrato&#xd;&#xa;	                    AND TCA.exercicio_contrato&#x3d;TC.exercicio&#xd;&#xa;	                    AND TCA.cod_entidade_contrato&#x3d;TC.cod_entidade&#xd;&#xa;	                    INNER JOIN sw_cgm&#xd;&#xa;	                    ON sw_cgm.numcgm&#x3d;TCA.cgm_publicacao&#xd;&#xa;	                    WHERE TC.exercicio&#x3d; stExercicio &#xd;&#xa;	                    AND &#x28;TC.data_inicio &#x3c;&#x3d; TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;	                        OR&#xd;&#xa;	                        TC.data_inicio BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;    &#xd;&#xa;	                        &#x29;&#xd;&#xa;	                    AND &#x28;TC.data_final &#x3e;&#x3d; TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;             &#xd;&#xa;	                        OR&#xd;&#xa;	                        TC.data_final BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;	                        &#x29;&#xd;&#xa;	                    AND TC.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                   &#xd;&#xa;	                    ORDER BY TC.nro_contrato, TC.cod_entidade, TCA.nro_aditivo&#xd;&#xa;			&#x29;,&#xd;&#xa;			  contratos21 as &#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 21 as tipo_Registro,&#xd;&#xa;	                    &#x28;TC.exercicio&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.nro_contrato,9, &#x27;0&#x27;&#x29;&#x29;&#x29; AS codContrato,&#xd;&#xa;	                    &#x28;TCA.exercicio&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TCA.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#xd;&#xa;	                    &#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TCA.nro_aditivo,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_contrato,3, &#x27;0&#x27;&#x29;&#x29;&#xd;&#xa;	                    &#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;RIGHT &#x28;TC.exercicio, 2&#x29;&#x29;&#x29; AS codAditivo,&#xd;&#xa;	                    EITEM.cod_item AS codItem,&#xd;&#xa;	                    CASE WHEN TCA.cod_tipo_aditivo&#x3d;9 THEN&#xd;&#xa;	                            1&#xd;&#xa;	                    WHEN TCA.cod_tipo_aditivo&#x3d;10 THEN&#xd;&#xa;	                            2&#xd;&#xa;	                    ElSE&#xd;&#xa;	                            TCAITEM.tipo_acresc_decresc&#xd;&#xa;	                    END AS tipoAlteracaoItem,&#xd;&#xa;	                    REPLACE&#x28;ROUND&#x28;TCAITEM.quantidade, 4&#x29;&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29; AS quantidade,&#xd;&#xa;	                    REPLACE&#x28;ROUND&#x28;&#x28;EITEM.vl_total&#x2f;EITEM.quantidade&#x29;, 4&#x29;&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29; AS valorUnitario&#xd;&#xa;	                    FROM tcemg.contrato AS TC&#xd;&#xa;	                    INNER JOIN tcemg.contrato_aditivo AS TCA&#xd;&#xa;	                    ON TCA.cod_contrato&#x3d;TC.cod_contrato&#xd;&#xa;	                    AND TCA.exercicio_contrato&#x3d;TC.exercicio&#xd;&#xa;	                    AND TCA.cod_entidade_contrato&#x3d;TC.cod_entidade&#xd;&#xa;	                    INNER JOIN tcemg.contrato_aditivo_item AS TCAITEM&#xd;&#xa;	                    ON TCAITEM.cod_contrato_aditivo&#x3d;TCA.cod_contrato_aditivo&#xd;&#xa;	                    AND TCAITEM.exercicio&#x3d;TCA.exercicio&#xd;&#xa;	                    AND TCAITEM.cod_entidade &#x3d;TCA.cod_entidade&#xd;&#xa;	                    INNER JOIN empenho.item_pre_empenho AS EITEM&#xd;&#xa;	                    ON EITEM.exercicio&#x3d;TCAITEM.exercicio_pre_empenho&#xd;&#xa;	                    AND EITEM.cod_pre_empenho&#x3d;TCAITEM.cod_pre_empenho&#xd;&#xa;	                    AND EITEM.num_item&#x3d;TCAITEM.num_item&#xd;&#xa;	                    WHERE TC.exercicio&#x3d; stExercicio                                       &#xd;&#xa;	                    AND &#x28;TC.data_inicio &#x3c;&#x3d; TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;             &#xd;&#xa;	                        OR&#xd;&#xa;	                        TC.data_inicio BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;	                        &#x29;&#xd;&#xa;	                    AND &#x28;TC.data_final &#x3e;&#x3d; TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                  &#xd;&#xa;	                        OR&#xd;&#xa;	                        TC.data_final BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;       &#xd;&#xa;	                        &#x29;&#xd;&#xa;	                    AND TC.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;           &#xd;&#xa;&#xd;&#xa;	                    ORDER BY TC.nro_contrato, TC.cod_entidade, TCA.nro_aditivo&#xd;&#xa;			&#x29;,&#xd;&#xa;  		      contratos30 as &#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 30 as tipo_Registro,&#xd;&#xa;	                    &#x28;TC.exercicio&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.nro_contrato,9, &#x27;0&#x27;&#x29;&#x29;&#x29; AS codContrato,&#xd;&#xa;	                    &#x28;SELECT valor FROM administracao.configuracao_entidade&#xd;&#xa;	                                   WHERE exercicio&#x3d;TCA.exercicio&#xd;&#xa;	                                   AND parametro&#x3d;&#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                                   AND cod_entidade&#x3d;TCA.cod_entidade&#x29;&#xd;&#xa;	                    AS codOrgao,&#xd;&#xa;	                    LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29; AS codUnidadeSub,&#xd;&#xa;	                    TC.nro_contrato AS nroContrato,&#xd;&#xa;	                    to_char&#x28;TC.data_assinatura, &#x27;ddmmyyyy&#x27;&#x29; AS dataAssinaturaContrato,&#xd;&#xa;	                    LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TCA.cod_tipo,2, &#x27;0&#x27;&#x29; AS tipoApostila,&#xd;&#xa;	                    TCA.cod_apostila AS nroApostila,&#xd;&#xa;	                    to_char&#x28;TCA.data_apostila, &#x27;ddmmyyyy&#x27;&#x29; AS dataApostila,&#xd;&#xa;	                    TCA.cod_alteracao AS tipoAlteracaoApostila,&#xd;&#xa;	                    TCA.descricao AS dscAlteracao,&#xd;&#xa;	                    REPLACE&#x28;TCA.valor_apostila&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29; AS valorApostila&#xd;&#xa;	                    FROM tcemg.contrato AS TC&#xd;&#xa;	                    INNER JOIN tcemg.contrato_apostila AS TCA&#xd;&#xa;	                    ON TCA.cod_contrato&#x3d;TC.cod_contrato&#xd;&#xa;	                    AND TCA.exercicio&#x3d;TC.exercicio&#xd;&#xa;	                    AND TCA.cod_entidade&#x3d;TC.cod_entidade&#xd;&#xa;	                    WHERE TC.exercicio&#x3d;  stExercicio                            &#xd;&#xa;	                    AND &#x28;TC.data_inicio &#x3c;&#x3d; TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;	                        OR&#xd;&#xa;	                        TC.data_inicio BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;	                        &#x29;&#xd;&#xa;	                    AND &#x28;TC.data_final &#x3e;&#x3d; TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;    &#xd;&#xa;	                        OR&#xd;&#xa;	                        TC.data_final BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;	                        &#x29;&#xd;&#xa;	                    AND TC.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;         &#xd;&#xa;	                    ORDER BY TC.nro_contrato, TC.cod_entidade&#xd;&#xa;			&#x29;,&#xd;&#xa;  		      contratos40 as &#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 40 as tipo_Registro,&#xd;&#xa;	                    &#x28;TC.exercicio&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.cod_entidade,2, &#x27;0&#x27;&#x29;&#x29;&#x7c;&#x7c;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.nro_contrato,9, &#x27;0&#x27;&#x29;&#x29;&#x29; AS codContrato,&#xd;&#xa;	                    &#x28;SELECT valor FROM administracao.configuracao_entidade&#xd;&#xa;	                                   WHERE exercicio&#x3d;TC.exercicio&#xd;&#xa;	                                   AND parametro&#x3d;&#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                                   AND cod_entidade&#x3d;TC.cod_entidade&#x29;&#xd;&#xa;	                    AS codOrgao,&#xd;&#xa;	                    LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;TC.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29; AS codUnidadeSub,&#xd;&#xa;	                    TC.nro_contrato AS nroContrato,&#xd;&#xa;	                    to_char&#x28;TC.data_assinatura, &#x27;ddmmyyyy&#x27;&#x29; AS dataAssinaturaContrato,&#xd;&#xa;	                    to_char&#x28;TCR.data_rescisao, &#x27;ddmmyyyy&#x27;&#x29; AS dataRescisao,&#xd;&#xa;	                    REPLACE&#x28;TCR.valor_rescisao&#x3a;&#x3a;TEXT, &#x27;.&#x27;, &#x27;,&#x27;&#x29; AS valorRescisao&#xd;&#xa;	                    FROM tcemg.contrato AS TC&#xd;&#xa;	                    INNER JOIN tcemg.contrato_rescisao AS TCR&#xd;&#xa;	                    ON TCR.cod_contrato&#x3d;TC.cod_contrato&#xd;&#xa;	                    AND TCR.exercicio&#x3d;TC.exercicio&#xd;&#xa;	                    AND TCR.cod_entidade&#x3d;TC.cod_entidade&#xd;&#xa;	                    WHERE TC.exercicio&#x3d;  stExercicio                            &#xd;&#xa;	                    AND &#x28;TC.data_inicio &#x3c;&#x3d; TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;	                        OR&#xd;&#xa;	                        TC.data_inicio BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;	                        &#x29;&#xd;&#xa;	                    AND &#x28;TC.data_final &#x3e;&#x3d; TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;        &#xd;&#xa;	                        OR&#xd;&#xa;	                        TC.data_final BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;    &#xd;&#xa;	                        &#x29;&#xd;&#xa;	                    AND TC.cod_entidade IN  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;         &#xd;&#xa;	                    ORDER BY TC.nro_contrato, TC.cod_entidade&#xd;&#xa;			&#x29;,&#xd;&#xa;			  contratos_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							codcontrato,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; &#x28;coalesce&#x28;codcontrato&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x29;&#x3a;&#x3a;bigint  &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nrocontrato&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;exerciciocontrato&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;int&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dataassinatura&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;contdeclicitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codorgaoresp, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29; &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesubresp&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroprocesso&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;exercicioprocesso&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;int&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipoprocesso&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;naturezaobjeto&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;objetocontrato,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,500&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipoinstrumento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;datainiciovigencia&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;datafinalvigencia&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vlcontrato&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;formafornecimento&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;formapagamento&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,100&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;prazoexecucao&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,100&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;multarescisoria&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,100&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;multa_inadimplemento&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,100&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;garantia&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cpfsignatariocontratante&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 11, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;datapublicacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;veiculodivulgacao&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;  &#xd;&#xa;					as d  &#xd;&#xa;				from contratos10&#xd;&#xa;				union all   &#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							codcontrato,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codcontrato&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;coditem&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;quantidadeitem&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;valorunitarioitem&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					as d&#xd;&#xa;				from contratos11&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        codcontrato,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codcontrato&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x3a;&#x3a;bigint					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codfuncao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codsubfuncao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 3, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codprograma&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;idacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;idsubacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;naturezadespesa&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 6, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codfontrecursos&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;      &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vlrecurso&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;   &#xd;&#xa;					as d&#xd;&#xa;				from contratos12&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        codcontrato,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codcontrato&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipodocumento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nrodocumento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cpfrepresentantelegal&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,11, &#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from contratos13&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        codcontrato,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codaditivo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x3a;&#x3a;bigint					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nrocontrato&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dataassinaturacontrato&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroaditivo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;int&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dataassinaturaaditivo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;alteracaovalor&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipotermoaditivo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;dscalteracao,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,250&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;novadatatermino&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;valoraditivo&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;datapublicacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;veiculodivulgacao,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,250&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from contratos20&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        codcontrato,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codaditivo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;coditem&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipoalteracaoitem&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;quantidade&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;valorunitario&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					as d&#xd;&#xa;				from contratos21&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        codcontrato,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nrocontrato&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dataassinaturacontrato&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipoapostila&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroapostila&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dataapostila&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipoalteracaoapostila&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;dscalteracao,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,250&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;valorapostila&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from contratos30&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        codcontrato,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nrocontrato&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dataassinaturacontrato&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;datarescisao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;valorrescisao&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from contratos40   &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;CONTRATOS.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from contratos_format order by codcontrato,tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;    if strpos&#x28;stArquivos,&#x27;&#x22;DISPENSA.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then				&#xd;&#xa;  			with dispensa10 as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 10 AS tipo_registro&#xd;&#xa;	                        , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade_resp&#xd;&#xa;	                        , LPAD&#x28;orgao.valor&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; AS cod_orgao_resp&#xd;&#xa;	                        , config_licitacao.exercicio_licitacao AS exercicio_processo&#xd;&#xa;	                        , config_licitacao.num_licitacao AS num_processo&#xd;&#xa;	                        , CASE WHEN modalidade.cod_modalidade &#x3d; 8 THEN 1&#xd;&#xa;	                               WHEN modalidade.cod_modalidade &#x3d; 9 THEN 2&#xd;&#xa;	                          END AS tipo_processo&#xd;&#xa;	                        , TO_CHAR&#x28;licitacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AS dt_abertura&#xd;&#xa;	                        , remove_acentos&#x28;justificativa_razao.justificativa&#x29; AS justificativa&#xd;&#xa;	                        , remove_acentos&#x28;justificativa_razao.razao&#x29; AS razao&#xd;&#xa;	                        , TO_CHAR&#x28;licitacao.timestamp,&#x27;ddmmyyyy&#x27;&#x29; AS dt_publicacao_termo_ratificacao&#xd;&#xa;	                        , CASE WHEN tipo_objeto.cod_tipo_objeto &#x3d; 1 THEN&#xd;&#xa;	                                    CASE WHEN &#x28;SUM&#x28;cotacao_fornecedor_item.vl_cotacao&#x29; &#x3e; 15000&#x29;&#xd;&#xa;	                                         THEN 2&#xd;&#xa;	                                         ELSE 99&#xd;&#xa;	                                    END&#xd;&#xa;	                               WHEN tipo_objeto.cod_tipo_objeto &#x3d; 2 THEN&#xd;&#xa;	                                    CASE WHEN &#x28;SUM&#x28;cotacao_fornecedor_item.vl_cotacao&#x29; &#x3e; 8000&#x29;&#xd;&#xa;	                                         THEN 1&#xd;&#xa;	                                         ELSE 99&#xd;&#xa;	                                    END&#xd;&#xa;	                               WHEN tipo_objeto.cod_tipo_objeto &#x3d; 3 THEN 3&#xd;&#xa;	                               WHEN tipo_objeto.cod_tipo_objeto &#x3d; 4 THEN 3&#xd;&#xa;	                               WHEN tipo_objeto.cod_tipo_objeto &#x3d; 6&#xd;&#xa;	                               THEN 3&#xd;&#xa;	                          END AS natureza_objeto&#xd;&#xa;	                        , remove_acentos&#x28;objeto.descricao&#x29; AS objeto&#xd;&#xa;	                        , sw_cgm.nom_cgm AS veiculo_publicacao&#xd;&#xa;	                        , CASE WHEN mapa.cod_tipo_licitacao &#x3d; 2&#xd;&#xa;	                               THEN 1&#xd;&#xa;	                               WHEN mapa.cod_tipo_licitacao &#x3d; 1 OR mapa.cod_tipo_licitacao &#x3d; 3&#xd;&#xa;	                               THEN 2&#xd;&#xa;	                          END AS processo_por_lote&#xd;&#xa;	                    FROM licitacao.licitacao as licitacao&#xd;&#xa;	              INNER JOIN &#x28;SELECT &#x2a;&#xd;&#xa;	                            FROM administracao.configuracao_entidade&#xd;&#xa;	                           WHERE configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;	                             AND configuracao_entidade.parametro  &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                             AND configuracao_entidade.exercicio  &#x3d; stExercicio                               &#xd;&#xa;	                         &#x29; AS orgao&#xd;&#xa;	                      ON orgao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;	              INNER JOIN compras.modalidade&#xd;&#xa;	                      ON modalidade.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;	              INNER JOIN compras.objeto&#xd;&#xa;	                      ON objeto.cod_objeto &#x3d; licitacao.cod_objeto&#xd;&#xa;	              INNER JOIN compras.tipo_objeto&#xd;&#xa;	                      ON tipo_objeto.cod_tipo_objeto &#x3d; licitacao.cod_tipo_objeto&#xd;&#xa;	              INNER JOIN licitacao.edital&#xd;&#xa;	                      ON edital.cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;	                     AND edital.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;	                     AND edital.cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;	                     AND edital.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;	               LEFT JOIN licitacao.publicacao_edital&#xd;&#xa;	                      ON publicacao_edital.num_edital &#x3d; edital.num_edital&#xd;&#xa;	                     AND publicacao_edital.exercicio  &#x3d; edital.exercicio&#xd;&#xa;	               LEFT JOIN licitacao.veiculos_publicidade&#xd;&#xa;	                      ON veiculos_publicidade.numcgm &#x3d; publicacao_edital.numcgm&#xd;&#xa;	              INNER JOIN orcamento.entidade&#xd;&#xa;	                      ON licitacao.cod_entidade &#x3d; entidade.cod_entidade&#xd;&#xa;	                     AND licitacao.exercicio    &#x3d; entidade.exercicio&#xd;&#xa;	               LEFT JOIN sw_cgm&#xd;&#xa;	                      ON entidade.numcgm &#x3d; sw_cgm.numcgm&#xd;&#xa;	                     AND sw_cgm.numcgm &#x3d; veiculos_publicidade.numcgm&#xd;&#xa;	              INNER JOIN compras.mapa&#xd;&#xa;	                      ON mapa.exercicio &#x3d; licitacao.exercicio_mapa&#xd;&#xa;	                     AND mapa.cod_mapa &#x3d; licitacao.cod_mapa&#xd;&#xa;	              INNER JOIN compras.mapa_cotacao&#xd;&#xa;	                      ON mapa.exercicio &#x3d; mapa_cotacao.exercicio_mapa&#xd;&#xa;	                     AND mapa.cod_mapa &#x3d; mapa_cotacao.cod_mapa&#xd;&#xa;	              INNER JOIN compras.julgamento&#xd;&#xa;	                      ON julgamento.exercicio &#x3d; mapa_cotacao.exercicio_cotacao&#xd;&#xa;	                     AND julgamento.cod_cotacao &#x3d; mapa_cotacao.cod_cotacao&#xd;&#xa;	              INNER JOIN compras.julgamento_item&#xd;&#xa;	                      ON julgamento_item.exercicio &#x3d; julgamento.exercicio&#xd;&#xa;	                     AND julgamento_item.cod_cotacao &#x3d; julgamento.cod_cotacao&#xd;&#xa;	                     AND julgamento_item.ordem &#x3d; 1&#xd;&#xa;	              INNER JOIN licitacao.homologacao&#xd;&#xa;	                      ON homologacao.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;	                     AND homologacao.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;	                     AND homologacao.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;	                     AND homologacao.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;	                     AND homologacao.cod_item&#x3d;julgamento_item.cod_item&#xd;&#xa;	                     AND homologacao.lote&#x3d;julgamento_item.lote&#xd;&#xa;	               LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;	                      ON homologacao_anulada.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;	                     AND homologacao_anulada.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;	                     AND homologacao_anulada.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;	                     AND homologacao_anulada.exercicio_licitacao&#x3d;homologacao.exercicio_licitacao&#xd;&#xa;	                     AND homologacao_anulada.num_homologacao&#x3d;homologacao.num_homologacao&#xd;&#xa;	                     AND homologacao_anulada.cod_item&#x3d;homologacao.cod_item&#xd;&#xa;	                     AND homologacao_anulada.lote&#x3d;homologacao.lote&#xd;&#xa;	              INNER JOIN compras.cotacao_fornecedor_item&#xd;&#xa;	                      ON julgamento_item.exercicio &#x3d; cotacao_fornecedor_item.exercicio&#xd;&#xa;	                     AND julgamento_item.cod_cotacao &#x3d; cotacao_fornecedor_item.cod_cotacao&#xd;&#xa;	                     AND julgamento_item.cod_item &#x3d; cotacao_fornecedor_item.cod_item&#xd;&#xa;	                     AND julgamento_item.cgm_fornecedor &#x3d; cotacao_fornecedor_item.cgm_fornecedor&#xd;&#xa;	                     AND julgamento_item.lote &#x3d; cotacao_fornecedor_item.lote&#xd;&#xa;	               LEFT JOIN licitacao.justificativa_razao&#xd;&#xa;	                      ON justificativa_razao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;	                     AND justificativa_razao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;	                     AND justificativa_razao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;	                     AND justificativa_razao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;	              INNER JOIN &#x28;&#xd;&#xa;	                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;   &#xd;&#xa;																VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																   ,cod_modalidade		INTEGER&#xd;&#xa;																   ,cod_entidade		INTEGER&#xd;&#xa;																   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																   ,num_licitacao		TEXT &#x29;&#xd;&#xa;	                         &#x29; AS config_licitacao&#xd;&#xa;	                      ON config_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;	                     AND config_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;	                     AND config_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;	                     AND config_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;	                   WHERE licitacao.cod_entidade in &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;         &#xd;&#xa;	                     AND homologacao_anulada.cod_licitacao IS NULL&#xd;&#xa;	                     AND TO_DATE&#x28;homologacao.timestamp&#x3a;&#x3a;varchar,&#x27;yyyy-mm-dd&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;	                     AND &#x28; licitacao.cod_modalidade &#x3d; 8 OR licitacao.cod_modalidade &#x3d; 9 &#x29;&#xd;&#xa;	                     AND NOT EXISTS&#x28; SELECT 1&#xd;&#xa;	                                       FROM licitacao.licitacao_anulada&#xd;&#xa;	                                      WHERE licitacao_anulada.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;	                                        AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;	                                        AND licitacao_anulada.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;	                                        AND licitacao_anulada.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;	                                   &#x29;&#xd;&#xa;	                GROUP BY tipo_registro&#xd;&#xa;	                       , cod_unidade_resp&#xd;&#xa;	                       , cod_orgao_resp&#xd;&#xa;	                       , exercicio_processo&#xd;&#xa;	                       , num_processo&#xd;&#xa;	                       , tipo_processo&#xd;&#xa;	                       , dt_abertura&#xd;&#xa;	                       , dt_publicacao_termo_ratificacao&#xd;&#xa;	                       , objeto,veiculo_publicacao&#xd;&#xa;	                       , processo_por_lote&#xd;&#xa;	                       , justificativa_razao.justificativa&#xd;&#xa;	                       , justificativa_razao.razao&#xd;&#xa;	                       , tipo_objeto.cod_tipo_objeto&#xd;&#xa;	                       , config_licitacao.exercicio_licitacao&#xd;&#xa;	                       , config_licitacao.num_licitacao&#xd;&#xa;	                ORDER BY num_processo&#xd;&#xa;			&#x29;, &#xd;&#xa;			  dispensa11 as &#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT 11 AS tipo_registro&#xd;&#xa;			                 , LPAD&#x28;orgao.valor&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; AS cod_orgao_resp&#xd;&#xa;			                 , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade_resp&#xd;&#xa;			                 , config_licitacao.exercicio_licitacao AS exercicio_processo&#xd;&#xa;			                 , config_licitacao.num_licitacao AS num_processo&#xd;&#xa;			                 , CASE WHEN modalidade.cod_modalidade &#x3d; 8&#xd;&#xa;			                        THEN 1&#xd;&#xa;			                        WHEN modalidade.cod_modalidade &#x3d; 9&#xd;&#xa;			                        THEN 2&#xd;&#xa;			                   END AS tipo_processo&#xd;&#xa;			                 , mapa_cotacao.cod_cotacao&#x3a;&#x3a;INTEGER AS num_lote&#xd;&#xa;			                 , &#x27;Lote n.&#x27;&#x7c;&#x7c;mapa_cotacao.cod_cotacao&#x3a;&#x3a;VARCHAR AS desc_lote&#xd;&#xa;			            FROM licitacao.licitacao&#xd;&#xa;			      INNER JOIN &#x28;SELECT &#x2a;&#xd;&#xa;			                    FROM administracao.configuracao_entidade&#xd;&#xa;			                   WHERE configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;			                     AND configuracao_entidade.parametro  &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			                     AND configuracao_entidade.exercicio  &#x3d;  stExercicio                               &#xd;&#xa;			                 &#x29; AS orgao&#xd;&#xa;			              ON orgao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			      INNER JOIN compras.objeto&#xd;&#xa;			              ON objeto.cod_objeto &#x3d; licitacao.cod_objeto&#xd;&#xa;			      INNER JOIN sw_processo&#xd;&#xa;			              ON sw_processo.cod_processo &#x3d; licitacao.cod_processo&#xd;&#xa;			             AND sw_processo.ano_exercicio &#x3d; licitacao.exercicio_processo&#xd;&#xa;			      INNER JOIN compras.modalidade&#xd;&#xa;			              ON modalidade.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			      INNER JOIN compras.tipo_objeto&#xd;&#xa;			              ON tipo_objeto.cod_tipo_objeto &#x3d; licitacao.cod_tipo_objeto&#xd;&#xa;			      INNER JOIN licitacao.edital&#xd;&#xa;			              ON edital.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND edital.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			             AND edital.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND edital.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;			       LEFT JOIN licitacao.publicacao_edital&#xd;&#xa;			              ON publicacao_edital.num_edital &#x3d; edital.num_edital&#xd;&#xa;			             AND publicacao_edital.exercicio &#x3d; edital.exercicio&#xd;&#xa;			       LEFT JOIN sw_cgm AS responsavel&#xd;&#xa;			              ON responsavel.numcgm &#x3d; edital.responsavel_juridico&#xd;&#xa;			       LEFT JOIN sw_cgm_pessoa_fisica&#xd;&#xa;			              ON sw_cgm_pessoa_fisica.numcgm &#x3d; responsavel.numcgm&#xd;&#xa;			      INNER JOIN sw_municipio&#xd;&#xa;			              ON sw_municipio.cod_municipio &#x3d; responsavel.cod_municipio&#xd;&#xa;			             AND sw_municipio.cod_uf &#x3d; responsavel.cod_uf&#xd;&#xa;			      INNER JOIN sw_uf&#xd;&#xa;			              ON sw_uf.cod_uf &#x3d; sw_municipio.cod_uf&#xd;&#xa;			      INNER JOIN compras.mapa&#xd;&#xa;			              ON mapa.exercicio &#x3d; licitacao.exercicio_mapa&#xd;&#xa;			             AND mapa.cod_mapa &#x3d; licitacao.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_cotacao&#xd;&#xa;			              ON mapa.exercicio &#x3d; mapa_cotacao.exercicio_mapa&#xd;&#xa;			             AND mapa.cod_mapa &#x3d; mapa_cotacao.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_solicitacao&#xd;&#xa;			              ON mapa_solicitacao.exercicio &#x3d; mapa.exercicio&#xd;&#xa;			             AND mapa_solicitacao.cod_mapa &#x3d; mapa.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_item&#xd;&#xa;			              ON mapa_item.cod_mapa &#x3d; mapa_solicitacao.cod_mapa&#xd;&#xa;			             AND mapa_item.exercicio &#x3d; mapa_solicitacao.exercicio&#xd;&#xa;			             AND mapa_item.cod_entidade &#x3d; mapa_solicitacao.cod_entidade&#xd;&#xa;			             AND mapa_item.cod_solicitacao &#x3d; mapa_solicitacao.cod_solicitacao&#xd;&#xa;			             AND mapa_item.exercicio_solicitacao &#x3d; mapa_solicitacao.exercicio_solicitacao&#xd;&#xa;			      INNER JOIN compras.julgamento&#xd;&#xa;			              ON julgamento.exercicio &#x3d; mapa_cotacao.exercicio_cotacao&#xd;&#xa;			             AND julgamento.cod_cotacao &#x3d; mapa_cotacao.cod_cotacao&#xd;&#xa;			      INNER JOIN compras.julgamento_item&#xd;&#xa;			              ON julgamento_item.exercicio &#x3d; julgamento.exercicio&#xd;&#xa;			             AND julgamento_item.cod_cotacao &#x3d; julgamento.cod_cotacao&#xd;&#xa;			             AND julgamento_item.cod_item &#x3d; mapa_item.cod_item&#xd;&#xa;			             AND julgamento_item.ordem &#x3d; 1&#xd;&#xa;			      INNER JOIN licitacao.homologacao&#xd;&#xa;			              ON homologacao.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;			             AND homologacao.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;			             AND homologacao.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;			             AND homologacao.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;			             AND homologacao.cod_item&#x3d;julgamento_item.cod_item&#xd;&#xa;			             AND homologacao.lote&#x3d;julgamento_item.lote&#xd;&#xa;			       LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;			              ON homologacao_anulada.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;			             AND homologacao_anulada.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;			             AND homologacao_anulada.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;			             AND homologacao_anulada.exercicio_licitacao&#x3d;homologacao.exercicio_licitacao&#xd;&#xa;			             AND homologacao_anulada.num_homologacao&#x3d;homologacao.num_homologacao&#xd;&#xa;			             AND homologacao_anulada.cod_item&#x3d;homologacao.cod_item&#xd;&#xa;			             AND homologacao_anulada.lote&#x3d;homologacao.lote&#xd;&#xa;			      INNER JOIN &#x28;&#xd;&#xa;			                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;        &#xd;&#xa;																		VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																		   ,cod_modalidade		INTEGER&#xd;&#xa;																		   ,cod_entidade		INTEGER&#xd;&#xa;																		   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																		   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																		   ,num_licitacao		TEXT &#x29;&#xd;&#xa;			                 &#x29; AS config_licitacao&#xd;&#xa;			              ON config_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND config_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND config_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			             AND config_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			           WHERE licitacao.cod_entidade in &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;      &#xd;&#xa;			             AND homologacao_anulada.cod_licitacao IS NULL&#xd;&#xa;			             AND TO_DATE&#x28;homologacao.timestamp&#x3a;&#x3a;varchar,&#x27;yyyy-mm-dd&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;			             AND &#x28; licitacao.cod_modalidade &#x3d; 8 OR licitacao.cod_modalidade &#x3d; 9 &#x29;&#xd;&#xa;			             AND NOT EXISTS&#x28; SELECT 1&#xd;&#xa;			                               FROM licitacao.licitacao_anulada&#xd;&#xa;			                              WHERE licitacao_anulada.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                                AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                                AND licitacao_anulada.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			                                AND licitacao_anulada.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			                 &#x29;&#xd;&#xa;			        GROUP BY tipo_registro&#xd;&#xa;			               , cod_orgao_resp&#xd;&#xa;			               , cod_unidade_resp&#xd;&#xa;			               , tipo_processo&#xd;&#xa;			               , num_lote&#xd;&#xa;			               , desc_lote&#xd;&#xa;			               , config_licitacao.exercicio_licitacao&#xd;&#xa;			               , config_licitacao.num_licitacao&#xd;&#xa;			        ORDER BY num_processo&#xd;&#xa;			&#x29;,&#xd;&#xa;			  dispensa12 as &#xd;&#xa;			&#x28;&#xd;&#xa;			          SELECT 12 AS tipo_registro&#xd;&#xa;			               , LPAD&#x28;orgao.valor&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; AS cod_orgao_resp&#xd;&#xa;			               , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade_resp&#xd;&#xa;			               , config_licitacao.exercicio_licitacao AS exercicio_processo&#xd;&#xa;			               , config_licitacao.num_licitacao AS num_processo&#xd;&#xa;			               , CASE WHEN modalidade.cod_modalidade &#x3d; 8&#xd;&#xa;			                      THEN 1&#xd;&#xa;			                      WHEN modalidade.cod_modalidade &#x3d; 9&#xd;&#xa;			                      THEN 2&#xd;&#xa;			                  END AS tipo_processo&#xd;&#xa;			               , mapa_item.cod_item AS cod_item&#xd;&#xa;			               , substring&#x28;mapa_item.cod_item&#x3a;&#x3a;VARCHAR FROM &#x27;.....&#x24;&#x27;&#x29; AS num_item&#xd;&#xa;			            FROM licitacao.licitacao&#xd;&#xa;			      INNER JOIN &#x28;SELECT &#x2a;&#xd;&#xa;			                    FROM administracao.configuracao_entidade&#xd;&#xa;			                   WHERE configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;			                     AND configuracao_entidade.parametro  &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			                     AND configuracao_entidade.exercicio  &#x3d; stExercicio                              &#xd;&#xa;			                 &#x29; AS orgao&#xd;&#xa;			              ON orgao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			      INNER JOIN compras.objeto&#xd;&#xa;			              ON objeto.cod_objeto &#x3d; licitacao.cod_objeto&#xd;&#xa;			      INNER JOIN sw_processo&#xd;&#xa;			              ON sw_processo.cod_processo &#x3d; licitacao.cod_processo&#xd;&#xa;			             AND sw_processo.ano_exercicio &#x3d; licitacao.exercicio_processo&#xd;&#xa;			      INNER JOIN compras.modalidade&#xd;&#xa;			              ON modalidade.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			      INNER JOIN compras.tipo_objeto&#xd;&#xa;			              ON tipo_objeto.cod_tipo_objeto &#x3d; licitacao.cod_tipo_objeto&#xd;&#xa;			      INNER JOIN licitacao.edital&#xd;&#xa;			              ON edital.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND edital.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			             AND edital.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND edital.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;			       LEFT JOIN licitacao.publicacao_edital&#xd;&#xa;			              ON publicacao_edital.num_edital &#x3d; edital.num_edital&#xd;&#xa;			             AND publicacao_edital.exercicio &#x3d; edital.exercicio&#xd;&#xa;			      INNER JOIN compras.mapa&#xd;&#xa;			              ON mapa.exercicio &#x3d; licitacao.exercicio_mapa&#xd;&#xa;			             AND mapa.cod_mapa &#x3d; licitacao.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_cotacao&#xd;&#xa;			              ON mapa.exercicio &#x3d; mapa_cotacao.exercicio_mapa&#xd;&#xa;			             AND mapa.cod_mapa &#x3d; mapa_cotacao.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_solicitacao&#xd;&#xa;			              ON mapa_solicitacao.exercicio &#x3d; mapa.exercicio&#xd;&#xa;			             AND mapa_solicitacao.cod_mapa &#x3d; mapa.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_item&#xd;&#xa;			              ON mapa_item.cod_mapa &#x3d; mapa_solicitacao.cod_mapa&#xd;&#xa;			             AND mapa_item.exercicio &#x3d; mapa_solicitacao.exercicio&#xd;&#xa;			             AND mapa_item.cod_entidade &#x3d; mapa_solicitacao.cod_entidade&#xd;&#xa;			             AND mapa_item.cod_solicitacao &#x3d; mapa_solicitacao.cod_solicitacao&#xd;&#xa;			             AND mapa_item.exercicio_solicitacao &#x3d; mapa_solicitacao.exercicio_solicitacao&#xd;&#xa;			      INNER JOIN compras.julgamento&#xd;&#xa;			              ON julgamento.exercicio &#x3d; mapa_cotacao.exercicio_cotacao&#xd;&#xa;			             AND julgamento.cod_cotacao &#x3d; mapa_cotacao.cod_cotacao&#xd;&#xa;			      INNER JOIN compras.julgamento_item&#xd;&#xa;			              ON julgamento_item.exercicio &#x3d; julgamento.exercicio&#xd;&#xa;			             AND julgamento_item.cod_cotacao &#x3d; julgamento.cod_cotacao&#xd;&#xa;			             AND julgamento_item.cod_item &#x3d; mapa_item.cod_item&#xd;&#xa;			             AND julgamento_item.ordem &#x3d; 1&#xd;&#xa;			      INNER JOIN licitacao.homologacao&#xd;&#xa;			              ON homologacao.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;			             AND homologacao.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;			             AND homologacao.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;			             AND homologacao.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;			             AND homologacao.cod_item&#x3d;julgamento_item.cod_item&#xd;&#xa;			             AND homologacao.lote&#x3d;julgamento_item.lote&#xd;&#xa;			       LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;			              ON homologacao_anulada.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;			             AND homologacao_anulada.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;			             AND homologacao_anulada.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;			             AND homologacao_anulada.exercicio_licitacao&#x3d;homologacao.exercicio_licitacao&#xd;&#xa;			             AND homologacao_anulada.num_homologacao&#x3d;homologacao.num_homologacao&#xd;&#xa;			             AND homologacao_anulada.cod_item&#x3d;homologacao.cod_item&#xd;&#xa;			             AND homologacao_anulada.lote&#x3d;homologacao.lote&#xd;&#xa;			      INNER JOIN &#x28;&#xd;&#xa;			                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;            &#xd;&#xa;																		VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																		   ,cod_modalidade		INTEGER&#xd;&#xa;																		   ,cod_entidade		INTEGER&#xd;&#xa;																		   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																		   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																		   ,num_licitacao		TEXT &#x29;&#xd;&#xa;			                 &#x29; AS config_licitacao&#xd;&#xa;			              ON config_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND config_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND config_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			             AND config_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			           WHERE licitacao.cod_entidade in &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;      &#xd;&#xa;			             AND homologacao_anulada.cod_licitacao IS NULL&#xd;&#xa;			             AND TO_DATE&#x28;homologacao.timestamp&#x3a;&#x3a;varchar,&#x27;yyyy-mm-dd&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;    &#xd;&#xa;			             AND &#x28; licitacao.cod_modalidade &#x3d; 8 OR licitacao.cod_modalidade &#x3d; 9 &#x29;&#xd;&#xa;			             AND NOT EXISTS&#x28; SELECT 1&#xd;&#xa;			                               FROM licitacao.licitacao_anulada&#xd;&#xa;			                              WHERE licitacao_anulada.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                                AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                                AND licitacao_anulada.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			                                AND licitacao_anulada.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			                            &#x29;&#xd;&#xa;			        GROUP BY tipo_registro&#xd;&#xa;			               , cod_orgao_resp&#xd;&#xa;			               , cod_unidade_resp&#xd;&#xa;			               , config_licitacao.exercicio_licitacao&#xd;&#xa;			               , config_licitacao.num_licitacao&#xd;&#xa;			               , tipo_processo&#xd;&#xa;			               , mapa_item.cod_item&#xd;&#xa;			        ORDER BY num_processo&#xd;&#xa;			&#x29;,&#xd;&#xa;  		      dispensa13 as &#xd;&#xa;			&#x28;&#xd;&#xa;		            SELECT 13 AS tipo_registro&#xd;&#xa;			                 , LPAD&#x28;orgao.valor&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; AS cod_orgao_resp&#xd;&#xa;			                 , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade_resp&#xd;&#xa;			                 , config_licitacao.exercicio_licitacao AS exercicio_processo&#xd;&#xa;			                 , config_licitacao.num_licitacao AS num_processo&#xd;&#xa;			                 , CASE WHEN modalidade.cod_modalidade &#x3d; 8 THEN 1&#xd;&#xa;			                        WHEN modalidade.cod_modalidade &#x3d; 9 THEN 2&#xd;&#xa;			                   END AS tipo_processo&#xd;&#xa;			                 , CASE WHEN mapa.cod_tipo_licitacao &#x3d; 2&#xd;&#xa;			                        THEN mapa_cotacao.cod_cotacao&#x3a;&#x3a;VARCHAR&#xd;&#xa;			                        ELSE &#x27; &#x27;&#xd;&#xa;			                    END AS num_lote&#xd;&#xa;			                 , mapa_item.cod_item AS cod_item&#xd;&#xa;			            FROM licitacao.licitacao&#xd;&#xa;			      INNER JOIN &#x28;SELECT &#x2a;&#xd;&#xa;			                    FROM administracao.configuracao_entidade&#xd;&#xa;			                   WHERE configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;			                     AND configuracao_entidade.parametro  &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			                     AND configuracao_entidade.exercicio  &#x3d; stExercicio                               &#xd;&#xa;			                 &#x29; AS orgao&#xd;&#xa;			              ON orgao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			      INNER JOIN compras.objeto&#xd;&#xa;			              ON objeto.cod_objeto &#x3d; licitacao.cod_objeto&#xd;&#xa;			      INNER JOIN sw_processo&#xd;&#xa;			              ON sw_processo.cod_processo &#x3d; licitacao.cod_processo&#xd;&#xa;			             AND sw_processo.ano_exercicio &#x3d; licitacao.exercicio_processo&#xd;&#xa;			      INNER JOIN compras.modalidade&#xd;&#xa;			              ON modalidade.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			      INNER JOIN compras.tipo_objeto&#xd;&#xa;			              ON tipo_objeto.cod_tipo_objeto &#x3d; licitacao.cod_tipo_objeto&#xd;&#xa;			      INNER JOIN licitacao.edital&#xd;&#xa;			              ON edital.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND edital.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			             AND edital.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND edital.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;			       LEFT JOIN licitacao.publicacao_edital&#xd;&#xa;			              ON publicacao_edital.num_edital &#x3d; edital.num_edital&#xd;&#xa;			             AND publicacao_edital.exercicio &#x3d; edital.exercicio&#xd;&#xa;			      INNER JOIN sw_cgm AS responsavel&#xd;&#xa;			              ON responsavel.numcgm &#x3d; edital.responsavel_juridico&#xd;&#xa;			      INNER JOIN sw_cgm_pessoa_fisica&#xd;&#xa;			              ON sw_cgm_pessoa_fisica.numcgm &#x3d; responsavel.numcgm&#xd;&#xa;			      INNER JOIN sw_municipio&#xd;&#xa;			              ON sw_municipio.cod_municipio &#x3d; responsavel.cod_municipio&#xd;&#xa;			             AND sw_municipio.cod_uf &#x3d; responsavel.cod_uf&#xd;&#xa;			      INNER JOIN sw_uf&#xd;&#xa;			              ON sw_uf.cod_uf &#x3d; sw_municipio.cod_uf&#xd;&#xa;			      INNER JOIN compras.mapa&#xd;&#xa;			              ON mapa.exercicio &#x3d; licitacao.exercicio_mapa&#xd;&#xa;			             AND mapa.cod_mapa &#x3d; licitacao.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_cotacao&#xd;&#xa;			              ON mapa.exercicio &#x3d; mapa_cotacao.exercicio_mapa&#xd;&#xa;			             AND mapa.cod_mapa &#x3d; mapa_cotacao.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_solicitacao&#xd;&#xa;			              ON mapa_solicitacao.exercicio &#x3d; mapa.exercicio&#xd;&#xa;			             AND mapa_solicitacao.cod_mapa &#x3d; mapa.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_item&#xd;&#xa;			              ON mapa_item.cod_mapa &#x3d; mapa_solicitacao.cod_mapa&#xd;&#xa;			             AND mapa_item.exercicio &#x3d; mapa_solicitacao.exercicio&#xd;&#xa;			             AND mapa_item.cod_entidade &#x3d; mapa_solicitacao.cod_entidade&#xd;&#xa;			             AND mapa_item.cod_solicitacao &#x3d; mapa_solicitacao.cod_solicitacao&#xd;&#xa;			             AND mapa_item.exercicio_solicitacao &#x3d; mapa_solicitacao.exercicio_solicitacao&#xd;&#xa;			      INNER JOIN compras.julgamento&#xd;&#xa;			              ON julgamento.exercicio &#x3d; mapa_cotacao.exercicio_cotacao&#xd;&#xa;			             AND julgamento.cod_cotacao &#x3d; mapa_cotacao.cod_cotacao&#xd;&#xa;			      INNER JOIN compras.julgamento_item&#xd;&#xa;			              ON julgamento_item.exercicio &#x3d; julgamento.exercicio&#xd;&#xa;			             AND julgamento_item.cod_cotacao &#x3d; julgamento.cod_cotacao&#xd;&#xa;			             AND julgamento_item.cod_item &#x3d; mapa_item.cod_item&#xd;&#xa;			             AND julgamento_item.ordem &#x3d; 1&#xd;&#xa;			      INNER JOIN licitacao.homologacao&#xd;&#xa;			              ON homologacao.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;			             AND homologacao.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;			             AND homologacao.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;			             AND homologacao.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;			             AND homologacao.cod_item&#x3d;julgamento_item.cod_item&#xd;&#xa;			             AND homologacao.lote&#x3d;julgamento_item.lote&#xd;&#xa;			       LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;			              ON homologacao_anulada.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;			             AND homologacao_anulada.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;			             AND homologacao_anulada.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;			             AND homologacao_anulada.exercicio_licitacao&#x3d;homologacao.exercicio_licitacao&#xd;&#xa;			             AND homologacao_anulada.num_homologacao&#x3d;homologacao.num_homologacao&#xd;&#xa;			             AND homologacao_anulada.cod_item&#x3d;homologacao.cod_item&#xd;&#xa;			             AND homologacao_anulada.lote&#x3d;homologacao.lote&#xd;&#xa;			      INNER JOIN &#x28;&#xd;&#xa;			                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;     &#xd;&#xa;																		VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																		   ,cod_modalidade		INTEGER&#xd;&#xa;																		   ,cod_entidade		INTEGER&#xd;&#xa;																		   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																		   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																		   ,num_licitacao		TEXT &#x29;&#xd;&#xa;			                 &#x29; AS config_licitacao&#xd;&#xa;			              ON config_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND config_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND config_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			             AND config_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			           WHERE licitacao.cod_entidade in &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;          &#xd;&#xa;			             AND homologacao_anulada.cod_licitacao IS NULL&#xd;&#xa;			             AND TO_DATE&#x28;homologacao.timestamp&#x3a;&#x3a;varchar,&#x27;yyyy-mm-dd&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;  AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;			             AND &#x28;licitacao.cod_modalidade &#x3d; 8 OR licitacao.cod_modalidade &#x3d; 9&#x29;&#xd;&#xa;			             AND NOT EXISTS&#x28; SELECT 1&#xd;&#xa;			                               FROM licitacao.licitacao_anulada&#xd;&#xa;			                              WHERE licitacao_anulada.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                                AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                                AND licitacao_anulada.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			                                AND licitacao_anulada.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			                            &#x29;&#xd;&#xa;			        GROUP BY tipo_registro&#xd;&#xa;			               , cod_orgao_resp&#xd;&#xa;			               , cod_unidade_resp&#xd;&#xa;			               , exercicio_processo&#xd;&#xa;			               , num_processo&#xd;&#xa;			               , tipo_processo&#xd;&#xa;			               , num_lote&#xd;&#xa;			               , mapa_item.cod_item&#xd;&#xa;			               , config_licitacao.exercicio_licitacao&#xd;&#xa;			               , config_licitacao.num_licitacao&#xd;&#xa;			        ORDER BY num_processo&#xd;&#xa;			&#x29;,&#xd;&#xa;			  dispensa14 as &#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT 14 AS tipo_registro&#xd;&#xa;			                 , LPAD&#x28;orgao.valor&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; AS cod_orgao_resp&#xd;&#xa;			                 , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade_resp&#xd;&#xa;			                 , config_licitacao.exercicio_licitacao AS exercicio_processo&#xd;&#xa;			                 , config_licitacao.num_licitacao AS num_processo&#xd;&#xa;			                 , CASE WHEN modalidade.cod_modalidade &#x3d; 8 THEN 1&#xd;&#xa;			                        WHEN modalidade.cod_modalidade &#x3d; 9 THEN 2&#xd;&#xa;			                   END AS tipo_processo&#xd;&#xa;			                 , 1 AS tipo_resp&#xd;&#xa;			                 , sw_cgm_pessoa_fisica.cpf AS num_cpf_resp&#xd;&#xa;			            FROM licitacao.licitacao&#xd;&#xa;			      INNER JOIN &#x28;SELECT &#x2a;&#xd;&#xa;			                    FROM administracao.configuracao_entidade&#xd;&#xa;			                   WHERE configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;			                     AND configuracao_entidade.parametro  &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			                     AND configuracao_entidade.exercicio  &#x3d; stExercicio                               &#xd;&#xa;			                 &#x29; AS orgao&#xd;&#xa;			              ON orgao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			      INNER JOIN compras.objeto&#xd;&#xa;			              ON objeto.cod_objeto &#x3d; licitacao.cod_objeto&#xd;&#xa;			      INNER JOIN sw_processo&#xd;&#xa;			              ON sw_processo.cod_processo &#x3d; licitacao.cod_processo&#xd;&#xa;			             AND sw_processo.ano_exercicio &#x3d; licitacao.exercicio_processo&#xd;&#xa;			      INNER JOIN compras.modalidade&#xd;&#xa;			              ON modalidade.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			      INNER JOIN compras.tipo_objeto&#xd;&#xa;			              ON tipo_objeto.cod_tipo_objeto &#x3d; licitacao.cod_tipo_objeto&#xd;&#xa;			      INNER JOIN licitacao.edital&#xd;&#xa;			              ON edital.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND edital.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			             AND edital.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND edital.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa; 		        LEFT JOIN licitacao.publicacao_edital&#xd;&#xa;			              ON publicacao_edital.num_edital &#x3d; edital.num_edital&#xd;&#xa;			             AND publicacao_edital.exercicio &#x3d; edital.exercicio&#xd;&#xa;			       LEFT JOIN sw_cgm AS responsavel&#xd;&#xa;			              ON responsavel.numcgm &#x3d; edital.responsavel_juridico&#xd;&#xa;			       LEFT JOIN sw_cgm_pessoa_fisica&#xd;&#xa;			              ON sw_cgm_pessoa_fisica.numcgm &#x3d; responsavel.numcgm&#xd;&#xa;			      INNER JOIN sw_municipio&#xd;&#xa;			              ON sw_municipio.cod_municipio &#x3d; responsavel.cod_municipio&#xd;&#xa;			             AND sw_municipio.cod_uf &#x3d; responsavel.cod_uf&#xd;&#xa;			      INNER JOIN sw_uf&#xd;&#xa;			              ON sw_uf.cod_uf &#x3d; sw_municipio.cod_uf&#xd;&#xa;			      INNER JOIN compras.mapa&#xd;&#xa;			              ON mapa.exercicio &#x3d; licitacao.exercicio_mapa&#xd;&#xa;			             AND mapa.cod_mapa &#x3d; licitacao.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_solicitacao&#xd;&#xa;			              ON mapa_solicitacao.exercicio &#x3d; mapa.exercicio&#xd;&#xa;			             AND mapa_solicitacao.cod_mapa &#x3d; mapa.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_cotacao&#xd;&#xa;			              ON mapa.exercicio &#x3d; mapa_cotacao.exercicio_mapa&#xd;&#xa;			             AND mapa.cod_mapa &#x3d; mapa_cotacao.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_item&#xd;&#xa;			              ON mapa_item.cod_mapa &#x3d; mapa_solicitacao.cod_mapa&#xd;&#xa;			             AND mapa_item.exercicio &#x3d; mapa_solicitacao.exercicio&#xd;&#xa;			             AND mapa_item.cod_entidade &#x3d; mapa_solicitacao.cod_entidade&#xd;&#xa;			             AND mapa_item.cod_solicitacao &#x3d; mapa_solicitacao.cod_solicitacao&#xd;&#xa;			             AND mapa_item.exercicio_solicitacao &#x3d; mapa_solicitacao.exercicio_solicitacao&#xd;&#xa;			      INNER JOIN compras.julgamento&#xd;&#xa;			              ON julgamento.exercicio &#x3d; mapa_cotacao.exercicio_cotacao&#xd;&#xa;			             AND julgamento.cod_cotacao &#x3d; mapa_cotacao.cod_cotacao&#xd;&#xa;			      INNER JOIN compras.julgamento_item&#xd;&#xa;			              ON julgamento_item.exercicio &#x3d; julgamento.exercicio&#xd;&#xa;			             AND julgamento_item.cod_cotacao &#x3d; julgamento.cod_cotacao&#xd;&#xa;			             AND julgamento_item.cod_item &#x3d; mapa_item.cod_item&#xd;&#xa;			             AND julgamento_item.ordem &#x3d; 1&#xd;&#xa;			      INNER JOIN licitacao.homologacao&#xd;&#xa;			              ON homologacao.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;			             AND homologacao.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;			             AND homologacao.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;			             AND homologacao.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;			             AND homologacao.cod_item&#x3d;julgamento_item.cod_item&#xd;&#xa;			             AND homologacao.lote&#x3d;julgamento_item.lote&#xd;&#xa;			       LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;			              ON homologacao_anulada.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;			             AND homologacao_anulada.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;			             AND homologacao_anulada.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;			             AND homologacao_anulada.exercicio_licitacao&#x3d;homologacao.exercicio_licitacao&#xd;&#xa;			             AND homologacao_anulada.num_homologacao&#x3d;homologacao.num_homologacao&#xd;&#xa;			             AND homologacao_anulada.cod_item&#x3d;homologacao.cod_item&#xd;&#xa;			             AND homologacao_anulada.lote&#x3d;homologacao.lote&#xd;&#xa;			      INNER JOIN &#x28;&#xd;&#xa;			                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;         &#xd;&#xa;																		VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																		   ,cod_modalidade		INTEGER&#xd;&#xa;																		   ,cod_entidade		INTEGER&#xd;&#xa;																		   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																		   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																		   ,num_licitacao		TEXT &#x29;&#xd;&#xa;			                 &#x29; AS config_licitacao&#xd;&#xa;			              ON config_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND config_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND config_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			             AND config_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			           WHERE licitacao.cod_entidade in &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;      &#xd;&#xa;			             AND homologacao_anulada.cod_licitacao IS NULL&#xd;&#xa;			             AND TO_DATE&#x28;homologacao.timestamp&#x3a;&#x3a;varchar,&#x27;yyyy-mm-dd&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;    AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;			             AND &#x28; licitacao.cod_modalidade &#x3d; 8 OR licitacao.cod_modalidade &#x3d; 9 &#x29;&#xd;&#xa;			             AND NOT EXISTS&#x28; SELECT 1&#xd;&#xa;			                               FROM licitacao.licitacao_anulada&#xd;&#xa;			                              WHERE licitacao_anulada.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                                AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                                AND licitacao_anulada.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			                                AND licitacao_anulada.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			                            &#x29;&#xd;&#xa;			        GROUP BY tipo_registro&#xd;&#xa;			               , cod_orgao_resp&#xd;&#xa;			               , cod_unidade_resp&#xd;&#xa;			               , config_licitacao.exercicio_licitacao&#xd;&#xa;			               , config_licitacao.num_licitacao&#xd;&#xa;			               , tipo_processo&#xd;&#xa;			               , tipo_resp&#xd;&#xa;			               , num_cpf_resp&#xd;&#xa;			        ORDER BY num_processo&#xd;&#xa;			&#x29;,&#xd;&#xa;			  dispensa15 as &#xd;&#xa;			&#x28;&#xd;&#xa;		          SELECT 15 AS tipo_registro&#xd;&#xa;			               , LPAD&#x28;orgao.valor&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; AS cod_orgao_resp&#xd;&#xa;			               , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade_resp&#xd;&#xa;			               , config_licitacao.exercicio_licitacao AS exercicio_processo&#xd;&#xa;			               , config_licitacao.num_licitacao AS num_processo&#xd;&#xa;			               , CASE WHEN modalidade.cod_modalidade &#x3d; 8 THEN 1&#xd;&#xa;			                      WHEN modalidade.cod_modalidade &#x3d; 9 THEN 2&#xd;&#xa;			                 END AS tipo_processo&#xd;&#xa;			               , mapa_item.cod_item AS cod_item&#xd;&#xa;			               , TRUNC&#x28;&#x28;mapa_item.vl_total&#x2f;mapa_item.quantidade&#x29;, 2&#x29;&#x3a;&#x3a;NUMERIC&#x28;14,4&#x29; AS vl_cot_precos_unitario&#xd;&#xa;			               , mapa_item.quantidade AS quantidade&#xd;&#xa;			               , CASE WHEN mapa.cod_tipo_licitacao &#x3d; 2&#xd;&#xa;			                      THEN mapa_cotacao.cod_cotacao&#x3a;&#x3a;VARCHAR&#xd;&#xa;			                      ELSE &#x27; &#x27;&#xd;&#xa;			                 END AS num_lote&#xd;&#xa;			            FROM licitacao.licitacao&#xd;&#xa;			      INNER JOIN &#x28;SELECT &#x2a;&#xd;&#xa;			                    FROM administracao.configuracao_entidade&#xd;&#xa;			                   WHERE configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;			                     AND configuracao_entidade.parametro  &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			                     AND configuracao_entidade.exercicio  &#x3d; stExercicio                                  &#xd;&#xa;			                 &#x29; AS orgao&#xd;&#xa;			              ON orgao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			      INNER JOIN compras.objeto&#xd;&#xa;			              ON objeto.cod_objeto &#x3d; licitacao.cod_objeto&#xd;&#xa;			      INNER JOIN sw_processo&#xd;&#xa;			              ON sw_processo.cod_processo &#x3d; licitacao.cod_processo&#xd;&#xa;			             AND sw_processo.ano_exercicio &#x3d; licitacao.exercicio_processo&#xd;&#xa;			      INNER JOIN compras.modalidade&#xd;&#xa;			              ON modalidade.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			      INNER JOIN compras.tipo_objeto&#xd;&#xa;			              ON tipo_objeto.cod_tipo_objeto &#x3d; licitacao.cod_tipo_objeto&#xd;&#xa;			      INNER JOIN licitacao.edital&#xd;&#xa;			              ON edital.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND edital.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			             AND edital.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND edital.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;			       LEFT JOIN licitacao.publicacao_edital&#xd;&#xa;			              ON publicacao_edital.num_edital &#x3d; edital.num_edital&#xd;&#xa;			             AND publicacao_edital.exercicio &#x3d; edital.exercicio&#xd;&#xa;			      INNER JOIN sw_cgm AS responsavel&#xd;&#xa;			              ON responsavel.numcgm &#x3d; edital.responsavel_juridico&#xd;&#xa;			      INNER JOIN sw_cgm_pessoa_fisica&#xd;&#xa;			              ON sw_cgm_pessoa_fisica.numcgm &#x3d; responsavel.numcgm&#xd;&#xa;			      INNER JOIN sw_municipio&#xd;&#xa;			              ON sw_municipio.cod_municipio &#x3d; responsavel.cod_municipio&#xd;&#xa;			             AND sw_municipio.cod_uf &#x3d; responsavel.cod_uf&#xd;&#xa;			      INNER JOIN sw_uf&#xd;&#xa;			              ON sw_uf.cod_uf &#x3d; sw_municipio.cod_uf&#xd;&#xa;			      INNER JOIN compras.mapa&#xd;&#xa;			              ON mapa.exercicio &#x3d; licitacao.exercicio_mapa&#xd;&#xa;			             AND mapa.cod_mapa &#x3d; licitacao.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_cotacao&#xd;&#xa;			              ON mapa.exercicio &#x3d; mapa_cotacao.exercicio_mapa&#xd;&#xa;			             AND mapa.cod_mapa &#x3d; mapa_cotacao.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_solicitacao&#xd;&#xa;			              ON mapa_solicitacao.exercicio &#x3d; mapa.exercicio&#xd;&#xa;			             AND mapa_solicitacao.cod_mapa &#x3d; mapa.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_item&#xd;&#xa;			              ON mapa_item.cod_mapa &#x3d; mapa_solicitacao.cod_mapa&#xd;&#xa;			             AND mapa_item.exercicio &#x3d; mapa_solicitacao.exercicio&#xd;&#xa;			             AND mapa_item.cod_entidade &#x3d; mapa_solicitacao.cod_entidade&#xd;&#xa;			             AND mapa_item.cod_solicitacao &#x3d; mapa_solicitacao.cod_solicitacao&#xd;&#xa;			             AND mapa_item.exercicio_solicitacao &#x3d; mapa_solicitacao.exercicio_solicitacao&#xd;&#xa;			      INNER JOIN compras.julgamento&#xd;&#xa;			              ON julgamento.exercicio &#x3d; mapa_cotacao.exercicio_cotacao&#xd;&#xa;			             AND julgamento.cod_cotacao &#x3d; mapa_cotacao.cod_cotacao&#xd;&#xa;			      INNER JOIN compras.julgamento_item&#xd;&#xa;			              ON julgamento_item.exercicio &#x3d; julgamento.exercicio&#xd;&#xa;			             AND julgamento_item.cod_cotacao &#x3d; julgamento.cod_cotacao&#xd;&#xa;			             AND julgamento_item.cod_item &#x3d; mapa_item.cod_item&#xd;&#xa;			             AND julgamento_item.ordem &#x3d; 1&#xd;&#xa;			      INNER JOIN licitacao.homologacao&#xd;&#xa;			              ON homologacao.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;			             AND homologacao.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;			             AND homologacao.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;			             AND homologacao.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;			             AND homologacao.cod_item&#x3d;julgamento_item.cod_item&#xd;&#xa;			             AND homologacao.lote&#x3d;julgamento_item.lote&#xd;&#xa;			       LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;			              ON homologacao_anulada.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;			             AND homologacao_anulada.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;			             AND homologacao_anulada.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;			             AND homologacao_anulada.exercicio_licitacao&#x3d;homologacao.exercicio_licitacao&#xd;&#xa;			             AND homologacao_anulada.num_homologacao&#x3d;homologacao.num_homologacao&#xd;&#xa;			             AND homologacao_anulada.cod_item&#x3d;homologacao.cod_item&#xd;&#xa;			             AND homologacao_anulada.lote&#x3d;homologacao.lote&#xd;&#xa;			      INNER JOIN compras.mapa_item_dotacao&#xd;&#xa;			              ON mapa_item_dotacao.exercicio &#x3d; mapa_item.exercicio&#xd;&#xa;			             AND mapa_item_dotacao.cod_mapa &#x3d; mapa_item.cod_mapa&#xd;&#xa;			             AND mapa_item_dotacao.exercicio_solicitacao &#x3d; mapa_item.exercicio_solicitacao&#xd;&#xa;			             AND mapa_item_dotacao.cod_entidade &#x3d; mapa_item.cod_entidade&#xd;&#xa;			             AND mapa_item_dotacao.cod_solicitacao &#x3d; mapa_item.cod_solicitacao&#xd;&#xa;			             AND mapa_item_dotacao.cod_centro &#x3d; mapa_item.cod_centro&#xd;&#xa;			             AND mapa_item_dotacao.cod_item &#x3d; mapa_item.cod_item&#xd;&#xa;			             AND mapa_item_dotacao.lote &#x3d; mapa_item.lote&#xd;&#xa;			      INNER JOIN orcamento.despesa&#xd;&#xa;			              ON despesa.exercicio &#x3d; mapa_item_dotacao.exercicio&#xd;&#xa;			             AND despesa.cod_despesa &#x3d; mapa_item_dotacao.cod_despesa&#xd;&#xa;			      INNER JOIN &#x28;&#xd;&#xa;			                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;    &#xd;&#xa;																		VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																		   ,cod_modalidade		INTEGER&#xd;&#xa;																		   ,cod_entidade		INTEGER&#xd;&#xa;																		   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																		   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																		   ,num_licitacao		TEXT &#x29;&#xd;&#xa;			                 &#x29; AS config_licitacao&#xd;&#xa;			              ON config_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND config_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND config_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			             AND config_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			           WHERE licitacao.cod_entidade in 	&#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;     &#xd;&#xa;			             AND homologacao_anulada.cod_licitacao IS NULL&#xd;&#xa;			             AND TO_DATE&#x28;homologacao.timestamp&#x3a;&#x3a;varchar,&#x27;yyyy-mm-dd&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;			             AND &#x28; licitacao.cod_modalidade &#x3d; 8 OR licitacao.cod_modalidade &#x3d; 9 &#x29;&#xd;&#xa;			             AND NOT EXISTS&#x28; SELECT 1&#xd;&#xa;			                              FROM licitacao.licitacao_anulada&#xd;&#xa;			                             WHERE licitacao_anulada.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                               AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                               AND licitacao_anulada.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			                               AND licitacao_anulada.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			                            &#x29;&#xd;&#xa;			        GROUP BY tipo_registro&#xd;&#xa;			               , cod_orgao_resp&#xd;&#xa;			               , cod_unidade_resp&#xd;&#xa;			               , exercicio_processo&#xd;&#xa;			               , num_processo&#xd;&#xa;			               , tipo_processo&#xd;&#xa;			               , mapa_item.cod_item&#xd;&#xa;			               , vl_cot_precos_unitario&#xd;&#xa;			               , mapa_item.quantidade&#xd;&#xa;			               , mapa_cotacao.cod_cotacao&#xd;&#xa;			               , mapa.cod_tipo_licitacao&#xd;&#xa;			               , config_licitacao.exercicio_licitacao&#xd;&#xa;			               , config_licitacao.num_licitacao&#xd;&#xa;			        ORDER BY num_processo&#xd;&#xa;			&#x29;,&#xd;&#xa;  		      dispensa16 as &#xd;&#xa;			&#x28;&#xd;&#xa;		          SELECT 16 AS tipo_registro&#xd;&#xa;			               , LPAD&#x28;orgao.valor&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; AS cod_orgao_resp&#xd;&#xa;			               , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade_resp&#xd;&#xa;			               , config_licitacao.exercicio_licitacao AS exercicio_processo&#xd;&#xa;			               , config_licitacao.num_licitacao AS num_processo&#xd;&#xa;			               , CASE WHEN modalidade.cod_modalidade &#x3d; 8 THEN 1&#xd;&#xa;			                      WHEN modalidade.cod_modalidade &#x3d; 9 THEN 2&#xd;&#xa;			                 END AS tipo_processo&#xd;&#xa;			               , LPAD&#x28;orgao.valor&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;			               , LPAD&#x28;LPAD&#x28;despesa.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;despesa.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_subunidade&#xd;&#xa;			               , LPAD&#x28;despesa.cod_funcao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; AS cod_funcao&#xd;&#xa;			               , despesa.cod_subfuncao AS cod_subfuncao&#xd;&#xa;			               , LPAD&#x28;ppa_programa.num_programa&#x3a;&#x3a;VARCHAR, 4, &#x27;0&#x27;&#x29; AS cod_programa&#xd;&#xa;			               , LPAD&#x28;&#x28;ppa_acao.num_acao&#x3a;&#x3a;varchar&#x29;, 4, &#x27;0&#x27;&#x29; AS id_acao&#xd;&#xa;			               , &#x27;0000&#x27; AS id_sub_acao&#xd;&#xa;			               , REPLACE&#x28;conta_despesa.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29; AS natureza_despesa&#xd;&#xa;			               , despesa.cod_recurso AS cod_font_recurso&#xd;&#xa;			               , despesa.vl_original vl_recurso&#xd;&#xa;			            FROM licitacao.licitacao&#xd;&#xa;			      INNER JOIN &#x28;SELECT &#x2a;&#xd;&#xa;			                    FROM administracao.configuracao_entidade&#xd;&#xa;			                   WHERE configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;			                     AND configuracao_entidade.parametro  &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			                     AND configuracao_entidade.exercicio  &#x3d; stExercicio                                &#xd;&#xa;			                 &#x29; AS orgao&#xd;&#xa;			              ON orgao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			      INNER JOIN compras.objeto&#xd;&#xa;			              ON objeto.cod_objeto &#x3d; licitacao.cod_objeto&#xd;&#xa;			      INNER JOIN sw_processo&#xd;&#xa;			              ON sw_processo.cod_processo &#x3d; licitacao.cod_processo&#xd;&#xa;			             AND sw_processo.ano_exercicio &#x3d; licitacao.exercicio_processo&#xd;&#xa;			      INNER JOIN compras.modalidade&#xd;&#xa;			              ON modalidade.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			      INNER JOIN compras.tipo_objeto&#xd;&#xa;			              ON tipo_objeto.cod_tipo_objeto &#x3d; licitacao.cod_tipo_objeto&#xd;&#xa;			      INNER JOIN licitacao.edital&#xd;&#xa;			              ON edital.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND edital.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			             AND edital.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND edital.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;			       LEFT JOIN licitacao.publicacao_edital&#xd;&#xa;			              ON publicacao_edital.num_edital &#x3d; edital.num_edital&#xd;&#xa;			             AND publicacao_edital.exercicio &#x3d; edital.exercicio&#xd;&#xa;			       LEFT JOIN sw_cgm AS responsavel&#xd;&#xa;			              ON responsavel.numcgm &#x3d; edital.responsavel_juridico&#xd;&#xa;			       LEFT JOIN sw_cgm_pessoa_fisica&#xd;&#xa;			              ON sw_cgm_pessoa_fisica.numcgm &#x3d; responsavel.numcgm&#xd;&#xa;			      INNER JOIN sw_municipio&#xd;&#xa;			              ON sw_municipio.cod_municipio &#x3d; responsavel.cod_municipio&#xd;&#xa;			             AND sw_municipio.cod_uf &#x3d; responsavel.cod_uf&#xd;&#xa;			      INNER JOIN sw_uf&#xd;&#xa;			              ON sw_uf.cod_uf &#x3d; sw_municipio.cod_uf&#xd;&#xa;			      INNER JOIN compras.mapa&#xd;&#xa;			              ON mapa.exercicio &#x3d; licitacao.exercicio_mapa&#xd;&#xa;			             AND mapa.cod_mapa &#x3d; licitacao.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_cotacao&#xd;&#xa;			              ON mapa.exercicio &#x3d; mapa_cotacao.exercicio_mapa&#xd;&#xa;			             AND mapa.cod_mapa &#x3d; mapa_cotacao.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_solicitacao&#xd;&#xa;			              ON mapa_solicitacao.exercicio &#x3d; mapa.exercicio&#xd;&#xa;			             AND mapa_solicitacao.cod_mapa &#x3d; mapa.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_item&#xd;&#xa;			              ON mapa_item.cod_mapa &#x3d; mapa_solicitacao.cod_mapa&#xd;&#xa;			             AND mapa_item.exercicio &#x3d; mapa_solicitacao.exercicio&#xd;&#xa;			             AND mapa_item.cod_entidade &#x3d; mapa_solicitacao.cod_entidade&#xd;&#xa;			             AND mapa_item.cod_solicitacao &#x3d; mapa_solicitacao.cod_solicitacao&#xd;&#xa;			             AND mapa_item.exercicio_solicitacao &#x3d; mapa_solicitacao.exercicio_solicitacao&#xd;&#xa;			      INNER JOIN compras.julgamento&#xd;&#xa;			              ON julgamento.exercicio &#x3d; mapa_cotacao.exercicio_cotacao&#xd;&#xa;			             AND julgamento.cod_cotacao &#x3d; mapa_cotacao.cod_cotacao&#xd;&#xa;			      INNER JOIN compras.julgamento_item&#xd;&#xa;			              ON julgamento_item.exercicio &#x3d; julgamento.exercicio&#xd;&#xa;			             AND julgamento_item.cod_cotacao &#x3d; julgamento.cod_cotacao&#xd;&#xa;			             AND julgamento_item.cod_item &#x3d; mapa_item.cod_item&#xd;&#xa;			             AND julgamento_item.ordem &#x3d; 1&#xd;&#xa;			      INNER JOIN licitacao.homologacao&#xd;&#xa;			              ON homologacao.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;			             AND homologacao.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;			             AND homologacao.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;			             AND homologacao.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;			             AND homologacao.cod_item&#x3d;julgamento_item.cod_item&#xd;&#xa;			             AND homologacao.lote&#x3d;julgamento_item.lote&#xd;&#xa;			       LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;			              ON homologacao_anulada.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;			             AND homologacao_anulada.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;			             AND homologacao_anulada.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;			             AND homologacao_anulada.exercicio_licitacao&#x3d;homologacao.exercicio_licitacao&#xd;&#xa;			             AND homologacao_anulada.num_homologacao&#x3d;homologacao.num_homologacao&#xd;&#xa;			             AND homologacao_anulada.cod_item&#x3d;homologacao.cod_item&#xd;&#xa;			             AND homologacao_anulada.lote&#x3d;homologacao.lote&#xd;&#xa;			      INNER JOIN compras.mapa_item_dotacao&#xd;&#xa;			              ON mapa_item_dotacao.exercicio &#x3d; mapa_item.exercicio&#xd;&#xa;			             AND mapa_item_dotacao.cod_mapa &#x3d; mapa_item.cod_mapa&#xd;&#xa;			             AND mapa_item_dotacao.exercicio_solicitacao &#x3d; mapa_item.exercicio_solicitacao&#xd;&#xa;			             AND mapa_item_dotacao.cod_entidade &#x3d; mapa_item.cod_entidade&#xd;&#xa;			             AND mapa_item_dotacao.cod_solicitacao &#x3d; mapa_item.cod_solicitacao&#xd;&#xa;			             AND mapa_item_dotacao.cod_centro &#x3d; mapa_item.cod_centro&#xd;&#xa;			             AND mapa_item_dotacao.cod_item &#x3d; mapa_item.cod_item&#xd;&#xa;			             AND mapa_item_dotacao.lote &#x3d; mapa_item.lote&#xd;&#xa;			      INNER JOIN orcamento.despesa&#xd;&#xa;			              ON despesa.exercicio &#x3d; mapa_item_dotacao.exercicio&#xd;&#xa;			             AND despesa.cod_despesa &#x3d; mapa_item_dotacao.cod_despesa&#xd;&#xa;			      INNER JOIN orcamento.programa&#xd;&#xa;			              ON programa.exercicio    &#x3d; despesa.exercicio&#xd;&#xa;			             AND programa.cod_programa &#x3d; despesa.cod_programa&#xd;&#xa;			      INNER JOIN orcamento.programa_ppa_programa&#xd;&#xa;			              ON programa_ppa_programa.exercicio    &#x3d; programa.exercicio&#xd;&#xa;			             AND programa_ppa_programa.cod_programa &#x3d; programa.cod_programa&#xd;&#xa;			      INNER JOIN ppa.programa AS ppa_programa&#xd;&#xa;			              ON ppa_programa.cod_programa &#x3d; programa_ppa_programa.cod_programa_ppa&#xd;&#xa;			      INNER JOIN orcamento.pao&#xd;&#xa;			              ON despesa.num_pao   &#x3d; pao.num_pao&#xd;&#xa;			             AND despesa.exercicio &#x3d; pao.exercicio&#xd;&#xa;			      INNER JOIN orcamento.pao_ppa_acao&#xd;&#xa;			              ON pao_ppa_acao.num_pao   &#x3d; pao.num_pao&#xd;&#xa;			             AND pao_ppa_acao.exercicio &#x3d; pao.exercicio&#xd;&#xa;			      INNER JOIN ppa.acao AS ppa_acao&#xd;&#xa;			              ON ppa_acao.cod_acao &#x3d; pao_ppa_acao.cod_acao&#xd;&#xa;			      INNER JOIN orcamento.conta_despesa AS conta_despesa&#xd;&#xa;			              ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;			             AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;			      INNER JOIN &#x28;&#xd;&#xa;			                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;        &#xd;&#xa;																		VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																		   ,cod_modalidade		INTEGER&#xd;&#xa;																		   ,cod_entidade		INTEGER&#xd;&#xa;																		   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																		   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																		   ,num_licitacao		TEXT &#x29;&#xd;&#xa;			                 &#x29; AS config_licitacao&#xd;&#xa;			              ON config_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND config_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND config_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			             AND config_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			           WHERE licitacao.cod_entidade in  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;     &#xd;&#xa;			             AND homologacao_anulada.cod_licitacao IS NULL&#xd;&#xa;			             AND TO_DATE&#x28;homologacao.timestamp&#x3a;&#x3a;varchar,&#x27;yyyy-mm-dd&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;			             AND &#x28; licitacao.cod_modalidade &#x3d; 8 OR licitacao.cod_modalidade &#x3d; 9 &#x29;&#xd;&#xa;			             AND NOT EXISTS&#x28; SELECT 1&#xd;&#xa;			                               FROM licitacao.licitacao_anulada&#xd;&#xa;			                              WHERE licitacao_anulada.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                                AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                                AND licitacao_anulada.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			                                AND licitacao_anulada.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			                           &#x29;&#xd;&#xa;			        GROUP BY tipo_registro&#xd;&#xa;			               , cod_orgao_resp&#xd;&#xa;			               , cod_unidade_resp&#xd;&#xa;			               , config_licitacao.exercicio_licitacao&#xd;&#xa;			               , config_licitacao.num_licitacao&#xd;&#xa;			               , tipo_processo&#xd;&#xa;			               , cod_orgao&#xd;&#xa;			               , cod_subunidade&#xd;&#xa;			               , cod_funcao&#xd;&#xa;			               , cod_subfuncao&#xd;&#xa;			               , num_programa&#xd;&#xa;			               , num_acao&#xd;&#xa;			               , id_sub_acao&#xd;&#xa;			               , natureza_despesa&#xd;&#xa;			               , cod_font_recurso&#xd;&#xa;			               , vl_recurso&#xd;&#xa;			        ORDER BY num_processo&#xd;&#xa;			&#x29;,&#xd;&#xa;  		      dispensa17 as &#xd;&#xa;			&#x28;&#xd;&#xa;		            SELECT 17 AS tipo_registro&#xd;&#xa;			                 , LPAD&#x28;orgao.valor&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; AS cod_orgao_resp&#xd;&#xa;			                 , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade_resp&#xd;&#xa;			                 , config_licitacao.exercicio_licitacao AS exercicio_processo&#xd;&#xa;			                 , config_licitacao.num_licitacao AS num_processo&#xd;&#xa;			                 , CASE WHEN modalidade.cod_modalidade &#x3d; 8 THEN 1&#xd;&#xa;			                        WHEN modalidade.cod_modalidade &#x3d; 9 THEN 2&#xd;&#xa;			                   END AS tipo_processo&#xd;&#xa;			                 , documento_pessoa.tipo_documento AS tipo_documento&#xd;&#xa;			                 , documento_pessoa.num_documento AS num_documento&#xd;&#xa;			                 , sw_cgm_pessoa_juridica.insc_estadual AS num_inscricao_estadual&#xd;&#xa;			                 , sw_uf.sigla_uf AS uf_inscricao_estadual&#xd;&#xa;			                 , CASE WHEN certificacao_documentos.cod_documento &#x3d; 5 AND documento_pessoa.tipo_documento &#x3d; 2 THEN certificacao_documentos.num_certificacao&#x3a;&#x3a;VARCHAR 	      ELSE &#x27;&#x27; END AS num_certidao_regularidade_inss&#xd;&#xa;			                 , CASE WHEN certificacao_documentos.cod_documento &#x3d; 5 AND documento_pessoa.tipo_documento &#x3d; 2 THEN TO_CHAR&#x28;certificacao_documentos.dt_emissao,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;  ELSE &#x27;&#x27; END AS dt_emissao_certidao_regularidade_inss&#xd;&#xa;			                 , CASE WHEN certificacao_documentos.cod_documento &#x3d; 5 AND documento_pessoa.tipo_documento &#x3d; 2 THEN TO_CHAR&#x28;certificacao_documentos.dt_validade,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; ELSE &#x27;&#x27; END AS dt_validade_certidao_regularidade_inss&#xd;&#xa;			                 , CASE WHEN certificacao_documentos.cod_documento &#x3d; 6 AND documento_pessoa.tipo_documento &#x3d; 2 THEN certificacao_documentos.num_certificacao&#x3a;&#x3a;VARCHAR 	      ELSE &#x27;&#x27; END AS num_certidao_regularidade_fgts&#xd;&#xa;			                 , CASE WHEN certificacao_documentos.cod_documento &#x3d; 6 AND documento_pessoa.tipo_documento &#x3d; 2 THEN TO_CHAR&#x28;certificacao_documentos.dt_emissao,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;  ELSE &#x27;&#x27; END AS dt_emissao_certidao_regularidade_fgts&#xd;&#xa;			                 , CASE WHEN certificacao_documentos.cod_documento &#x3d; 6 AND documento_pessoa.tipo_documento &#x3d; 2 THEN TO_CHAR&#x28;certificacao_documentos.dt_validade,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; ELSE &#x27;&#x27; END AS dt_validade_certidao_regularidade_fgts&#xd;&#xa;			                 , CASE WHEN certificacao_documentos.cod_documento &#x3d; 7 AND documento_pessoa.tipo_documento &#x3d; 2 THEN certificacao_documentos.num_certificacao&#x3a;&#x3a;VARCHAR         ELSE &#x27;&#x27; END AS num_cndt&#xd;&#xa;			                 , CASE WHEN certificacao_documentos.cod_documento &#x3d; 7 AND documento_pessoa.tipo_documento &#x3d; 2 THEN TO_CHAR&#x28;certificacao_documentos.dt_emissao,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;  ELSE &#x27;&#x27; END AS dt_emissao_cndt&#xd;&#xa;			                 , CASE WHEN certificacao_documentos.cod_documento &#x3d; 7 AND documento_pessoa.tipo_documento &#x3d; 2 THEN TO_CHAR&#x28;certificacao_documentos.dt_validade,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; ELSE &#x27;&#x27; END AS dt_validade_cndt&#xd;&#xa;			                 , CASE WHEN mapa.cod_tipo_licitacao &#x3d; 2&#xd;&#xa;			                        THEN mapa_cotacao.cod_cotacao&#x3a;&#x3a;VARCHAR&#xd;&#xa;			                        ELSE &#x27; &#x27;&#xd;&#xa;			                    END AS num_lote&#xd;&#xa;			                 , mapa_item.cod_item AS cod_item&#xd;&#xa;			                 , mapa_item.quantidade AS quantidade&#xd;&#xa;			              &#xd;&#xa;			                 , TRUNC&#x28;&#x28;mapa_item.vl_total&#x2f;mapa_item.quantidade&#x29;, 2&#x29;&#x3a;&#x3a;NUMERIC&#x28;14,4&#x29; AS valor_item&#xd;&#xa;			            FROM licitacao.licitacao&#xd;&#xa;			      INNER JOIN &#x28;SELECT &#x2a;&#xd;&#xa;			                    FROM administracao.configuracao_entidade&#xd;&#xa;			                   WHERE configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;			                     AND configuracao_entidade.parametro  &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			                     AND configuracao_entidade.exercicio  &#x3d; stExercicio                             &#xd;&#xa;			                 &#x29; AS orgao&#xd;&#xa;			              ON orgao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			      INNER JOIN compras.objeto&#xd;&#xa;			              ON objeto.cod_objeto &#x3d; licitacao.cod_objeto&#xd;&#xa;			      INNER JOIN sw_processo&#xd;&#xa;			              ON sw_processo.cod_processo &#x3d; licitacao.cod_processo&#xd;&#xa;			             AND sw_processo.ano_exercicio &#x3d; licitacao.exercicio_processo&#xd;&#xa;			      INNER JOIN compras.modalidade&#xd;&#xa;			              ON modalidade.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			      INNER JOIN compras.tipo_objeto&#xd;&#xa;			              ON tipo_objeto.cod_tipo_objeto &#x3d; licitacao.cod_tipo_objeto&#xd;&#xa;			      INNER JOIN licitacao.edital&#xd;&#xa;			              ON edital.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND edital.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			             AND edital.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND edital.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;			       LEFT JOIN licitacao.publicacao_edital&#xd;&#xa;			              ON publicacao_edital.num_edital &#x3d; edital.num_edital&#xd;&#xa;			             AND publicacao_edital.exercicio &#x3d; edital.exercicio&#xd;&#xa;			      INNER JOIN sw_cgm AS responsavel&#xd;&#xa;			              ON responsavel.numcgm &#x3d; edital.responsavel_juridico&#xd;&#xa;			       LEFT JOIN sw_cgm_pessoa_juridica&#xd;&#xa;			              ON sw_cgm_pessoa_juridica.numcgm &#x3d; responsavel.numcgm&#xd;&#xa;			       LEFT JOIN &#x28; SELECT num_documento, numcgm, tipo_documento&#xd;&#xa;			                    FROM &#x28;&#xd;&#xa;			                            SELECT cpf AS num_documento, numcgm, 1 AS tipo_documento&#xd;&#xa;			                              FROM sw_cgm_pessoa_fisica&#xd;&#xa;			                             UNION&#xd;&#xa;			                            SELECT cnpj AS num_documento, numcgm, 2 AS tipo_documento&#xd;&#xa;			                              FROM sw_cgm_pessoa_juridica&#xd;&#xa;			                        &#x29; AS tabela&#xd;&#xa;			                    GROUP BY numcgm, num_documento, tipo_documento&#xd;&#xa;			                &#x29; AS documento_pessoa&#xd;&#xa;			              ON documento_pessoa.numcgm &#x3d; responsavel.numcgm&#xd;&#xa;			      INNER JOIN sw_municipio&#xd;&#xa;			              ON sw_municipio.cod_municipio &#x3d; responsavel.cod_municipio&#xd;&#xa;			             AND sw_municipio.cod_uf &#x3d; responsavel.cod_uf&#xd;&#xa;			      INNER JOIN sw_uf&#xd;&#xa;			              ON sw_uf.cod_uf &#x3d; sw_municipio.cod_uf&#xd;&#xa;			      INNER JOIN compras.mapa&#xd;&#xa;			              ON mapa.exercicio &#x3d; licitacao.exercicio_mapa&#xd;&#xa;			             AND mapa.cod_mapa &#x3d; licitacao.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_solicitacao&#xd;&#xa;			              ON mapa_solicitacao.exercicio &#x3d; mapa.exercicio&#xd;&#xa;			             AND mapa_solicitacao.cod_mapa &#x3d; mapa.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_cotacao&#xd;&#xa;			              ON mapa.exercicio &#x3d; mapa_cotacao.exercicio_mapa&#xd;&#xa;			             AND mapa.cod_mapa &#x3d; mapa_cotacao.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_item&#xd;&#xa;			              ON mapa_item.cod_mapa &#x3d; mapa_solicitacao.cod_mapa&#xd;&#xa;			             AND mapa_item.exercicio &#x3d; mapa_solicitacao.exercicio&#xd;&#xa;			             AND mapa_item.cod_entidade &#x3d; mapa_solicitacao.cod_entidade&#xd;&#xa;			             AND mapa_item.cod_solicitacao &#x3d; mapa_solicitacao.cod_solicitacao&#xd;&#xa;			             AND mapa_item.exercicio_solicitacao &#x3d; mapa_solicitacao.exercicio_solicitacao&#xd;&#xa;			      INNER JOIN compras.julgamento&#xd;&#xa;			              ON julgamento.exercicio &#x3d; mapa_cotacao.exercicio_cotacao&#xd;&#xa;			             AND julgamento.cod_cotacao &#x3d; mapa_cotacao.cod_cotacao&#xd;&#xa;			      INNER JOIN compras.julgamento_item&#xd;&#xa;			              ON julgamento_item.exercicio &#x3d; julgamento.exercicio&#xd;&#xa;			             AND julgamento_item.cod_cotacao &#x3d; julgamento.cod_cotacao&#xd;&#xa;			             AND julgamento_item.cod_item &#x3d; mapa_item.cod_item&#xd;&#xa;			             AND julgamento_item.ordem &#x3d; 1&#xd;&#xa;			      INNER JOIN licitacao.homologacao&#xd;&#xa;			              ON homologacao.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;			             AND homologacao.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;			             AND homologacao.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;			             AND homologacao.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;			             AND homologacao.cod_item&#x3d;julgamento_item.cod_item&#xd;&#xa;			             AND homologacao.lote&#x3d;julgamento_item.lote&#xd;&#xa;			       LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;			              ON homologacao_anulada.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;			             AND homologacao_anulada.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;			             AND homologacao_anulada.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;			             AND homologacao_anulada.exercicio_licitacao&#x3d;homologacao.exercicio_licitacao&#xd;&#xa;			             AND homologacao_anulada.num_homologacao&#x3d;homologacao.num_homologacao&#xd;&#xa;			             AND homologacao_anulada.cod_item&#x3d;homologacao.cod_item&#xd;&#xa;			             AND homologacao_anulada.lote&#x3d;homologacao.lote&#xd;&#xa;			      INNER JOIN licitacao.licitacao_documentos&#xd;&#xa;			              ON licitacao_documentos.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND licitacao_documentos.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND licitacao_documentos.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			             AND licitacao_documentos.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			      INNER JOIN licitacao.documento&#xd;&#xa;			              ON documento.cod_documento &#x3d; licitacao_documentos.cod_documento&#xd;&#xa;			       LEFT JOIN licitacao.certificacao_documentos&#xd;&#xa;			              ON certificacao_documentos.cod_documento &#x3d; documento.cod_documento&#xd;&#xa;			             AND certificacao_documentos.cgm_fornecedor &#x3d; julgamento_item.cgm_fornecedor&#xd;&#xa;			             AND certificacao_documentos.exercicio &#x3d; licitacao_documentos.exercicio&#xd;&#xa;			      INNER JOIN &#x28; &#xd;&#xa;			                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;    &#xd;&#xa;																		VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																		   ,cod_modalidade		INTEGER&#xd;&#xa;																		   ,cod_entidade		INTEGER&#xd;&#xa;																		   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																		   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																		   ,num_licitacao		TEXT &#x29;&#xd;&#xa;			                 &#x29; AS config_licitacao&#xd;&#xa;			              ON config_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND config_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND config_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			             AND config_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			           WHERE licitacao.cod_entidade in &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;          &#xd;&#xa;			             AND homologacao_anulada.cod_licitacao IS NULL&#xd;&#xa;			             AND TO_DATE&#x28;homologacao.timestamp&#x3a;&#x3a;varchar,&#x27;yyyy-mm-dd&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; &#xd;&#xa;			             AND &#x28; licitacao.cod_modalidade &#x3d; 8 OR licitacao.cod_modalidade &#x3d; 9 &#x29;&#xd;&#xa;			             AND NOT EXISTS&#x28; SELECT 1&#xd;&#xa;			                                FROM licitacao.licitacao_anulada&#xd;&#xa;			                               WHERE licitacao_anulada.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                                 AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                                 AND licitacao_anulada.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			                                 AND licitacao_anulada.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			                            &#x29;&#xd;&#xa;			        GROUP BY tipo_registro&#xd;&#xa;			               , cod_orgao_resp&#xd;&#xa;			               , cod_unidade_resp&#xd;&#xa;			               , exercicio_processo&#xd;&#xa;			               , num_processo&#xd;&#xa;			               , tipo_processo&#xd;&#xa;			               , tipo_documento&#xd;&#xa;			               , documento_pessoa.num_documento&#xd;&#xa;			               , num_inscricao_estadual&#xd;&#xa;			               , uf_inscricao_estadual&#xd;&#xa;			               , num_certidao_regularidade_inss&#xd;&#xa;			               , dt_emissao_certidao_regularidade_inss&#xd;&#xa;			               , dt_validade_certidao_regularidade_inss&#xd;&#xa;			               , num_certidao_regularidade_fgts&#xd;&#xa;			               , dt_emissao_certidao_regularidade_fgts&#xd;&#xa;			               , dt_validade_certidao_regularidade_fgts&#xd;&#xa;			               , num_cndt&#xd;&#xa;			               , dt_emissao_cndt&#xd;&#xa;			               , dt_validade_cndt&#xd;&#xa;			               , num_lote&#xd;&#xa;			               , mapa_item.cod_item&#xd;&#xa;			               , mapa_item.quantidade&#xd;&#xa;			               , valor_item&#xd;&#xa;			               , mapa_cotacao.cod_cotacao&#xd;&#xa;			               , mapa.cod_tipo_licitacao&#xd;&#xa;			               , config_licitacao.exercicio_licitacao&#xd;&#xa;			               , config_licitacao.num_licitacao&#xd;&#xa;		&#xd;&#xa;			        ORDER BY num_processo&#xd;&#xa;			&#x29;,&#xd;&#xa;			  dispensa_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_unidade_resp,&#xd;&#xa;							num_processo,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_resp&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;exercicio_processo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_processo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; to_char&#x28;to_date&#x28;dt_abertura, &#x27;DD MM YYYY&#x27;&#x29;, &#x27;DDMMYYY&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;natureza_objeto&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 1, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;objeto,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,500&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;justificativa,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,250&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;razao,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,250&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_publicacao_termo_ratificacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;veiculo_publicacao,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;processo_por_lote&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;					as d  &#xd;&#xa;				from dispensa10&#xd;&#xa;				union all   &#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_unidade_resp,&#xd;&#xa;							num_processo,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_resp&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;exercicio_processo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_processo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_lote&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x3a;&#x3a;int&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;desc_lote&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from dispensa11&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        cod_unidade_resp,&#xd;&#xa;					        num_processo,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_resp&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;exercicio_processo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_processo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_item&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_item&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					as d&#xd;&#xa;				from dispensa12&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        cod_unidade_resp,&#xd;&#xa;					        num_processo,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_resp&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;exercicio_processo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_processo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;				    &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;lpad&#x28;case when num_lote&#x3a;&#x3a;varchar &#x21;&#x3d; &#x27;&#x27;       then num_lote&#x3a;&#x3a;varchar else null end, 4, &#x27;0&#x27;&#x29;,&#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_item&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint   &#xd;&#xa;					as d&#xd;&#xa;				from dispensa13&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        cod_unidade_resp,&#xd;&#xa;					        num_processo,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_resp&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;exercicio_processo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_processo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;num_cpf_resp&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,11, &#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from dispensa14&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        cod_unidade_resp,&#xd;&#xa;					        num_processo,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_resp&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;exercicio_processo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_processo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_lote&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_item&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_cot_precos_unitario&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;quantidade&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from dispensa15&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        cod_unidade_resp,&#xd;&#xa;					        num_processo,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_resp&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;exercicio_processo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_processo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_subunidade&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_funcao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_subfuncao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 3, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_programa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;id_acao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;id_sub_acao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;natureza_despesa&#x3a;&#x3a;varchar,1,6&#x29;, &#x27; &#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_font_recurso&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 3, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_recurso&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from dispensa16&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        cod_unidade_resp,&#xd;&#xa;					        num_processo,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_resp&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;exercicio_processo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_processo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;num_inscricao_estadual&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,30&#x29;,&#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;uf_inscricao_estadual&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;num_certidao_regularidade_inss&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,30&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_emissao_certidao_regularidade_inss&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_validade_certidao_regularidade_inss&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;num_certidao_regularidade_fgts&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,30&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_emissao_certidao_regularidade_fgts&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_validade_certidao_regularidade_fgts&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;num_cndt&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,30&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_emissao_cndt&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_validade_cndt&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_lote&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_item&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#x3a;&#x3a;bigint					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;quantidade&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;valor_item&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from dispensa17      &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;DISPENSA.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from dispensa_format order by cod_unidade_resp,num_processo,tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;    if strpos&#x28;stArquivos,&#x27;&#x22;IDE.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with ide as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT &#x28; SELECT cnpj&#xd;&#xa;			                   FROM sw_cgm_pessoa_juridica&#xd;&#xa;			              LEFT JOIN administracao.configuracao&#xd;&#xa;			                     ON parametro &#x3d; &#x27;cod_entidade_prefeitura&#x27;&#xd;&#xa;			                    AND configuracao.exercicio &#x3d; stExercicio             &#xd;&#xa;			              LEFT JOIN orcamento.entidade&#xd;&#xa;			                     ON cod_entidade&#x3d;configuracao.valor&#x3a;&#x3a;integer&#xd;&#xa;			                    AND entidade.exercicio &#x3d; configuracao.exercicio&#xd;&#xa;			                  WHERE sw_cgm_pessoa_juridica.numcgm&#x3d;entidade.numcgm&#xd;&#xa;			             &#x29; AS cnpj_municipio&#xd;&#xa;			             , &#x28; SELECT DISTINCT cod_municipio&#xd;&#xa;			                   FROM tcemg.configurar_ide&#xd;&#xa;			             &#x29; AS cod_municipio&#xd;&#xa;			             , LPAD&#x28;&#x28;SELECT valor&#xd;&#xa;			                       FROM tcemg.orgao&#xd;&#xa;			                 INNER JOIN administracao.configuracao_entidade&#xd;&#xa;			                         ON configuracao_entidade.valor&#x3a;&#x3a;integer &#x3d; orgao.num_orgao&#xd;&#xa;			                      WHERE  configuracao_entidade.exercicio   &#x3d; ACE.exercicio&#xd;&#xa;			                        AND configuracao_entidade.cod_entidade &#x3d; ACE.cod_entidade&#xd;&#xa;			                        AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			             &#x29;, 2, &#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;			             , &#x28; SELECT valor&#xd;&#xa;			                   FROM tcemg.orgao&#xd;&#xa;			             INNER JOIN administracao.configuracao_entidade&#xd;&#xa;			                     ON configuracao_entidade.valor&#x3a;&#x3a;integer &#x3d; orgao.num_orgao&#xd;&#xa;			                  WHERE configuracao_entidade.exercicio    &#x3d; ACE.exercicio&#xd;&#xa;			                    AND configuracao_entidade.cod_entidade &#x3d; ACE.cod_entidade&#xd;&#xa;			                    AND parametro &#x3d; &#x27;tcemg_tipo_orgao_entidade_sicom&#x27;&#xd;&#xa;			             &#x29; AS tipo_orgao&#xd;&#xa;			             , stExercicio AS exercicio_referencia    &#xd;&#xa;			             , lpad&#x28;stMes, 2, &#x27;0&#x27;&#x29; AS mes_referencia            &#xd;&#xa;			             , to_char&#x28;CURRENT_DATE&#x3a;&#x3a;timestamp,&#x27;ddmmyyyy&#x27;&#x29; as data_geracao&#xd;&#xa;			             , to_char&#x28;CURRENT_DATE&#x3a;&#x3a;timestamp,&#x27;yyyymmdd&#x27;&#x29;&#x7c;&#x7c; &#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; lpad&#x28;stMes,2, &#x27;0&#x27;&#x29; as cod_remessa   &#xd;&#xa;			          FROM administracao.configuracao_entidade AS ACE&#xd;&#xa;			         WHERE ACE.exercicio &#x3d; stExercicio           &#xd;&#xa;			           AND ACE.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;         &#xd;&#xa;			           AND ACE.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			&#x29;, &#xd;&#xa;			  ide_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							cnpj_municipio,&#xd;&#xa;							coalesce&#x28;cod_municipio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cnpj_municipio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,14, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29; ,2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipo_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29; ,2, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_referencia&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;mes_referencia&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_geracao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_remessa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					as d  &#xd;&#xa;				from ide&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;IDE.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from ide_format order by cnpj_municipio&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;PARELIC.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with paralelic as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 10 as tipo_registro&#xd;&#xa;			                   , LPAD&#x28;orgao_sicom.valor&#x3a;&#x3a;varchar,2,&#x27;0&#x27;&#x29; as cod_orgao&#xd;&#xa;			                   , LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;licitacao.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;licitacao.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29; AS codunidadesub&#xd;&#xa;			                   , config_licitacao.exercicio_licitacao&#xd;&#xa;			                   , config_licitacao.num_licitacao AS num_processo_licitatorio&#xd;&#xa;			                   , to_char&#x28;edital.dt_aprovacao_juridico, &#x27;ddmmyyyy&#x27;&#x29; as data_parecer&#xd;&#xa;			                   , 2 as tipo_parecer&#xd;&#xa;			                   , pf.cpf as cpf&#xd;&#xa;			                FROM licitacao.licitacao&#xd;&#xa;			                JOIN licitacao.edital&#xd;&#xa;			                  ON edital.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;			                 AND edital.cod_licitacao   &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                 AND edital.cod_modalidade  &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                 AND edital.cod_entidade    &#x3d; licitacao.cod_entidade&#xd;&#xa;			                JOIN licitacao.cotacao_licitacao AS CL&#xd;&#xa;			                  ON CL.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                 AND CL.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                 AND CL.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;			                 AND CL.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;			                JOIN licitacao.adjudicacao AS A&#xd;&#xa;			                  ON A.cod_licitacao        &#x3d; CL.cod_licitacao&#xd;&#xa;			                 AND A.cod_modalidade       &#x3d; CL.cod_modalidade&#xd;&#xa;			                 AND A.cod_entidade         &#x3d; CL.cod_entidade&#xd;&#xa;			                 AND A.exercicio_licitacao  &#x3d; CL.exercicio_licitacao&#xd;&#xa;			                 AND A.lote                 &#x3d; CL.lote&#xd;&#xa;			                 AND A.cod_cotacao          &#x3d; CL.cod_cotacao&#xd;&#xa;			                 AND A.cod_item             &#x3d; CL.cod_item&#xd;&#xa;			                 AND A.exercicio_cotacao    &#x3d; CL.exercicio_cotacao&#xd;&#xa;			                 AND A.cgm_fornecedor       &#x3d; CL.cgm_fornecedor&#xd;&#xa;			                JOIN licitacao.homologacao AS H&#xd;&#xa;			                  ON H.num_adjudicacao      &#x3d; A.num_adjudicacao&#xd;&#xa;			                 AND H.cod_entidade         &#x3d; A.cod_entidade&#xd;&#xa;			                 AND H.cod_modalidade       &#x3d; A.cod_modalidade&#xd;&#xa;			                 AND H.cod_licitacao        &#x3d; A.cod_licitacao&#xd;&#xa;			                 AND H.exercicio_licitacao  &#x3d; A.exercicio_licitacao&#xd;&#xa;			                 AND H.cod_item             &#x3d; A.cod_item&#xd;&#xa;			                 AND H.cod_cotacao          &#x3d; A.cod_cotacao&#xd;&#xa;			                 AND H.lote                 &#x3d; A.lote&#xd;&#xa;			                 AND H.exercicio_cotacao    &#x3d; A.exercicio_cotacao&#xd;&#xa;			                 AND H.cgm_fornecedor       &#x3d; A.cgm_fornecedor&#xd;&#xa;			                 AND &#x28;SELECT num_homologacao&#xd;&#xa;			                        FROM licitacao.homologacao_anulada AS HANUL&#xd;&#xa;			                       WHERE HANUL.num_homologacao      &#x3d; H.num_homologacao&#xd;&#xa;			                         AND HANUL.cod_licitacao        &#x3d; H.cod_licitacao&#xd;&#xa;					                 AND HANUL.cod_modalidade       &#x3d; H.cod_modalidade&#xd;&#xa;					                 AND HANUL.cod_entidade         &#x3d; H.cod_entidade&#xd;&#xa;					                 AND HANUL.num_adjudicacao      &#x3d; H.num_adjudicacao&#xd;&#xa;					                 AND HANUL.exercicio_licitacao  &#x3d; H.exercicio_licitacao&#xd;&#xa;					                 AND HANUL.lote                 &#x3d; H.lote&#xd;&#xa;					                 AND HANUL.cod_cotacao          &#x3d; H.cod_cotacao&#xd;&#xa;					                 AND HANUL.cod_item             &#x3d; H.cod_item&#xd;&#xa;					                 AND HANUL.exercicio_cotacao    &#x3d; H.exercicio_cotacao&#xd;&#xa;					                 AND HANUL.cgm_fornecedor       &#x3d; H.cgm_fornecedor&#xd;&#xa;			                     &#x29; IS NULL&#xd;&#xa;			           LEFT JOIN public.sw_cgm_pessoa_fisica as pf&#xd;&#xa;			                  ON pf.numcgm &#x3d; edital.responsavel_juridico&#xd;&#xa;			                JOIN &#x28;SELECT valor&#x3a;&#x3a;integer&#xd;&#xa;			                            , configuracao_entidade.exercicio&#xd;&#xa;			                            , configuracao_entidade.cod_entidade&#xd;&#xa;			                        FROM tcemg.orgao&#xd;&#xa;			                  INNER JOIN administracao.configuracao_entidade&#xd;&#xa;			                          ON configuracao_entidade.valor&#x3a;&#x3a;integer &#x3d; orgao.num_orgao&#xd;&#xa;			                       WHERE configuracao_entidade.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;  AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;    &#xd;&#xa;			                    &#x29;  AS orgao_sicom&#xd;&#xa;			                  ON orgao_sicom.exercicio&#x3d;stExercicio    &#xd;&#xa;			                 AND orgao_sicom.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;		&#xd;&#xa;			            JOIN &#x28;&#xd;&#xa;			                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;  &#xd;&#xa;																		VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																		   ,cod_modalidade		INTEGER&#xd;&#xa;																		   ,cod_entidade		INTEGER&#xd;&#xa;																		   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																		   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																		   ,num_licitacao		TEXT &#x29;&#xd;&#xa;			                 &#x29; AS config_licitacao&#xd;&#xa;			              ON config_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND config_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND config_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			             AND config_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			               WHERE H.timestamp BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;    &#xd;&#xa;			                 AND licitacao.cod_modalidade NOT IN &#x28;8,9&#x29;&#xd;&#xa;			                 AND NOT EXISTS &#x28;SELECT 1&#xd;&#xa;			                                   FROM licitacao.licitacao_anulada&#xd;&#xa;			                                   WHERE licitacao_anulada.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			                                     AND licitacao_anulada.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                                     AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                                     AND licitacao_anulada.cod_entidade &#x3d; licitacao.cod_entidade&#x29;&#xd;&#xa;			               GROUP BY 1,2,3,4,5,6,7,8&#xd;&#xa;			&#x29;, &#xd;&#xa;			  paralelic_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro,&#xd;&#xa;							codunidadesub,&#xd;&#xa;							coalesce&#x28;tipo_registro&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;							&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29; ,5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29; ,4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo_licitatorio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_parecer&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_parecer&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cpf&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 11, &#x27; &#x27;&#x29;     &#xd;&#xa;					as d  &#xd;&#xa;				from paralelic&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;PARELIC.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from paralelic_format order by codunidadesub, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;HOMOLIC.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with homolic10 as&#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT &#x27;10&#x27;&#x3a;&#x3a;char&#x28;2&#x29; AS tipo_registro&#xd;&#xa;		                          , LPAD&#x28;&#x28;SELECT valor&#xd;&#xa;		                                    FROM administracao.configuracao_entidade&#xd;&#xa;		                                   WHERE exercicio &#x3d; &#x27;2016&#x27;&#xd;&#xa;		                                     AND parametro like &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;		                                     AND cod_entidade &#x3d; licitacao.cod_entidade&#x29;, 2, &#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;		                           , CASE WHEN homologacao.exercicio_licitacao &#x3c;&#x3d; &#x27;2013&#x27;&#xd;&#xa;		                                  THEN &#x27;&#x27;&#xd;&#xa;		                                  ELSE LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;lpad&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;		                             END AS cod_unidadesub&#xd;&#xa;		                           , config_licitacao.exercicio_licitacao&#xd;&#xa;		                           , config_licitacao.num_licitacao AS nro_processolicitatorio&#xd;&#xa;		                           , CASE WHEN sw_cgm_pessoa_juridica.cnpj IS NOT NULL THEN 2&#xd;&#xa;		                                   WHEN sw_cgm_pessoa_fisica.cpf  IS NOT NULL THEN 1&#xd;&#xa;		                                   ELSE 3&#xd;&#xa;		                              END AS tipo_documento&#xd;&#xa;		                           , CASE WHEN mapa.cod_tipo_licitacao &#x3d; 2&#xd;&#xa;		                                  THEN homologacao.lote&#xd;&#xa;		                                  ELSE NULL&#xd;&#xa;		                              END AS nro_lote&#xd;&#xa;		                            , cotacao_fornecedor_item.cod_item&#xd;&#xa;		                            , cotacao_item.quantidade&#xd;&#xa;		                            , &#x28;cotacao_fornecedor_item.vl_cotacao &#x2f; cotacao_item.quantidade&#x29;&#x3a;&#x3a;numeric&#x28;14,4&#x29; as valor_unitario&#xd;&#xa;		                            , CASE WHEN sw_cgm_pessoa_juridica.cnpj IS NOT NULL&#xd;&#xa;		                                   THEN sw_cgm_pessoa_juridica.cnpj&#xd;&#xa;		                                   ELSE sw_cgm_pessoa_fisica.cpf&#xd;&#xa;		                              END AS nro_documento&#xd;&#xa;			                    FROM licitacao.homologacao&#xd;&#xa;			              INNER JOIN licitacao.adjudicacao&#xd;&#xa;		                      ON adjudicacao.num_adjudicacao     &#x3d; homologacao.num_adjudicacao&#xd;&#xa;		                     AND adjudicacao.cod_entidade        &#x3d; homologacao.cod_entidade&#xd;&#xa;		                     AND adjudicacao.cod_modalidade      &#x3d; homologacao.cod_modalidade&#xd;&#xa;		                     AND adjudicacao.cod_licitacao       &#x3d; homologacao.cod_licitacao&#xd;&#xa;		                     AND adjudicacao.exercicio_licitacao &#x3d; homologacao.exercicio_licitacao&#xd;&#xa;		                     AND adjudicacao.cod_item            &#x3d; homologacao.cod_item&#xd;&#xa;		                     AND adjudicacao.cod_cotacao         &#x3d; homologacao.cod_cotacao&#xd;&#xa;		                     AND adjudicacao.lote                &#x3d; homologacao.lote&#xd;&#xa;		                     AND adjudicacao.exercicio_cotacao   &#x3d; homologacao.exercicio_cotacao&#xd;&#xa;		                     AND adjudicacao.cgm_fornecedor      &#x3d; homologacao.cgm_fornecedor&#xd;&#xa;		              INNER JOIN licitacao.cotacao_licitacao&#xd;&#xa;		                      ON cotacao_licitacao.cod_licitacao       &#x3d; adjudicacao.cod_licitacao&#xd;&#xa;		                     AND cotacao_licitacao.cod_modalidade      &#x3d; adjudicacao.cod_modalidade&#xd;&#xa;		                     AND cotacao_licitacao.cod_entidade        &#x3d; adjudicacao.cod_entidade&#xd;&#xa;		                     AND cotacao_licitacao.exercicio_licitacao &#x3d; adjudicacao.exercicio_licitacao&#xd;&#xa;		                     AND cotacao_licitacao.lote                &#x3d; adjudicacao.lote&#xd;&#xa;		                     AND cotacao_licitacao.cod_cotacao         &#x3d; adjudicacao.cod_cotacao&#xd;&#xa;		                     AND cotacao_licitacao.cod_item            &#x3d; adjudicacao.cod_item&#xd;&#xa;		                     AND cotacao_licitacao.exercicio_cotacao   &#x3d; adjudicacao.exercicio_cotacao&#xd;&#xa;		                     AND cotacao_licitacao.cgm_fornecedor      &#x3d; adjudicacao.cgm_fornecedor&#xd;&#xa;		              INNER JOIN licitacao.licitacao&#xd;&#xa;		                      ON licitacao.cod_licitacao  &#x3d; cotacao_licitacao.cod_licitacao&#xd;&#xa;		                     AND licitacao.cod_modalidade &#x3d; cotacao_licitacao.cod_modalidade&#xd;&#xa;		                     AND licitacao.cod_entidade   &#x3d; cotacao_licitacao.cod_entidade&#xd;&#xa;		                     AND licitacao.exercicio      &#x3d; cotacao_licitacao.exercicio_licitacao&#xd;&#xa;		              INNER JOIN compras.cotacao_fornecedor_item&#xd;&#xa;		                      ON cotacao_fornecedor_item.cgm_fornecedor &#x3d; cotacao_licitacao.cgm_fornecedor&#xd;&#xa;		                     AND cotacao_fornecedor_item.cod_cotacao    &#x3d; cotacao_licitacao.cod_cotacao&#xd;&#xa;		                     AND cotacao_fornecedor_item.exercicio      &#x3d; cotacao_licitacao.exercicio_cotacao&#xd;&#xa;		                     AND cotacao_fornecedor_item.lote           &#x3d; cotacao_licitacao.lote&#xd;&#xa;		                     AND cotacao_fornecedor_item.cod_item       &#x3d; cotacao_licitacao.cod_item&#xd;&#xa;		              INNER JOIN compras.cotacao_item&#xd;&#xa;		                      ON cotacao_item.exercicio   &#x3d; cotacao_fornecedor_item.exercicio&#xd;&#xa;		                     AND cotacao_item.cod_cotacao &#x3d; cotacao_fornecedor_item.cod_cotacao&#xd;&#xa;		                     AND cotacao_item.cod_item    &#x3d; cotacao_fornecedor_item.cod_item&#xd;&#xa;		                     AND cotacao_item.lote        &#x3d; cotacao_fornecedor_item.lote&#xd;&#xa;		              INNER JOIN compras.cotacao&#xd;&#xa;		                      ON cotacao.exercicio   &#x3d; cotacao_item.exercicio&#xd;&#xa;		                     AND cotacao.cod_cotacao &#x3d; cotacao_item.cod_cotacao&#xd;&#xa;		              INNER JOIN compras.mapa_cotacao&#xd;&#xa;		                      ON mapa_cotacao.exercicio_cotacao &#x3d; cotacao.exercicio&#xd;&#xa;		                     AND mapa_cotacao.cod_cotacao       &#x3d; cotacao.cod_cotacao&#xd;&#xa;		              INNER JOIN compras.julgamento_item&#xd;&#xa;		                      ON cotacao_fornecedor_item.exercicio      &#x3d; julgamento_item.exercicio&#xd;&#xa;		                     AND cotacao_fornecedor_item.cod_cotacao    &#x3d; julgamento_item.cod_cotacao&#xd;&#xa;		                     AND cotacao_fornecedor_item.cod_item       &#x3d; julgamento_item.cod_item&#xd;&#xa;		                     AND cotacao_fornecedor_item.cgm_fornecedor &#x3d; julgamento_item.cgm_fornecedor&#xd;&#xa;		                     AND cotacao_fornecedor_item.lote           &#x3d; julgamento_item.lote&#xd;&#xa;		              INNER JOIN licitacao.participante&#xd;&#xa;		                      ON participante.cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                     AND participante.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                     AND participante.cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;		                     AND participante.exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;		                     AND participante.cgm_fornecedor &#x3d; cotacao_fornecedor_item.cgm_fornecedor&#xd;&#xa;		               LEFT JOIN sw_cgm_pessoa_juridica&#xd;&#xa;		                      ON sw_cgm_pessoa_juridica.numcgm &#x3d; participante.cgm_fornecedor&#xd;&#xa;		               LEFT JOIN sw_cgm_pessoa_fisica&#xd;&#xa;		                      ON sw_cgm_pessoa_fisica.numcgm &#x3d; participante.cgm_fornecedor&#xd;&#xa;		              INNER JOIN compras.fornecedor&#xd;&#xa;		                      ON fornecedor.cgm_fornecedor &#x3d; participante.cgm_fornecedor&#xd;&#xa;		              INNER JOIN compras.mapa&#xd;&#xa;		                      ON mapa.exercicio &#x3d; mapa_cotacao.exercicio_mapa&#xd;&#xa;		                     AND mapa.cod_mapa  &#x3d; mapa_cotacao.cod_mapa&#xd;&#xa;		              INNER JOIN compras.mapa_item&#xd;&#xa;		                      ON mapa_item.exercicio &#x3d; mapa.exercicio&#xd;&#xa;		                     AND mapa_item.cod_mapa  &#x3d; mapa.cod_mapa&#xd;&#xa;		                     AND mapa_item.cod_item  &#x3d; cotacao_fornecedor_item.cod_item&#xd;&#xa;		                     AND mapa_item.lote      &#x3d; cotacao_fornecedor_item.lote&#xd;&#xa;		              INNER JOIN &#x28;&#xd;&#xa;		                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;    &#xd;&#xa;																	VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																	   ,cod_modalidade		INTEGER&#xd;&#xa;																	   ,cod_entidade		INTEGER&#xd;&#xa;																	   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																	   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																	   ,num_licitacao		TEXT &#x29;&#xd;&#xa;		                 &#x29; AS config_licitacao&#xd;&#xa;		              ON config_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;		             AND config_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;		             AND config_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		             AND config_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;		                   WHERE licitacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;      &#xd;&#xa;		                     AND TO_DATE&#x28;homologacao.timestamp&#x3a;&#x3a;varchar, &#x27;YYYY-MM-DD&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;		                     AND licitacao.cod_modalidade NOT IN &#x28;8,9&#x29;&#xd;&#xa;		                     AND NOT EXISTS&#x28; SELECT 1 FROM licitacao.licitacao_anulada&#xd;&#xa;		                                     WHERE licitacao_anulada.cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                                     AND licitacao_anulada.cod_modalidade   &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                                     AND licitacao_anulada.cod_entidade     &#x3d; licitacao.cod_entidade&#xd;&#xa;		                                     AND licitacao_anulada.exercicio        &#x3d; licitacao.exercicio &#x29;&#xd;&#xa;		        GROUP BY tipo_registro&#xd;&#xa;		                            , cod_orgao&#xd;&#xa;		                            , cod_unidadesub&#xd;&#xa;		                            , homologacao.exercicio_licitacao&#xd;&#xa;		                            , nro_processolicitatorio&#xd;&#xa;		                            , tipo_documento&#xd;&#xa;		                            , nro_lote&#xd;&#xa;		                            , cotacao_fornecedor_item.cod_item&#xd;&#xa;		                            , cotacao_item.quantidade&#xd;&#xa;		                            , cotacao_fornecedor_item.vl_cotacao&#xd;&#xa;		                            , licitacao.cod_licitacao&#xd;&#xa;		                            , licitacao.cod_modalidade&#xd;&#xa;		                            , sw_cgm_pessoa_juridica.cnpj&#xd;&#xa;		                            , sw_cgm_pessoa_fisica.cpf&#xd;&#xa;		                            , config_licitacao.exercicio_licitacao&#xd;&#xa;		                            , config_licitacao.num_licitacao&#xd;&#xa;		                     ORDER BY nro_processolicitatorio&#xd;&#xa;		                            , licitacao.cod_licitacao&#xd;&#xa;		                            , licitacao.cod_modalidade&#xd;&#xa;		                            , cod_unidadesub&#xd;&#xa;		                            , tipo_registro&#xd;&#xa;		                            , cod_orgao&#xd;&#xa;		                            , exercicio_licitacao&#xd;&#xa;		                            , tipo_documento&#xd;&#xa;		                            , nro_documento&#xd;&#xa;		                            , nro_lote&#xd;&#xa;		                            , cod_item&#xd;&#xa;			&#x29;, &#xd;&#xa;			  homolic30 as &#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT &#x27;30&#x27;&#x3a;&#x3a;char&#x28;2&#x29; AS tipo_registro&#xd;&#xa;		                         , LPAD&#x28;&#x28;SELECT valor&#xd;&#xa;		                                   FROM administracao.configuracao_entidade&#xd;&#xa;		                                  WHERE exercicio &#x3d; &#x27;2016&#x27;&#xd;&#xa;		                                    AND parametro like &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;		                                    AND cod_entidade &#x3d; licitacao.cod_entidade&#x29;, 2, &#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;		                          , CASE WHEN homologacao.exercicio_licitacao &#x3c;&#x3d; &#x27;2013&#x27;&#xd;&#xa;		                                 THEN &#x27;&#x27;&#xd;&#xa;		                                 ELSE LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;lpad&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;		                            END AS cod_unidadesub&#xd;&#xa;		                          , config_licitacao.exercicio_licitacao&#xd;&#xa;		                          , config_licitacao.num_licitacao AS nro_processolicitatorio&#xd;&#xa;		                          , TO_CHAR&#x28;TO_DATE&#x28;homologacao.timestamp&#x3a;&#x3a;varchar, &#x27;YYYY-MM-DD&#x27;&#x29;,&#x27;DDMMYYYY&#x27;&#x29; as dt_homologacao&#xd;&#xa;		                          , TO_CHAR&#x28;TO_DATE&#x28;adjudicacao.timestamp&#x3a;&#x3a;varchar, &#x27;YYYY-MM-DD&#x27;&#x29;,&#x27;DDMMYYYY&#x27;&#x29; as dt_adjudicacao&#xd;&#xa;		                    FROM licitacao.homologacao&#xd;&#xa;		              INNER JOIN licitacao.adjudicacao&#xd;&#xa;		                      ON adjudicacao.num_adjudicacao     &#x3d; homologacao.num_adjudicacao&#xd;&#xa;		                     AND adjudicacao.cod_entidade        &#x3d; homologacao.cod_entidade&#xd;&#xa;		                     AND adjudicacao.cod_modalidade      &#x3d; homologacao.cod_modalidade&#xd;&#xa;		                     AND adjudicacao.cod_licitacao       &#x3d; homologacao.cod_licitacao&#xd;&#xa;		                     AND adjudicacao.exercicio_licitacao &#x3d; homologacao.exercicio_licitacao&#xd;&#xa;		                     AND adjudicacao.cod_item            &#x3d; homologacao.cod_item&#xd;&#xa;		                     AND adjudicacao.cod_cotacao         &#x3d; homologacao.cod_cotacao&#xd;&#xa;		                     AND adjudicacao.lote                &#x3d; homologacao.lote&#xd;&#xa;		                     AND adjudicacao.exercicio_cotacao   &#x3d; homologacao.exercicio_cotacao&#xd;&#xa;		                     AND adjudicacao.cgm_fornecedor      &#x3d; homologacao.cgm_fornecedor&#xd;&#xa;		              INNER JOIN licitacao.cotacao_licitacao&#xd;&#xa;		                      ON cotacao_licitacao.cod_licitacao       &#x3d; adjudicacao.cod_licitacao&#xd;&#xa;		                     AND cotacao_licitacao.cod_modalidade      &#x3d; adjudicacao.cod_modalidade&#xd;&#xa;		                     AND cotacao_licitacao.cod_entidade        &#x3d; adjudicacao.cod_entidade&#xd;&#xa;		                     AND cotacao_licitacao.exercicio_licitacao &#x3d; adjudicacao.exercicio_licitacao&#xd;&#xa;		                     AND cotacao_licitacao.lote                &#x3d; adjudicacao.lote&#xd;&#xa;		                     AND cotacao_licitacao.cod_cotacao         &#x3d; adjudicacao.cod_cotacao&#xd;&#xa;		                     AND cotacao_licitacao.cod_item            &#x3d; adjudicacao.cod_item&#xd;&#xa;		                     AND cotacao_licitacao.exercicio_cotacao   &#x3d; adjudicacao.exercicio_cotacao&#xd;&#xa;		                     AND cotacao_licitacao.cgm_fornecedor      &#x3d; adjudicacao.cgm_fornecedor&#xd;&#xa;		              INNER JOIN licitacao.licitacao&#xd;&#xa;		                      ON licitacao.cod_licitacao  &#x3d; cotacao_licitacao.cod_licitacao&#xd;&#xa;		                     AND licitacao.cod_modalidade &#x3d; cotacao_licitacao.cod_modalidade&#xd;&#xa;		                     AND licitacao.cod_entidade   &#x3d; cotacao_licitacao.cod_entidade&#xd;&#xa;		                     AND licitacao.exercicio      &#x3d; cotacao_licitacao.exercicio_licitacao&#xd;&#xa;		              INNER JOIN licitacao.participante&#xd;&#xa;		                      ON participante.cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                     AND participante.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                     AND participante.cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;		                     AND participante.exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;		              INNER JOIN compras.fornecedor&#xd;&#xa;		                      ON fornecedor.cgm_fornecedor &#x3d; participante.cgm_fornecedor&#xd;&#xa;		              INNER JOIN compras.cotacao_fornecedor_item&#xd;&#xa;		                      ON cotacao_fornecedor_item.cgm_fornecedor &#x3d; cotacao_licitacao.cgm_fornecedor&#xd;&#xa;		                     AND cotacao_fornecedor_item.cod_cotacao    &#x3d; cotacao_licitacao.cod_cotacao&#xd;&#xa;		                     AND cotacao_fornecedor_item.exercicio      &#x3d; cotacao_licitacao.exercicio_cotacao&#xd;&#xa;		                     AND cotacao_fornecedor_item.lote           &#x3d; cotacao_licitacao.lote&#xd;&#xa;		                     AND cotacao_fornecedor_item.cod_item       &#x3d; cotacao_licitacao.cod_item&#xd;&#xa;		              INNER JOIN compras.cotacao_item&#xd;&#xa;		                      ON cotacao_item.exercicio   &#x3d; cotacao_fornecedor_item.exercicio&#xd;&#xa;		                     AND cotacao_item.cod_cotacao &#x3d; cotacao_fornecedor_item.cod_cotacao&#xd;&#xa;		                     AND cotacao_item.cod_item    &#x3d; cotacao_fornecedor_item.cod_item&#xd;&#xa;		                     AND cotacao_item.lote        &#x3d; cotacao_fornecedor_item.lote&#xd;&#xa;		              INNER JOIN compras.cotacao&#xd;&#xa;		                      ON cotacao.exercicio   &#x3d; cotacao_item.exercicio&#xd;&#xa;		                     AND cotacao.cod_cotacao &#x3d; cotacao_item.cod_cotacao&#xd;&#xa;		              INNER JOIN compras.mapa_cotacao&#xd;&#xa;		                      ON mapa_cotacao.exercicio_cotacao &#x3d; cotacao.exercicio&#xd;&#xa;		                     AND mapa_cotacao.cod_cotacao       &#x3d; cotacao.cod_cotacao&#xd;&#xa;		              INNER JOIN compras.julgamento_item&#xd;&#xa;		                      ON  cotacao_fornecedor_item.exercicio       &#x3d; julgamento_item.exercicio&#xd;&#xa;		                     AND   cotacao_fornecedor_item.cod_cotacao    &#x3d; julgamento_item.cod_cotacao&#xd;&#xa;		                     AND   cotacao_fornecedor_item.cod_item       &#x3d; julgamento_item.cod_item&#xd;&#xa;		                     AND   cotacao_fornecedor_item.cgm_fornecedor &#x3d; julgamento_item.cgm_fornecedor&#xd;&#xa;		                     AND   cotacao_fornecedor_item.lote           &#x3d; julgamento_item.lote&#xd;&#xa;		              INNER JOIN compras.mapa&#xd;&#xa;		                      ON mapa.exercicio &#x3d; mapa_cotacao.exercicio_mapa&#xd;&#xa;		                     AND mapa.cod_mapa  &#x3d; mapa_cotacao.cod_mapa&#xd;&#xa;		              INNER JOIN  compras.mapa_item&#xd;&#xa;		                      ON  mapa_item.exercicio &#x3d; mapa.exercicio&#xd;&#xa;		                     AND  mapa_item.cod_mapa  &#x3d; mapa.cod_mapa&#xd;&#xa;		                     AND  mapa_item.cod_item  &#x3d; cotacao_fornecedor_item.cod_item&#xd;&#xa;		                     AND  mapa_item.lote      &#x3d; cotacao_fornecedor_item.lote&#xd;&#xa;		              INNER JOIN compras.mapa_item_dotacao&#xd;&#xa;		                      ON mapa_item_dotacao.exercicio             &#x3d; mapa_item.exercicio&#xd;&#xa;		                     AND mapa_item_dotacao.cod_mapa              &#x3d; mapa_item.cod_mapa&#xd;&#xa;		                     AND mapa_item_dotacao.exercicio_solicitacao &#x3d; mapa_item.exercicio_solicitacao&#xd;&#xa;		                     AND mapa_item_dotacao.cod_entidade          &#x3d; mapa_item.cod_entidade&#xd;&#xa;		                     AND mapa_item_dotacao.cod_solicitacao       &#x3d; mapa_item.cod_solicitacao&#xd;&#xa;		                     AND mapa_item_dotacao.cod_centro            &#x3d; mapa_item.cod_centro&#xd;&#xa;		                     AND mapa_item_dotacao.cod_item              &#x3d; mapa_item.cod_item&#xd;&#xa;		                     AND mapa_item_dotacao.lote                  &#x3d; mapa_item.lote&#xd;&#xa;		              INNER JOIN compras.solicitacao_item_dotacao&#xd;&#xa;		                      ON solicitacao_item_dotacao.exercicio       &#x3d; mapa_item_dotacao.exercicio_solicitacao&#xd;&#xa;		                     AND solicitacao_item_dotacao.cod_entidade    &#x3d; mapa_item_dotacao.cod_entidade&#xd;&#xa;		                     AND solicitacao_item_dotacao.cod_solicitacao &#x3d; mapa_item_dotacao.cod_solicitacao&#xd;&#xa;		                     AND solicitacao_item_dotacao.cod_centro      &#x3d; mapa_item_dotacao.cod_centro&#xd;&#xa;		                     AND solicitacao_item_dotacao.cod_item        &#x3d; mapa_item_dotacao.cod_item&#xd;&#xa;		                     AND solicitacao_item_dotacao.cod_conta       &#x3d; mapa_item_dotacao.cod_conta&#xd;&#xa;		                     AND solicitacao_item_dotacao.cod_despesa     &#x3d; mapa_item_dotacao.cod_despesa&#xd;&#xa;		              INNER JOIN orcamento.despesa&#xd;&#xa;		                      ON despesa.exercicio   &#x3d; solicitacao_item_dotacao.exercicio&#xd;&#xa;		                     AND despesa.cod_despesa &#x3d; solicitacao_item_dotacao.cod_despesa&#xd;&#xa;		                 INNER JOIN &#x28;&#xd;&#xa;		                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;          &#xd;&#xa;																	VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																	   ,cod_modalidade		INTEGER&#xd;&#xa;																	   ,cod_entidade		INTEGER&#xd;&#xa;																	   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																	   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																	   ,num_licitacao		TEXT &#x29;&#xd;&#xa;		                 &#x29; AS config_licitacao&#xd;&#xa;		                 ON config_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;		                AND config_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                AND config_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                AND config_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;		              WHERE licitacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;		                AND TO_DATE&#x28;homologacao.timestamp&#x3a;&#x3a;varchar, &#x27;YYYY-MM-DD&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;    &#xd;&#xa;		                AND licitacao.cod_modalidade NOT IN &#x28;8,9&#x29;&#xd;&#xa;		                AND NOT EXISTS&#x28; SELECT 1 FROM licitacao.licitacao_anulada&#xd;&#xa;		                                WHERE licitacao_anulada.cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                                AND licitacao_anulada.cod_modalidade   &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                                AND licitacao_anulada.cod_entidade     &#x3d; licitacao.cod_entidade&#xd;&#xa;		                                AND licitacao_anulada.exercicio        &#x3d; licitacao.exercicio &#x29;&#xd;&#xa;		            GROUP BY 1,2,3,4,5,6,7&#xd;&#xa;		            ORDER BY nro_processolicitatorio&#xd;&#xa;			&#x29;,&#xd;&#xa;			  homolic_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							nro_processolicitatorio,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidadesub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 5,&#x27; &#x27;&#x29;		&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_processolicitatorio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_documento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_lote&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_item&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;quantidade&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;valor_unitario&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from homolic10&#xd;&#xa;				union all   &#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							nro_processolicitatorio,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidadesub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 5,&#x27; &#x27;&#x29;		&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_processolicitatorio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_homologacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_adjudicacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from homolic30&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;HOMOLIC.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from homolic_format order by nro_processolicitatorio,tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;		&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;JULGLIC.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then				&#xd;&#xa;			with julglic10 as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 10 AS tipo_registro&#xd;&#xa;	                       , LPAD&#x28;configuracao_entidade.valor,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;	                       , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade&#xd;&#xa;	                       , &#x28; SELECT exercicio_licitacao&#xd;&#xa;	                             FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;   &#xd;&#xa;	                                                               VALUES &#x28;cod_licitacao       INTEGER&#xd;&#xa;	                                                                      ,cod_modalidade      INTEGER&#xd;&#xa;	                                                                      ,cod_entidade        INTEGER&#xd;&#xa;	                                                                      ,exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;	                                                                      ,exercicio_licitacao VARCHAR&#xd;&#xa;	                                                                      ,num_licitacao       TEXT &#x29;&#xd;&#xa;	                            WHERE cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;	                              AND cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;	                              AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;	                              AND exercicio &#x3d; licitacao.exercicio&#xd;&#xa;	                         &#x29; AS exercicio_licitacao&#xd;&#xa;	                       , &#x28; SELECT num_licitacao&#xd;&#xa;	                             FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;   &#xd;&#xa;	                                                               VALUES &#x28;cod_licitacao       INTEGER&#xd;&#xa;	                                                                      ,cod_modalidade      INTEGER&#xd;&#xa;	                                                                      ,cod_entidade        INTEGER&#xd;&#xa;	                                                                      ,exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;	                                                                      ,exercicio_licitacao VARCHAR&#xd;&#xa;	                                                                      ,num_licitacao       TEXT &#x29;&#xd;&#xa;	                            WHERE cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;	                              AND cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;	                              AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;	                              AND exercicio &#x3d; licitacao.exercicio&#xd;&#xa;	                         &#x29; AS num_processo_licitatorio&#xd;&#xa;	                       , documento_pessoa.tipo_documento AS tipo_documento&#xd;&#xa;	                       , documento_pessoa.num_documento AS num_documento&#xd;&#xa;	                       , CASE WHEN mapa.cod_tipo_licitacao &#x3d; 2&#xd;&#xa;	                                   THEN homologacao.lote&#x3a;&#x3a;VARCHAR&#xd;&#xa;	                              ELSE &#x27; &#x27;&#xd;&#xa;	                         END AS num_lote&#xd;&#xa;	                       , mapa_item.cod_item AS cod_item&#xd;&#xa;	                       , &#x28;SUM&#x28;mapa_item.vl_total&#x29; &#x2f; SUM&#x28;mapa_item.quantidade&#x29; &#x29;&#x3a;&#x3a;numeric&#x28;14,4&#x29; AS vl_unitario&#xd;&#xa;	                       , SUM&#x28;mapa_item.quantidade&#x29;&#x3a;&#x3a;numeric&#x28;14,4&#x29; AS quantidade&#xd;&#xa;	                    FROM licitacao.licitacao&#xd;&#xa;	              INNER JOIN compras.mapa&#xd;&#xa;	                      ON mapa.exercicio &#x3d; licitacao.exercicio_mapa&#xd;&#xa;	                     AND mapa.cod_mapa &#x3d; licitacao.cod_mapa&#xd;&#xa;	              INNER JOIN compras.mapa_solicitacao&#xd;&#xa;	                      ON mapa_solicitacao.exercicio &#x3d; mapa.exercicio&#xd;&#xa;	                     AND mapa_solicitacao.cod_mapa &#x3d; mapa.cod_mapa&#xd;&#xa;	              INNER JOIN compras.mapa_item&#xd;&#xa;	                      ON mapa_item.exercicio &#x3d; mapa_solicitacao.exercicio&#xd;&#xa;	                     AND mapa_item.cod_entidade &#x3d; mapa_solicitacao.cod_entidade&#xd;&#xa;	                     AND mapa_item.cod_solicitacao &#x3d; mapa_solicitacao.cod_solicitacao&#xd;&#xa;	                     AND mapa_item.cod_mapa &#x3d; mapa_solicitacao.cod_mapa&#xd;&#xa;	                     AND mapa_item.exercicio_solicitacao &#x3d; mapa_solicitacao.exercicio_solicitacao&#xd;&#xa;	              INNER JOIN compras.mapa_cotacao&#xd;&#xa;	                      ON mapa_cotacao.exercicio_mapa &#x3d; mapa.exercicio&#xd;&#xa;	                     AND mapa_cotacao.cod_mapa &#x3d; mapa.cod_mapa&#xd;&#xa;	              INNER JOIN compras.cotacao&#xd;&#xa;	                      ON cotacao.exercicio &#x3d; mapa_cotacao.exercicio_cotacao&#xd;&#xa;	                     AND cotacao.cod_cotacao &#x3d; mapa_cotacao.cod_cotacao&#xd;&#xa;	              INNER JOIN compras.julgamento&#xd;&#xa;	                      ON julgamento.exercicio &#x3d; cotacao.exercicio&#xd;&#xa;	                     AND julgamento.cod_cotacao &#x3d; cotacao.cod_cotacao&#xd;&#xa;	              INNER JOIN compras.julgamento_item&#xd;&#xa;	                      ON julgamento_item.exercicio &#x3d; julgamento.exercicio&#xd;&#xa;	                     AND julgamento_item.cod_cotacao &#x3d; julgamento.cod_cotacao&#xd;&#xa;	                     AND julgamento_item.cod_item &#x3d; mapa_item.cod_item&#xd;&#xa;	              INNER JOIN licitacao.homologacao&#xd;&#xa;	                      ON homologacao.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;	                     AND homologacao.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;	                     AND homologacao.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;	                     AND homologacao.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;	                     AND homologacao.cod_item&#x3d;julgamento_item.cod_item&#xd;&#xa;	                     AND homologacao.lote&#x3d;julgamento_item.lote&#xd;&#xa;	               LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;	                      ON homologacao_anulada.cod_licitacao&#x3d;homologacao.cod_licitacao&#xd;&#xa;	                     AND homologacao_anulada.cod_modalidade&#x3d;homologacao.cod_modalidade&#xd;&#xa;	                     AND homologacao_anulada.cod_entidade&#x3d;homologacao.cod_entidade&#xd;&#xa;	                     AND homologacao_anulada.exercicio_licitacao&#x3d;homologacao.exercicio_licitacao&#xd;&#xa;	                     AND homologacao_anulada.num_homologacao&#x3d;homologacao.num_homologacao&#xd;&#xa;	                     AND homologacao_anulada.cod_item&#x3d;homologacao.cod_item&#xd;&#xa;	                     AND homologacao_anulada.lote&#x3d;homologacao.lote&#xd;&#xa;	              INNER JOIN administracao.configuracao_entidade&#xd;&#xa;	                      ON configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                     AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;	                     AND configuracao_entidade.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;	                     AND configuracao_entidade.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;	              INNER JOIN &#x28; SELECT num_documento, numcgm, tipo_documento&#xd;&#xa;	                             FROM &#x28;&#xd;&#xa;	                                    SELECT cpf AS num_documento, numcgm, 1 AS tipo_documento&#xd;&#xa;	                                      FROM sw_cgm_pessoa_fisica&#xd;&#xa;	                                     UNION&#xd;&#xa;	                                    SELECT cnpj AS num_documento, numcgm, 2 AS tipo_documento&#xd;&#xa;	                                      FROM sw_cgm_pessoa_juridica&#xd;&#xa;	                                  &#x29; AS tabela&#xd;&#xa;	                         GROUP BY numcgm, num_documento, tipo_documento&#xd;&#xa;	                         &#x29; AS documento_pessoa&#xd;&#xa;	                      ON documento_pessoa.numcgm &#x3d; julgamento_item.cgm_fornecedor&#xd;&#xa;	                   WHERE TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;	                     AND last_day&#x28;TO_DATE&#x28;Stexercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;    &#xd;&#xa;	                     AND homologacao_anulada.cod_licitacao IS NULL&#xd;&#xa;	                     AND licitacao.cod_entidade in  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;     &#xd;&#xa;	                     AND licitacao.cod_modalidade NOT IN &#x28;8,9&#x29;&#xd;&#xa;	                     AND NOT EXISTS &#x28; SELECT 1&#xd;&#xa;	                                        FROM licitacao.licitacao_anulada&#xd;&#xa;	                                       WHERE licitacao_anulada.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;	                                         AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;	                                         AND licitacao_anulada.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;	                                         AND licitacao_anulada.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;	                                    &#x29;&#xd;&#xa;	                GROUP BY tipo_registro&#xd;&#xa;	                       , cod_orgao&#xd;&#xa;	                       , cod_unidade&#xd;&#xa;	                       , tipo_documento&#xd;&#xa;	                       , num_documento&#xd;&#xa;	                       , num_lote&#xd;&#xa;	                       , mapa_item.cod_item&#xd;&#xa;	                       , licitacao.cod_entidade&#xd;&#xa;	                       , licitacao.cod_licitacao&#xd;&#xa;	                       , licitacao.cod_modalidade&#xd;&#xa;	                       , licitacao.exercicio&#xd;&#xa;	                ORDER BY num_processo_licitatorio&#xd;&#xa;			&#x29;,&#xd;&#xa;			   julglic30 as&#xd;&#xa;			&#x28;&#xd;&#xa;			          SELECT 30 AS tipo_registro&#xd;&#xa;			               , LPAD&#x28;configuracao_entidade.valor,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;			               , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade&#xd;&#xa;			               , &#x28;SELECT exercicio_licitacao&#xd;&#xa;			                    FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;  &#xd;&#xa;			                                                      VALUES &#x28;cod_licitacao       INTEGER&#xd;&#xa;			                                                             ,cod_modalidade      INTEGER&#xd;&#xa;			                                                             ,cod_entidade        INTEGER&#xd;&#xa;			                                                             ,exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;			                                                             ,exercicio_licitacao VARCHAR&#xd;&#xa;			                                                             ,num_licitacao       TEXT &#x29;&#xd;&#xa;			                   WHERE cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			                     AND cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                     AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                     AND exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			                 &#x29; AS exercicio_licitacao&#xd;&#xa;			               , &#x28;SELECT num_licitacao&#xd;&#xa;			                    FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;     &#xd;&#xa;			                                                      VALUES &#x28;cod_licitacao       INTEGER&#xd;&#xa;			                                                             ,cod_modalidade      INTEGER&#xd;&#xa;			                                                             ,cod_entidade        INTEGER&#xd;&#xa;			                                                             ,exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;			                                                             ,exercicio_licitacao VARCHAR&#xd;&#xa;			                                                             ,num_licitacao       TEXT &#x29;&#xd;&#xa;			                   WHERE cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			                     AND cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                     AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                     AND exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			                 &#x29; AS num_processo_licitatorio&#xd;&#xa;			               , TO_CHAR&#x28;julgamento.timestamp,&#x27;ddmmyyyy&#x27;&#x29; AS dt_julgamento&#xd;&#xa;			               , 1 AS presenca_licitantes&#xd;&#xa;			               , CASE WHEN participante.renuncia_recurso &#x3d; true THEN&#xd;&#xa;			                                    1&#xd;&#xa;			                         ELSE&#xd;&#xa;			                                    2&#xd;&#xa;			                    END AS renuncia_recurso&#xd;&#xa;			            FROM licitacao.licitacao&#xd;&#xa;			      INNER JOIN licitacao.participante&#xd;&#xa;			              ON participante.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			             AND participante.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			             AND participante.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             AND participante.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			      INNER JOIN compras.mapa&#xd;&#xa;			              ON mapa.exercicio &#x3d; licitacao.exercicio_mapa&#xd;&#xa;			             AND mapa.cod_mapa &#x3d; licitacao.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_solicitacao&#xd;&#xa;			              ON mapa_solicitacao.exercicio &#x3d; mapa.exercicio&#xd;&#xa;			             AND mapa_solicitacao.cod_mapa &#x3d; mapa.cod_mapa&#xd;&#xa;			      INNER JOIN compras.mapa_item&#xd;&#xa;			              ON mapa_item.exercicio &#x3d; mapa_solicitacao.exercicio&#xd;&#xa;			             AND mapa_item.cod_entidade &#x3d; mapa_solicitacao.cod_entidade&#xd;&#xa;			             AND mapa_item.cod_solicitacao &#x3d; mapa_solicitacao.cod_solicitacao&#xd;&#xa;			             AND mapa_item.cod_mapa &#x3d; mapa_solicitacao.cod_mapa&#xd;&#xa;			             AND mapa_item.exercicio_solicitacao &#x3d; mapa_solicitacao.exercicio_solicitacao&#xd;&#xa;			      INNER JOIN compras.mapa_cotacao&#xd;&#xa;			              ON mapa_cotacao.exercicio_mapa &#x3d; mapa.exercicio&#xd;&#xa;			             AND mapa_cotacao.cod_mapa &#x3d; mapa.cod_mapa&#xd;&#xa;			      INNER JOIN compras.cotacao&#xd;&#xa;			              ON cotacao.exercicio &#x3d; mapa_cotacao.exercicio_cotacao&#xd;&#xa;			             AND cotacao.cod_cotacao &#x3d; mapa_cotacao.cod_cotacao&#xd;&#xa;			      INNER JOIN compras.julgamento&#xd;&#xa;			              ON julgamento.exercicio &#x3d; cotacao.exercicio&#xd;&#xa;			             AND julgamento.cod_cotacao &#x3d; cotacao.cod_cotacao&#xd;&#xa;			      INNER JOIN compras.julgamento_item&#xd;&#xa;			              ON julgamento_item.exercicio &#x3d; julgamento.exercicio&#xd;&#xa;			             AND julgamento_item.cod_cotacao &#x3d; julgamento.cod_cotacao&#xd;&#xa;			             AND julgamento_item.cod_item &#x3d; mapa_item.cod_item&#xd;&#xa;			      INNER JOIN licitacao.homologacao&#xd;&#xa;			              ON homologacao.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;			             AND homologacao.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;			             AND homologacao.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;			             AND homologacao.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;			             AND homologacao.cod_item&#x3d;julgamento_item.cod_item&#xd;&#xa;			             AND homologacao.lote&#x3d;julgamento_item.lote&#xd;&#xa;			       LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;			              ON homologacao_anulada.cod_licitacao&#x3d;homologacao.cod_licitacao&#xd;&#xa;			             AND homologacao_anulada.cod_modalidade&#x3d;homologacao.cod_modalidade&#xd;&#xa;			             AND homologacao_anulada.cod_entidade&#x3d;homologacao.cod_entidade&#xd;&#xa;			             AND homologacao_anulada.exercicio_licitacao&#x3d;homologacao.exercicio_licitacao&#xd;&#xa;			             AND homologacao_anulada.num_homologacao&#x3d;homologacao.num_homologacao&#xd;&#xa;			             AND homologacao_anulada.cod_item&#x3d;homologacao.cod_item&#xd;&#xa;			             AND homologacao_anulada.lote&#x3d;homologacao.lote&#xd;&#xa;			      INNER JOIN administracao.configuracao_entidade&#xd;&#xa;			              ON configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			             AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;			             AND configuracao_entidade.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			             AND configuracao_entidade.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			      INNER JOIN sw_cgm AS responsavel&#xd;&#xa;			              ON responsavel.numcgm &#x3d; participante.numcgm_representante&#xd;&#xa;			      INNER JOIN &#x28; SELECT num_documento, numcgm, tipo_documento&#xd;&#xa;			                     FROM &#x28;&#xd;&#xa;			                            SELECT cpf AS num_documento, numcgm, 1 AS tipo_documento&#xd;&#xa;			                              FROM sw_cgm_pessoa_fisica&#xd;&#xa;			                             UNION&#xd;&#xa;			                            SELECT cnpj AS num_documento, numcgm, 2 AS tipo_documento&#xd;&#xa;			                              FROM sw_cgm_pessoa_juridica&#xd;&#xa;			                        &#x29; AS tabela&#xd;&#xa;			                    GROUP BY numcgm, num_documento, tipo_documento&#xd;&#xa;			                 &#x29; AS documento_pessoa&#xd;&#xa;			              ON documento_pessoa.numcgm &#x3d; responsavel.numcgm&#xd;&#xa;			           WHERE TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;			             AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;   &#xd;&#xa;			             AND homologacao_anulada.cod_licitacao IS NULL&#xd;&#xa;			             AND licitacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29; 		&#xd;&#xa;			             AND licitacao.cod_modalidade NOT IN &#x28;8,9&#x29;&#xd;&#xa;			             AND NOT EXISTS&#x28; SELECT 1&#xd;&#xa;			                               FROM licitacao.licitacao_anulada&#xd;&#xa;			                              WHERE licitacao_anulada.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                                AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                                AND licitacao_anulada.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			                                AND licitacao_anulada.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			                           &#x29;&#xd;&#xa;			        GROUP BY tipo_registro&#xd;&#xa;			               , cod_orgao&#xd;&#xa;			               , cod_unidade&#xd;&#xa;			               , dt_julgamento, presenca_licitantes&#xd;&#xa;			               , renuncia_recurso&#xd;&#xa;			               , licitacao.cod_entidade&#xd;&#xa;			               , licitacao.cod_licitacao&#xd;&#xa;			               , licitacao.cod_modalidade&#xd;&#xa;			               , licitacao.exercicio&#xd;&#xa;			        ORDER BY num_processo_licitatorio&#xd;&#xa;			&#x29;,&#xd;&#xa;			  julglic_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							num_processo_licitatorio,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;,5 ,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo_licitatorio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_documento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_lote&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_item&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_unitario&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;quantidade&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from julglic10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							num_processo_licitatorio,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;,5 ,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo_licitatorio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_julgamento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;,8 ,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;presenca_licitantes&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;renuncia_recurso&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from julglic30&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;JULGLIC.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from julglic_format order by num_processo_licitatorio,tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;		&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;ITEM.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with item10 as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 10 AS tipo_Registro&#xd;&#xa;		                    , AC.cod_item AS codItem&#xd;&#xa;		                    , remove_acentos&#x28;SUBSTR&#x28;RTRIM&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;AC.descricao,Chr&#x28;39&#x29;, &#x27;&#x27;&#x29;, Chr&#x28;59&#x29; , &#x27;&#x27;&#x29;, Chr&#x28;34&#x29;, &#x27;&#x27;&#x29;&#x29;, 0, 240&#x29;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; AC.cod_item&#x3a;&#x3a;VARCHAR AS dscItem&#xd;&#xa;		                    , remove_acentos&#x28;AU.nom_unidade&#x29; AS unidadeMedida&#xd;&#xa;		                    , 1 AS tipoCadastro&#xd;&#xa;		                    , &#x27;&#x27;&#x3a;&#x3a; TEXT AS justificativaAlteracao&#xd;&#xa;		                FROM &#x28;&#xd;&#xa;		                        SELECT cod_item&#xd;&#xa;		                        FROM licitacao.homologacao&#xd;&#xa;		                        WHERE to_char&#x28;timestamp,&#x27;mmyyyy&#x27;&#x29; &#x3d;  &#x28;lpad&#x28;stMes, 2 , &#x27;0&#x27;&#x29; &#x7c;&#x7c; stExercicio&#x29;   &#xd;&#xa;		                        AND homologado &#x3d; TRUE&#xd;&#xa;		                        UNION&#xd;&#xa;		                        SELECT cod_item&#xd;&#xa;		                        FROM empenho.empenho&#xd;&#xa;		                        INNER JOIN  empenho.item_pre_empenho&#xd;&#xa;		                            ON item_pre_empenho.cod_pre_empenho     &#x3d; empenho.cod_pre_empenho&#xd;&#xa;		                            AND item_pre_empenho.exercicio          &#x3d; empenho.exercicio&#xd;&#xa;		                        WHERE to_char&#x28;empenho.dt_empenho,&#x27;mmyyyy&#x27;&#x29; &#x3d; &#x28;lpad&#x28;stMes, 2 , &#x27;0&#x27;&#x29; &#x7c;&#x7c; stExercicio&#x29;          &#xd;&#xa;		                        UNION&#xd;&#xa;		                        SELECT cod_item&#xd;&#xa;		                        FROM compras.homologacao&#xd;&#xa;		                        WHERE TO_CHAR&#x28;timestamp,&#x27;mmyyyy&#x27;&#x29; &#x3d; &#x28;lpad&#x28;stMes, 2 , &#x27;0&#x27;&#x29; &#x7c;&#x7c; stExercicio&#x29;    &#xd;&#xa;		                &#x29; as itens&#xd;&#xa;		                INNER JOIN almoxarifado.catalogo_item AS AC&#xd;&#xa;		                    ON AC.cod_item &#x3d; itens.cod_item&#xd;&#xa;		                LEFT JOIN administracao.unidade_medida AS AU&#xd;&#xa;		                     ON AU.cod_unidade  &#x3d; AC.cod_unidade&#xd;&#xa;		                    AND AU.cod_grandeza &#x3d; AC.cod_grandeza&#xd;&#xa;		                INNER JOIN tcemg.arquivo_item&#xd;&#xa;		                     ON arquivo_item.cod_item &#x3d; AC.cod_item&#xd;&#xa;		                    AND arquivo_item.mes &#x3d; lpad&#x28;stMes, 2, &#x27;0&#x27;&#x29;  &#xd;&#xa;		                    AND arquivo_item.exercicio &#x3d; stExercicio &#xd;&#xa;		                WHERE AC.ativo &#x3d; TRUE&#xd;&#xa;			&#x29;, &#xd;&#xa;			  item_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							coditem,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;coditem&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;dscitem&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,1000&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;unidademedida&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipocadastro&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;justificativaalteracao&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,100&#x29;,&#x27; &#x27;&#x29;					&#xd;&#xa;					as d&#xd;&#xa;				from item10&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;ITEM.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from item_format order by coditem,tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;ORGAO.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with orgao10 as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 10 AS tipo_Registro,&#xd;&#xa;			                          &#x28;SELECT valor&#x3a;&#x3a;INTEGER&#xd;&#xa;			                             FROM administracao.configuracao_entidade&#xd;&#xa;			                            WHERE exercicio &#x3d; ACE.exercicio&#xd;&#xa;			                              AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			                              AND cod_entidade &#x3d; ACE.cod_entidade&#x29; AS codOrgao,&#xd;&#xa;			                          ACE.valor&#x3a;&#x3a;INTEGER AS tipoOrgao,&#xd;&#xa;			                          CGM_PJ.cnpj&#x3a;&#x3a;TEXT AS cnpjOrgao,&#xd;&#xa;						  ACE.cod_entidade&#x7c;&#x7c;&#x27;&#x27;&#x7c;&#x7c;ACE.exercicio AS chave,&#xd;&#xa;						  CGM_fornecedor_sw.tipo_documento,&#xd;&#xa;			                          CGM_fornecedor_sw.numero_documento,&#xd;&#xa;						  sem_acentos&#x28;&#x27;Vers&#xe3;o&#x3a; 2054&#x27;&#x29;&#x3a;&#x3a;text AS versao&#xd;&#xa;			                    FROM administracao.configuracao_entidade AS ACE&#xd;&#xa;			              INNER JOIN orcamento.entidade AS OE&#xd;&#xa;			                      ON OE.cod_entidade &#x3d; ACE.cod_entidade&#xd;&#xa;			                     AND OE.exercicio &#x3d; ACE.exercicio&#xd;&#xa;			               LEFT JOIN sw_cgm_pessoa_juridica AS CGM_PJ&#xd;&#xa;			                      ON CGM_PJ.numcgm &#x3d; OE.numcgm&#xd;&#xa;				      INNER JOIN &#x28; SELECT valor&#xd;&#xa;						        , configuracao.exercicio&#xd;&#xa;						        , CGM.tipo_documento&#xd;&#xa;						        , CGM.numero_documento&#xd;&#xa;					             FROM administracao.configuracao&#xd;&#xa;			                             JOIN &#x28; SELECT sw_cgm.numcgm&#xd;&#xa;								 , CASE WHEN sw_cgm_pessoa_fisica.numcgm &#x3d; sw_cgm.numcgm THEN 1&#xd;&#xa;			                                                WHEN sw_cgm_pessoa_juridica.numcgm &#x3d; sw_cgm.numcgm THEN 2&#xd;&#xa;									ELSE 3&#xd;&#xa;			                                           END AS tipo_documento&#xd;&#xa;						                 , CASE WHEN sw_cgm_pessoa_fisica.numcgm &#x3d; sw_cgm.numcgm THEN sw_cgm_pessoa_fisica.cpf&#xd;&#xa;			                                                WHEN sw_cgm_pessoa_juridica.numcgm &#x3d; sw_cgm.numcgm THEN sw_cgm_pessoa_juridica.cnpj&#xd;&#xa;			                                           END AS numero_documento&#xd;&#xa;			                                      FROM sw_cgm&#xd;&#xa;			                                 LEFT JOIN sw_cgm_pessoa_fisica&#xd;&#xa;			                                        ON sw_cgm_pessoa_fisica.numcgm &#x3d; sw_cgm.numcgm&#xd;&#xa;			                                 LEFT JOIN sw_cgm_pessoa_juridica&#xd;&#xa;			                                        ON sw_cgm_pessoa_juridica.numcgm &#x3d; sw_cgm.numcgm&#xd;&#xa;			                                  &#x29; AS CGM&#xd;&#xa;			                                  ON CGM.numcgm&#x3a;&#x3a;text &#x3d; configuracao.valor&#xd;&#xa;			                               WHERE configuracao.parametro&#x3d; &#x27;fornecedor_software&#x27;&#xd;&#xa;			                                 AND configuracao.exercicio&#x3d; stExercicio   &#xd;&#xa;						&#x29; AS CGM_fornecedor_sw&#xd;&#xa;					      ON CGM_fornecedor_sw.exercicio &#x3d; stExercicio   &#xd;&#xa;			                   WHERE ACE.exercicio &#x3d; stExercicio         &#xd;&#xa;			                     AND ACE.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;			                     AND ACE.parametro &#x3d; &#x27;tcemg_tipo_orgao_entidade_sicom&#x27;&#xd;&#xa;			&#x29;,&#xd;&#xa;			   orgao11 as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 11 AS tipo_Registro&#xd;&#xa;						, configuracao_orgao.tipo_responsavel AS tipoResponsavel&#xd;&#xa;						, cgm_pf.rg AS cartIdent&#xd;&#xa;						, sw_uf.sigla_uf AS orgEmissorCi&#xd;&#xa;						, cgm_pf.cpf&#xd;&#xa;						, CASE WHEN configuracao_orgao.tipo_responsavel &#x3d; 2&#xd;&#xa;						       THEN configuracao_orgao.crc_contador&#xd;&#xa;						       ELSE &#x27;&#x27;&#xd;&#xa;						  END as crcContador&#xd;&#xa;						, CASE WHEN configuracao_orgao.tipo_responsavel &#x3d; 2&#xd;&#xa;						       THEN configuracao_orgao.uf_crccontador&#xd;&#xa;						       ELSE &#x27;&#x27;&#xd;&#xa;						  END AS ufCrcContador&#xd;&#xa;						, CASE WHEN configuracao_orgao.tipo_responsavel &#x3d; 4&#xd;&#xa;						       THEN configuracao_orgao.cargo_ordenador_despesa&#xd;&#xa;						       ELSE &#x27;&#x27;&#xd;&#xa;						  END AS cargoOrdDespDeleg&#xd;&#xa;						, configuracao_entidade.exercicio&#xd;&#xa;						, configuracao_entidade.cod_entidade&#xd;&#xa;						, configuracao_orgao.num_cgm AS cgm&#xd;&#xa;						, CASE WHEN TO_CHAR&#x28;TO_DATE&#x28;stDtinicio,&#x27;DD&#x2f;MM&#x2f;YYYY&#x27;&#x29;, &#x27;yyyymmdd&#x27;&#x29; &#x3e; TO_CHAR&#x28;dt_inicio, &#x27;yyyymmdd&#x27;&#x29;   &#xd;&#xa;			                   THEN TO_CHAR&#x28;TO_DATE&#x28;stDtinicio,&#x27;DD&#x2f;MM&#x2f;YYYY&#x27;&#x29;, &#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;			                   ELSE to_char&#x28;configuracao_orgao.dt_inicio, &#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;			               END AS dtInicio&#xd;&#xa;			            , CASE WHEN TO_CHAR&#x28;TO_DATE&#x28;stDtfim,&#x27;DD&#x2f;MM&#x2f;YYYY&#x27;&#x29;, &#x27;yyyymmdd&#x27;&#x29; &#x3c; TO_CHAR&#x28;dt_fim, &#x27;yyyymmdd&#x27;&#x29;       &#xd;&#xa;			                   THEN TO_CHAR&#x28;TO_DATE&#x28;stDtfim,&#x27;DD&#x2f;MM&#x2f;YYYY&#x27;&#x29;, &#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;			                   ELSE to_char&#x28;configuracao_orgao.dt_inicio, &#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;			               END AS dtfinal&#xd;&#xa;			            , configuracao_orgao.email AS email&#xd;&#xa;						, configuracao_entidade.cod_entidade&#x7c;&#x7c;&#x27;&#x27;&#x7c;&#x7c;configuracao_entidade.exercicio AS chave&#xd;&#xa;					   FROM administracao.configuracao_entidade&#xd;&#xa;				     INNER JOIN tcemg.configuracao_orgao&#xd;&#xa;					     ON configuracao_orgao.cod_entidade &#x3d; configuracao_entidade.cod_entidade&#xd;&#xa;					    AND configuracao_orgao.exercicio    &#x3d; configuracao_entidade.exercicio&#xd;&#xa;				      LEFT JOIN sw_cgm_pessoa_fisica AS cgm_pf&#xd;&#xa;					     ON cgm_pf.numcgm &#x3d; configuracao_orgao.num_cgm&#xd;&#xa;				      LEFT JOIN sw_cgm AS cgm&#xd;&#xa;					     ON cgm.numcgm &#x3d; configuracao_orgao.num_cgm&#xd;&#xa;				     INNER JOIN sw_uf&#xd;&#xa;					     ON sw_uf.cod_uf &#x3d; cgm_pf.cod_uf_orgao_emissor&#xd;&#xa;					  WHERE configuracao_entidade.exercicio    &#x3d; stExercicio    &#xd;&#xa;					    AND configuracao_entidade.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;					    AND configuracao_entidade.parametro    &#x3d; &#x27;tcemg_cgm_responsavel&#x27;&#xd;&#xa;					    AND &#x28;TO_DATE&#x28;stDtinicio,&#x27;DD&#x2f;MM&#x2f;YYYY&#x27;&#x29; BETWEEN dt_inicio AND dt_fim   &#xd;&#xa;			                OR&#xd;&#xa;							 TO_DATE&#x28;stDtfim,&#x27;DD&#x2f;MM&#x2f;YYYY&#x27;&#x29; BETWEEN dt_inicio AND dt_fim   &#xd;&#xa;							&#x29;&#xd;&#xa;			&#x29;,&#xd;&#xa;			  orgao_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							chave,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;,2,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipoorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;,2,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cnpjorgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,14 ,&#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;numero_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,14 ,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;versao&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from orgao10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							chave,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tiporesponsavel&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,2 ,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;cartident&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,10&#x29;,&#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;orgemissorci&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,10&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cpf&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,11 ,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;crccontador&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;ufcrccontador&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;,2 ,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;cargoorddespdeleg&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dtinicio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;,8 ,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dtfinal&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;,8 ,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;email&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from orgao11&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;ORGAO.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from orgao_format order by chave,tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;PESSOA.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then				&#xd;&#xa;			with pessoa10 as&#xd;&#xa;			&#x28;&#xd;&#xa;		           SELECT&#xd;&#xa;			                  10 AS tipo_registro&#xd;&#xa;			                , SW_CGM.numcgm&#xd;&#xa;			                , sem_acentos&#x28;SW_CGM.nom_cgm&#x29; AS nome_razao_social&#xd;&#xa;			                , CASE WHEN sw_cgm_pessoa_fisica.cpf IS NOT NULL THEN sw_cgm_pessoa_fisica.cpf&#xd;&#xa;			                       ELSE sw_cgm_pessoa_juridica.cnpj END AS nro_documento&#xd;&#xa;			                , CASE WHEN sw_cgm.cod_pais &#x3c;&#x3e; 1 THEN 3&#xd;&#xa;			                       WHEN sw_cgm_pessoa_fisica.cpf IS NOT NULL THEN 1&#xd;&#xa;			                       ELSE 2 END AS tipo_documento&#xd;&#xa;			                , 1  AS tipo_cadastro&#xd;&#xa;			                , &#x27;&#x27; AS justificativa_alteracao&#xd;&#xa;			           FROM SW_CGM&#xd;&#xa;			      LEFT JOIN sw_cgm_pessoa_fisica&#xd;&#xa;			             ON SW_CGM.numcgm &#x3d; sw_cgm_pessoa_fisica.numcgm&#xd;&#xa;			      LEFT JOIN sw_cgm_pessoa_juridica&#xd;&#xa;			             ON SW_CGM.numcgm &#x3d; sw_cgm_pessoa_juridica.numcgm&#xd;&#xa;			      LEFT JOIN sw_cga&#xd;&#xa;			             ON SW_CGM.numcgm &#x3d; sw_cga.numcgm&#xd;&#xa;			     INNER JOIN tcemg.arquivo_pessoa&#xd;&#xa;			             ON SW_CGM.numcgm &#x3d; arquivo_pessoa.numcgm&#xd;&#xa;			            AND arquivo_pessoa.mes &#x3d; stMes&#x3a;&#x3a;int   &#xd;&#xa;			            AND arquivo_pessoa.ano &#x3d; stExercicio   &#xd;&#xa;			          WHERE SW_CGM.numcgm &#x3e; 0&#xd;&#xa;			            AND &#x28;sw_cgm_pessoa_fisica.cpf IS NOT NULL OR  sw_cgm_pessoa_juridica.cnpj IS NOT NULL &#x29;&#xd;&#xa;			       GROUP BY SW_CGM.numcgm&#xd;&#xa;			              , sw_cgm_pessoa_fisica.cpf&#xd;&#xa;			              , sw_cgm_pessoa_juridica.cnpj&#xd;&#xa;			              , sw_cgm_pessoa_fisica.numcgm&#xd;&#xa;			              , sw_cgm_pessoa_juridica.numcgm&#xd;&#xa;			&#x29;,&#xd;&#xa;			  pessoa_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							tipo_documento,nro_documento, numcgm,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;nome_razao_social&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,120&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_cadastro&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;justificativa_alteracao&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,100&#x29;,&#x27; &#x27;&#x29;   &#xd;&#xa;					as d&#xd;&#xa;				from pessoa10&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;PESSOA.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from pessoa_format order by nro_documento, tipo_documento, numcgm, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;PARPPS.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with parpps10 as&#xd;&#xa;			&#x28;&#xd;&#xa;				Select tipo_registro&#xd;&#xa;	                        , cod_orgao&#xd;&#xa;	                        , vl_saldo_financeiro_exercicioanterior&#xd;&#xa;&#xd;&#xa;	                    From &#x28; Select 10 as tipo_registro&#xd;&#xa;	                                , orgao_sicom.valor as cod_orgao&#xd;&#xa;	                                , &#x28;Select vl_saldo_financeiro from stn.rreo_anexo_13 where ano &#x3d; &#x28;CAST&#x28;stExercicio AS INT&#x29;-1&#x29;&#x3a;&#x3a;TEXT&#x29; as vl_saldo_financeiro_exercicioanterior   &#xd;&#xa;	                            From stn.rreo_anexo_13&#xd;&#xa;	                            JOIN &#x28;SELECT valor&#x3a;&#x3a;integer&#xd;&#xa;	                                        , configuracao_entidade.exercicio&#xd;&#xa;	                                        , configuracao_entidade.cod_entidade&#xd;&#xa;	                                     FROM tcemg.orgao&#xd;&#xa;	                               INNER JOIN administracao.configuracao_entidade&#xd;&#xa;	                                       ON configuracao_entidade.valor&#x3a;&#x3a;integer &#x3d; orgao.num_orgao&#xd;&#xa;	                                    WHERE configuracao_entidade.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;   &#xd;&#xa;	                                  &#x29;  AS orgao_sicom&#xd;&#xa;	                                       ON orgao_sicom.exercicio&#x3d; StExercicio_ant  &#xd;&#xa;	                                      AND orgao_sicom.cod_entidade &#x3d; rreo_anexo_13.cod_entidade&#xd;&#xa;	                            Where rreo_anexo_13.ano &#x3d; stExercicio     &#xd;&#xa;	                           &#x29; as tabela&#xd;&#xa;			&#x29;,&#xd;&#xa;			parpps20 as&#xd;&#xa;			&#x28;&#xd;&#xa;			  Select tipo_registro&#xd;&#xa;			        , cod_orgao&#xd;&#xa;			        , exercicio&#xd;&#xa;			        , vl_receita_previdenciaria&#xd;&#xa;			        , vl_despesa_previdenciaria&#xd;&#xa;			            From &#x28; Select 20 as tipo_registro&#xd;&#xa;			                        , orgao_sicom.valor as cod_orgao&#xd;&#xa;			                        , rreo_anexo_13.ano&#x3a;&#x3a;VARCHAR as exercicio&#xd;&#xa;			                        , rreo_anexo_13.vl_receita_previdenciaria as vl_receita_previdenciaria&#xd;&#xa;			                        , rreo_anexo_13.vl_despesa_previdenciaria as vl_despesa_previdenciaria&#xd;&#xa;			                    From stn.rreo_anexo_13&#xd;&#xa;			                    JOIN &#x28;SELECT valor&#x3a;&#x3a;integer&#xd;&#xa;			                                , configuracao_entidade.exercicio&#xd;&#xa;			                                , configuracao_entidade.cod_entidade&#xd;&#xa;			                             FROM tcemg.orgao&#xd;&#xa;			                       INNER JOIN administracao.configuracao_entidade&#xd;&#xa;			                               ON configuracao_entidade.valor&#x3a;&#x3a;integer &#x3d; orgao.num_orgao&#xd;&#xa;			                            WHERE configuracao_entidade.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;   &#xd;&#xa;			                          &#x29;  AS orgao_sicom&#xd;&#xa;			                               ON orgao_sicom.exercicio&#x3d; &#x27;2014&#x27;&#xd;&#xa;			                              AND orgao_sicom.cod_entidade &#x3d; rreo_anexo_13.cod_entidade&#xd;&#xa;			                    Where&#xd;&#xa;			                        rreo_anexo_13.ano BETWEEN StExercicio_ant AND &#x28;select max&#x28;rreo_anexo_13.ano&#x29; from stn.rreo_anexo_13&#x29;    &#xd;&#xa;			                    Group by  rreo_anexo_13.ano&#xd;&#xa;			                            , orgao_sicom.valor&#xd;&#xa;			                            , rreo_anexo_13.vl_receita_previdenciaria&#xd;&#xa;			                            , rreo_anexo_13.vl_despesa_previdenciaria&#xd;&#xa;			                   &#x29; as tabela&#xd;&#xa;			&#x29;,&#xd;&#xa;			  parpps_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_orgao,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_saldo_financeiro_exercicioanterior&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from parpps10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_orgao,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;exercicio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_receita_previdenciaria&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_despesa_previdenciaria&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from parpps20&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;PARPPS.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from parpps_format order by cod_orgao, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;REC.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with rec10 as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT tipo_registro&#xd;&#xa;					 , cod_receita_final AS cod_receita&#xd;&#xa;					 , cod_orgao&#xd;&#xa;					 , deducao_receita&#xd;&#xa;					 , identificador_deducao&#xd;&#xa;					 , CASE WHEN SUBSTR&#x28;natureza_receita&#x3a;&#x3a;text, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;						THEN SUBSTR&#x28;natureza_receita&#x3a;&#x3a;text, 2, 8&#x29;&#x3a;&#x3a;integer&#xd;&#xa;						ELSE natureza_receita&#xd;&#xa;					    END AS natureza_receita&#xd;&#xa;					 , remove_acentos&#x28;especificacao&#x29; as especificacao&#xd;&#xa;					 , CASE WHEN SUBSTR&#x28;cod_receita_final&#x3a;&#x3a;VARCHAR, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;						THEN REPLACE&#x28;REPLACE&#x28;sum&#x28;tabela.vl_previsto&#x29;&#x3a;&#x3a;VARCHAR,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;-&#x27;,&#x27;&#x27;&#x29;&#xd;&#xa;						ELSE REPLACE&#x28;sum&#x28;tabela.vl_previsto&#x29;&#x3a;&#x3a;VARCHAR,&#x27;.&#x27;,&#x27;,&#x27;&#x29;&#xd;&#xa;					    END AS vl_previsto&#xd;&#xa;				      FROM &#x28;&#xd;&#xa;				           SELECT 10&#x3a;&#x3a;integer AS tipo_registro&#xd;&#xa;						, CASE WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;						       THEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29;&#x3a;&#x3a;integer&#xd;&#xa;						       ELSE CASE WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240101&#xd;&#xa;								   OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240102&#xd;&#xa;								   OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17219903&#xd;&#xa;								 THEN RPAD&#x28;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;, 8, &#x27;0&#x27;&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;								 WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 24210100&#xd;&#xa;								 THEN &#x27;24210101&#x27;&#xd;&#xa;								 WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 19319902&#xd;&#xa;								 THEN &#x27;19319900&#x27;&#xd;&#xa;								 ELSE SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;							     END&#xd;&#xa;						  END AS cod_receita_final&#xd;&#xa;						, configuracao_entidade.valor AS cod_orgao&#xd;&#xa;						, rec.masc_recurso_red AS recurso&#xd;&#xa;						, CASE WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;						       THEN 1&#xd;&#xa;						       ELSE 2&#xd;&#xa;						   END AS deducao_receita&#xd;&#xa;						, valores_identificadores.cod_identificador&#x3a;&#x3a;integer AS identificador_deducao&#xd;&#xa;						, CASE WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;						       THEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29;&#x3a;&#x3a;integer&#xd;&#xa;						       ELSE CASE WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240101&#xd;&#xa;								   OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240102&#xd;&#xa;								   OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17219903&#xd;&#xa;								 THEN RPAD&#x28;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;, 8, &#x27;0&#x27;&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;								 WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 24210100&#xd;&#xa;								 THEN &#x27;24210101&#x27;&#xd;&#xa;								 WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 19319902&#xd;&#xa;								 THEN &#x27;19319900&#x27;&#xd;&#xa;								 ELSE SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;							     END&#xd;&#xa;						  END AS natureza_receita&#xd;&#xa;						, CASE WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;						       THEN &#x28;SELECT TRIM&#x28;o_cr.descricao&#x29;&#xd;&#xa;							       FROM orcamento.conta_receita AS o_cr&#xd;&#xa;							      WHERE o_cr.exercicio &#x3d; stExercicio     &#xd;&#xa;								AND RPAD&#x28;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29;,15,&#x27;0&#x27;&#x29; &#x3d; REPLACE&#x28;o_cr.cod_estrutural,&#x27;.&#x27;,&#x27;&#x27;&#x29;&#x29;&#xd;&#xa;						       ELSE &#x28;SELECT TRIM&#x28;descricao&#x29;&#xd;&#xa;							       FROM orcamento.conta_receita AS o_cr&#xd;&#xa;							      WHERE o_cr.exercicio &#x3d;  stExercicio     &#xd;&#xa;								AND RPAD&#x28;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;,14,&#x27;0&#x27;&#x29; &#x3d; REPLACE&#x28;o_cr.cod_estrutural,&#x27;.&#x27;,&#x27;&#x27;&#x29;&#x29;&#xd;&#xa;						  END AS especificacao&#xd;&#xa;						, CASE WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;						       THEN detalhamento_receitas.arrecadado_periodo&#xd;&#xa;						       ELSE	ABS&#x28;detalhamento_receitas.arrecadado_periodo&#x29;&#xd;&#xa;						  END AS vl_previsto&#xd;&#xa;					     FROM orcamento.receita&#xd;&#xa;					LEFT JOIN orcamento.recurso&#x28;stExercicio&#x29; AS rec    &#xd;&#xa;					       ON rec.cod_recurso &#x3d; receita.cod_recurso&#xd;&#xa;					      AND rec.exercicio   &#x3d; receita.exercicio&#xd;&#xa;				       INNER JOIN orcamento.conta_receita&#xd;&#xa;					       ON conta_receita.cod_conta &#x3d; receita.cod_conta&#xd;&#xa;					      AND conta_receita.exercicio &#x3d; receita.exercicio&#xd;&#xa;				       INNER JOIN administracao.configuracao_entidade&#xd;&#xa;					       ON configuracao_entidade.cod_entidade &#x3d; receita.cod_entidade&#xd;&#xa;					      AND configuracao_entidade.exercicio    &#x3d; receita.exercicio&#xd;&#xa;				       INNER JOIN tcemg.fn_detalhamento_receitas&#x28;stExercicio,&#x27;&#x27;, stDtinicio,stDtfim,stEntidade,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;&#x29;  &#xd;&#xa;				  			         AS detalhamento_receitas &#x28;&#xd;&#xa;									    cod_estrutural      varchar,&#xd;&#xa;									    receita             integer,&#xd;&#xa;									    recurso             varchar,&#xd;&#xa;									    descricao           varchar,&#xd;&#xa;									    valor_previsto      numeric,&#xd;&#xa;									    arrecadado_periodo  numeric,&#xd;&#xa;									    arrecadado_ano      numeric,&#xd;&#xa;									    diferenca           numeric&#xd;&#xa;					    &#x29; ON detalhamento_receitas.cod_estrutural &#x3d; conta_receita.cod_estrutural&#xd;&#xa;					     AND SUBSTR&#x28;detalhamento_receitas.cod_estrutural, 1, 1&#x29; &#x21;&#x3d; &#x27;9&#x27;&#xd;&#xa;					LEFT JOIN tcemg.receita_indentificadores_peculiar_receita&#xd;&#xa;					       ON receita_indentificadores_peculiar_receita.exercicio &#x3d; receita.exercicio&#xd;&#xa;					      AND receita_indentificadores_peculiar_receita.cod_receita &#x3d; receita.cod_receita&#xd;&#xa;					LEFT JOIN tcemg.valores_identificadores&#xd;&#xa;					       ON valores_identificadores.cod_identificador &#x3d; receita_indentificadores_peculiar_receita.cod_identificador&#xd;&#xa;					     WHERE receita.exercicio &#x3d; stExercicio     &#xd;&#xa;					       AND receita.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;     &#xd;&#xa;					       AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;					       AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;					       &#xd;&#xa;					       AND conta_receita.cod_conta NOT IN &#x28;384&#x29; &#xd;&#xa;					 GROUP BY  cod_receita_final&#xd;&#xa;						 , conta_receita.cod_estrutural&#xd;&#xa;						 , conta_receita.descricao&#xd;&#xa;						 , cod_orgao&#xd;&#xa;						 , identificador_deducao&#xd;&#xa;						 , detalhamento_receitas.arrecadado_periodo&#xd;&#xa;						 , rec.masc_recurso_red&#xd;&#xa;					 UNION&#xd;&#xa;					   SELECT 10&#x3a;&#x3a;integer AS tipo_registro&#xd;&#xa;						, SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29;&#x3a;&#x3a;integer AS cod_receita_final&#xd;&#xa;						, LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;						, rec.masc_recurso_red AS recurso&#xd;&#xa;						, CASE WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;						       THEN 1&#xd;&#xa;						       ELSE 2&#xd;&#xa;						END AS deducao_receita&#xd;&#xa;						, valores_identificadores.cod_identificador AS indentificador_deducao&#xd;&#xa;						, SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29;&#x3a;&#x3a;integer AS natureza_receita&#xd;&#xa;						, TRIM&#x28;conta_receita.descricao&#x29; AS especificacao&#xd;&#xa;						, SUM&#x28;arrecadacao_receita_dedutora.vl_deducao&#x29; AS vl_previsto&#xd;&#xa;					     FROM orcamento.receita&#xd;&#xa;					LEFT JOIN orcamento.recurso&#x28;stExercicio&#x29; as rec     &#xd;&#xa;					       ON rec.cod_recurso &#x3d; receita.cod_recurso&#xd;&#xa;					      AND rec.exercicio   &#x3d; receita.exercicio&#xd;&#xa;				       INNER JOIN tesouraria.arrecadacao_receita_dedutora&#xd;&#xa;					       ON arrecadacao_receita_dedutora.cod_receita_dedutora&#x3d;receita.cod_receita&#xd;&#xa;					      AND arrecadacao_receita_dedutora.exercicio&#x3d;receita.exercicio&#xd;&#xa;					      AND arrecadacao_receita_dedutora.timestamp_arrecadacao&#x3a;&#x3a;date BETWEEN TO_DATE&#x28; stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27; &#x29; AND TO_DATE&#x28; stDtfim, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27; &#x29;   &#xd;&#xa;				       INNER JOIN administracao.configuracao_entidade&#xd;&#xa;					       ON configuracao_entidade.cod_entidade &#x3d; receita.cod_entidade&#xd;&#xa;					      AND configuracao_entidade.exercicio &#x3d; receita.exercicio&#xd;&#xa;				       INNER JOIN orcamento.conta_receita&#xd;&#xa;					       ON conta_receita.cod_conta &#x3d; receita.cod_conta&#xd;&#xa;					      AND conta_receita.exercicio &#x3d; receita.exercicio&#xd;&#xa;					LEFT JOIN tcemg.receita_indentificadores_peculiar_receita&#xd;&#xa;					       ON receita_indentificadores_peculiar_receita.exercicio &#x3d; receita.exercicio&#xd;&#xa;					      AND receita_indentificadores_peculiar_receita.cod_receita &#x3d; receita.cod_receita&#xd;&#xa;					LEFT JOIN tcemg.valores_identificadores&#xd;&#xa;					       ON valores_identificadores.cod_identificador &#x3d; receita_indentificadores_peculiar_receita.cod_identificador&#xd;&#xa;					     WHERE receita.exercicio &#x3d; stExercicio         &#xd;&#xa;					       AND receita.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;					       AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;					       AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_tipo_orgao_entidade_sicom&#x27;&#xd;&#xa;					 GROUP BY receita.cod_receita&#xd;&#xa;						 , receita.exercicio&#xd;&#xa;						 , cod_orgao&#xd;&#xa;						 , conta_receita.cod_estrutural&#xd;&#xa;						 , conta_receita.descricao&#xd;&#xa;						 , indentificador_deducao&#xd;&#xa;						 , natureza_receita&#xd;&#xa;						 , especificacao&#xd;&#xa;						 , rec.masc_recurso_red&#xd;&#xa;					   &#x29; AS tabela&#xd;&#xa;				       WHERE tabela.vl_previsto&#x3c;&#x3e;0.00&#xd;&#xa;				    GROUP BY tipo_registro&#xd;&#xa;				           , cod_orgao&#xd;&#xa;					   , deducao_receita&#xd;&#xa;					   , identificador_deducao&#xd;&#xa;					   , natureza_receita&#xd;&#xa;					   , cod_receita&#xd;&#xa;					   , especificacao&#xd;&#xa;				    ORDER BY tabela.natureza_receita&#xd;&#xa;			&#x29;,&#xd;&#xa;			rec11 as&#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT tipo_registro&#xd;&#xa;				 , cod_receita&#xd;&#xa;				 , cod_font_recursos&#xd;&#xa;				 , REPLACE&#x28;REPLACE&#x28;sum&#x28;vl_arrecadado_fonte&#x29;&#x3a;&#x3a;VARCHAR,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;-&#x27;,&#x27;&#x27;&#x29; AS vl_arrecadado_fonte&#xd;&#xa;			       FROM&#x28;&#xd;&#xa;					SELECT 11 AS tipo_registro&#xd;&#xa;					     , CASE WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;						    THEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29;&#x3a;&#x3a;integer&#xd;&#xa;							   ELSE CASE WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240101&#xd;&#xa;								       OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17240102&#xd;&#xa;								       OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 17219903&#xd;&#xa;								     THEN RPAD&#x28;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;, 8, &#x27;0&#x27;&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;								     WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 24210100&#xd;&#xa;								     THEN &#x27;24210101&#x27;&#xd;&#xa;								     WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER &#x3d; 19319902&#xd;&#xa;								     THEN &#x27;19319900&#x27;&#xd;&#xa;								     ELSE SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;								 END&#xd;&#xa;						END AS cod_receita&#xd;&#xa;					     , receita.cod_recurso&#x3a;&#x3a;integer AS cod_font_recursos&#xd;&#xa;					     , detalhamento_receitas.arrecadado_periodo AS vl_arrecadado_fonte&#xd;&#xa;					  FROM orcamento.receita&#xd;&#xa;				    INNER JOIN orcamento.conta_receita&#xd;&#xa;					    ON conta_receita.cod_conta &#x3d; receita.cod_conta&#xd;&#xa;					   AND conta_receita.exercicio &#x3d; receita.exercicio&#xd;&#xa;				    INNER JOIN &#x28;&#xd;&#xa;				                SELECT cod_estrutural&#xd;&#xa;						     , receita&#xd;&#xa;						     , recurso&#xd;&#xa;						     , descricao&#xd;&#xa;						     , sum&#x28;detalhamento.arrecadado_periodo&#x29; as arrecadado_periodo&#xd;&#xa;						  FROM &#x28;&#xd;&#xa;							  SELECT &#x2a; FROM tcemg.fn_detalhamento_receitas&#x28;stExercicio,&#x27;&#x27;,stDtinicio,stDtfim,stEntidade,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;&#x29;  &#xd;&#xa;							      AS detalhamento_receitas&#x28;&#xd;&#xa;											cod_estrutural      varchar,&#xd;&#xa;											receita             integer,&#xd;&#xa;											recurso             varchar,&#xd;&#xa;											descricao           varchar,&#xd;&#xa;											valor_previsto      numeric,&#xd;&#xa;											arrecadado_periodo  numeric,&#xd;&#xa;											arrecadado_ano      numeric,&#xd;&#xa;											diferenca           numeric&#xd;&#xa;								&#x29;&#xd;&#xa;							    WHERE SUBSTR&#x28;cod_estrutural, 1, 1&#x29; &#x21;&#x3d; &#x27;9&#x27;&#xd;&#xa;							UNION&#xd;&#xa;							  SELECT conta_receita.cod_estrutural&#x3a;&#x3a;varchar AS cod_estrutural&#xd;&#xa;							       , receita.cod_receita AS receita&#xd;&#xa;							       , rec.masc_recurso_red AS recurso&#xd;&#xa;							       , TRIM&#x28;conta_receita.descricao&#x29;&#x3a;&#x3a;varchar AS descricao&#xd;&#xa;							       , 0.00&#x3a;&#x3a;numeric AS valor_previsto&#xd;&#xa;							       , SUM&#x28;arrecadacao_receita_dedutora.vl_deducao&#x29;&#x3a;&#x3a;numeric AS arrecadado_periodo&#xd;&#xa;							       , 0.00&#x3a;&#x3a;numeric AS arrecadado_ano&#xd;&#xa;							       , 0.00&#x3a;&#x3a;numeric AS diferenca&#xd;&#xa;							    FROM orcamento.receita&#xd;&#xa;						       LEFT JOIN orcamento.recurso&#x28;stExercicio&#x29; as rec     &#xd;&#xa;							      ON rec.cod_recurso &#x3d; receita.cod_recurso&#xd;&#xa;							     AND rec.exercicio   &#x3d; receita.exercicio&#xd;&#xa;						      INNER JOIN tesouraria.arrecadacao_receita_dedutora&#xd;&#xa;							      ON arrecadacao_receita_dedutora.cod_receita_dedutora &#x3d; receita.cod_receita&#xd;&#xa;							     AND arrecadacao_receita_dedutora.exercicio            &#x3d; receita.exercicio&#xd;&#xa;							     AND arrecadacao_receita_dedutora.timestamp_arrecadacao&#x3a;&#x3a;date BETWEEN TO_DATE&#x28; stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27; &#x29; AND TO_DATE&#x28; stDtfim, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27; &#x29;  &#xd;&#xa;						      INNER JOIN administracao.configuracao_entidade&#xd;&#xa;							      ON configuracao_entidade.cod_entidade &#x3d; receita.cod_entidade&#xd;&#xa;							     AND configuracao_entidade.exercicio    &#x3d; receita.exercicio&#xd;&#xa;						      INNER JOIN orcamento.conta_receita&#xd;&#xa;							      ON conta_receita.cod_conta &#x3d; receita.cod_conta&#xd;&#xa;							     AND conta_receita.exercicio &#x3d; receita.exercicio&#xd;&#xa;						       LEFT JOIN tcemg.receita_indentificadores_peculiar_receita&#xd;&#xa;							      ON receita_indentificadores_peculiar_receita.exercicio   &#x3d; receita.exercicio&#xd;&#xa;							     AND receita_indentificadores_peculiar_receita.cod_receita &#x3d; receita.cod_receita&#xd;&#xa;						       LEFT JOIN tcemg.valores_identificadores&#xd;&#xa;							      ON valores_identificadores.cod_identificador &#x3d; receita_indentificadores_peculiar_receita.cod_identificador&#xd;&#xa;							   WHERE receita.exercicio    &#x3d; stExercicio        &#xd;&#xa;							     AND receita.cod_entidade IN  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;  &#xd;&#xa;							     AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;							     AND configuracao_entidade.parametro  &#x3d; &#x27;tcemg_tipo_orgao_entidade_sicom&#x27;&#xd;&#xa;							GROUP BY receita.cod_receita&#xd;&#xa;							       , receita.exercicio&#xd;&#xa;							       , cod_estrutural&#xd;&#xa;							       , conta_receita.descricao&#xd;&#xa;							       , rec.masc_recurso_red&#xd;&#xa;						    &#x29;&#xd;&#xa;						   AS detalhamento&#xd;&#xa;					     GROUP BY cod_estrutural&#xd;&#xa;						    , receita&#xd;&#xa;						    , recurso&#xd;&#xa;						    , descricao&#xd;&#xa;					    &#x29; AS detalhamento_receitas&#xd;&#xa;					    ON detalhamento_receitas.cod_estrutural &#x3d; conta_receita.cod_estrutural&#xd;&#xa;					 WHERE receita.exercicio    &#x3d; stExercicio        &#xd;&#xa;					   AND receita.cod_entidade IN  &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;					   &#xd;&#xa;					   AND detalhamento_receitas.arrecadado_periodo &#x3c;&#x3e; 0.00&#xd;&#xa;				      GROUP BY receita.cod_receita&#xd;&#xa;					     , receita.cod_recurso&#xd;&#xa;					     , conta_receita.cod_estrutural&#xd;&#xa;					     , detalhamento_receitas.arrecadado_periodo&#xd;&#xa;				      ORDER BY tipo_registro&#xd;&#xa;					     , cod_receita&#xd;&#xa;					     , cod_font_recursos&#xd;&#xa;					     &#x29; AS tabela&#xd;&#xa;				      GROUP BY tipo_registro&#xd;&#xa;					     , cod_receita&#xd;&#xa;					     , cod_font_recursos&#xd;&#xa;				      ORDER BY tipo_registro&#xd;&#xa;				             , cod_receita&#xd;&#xa;					     , cod_font_recursos&#xd;&#xa;			&#x29;,&#xd;&#xa;			  rec_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_receita,&#xd;&#xa;							0 as cod_font_recursos,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_receita&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;deducao_receita&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;identificador_deducao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;natureza_receita&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;especificacao&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,100&#x29;,&#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_previsto&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from rec10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_receita,&#xd;&#xa;							cod_font_recursos,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_receita&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_font_recursos&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_arrecadado_fonte&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from rec11&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;REC.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from rec_format order by cod_receita, cod_font_recursos, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;REGLIC.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with reglic10 as&#xd;&#xa;			&#x28;&#xd;&#xa;							SELECT norma.cod_norma&#xd;&#xa;                                   , &#x27;10&#x27; as tipo_registro&#xd;&#xa;                                   , tipo_registro_preco.cod_entidade as cod_orgao&#xd;&#xa;                                   , tipo_registro_preco.cod_tipo_decreto as tipo_decreto&#xd;&#xa;                                   , num_norma&#x3a;&#x3a;integer as nro_decreto_municipal&#xd;&#xa;                                   , to_char&#x28; norma.dt_assinatura&#x3a;&#x3a;date, &#x27;ddmmyyyy&#x27;&#x3a;&#x3a;text &#x29;  as data_decreto_municipal&#xd;&#xa;                                   , to_char&#x28; norma.dt_publicacao&#x3a;&#x3a;date, &#x27;ddmmyyyy&#x27;&#x3a;&#x3a;text &#x29;  as data_publicacao_decreto_municipal&#xd;&#xa;                            FROM  tcemg.tipo_registro_preco&#xd;&#xa;                    INNER JOIN normas.norma&#xd;&#xa;                                ON norma.cod_norma &#x3d; tipo_registro_preco.cod_norma&#xd;&#xa;                         WHERE tipo_registro_preco.exercicio &#x3d;  stExercicio   &#xd;&#xa;                             AND tipo_registro_preco.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;  &#xd;&#xa;                             AND tipo_registro_preco.cod_tipo_decreto IS NOT NULL&#xd;&#xa;                   GROUP BY norma.cod_norma&#xd;&#xa;                                 , tipo_registro&#xd;&#xa;                                 , cod_orgao&#xd;&#xa;                                 , tipo_decreto&#xd;&#xa;                                 , num_norma&#xd;&#xa;			&#x29;,&#xd;&#xa;			reglic20 as&#xd;&#xa;			&#x28;&#xd;&#xa;	                SELECT&#xd;&#xa;	                        20 AS tipo_registro&#xd;&#xa;	                      , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;	                      , configuracao_reglic.&#x2a;&#xd;&#xa;	                      , to_char&#x28; norma.dt_assinatura&#x3a;&#x3a;date, &#x27;ddmmyyyy&#x27;&#x3a;&#x3a;text &#x29;  as data_norma_reg&#xd;&#xa;	                      , to_char&#x28; norma.dt_publicacao&#x3a;&#x3a;date, &#x27;ddmmyyyy&#x27;&#x3a;&#x3a;text &#x29;  as data_pub_norma_reg&#xd;&#xa;	                      , num_norma as  nro_norma_reg&#xd;&#xa;	                FROM tcemg.configuracao_reglic&#xd;&#xa;	                JOIN normas.norma&#xd;&#xa;	                  ON norma.cod_norma &#x3d; configuracao_reglic.cod_norma&#xd;&#xa;	                JOIN administracao.configuracao_entidade&#xd;&#xa;	                  ON configuracao_entidade.cod_entidade &#x3d; configuracao_reglic.cod_entidade&#xd;&#xa;	                 AND configuracao_entidade.exercicio &#x3d; configuracao_reglic.exercicio&#xd;&#xa;	                 AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;	                 AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	               WHERE configuracao_reglic.exercicio &#x3d;  stExercicio    &#xd;&#xa;	                 AND configuracao_reglic.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;	                 AND TO_DATE&#x28;TO_CHAR&#x28;norma.dt_assinatura,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; BETWEEN TO_DATE&#x28;&#x27;01&#x2f;02&#x2f;2015&#x27;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;	                 AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;   &#xd;&#xa;	            GROUP BY tipo_registro, cod_orgao, configuracao_reglic.exercicio, configuracao_reglic.cod_entidade, norma.dt_assinatura, norma.dt_publicacao, norma.num_norma&#xd;&#xa;			&#x29;,&#xd;&#xa;			  reglic_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipo_decreto&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_decreto_municipal&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_decreto_municipal&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_publicacao_decreto_municipal&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from reglic10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;regulamento_art_47&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;		&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_norma_reg&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_norma_reg&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_pub_norma_reg&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 8, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;reg_exclusiva&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;artigo_reg_exclusiva&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;valor_limite_reg_exclusiva&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;proc_sub_contratacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;artigo_proc_sub_contratacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;percentual_sub_contratacao&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;criterio_empenho_pagamento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;artigo_empenho_pagamento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;estabeleceu_perc_contratacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;artigo_perc_contratacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;percentual_contratacao&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					as d&#xd;&#xa;				from reglic20&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;REGLIC.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from reglic_format order by tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;LQD.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with lqd10 as&#xd;&#xa;			&#x28;&#xd;&#xa;					 SELECT &#x2a;&#xd;&#xa;	                      FROM &#x28;&#xd;&#xa;	                          SELECT 10 AS tipo_registro&#xd;&#xa;	                               , LPAD&#x28;&#x28;nota_liquidacao.cod_nota&#x3a;&#x3a;VARCHAR &#x7c;&#x7c; nota_liquidacao.exercicio&#x29;, 15, &#x27;0&#x27;&#x29; AS cod_reduzido&#xd;&#xa;	                               , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;	                               , LPAD&#x28;LPAD&#x28;despesa.num_orgao&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; LPAD&#x28;despesa.num_unidade&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade&#xd;&#xa;	                               , CASE WHEN empenho.exercicio &#x3c; &#x27;2015&#x27;&#xd;&#xa;	                                        THEN&#xd;&#xa;	                                                2 &#xd;&#xa;	                                        ELSE&#xd;&#xa;	                                                1 &#xd;&#xa;	                                END AS tipo_liquidacao&#xd;&#xa;	                               , empenho.cod_empenho AS num_empenho&#xd;&#xa;	                               , TO_CHAR&#x28;empenho.dt_empenho,&#x27;ddmmyyyy&#x27;&#x29; AS dt_empenho&#xd;&#xa;	                               , TO_CHAR&#x28;nota_liquidacao.dt_liquidacao,&#x27;ddmmyyyy&#x27;&#x29; AS dt_liquidacao&#xd;&#xa;	                               , TCEMG.numero_nota_liquidacao&#x28;stExercicio,   &#xd;&#xa;	                                                              empenho.cod_entidade,&#xd;&#xa;	                                                              nota_liquidacao.cod_nota,&#xd;&#xa;	                                                              nota_liquidacao.exercicio_empenho,&#xd;&#xa;	                                                              empenho.cod_empenho&#xd;&#xa;	                                                             &#x29; AS num_liquidacao&#xd;&#xa;	                               , LPAD&#x28;REPLACE&#x28;SUM&#x28;nota_liquidacao_item.vl_total&#x29;&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,13,&#x27;0&#x27;&#x29; AS vl_liquidado&#xd;&#xa;	                               , ordenador.cpf AS cpf_liquidante&#xd;&#xa;	                            FROM empenho.pre_empenho&#xd;&#xa;	                      INNER JOIN empenho.empenho&#xd;&#xa;	                              ON empenho.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                             AND empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                      INNER JOIN empenho.nota_liquidacao&#xd;&#xa;	                              ON nota_liquidacao.exercicio_empenho &#x3d; empenho.exercicio&#xd;&#xa;	                             AND nota_liquidacao.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;	                             AND nota_liquidacao.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;	                      INNER JOIN empenho.nota_liquidacao_item&#xd;&#xa;	                              ON nota_liquidacao_item.exercicio &#x3d; nota_liquidacao.exercicio&#xd;&#xa;	                             AND nota_liquidacao_item.cod_entidade &#x3d; nota_liquidacao.cod_entidade&#xd;&#xa;	                             AND nota_liquidacao_item.cod_nota &#x3d; nota_liquidacao.cod_nota&#xd;&#xa;	                       LEFT JOIN &#x28;SELECT despesa.&#x2a;&#xd;&#xa;	                                       , conta_despesa.cod_estrutural&#xd;&#xa;	                                       , pre_empenho_despesa.cod_pre_empenho&#xd;&#xa;	                                       , recurso.cod_fonte&#xd;&#xa;	                                       , uniorcam.cgm_ordenador&#xd;&#xa;	                                   FROM empenho.pre_empenho_despesa&#xd;&#xa;	                             INNER JOIN orcamento.despesa&#xd;&#xa;	                                     ON despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;	                                    AND despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;	                             INNER JOIN orcamento.conta_despesa&#xd;&#xa;	                                     ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;	                                    AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;	                             INNER JOIN orcamento.recurso&#xd;&#xa;	                                     ON despesa.cod_recurso &#x3d; recurso.cod_recurso&#xd;&#xa;	                                    AND despesa.exercicio   &#x3d; recurso.exercicio&#xd;&#xa;	                             INNER JOIN tcemg.uniorcam&#xd;&#xa;	                                     ON uniorcam.exercicio &#x3d; despesa.exercicio&#xd;&#xa;	                                    AND uniorcam.num_orgao &#x3d; despesa.num_orgao&#xd;&#xa;	                                    AND uniorcam.num_unidade &#x3d; despesa.num_unidade&#xd;&#xa;	                                 &#x29; AS despesa&#xd;&#xa;	                              ON despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                             AND despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                      INNER JOIN administracao.configuracao_entidade&#xd;&#xa;	                              ON configuracao_entidade.cod_entidade  &#x3d; nota_liquidacao.cod_entidade&#xd;&#xa;	                             AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                             AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;	                             AND configuracao_entidade.exercicio &#x3d; nota_liquidacao.exercicio&#xd;&#xa;	                       LEFT JOIN sw_cgm_pessoa_fisica AS ordenador&#xd;&#xa;	                              ON ordenador.numcgm &#x3d; despesa.cgm_ordenador&#xd;&#xa;	                           WHERE nota_liquidacao.exercicio &#x3d; stExercicio                                                            &#xd;&#xa;	                             AND TO_CHAR&#x28;nota_liquidacao.dt_liquidacao,&#x27;mmyyyy&#x27;&#x29; &#x3d;  &#x28;lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; stExercicio&#x29;             &#xd;&#xa;	                             AND nota_liquidacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;	                             AND pre_empenho.implantado &#x3d; &#x27;f&#x27;&#xd;&#xa;	                        GROUP BY empenho.cod_entidade&#xd;&#xa;	                               , nota_liquidacao.cod_nota&#xd;&#xa;	                               , nota_liquidacao.exercicio_empenho&#xd;&#xa;	                               , empenho.cod_empenho&#xd;&#xa;	                               , configuracao_entidade.valor&#xd;&#xa;	                               , despesa.num_unidade&#xd;&#xa;	                               , despesa.num_orgao&#xd;&#xa;	                               , empenho.dt_empenho&#xd;&#xa;	                               , nota_liquidacao.dt_liquidacao&#xd;&#xa;	                               , nota_liquidacao.exercicio&#xd;&#xa;	                               , empenho.exercicio&#xd;&#xa;	                               , ordenador.cpf&#xd;&#xa;	                           UNION&#xd;&#xa;	                          SELECT 10 AS tipo_registro&#xd;&#xa;	                               , LPAD&#x28;&#x28;nota_liquidacao.cod_nota&#x3a;&#x3a;VARCHAR &#x7c;&#x7c; nota_liquidacao.exercicio&#x29;, 15, &#x27;0&#x27;&#x29; AS cod_reduzido&#xd;&#xa;	                               , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;	                               , CASE WHEN uniorcam_atual.num_orgao_atual IS NOT NULL&#xd;&#xa;	                                      THEN LPAD&#x28;LPAD&#x28;uniorcam_atual.num_orgao_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;uniorcam_atual.num_unidade_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;	                                      ELSE LPAD&#x28;restos_pre_empenho.num_unidade&#x3a;&#x3a;VARCHAR,5,&#x27;0&#x27;&#x29;&#xd;&#xa;	                                   END AS cod_unidade&#xd;&#xa;	                               , CASE WHEN empenho.exercicio &#x3c; stExercicio                                           &#xd;&#xa;	                                        THEN&#xd;&#xa;	                                                2 &#xd;&#xa;	                                        ELSE&#xd;&#xa;	                                                1 &#xd;&#xa;	                                END AS tipo_liquidacao&#xd;&#xa;	                               , empenho.cod_empenho AS num_empenho&#xd;&#xa;	                               , TO_CHAR&#x28;empenho.dt_empenho,&#x27;ddmmyyyy&#x27;&#x29; AS dt_empenho&#xd;&#xa;	                               , TO_CHAR&#x28;nota_liquidacao.dt_liquidacao,&#x27;ddmmyyyy&#x27;&#x29; AS dt_liquidacao&#xd;&#xa;	                               , TCEMG.numero_nota_liquidacao&#x28;stExercicio,                                           &#xd;&#xa;	                                                              empenho.cod_entidade,&#xd;&#xa;	                                                              nota_liquidacao.cod_nota,&#xd;&#xa;	                                                              nota_liquidacao.exercicio_empenho,&#xd;&#xa;	                                                              empenho.cod_empenho&#xd;&#xa;	                                                             &#x29; AS num_liquidacao&#xd;&#xa;	                               , LPAD&#x28;REPLACE&#x28;SUM&#x28;nota_liquidacao_item.vl_total&#x29;&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,13,&#x27;0&#x27;&#x29; AS vl_liquidado&#xd;&#xa;	                               , ordenador.cpf AS cpf_liquidante&#xd;&#xa;	                            FROM empenho.pre_empenho&#xd;&#xa;	                      INNER JOIN empenho.restos_pre_empenho&#xd;&#xa;	                              ON restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                             AND restos_pre_empenho.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                       LEFT JOIN &#x28;SELECT uniorcam.exercicio&#xd;&#xa;	                                       , uniorcam.num_unidade&#xd;&#xa;	                                       , uniorcam.num_orgao&#xd;&#xa;	                                       , uniorcam.exercicio_atual&#xd;&#xa;	                                       , uniorcam.num_unidade_atual&#xd;&#xa;	                                       , uniorcam.num_orgao_atual&#xd;&#xa;	                                       , CASE WHEN uniorcam.cgm_ordenador IS NOT NULL&#xd;&#xa;	                                              THEN uniorcam.cgm_ordenador&#xd;&#xa;	                                              ELSE atual.cgm_ordenador&#xd;&#xa;	                                          END AS cgm_ordenador&#xd;&#xa;	                                    FROM tcemg.uniorcam&#xd;&#xa;	                               LEFT JOIN tcemg.uniorcam AS atual&#xd;&#xa;	                                      ON atual.num_unidade &#x3d; uniorcam.num_unidade_atual&#xd;&#xa;	                                     AND atual.num_orgao &#x3d; uniorcam.num_orgao_atual&#xd;&#xa;	                                     AND atual.exercicio &#x3d; uniorcam.exercicio_atual&#xd;&#xa;	                                 &#x29; AS uniorcam_atual&#xd;&#xa;	                              ON uniorcam_atual.num_unidade &#x3d; restos_pre_empenho.num_unidade&#xd;&#xa;	                             AND uniorcam_atual.exercicio &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;	                             AND uniorcam_atual.num_orgao_atual IS NOT NULL&#xd;&#xa;	                      INNER JOIN empenho.empenho&#xd;&#xa;	                              ON empenho.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                             AND empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                      INNER JOIN empenho.nota_liquidacao&#xd;&#xa;	                              ON nota_liquidacao.exercicio_empenho &#x3d; empenho.exercicio&#xd;&#xa;	                             AND nota_liquidacao.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;	                             AND nota_liquidacao.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;	                      INNER JOIN empenho.nota_liquidacao_item&#xd;&#xa;	                              ON nota_liquidacao_item.exercicio &#x3d; nota_liquidacao.exercicio&#xd;&#xa;	                             AND nota_liquidacao_item.cod_entidade &#x3d; nota_liquidacao.cod_entidade&#xd;&#xa;	                             AND nota_liquidacao_item.cod_nota &#x3d; nota_liquidacao.cod_nota&#xd;&#xa;	                       LEFT JOIN &#x28;SELECT despesa.&#x2a;&#xd;&#xa;	                                       , conta_despesa.cod_estrutural&#xd;&#xa;	                                       , pre_empenho_despesa.cod_pre_empenho&#xd;&#xa;	                                       , recurso.cod_fonte&#xd;&#xa;	                                       , uniorcam.cgm_ordenador&#xd;&#xa;	                                       , uniorcam.num_unidade AS num_unidade_uniorcam&#xd;&#xa;	                                       , uniorcam.num_orgao AS num_orgao_uniorcam&#xd;&#xa;	                                    FROM empenho.pre_empenho_despesa&#xd;&#xa;	                              INNER JOIN orcamento.despesa&#xd;&#xa;	                                      ON despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;	                                     AND despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;	                              INNER JOIN orcamento.conta_despesa&#xd;&#xa;	                                      ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;	                                     AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;	                              INNER JOIN orcamento.recurso&#xd;&#xa;	                                      ON despesa.cod_recurso &#x3d; recurso.cod_recurso&#xd;&#xa;	                                     AND despesa.exercicio   &#x3d; recurso.exercicio&#xd;&#xa;	                              INNER JOIN tcemg.uniorcam&#xd;&#xa;	                                      ON uniorcam.exercicio &#x3d; despesa.exercicio&#xd;&#xa;	                                     AND uniorcam.num_orgao &#x3d; despesa.num_orgao&#xd;&#xa;	                                     AND uniorcam.num_unidade &#x3d; despesa.num_unidade&#xd;&#xa;	                                 &#x29; AS despesa&#xd;&#xa;	                              ON despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                             AND despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                      INNER JOIN administracao.configuracao_entidade&#xd;&#xa;	                              ON configuracao_entidade.cod_entidade  &#x3d; nota_liquidacao.cod_entidade&#xd;&#xa;	                             AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                             AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;	                             AND configuracao_entidade.exercicio &#x3d; nota_liquidacao.exercicio&#xd;&#xa;	                       LEFT JOIN sw_cgm_pessoa_fisica AS ordenador&#xd;&#xa;	                              ON &#x28;   &#x28; ordenador.numcgm &#x3d; uniorcam_atual.cgm_ordenador&#xd;&#xa;	                                   AND uniorcam_atual.num_orgao_atual IS NOT NULL&#xd;&#xa;	                                   AND uniorcam_atual.cgm_ordenador IS NOT NULL&#xd;&#xa;	                                     &#x29;&#xd;&#xa;	                                  OR &#x28; ordenador.numcgm &#x3d; despesa.cgm_ordenador&#xd;&#xa;	                                   AND uniorcam_atual.num_orgao_atual IS NULL&#xd;&#xa;	                                   AND uniorcam_atual.cgm_ordenador IS NULL&#xd;&#xa;	                                     &#x29;&#xd;&#xa;	                                 &#x29;&#xd;&#xa;	                           WHERE nota_liquidacao.exercicio &#x3d; stExercicio                                                                 &#xd;&#xa;	                             AND TO_CHAR&#x28;nota_liquidacao.dt_liquidacao,&#x27;mmyyyy&#x27;&#x29; &#x3d; &#x28;lpad&#x28;stMes,2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; stExercicio&#x29;                   &#xd;&#xa;	                             AND nota_liquidacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;         &#xd;&#xa;	                             AND pre_empenho.implantado &#x3d; &#x27;t&#x27;&#xd;&#xa;	                        GROUP BY tipo_registro&#xd;&#xa;	                               , cod_reduzido&#xd;&#xa;	                               , cod_orgao&#xd;&#xa;	                               , cod_unidade&#xd;&#xa;	                               , tipo_liquidacao&#xd;&#xa;	                               , num_empenho&#xd;&#xa;	                               , empenho.dt_empenho&#xd;&#xa;	                               , nota_liquidacao.dt_liquidacao&#xd;&#xa;	                               , num_liquidacao&#xd;&#xa;	                               , cpf_liquidante&#xd;&#xa;	                           &#x29; AS tabela&#xd;&#xa;	                  ORDER BY num_empenho&#xd;&#xa;			&#x29;,&#xd;&#xa;			lqd11 as&#xd;&#xa;			&#x28;&#xd;&#xa;			        SELECT &#x2a;&#xd;&#xa;	                      FROM &#x28;&#xd;&#xa;	                          SELECT 11 AS tipo_registro&#xd;&#xa;	                               , LPAD&#x28;&#x28;nota_liquidacao.cod_nota&#x3a;&#x3a;VARCHAR &#x7c;&#x7c; nota_liquidacao.exercicio&#x29;, 15, &#x27;0&#x27;&#x29; AS cod_reduzido&#xd;&#xa;	                               , LPAD&#x28;LPAD&#x28;despesa.num_orgao&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; LPAD&#x28;despesa.num_unidade&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade&#xd;&#xa;	                               , empenho.cod_empenho AS num_empenho&#xd;&#xa;	                               , TO_CHAR&#x28;empenho.dt_empenho,&#x27;ddmmyyyy&#x27;&#x29; AS dt_empenho&#xd;&#xa;	                               , TCEMG.numero_nota_liquidacao&#x28;stExercicio,empenho.cod_entidade,nota_liquidacao.cod_nota,nota_liquidacao.exercicio_empenho,empenho.cod_empenho&#x29; AS num_liquidacao&#xd;&#xa;	                               , despesa.cod_fonte&#x3a;&#x3a;varchar AS cod_font_recursos&#xd;&#xa;	                               , REPLACE&#x28;SUM&#x28;nota_liquidacao_item.vl_total&#x29;&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29; AS vl_fonte&#xd;&#xa;	                            FROM empenho.pre_empenho&#xd;&#xa;	                      INNER JOIN empenho.empenho&#xd;&#xa;	                              ON empenho.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                             AND empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                      INNER JOIN empenho.nota_liquidacao&#xd;&#xa;	                              ON nota_liquidacao.exercicio_empenho &#x3d; empenho.exercicio&#xd;&#xa;	                             AND nota_liquidacao.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;	                             AND nota_liquidacao.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;	                      INNER JOIN empenho.nota_liquidacao_item&#xd;&#xa;	                              ON nota_liquidacao_item.exercicio &#x3d; nota_liquidacao.exercicio&#xd;&#xa;	                             AND nota_liquidacao_item.cod_entidade &#x3d; nota_liquidacao.cod_entidade&#xd;&#xa;	                             AND nota_liquidacao_item.cod_nota &#x3d; nota_liquidacao.cod_nota&#xd;&#xa;	                       LEFT JOIN &#x28;SELECT despesa.&#x2a;&#xd;&#xa;	                                       , conta_despesa.cod_estrutural&#xd;&#xa;	                                       , pre_empenho_despesa.cod_pre_empenho&#xd;&#xa;	                                       , recurso.cod_fonte&#xd;&#xa;	                                       , uniorcam.cgm_ordenador&#xd;&#xa;	                                   FROM empenho.pre_empenho_despesa&#xd;&#xa;	                             INNER JOIN orcamento.despesa&#xd;&#xa;	                                     ON despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;	                                    AND despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;	                             INNER JOIN orcamento.conta_despesa&#xd;&#xa;	                                     ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;	                                    AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;	                             INNER JOIN orcamento.recurso&#xd;&#xa;	                                     ON despesa.cod_recurso &#x3d; recurso.cod_recurso&#xd;&#xa;	                                    AND despesa.exercicio   &#x3d; recurso.exercicio&#xd;&#xa;	                             INNER JOIN tcemg.uniorcam&#xd;&#xa;	                                     ON uniorcam.exercicio &#x3d; despesa.exercicio&#xd;&#xa;	                                    AND uniorcam.num_orgao &#x3d; despesa.num_orgao&#xd;&#xa;	                                    AND uniorcam.num_unidade &#x3d; despesa.num_unidade&#xd;&#xa;	                                 &#x29; AS despesa&#xd;&#xa;	                              ON despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                             AND despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                      INNER JOIN administracao.configuracao_entidade&#xd;&#xa;	                              ON configuracao_entidade.cod_entidade  &#x3d; nota_liquidacao.cod_entidade&#xd;&#xa;	                             AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                             AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;	                             AND configuracao_entidade.exercicio &#x3d; nota_liquidacao.exercicio&#xd;&#xa;	                           WHERE nota_liquidacao.exercicio &#x3d; stExercicio  &#xd;&#xa;	                             AND TO_CHAR&#x28;nota_liquidacao.dt_liquidacao,&#x27;mmyyyy&#x27;&#x29; &#x3d;  &#x28;lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; stExercicio&#x29;  &#xd;&#xa;	                             AND nota_liquidacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;	                             AND pre_empenho.implantado &#x3d; &#x27;f&#x27;&#xd;&#xa;	                        GROUP BY empenho.cod_entidade&#xd;&#xa;	                               , nota_liquidacao.cod_nota&#xd;&#xa;	                               , nota_liquidacao.exercicio_empenho&#xd;&#xa;	                               , empenho.cod_empenho&#xd;&#xa;	                               , configuracao_entidade.valor&#xd;&#xa;	                               , despesa.num_unidade&#xd;&#xa;	                               , despesa.num_orgao&#xd;&#xa;	                               , empenho.dt_empenho&#xd;&#xa;	                               , nota_liquidacao.dt_liquidacao&#xd;&#xa;	                               , despesa.cod_fonte&#xd;&#xa;	                               , nota_liquidacao.exercicio&#xd;&#xa;	                        UNION&#xd;&#xa;	                          SELECT 11 AS tipo_registro&#xd;&#xa;	                               , LPAD&#x28;&#x28;nota_liquidacao.cod_nota&#x3a;&#x3a;VARCHAR &#x7c;&#x7c; nota_liquidacao.exercicio&#x29;, 15, &#x27;0&#x27;&#x29; AS cod_reduzido&#xd;&#xa;	                               , CASE WHEN uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;	                                           THEN LPAD&#x28;LPAD&#x28;uniorcam.num_orgao_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;uniorcam.num_unidade_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;	                                           ELSE LPAD&#x28;restos_pre_empenho.num_unidade&#x3a;&#x3a;VARCHAR,5,&#x27;0&#x27;&#x29;&#xd;&#xa;	                                 END AS cod_unidade&#xd;&#xa;	                               , empenho.cod_empenho AS num_empenho&#xd;&#xa;	                               , TO_CHAR&#x28;empenho.dt_empenho,&#x27;ddmmyyyy&#x27;&#x29; AS dt_empenho&#xd;&#xa;	                               , TCEMG.numero_nota_liquidacao&#x28;stexercicio,empenho.cod_entidade,nota_liquidacao.cod_nota,nota_liquidacao.exercicio_empenho,empenho.cod_empenho&#x29; AS num_liquidacao&#xd;&#xa;	                               , restos_pre_empenho.recurso&#x3a;&#x3a;varchar AS cod_font_recursos&#xd;&#xa;	                               , REPLACE&#x28;SUM&#x28;nota_liquidacao_item.vl_total&#x29;&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29; AS vl_fonte&#xd;&#xa;	                            FROM empenho.pre_empenho&#xd;&#xa;	                      INNER JOIN empenho.restos_pre_empenho&#xd;&#xa;	                              ON restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                             AND restos_pre_empenho.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                       LEFT JOIN tcemg.uniorcam&#xd;&#xa;	                              ON uniorcam.num_unidade &#x3d; restos_pre_empenho.num_unidade&#xd;&#xa;	                             AND uniorcam.exercicio &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;	                             AND uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;	                      INNER JOIN empenho.empenho&#xd;&#xa;	                              ON empenho.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                             AND empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                      INNER JOIN empenho.nota_liquidacao&#xd;&#xa;	                              ON nota_liquidacao.exercicio_empenho &#x3d; empenho.exercicio&#xd;&#xa;	                             AND nota_liquidacao.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;	                             AND nota_liquidacao.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;	                      INNER JOIN empenho.nota_liquidacao_item&#xd;&#xa;	                              ON nota_liquidacao_item.exercicio &#x3d; nota_liquidacao.exercicio&#xd;&#xa;	                             AND nota_liquidacao_item.cod_entidade &#x3d; nota_liquidacao.cod_entidade&#xd;&#xa;	                             AND nota_liquidacao_item.cod_nota &#x3d; nota_liquidacao.cod_nota&#xd;&#xa;	                       LEFT JOIN &#x28;SELECT despesa.&#x2a;&#xd;&#xa;	                                       , conta_despesa.cod_estrutural&#xd;&#xa;	                                       , pre_empenho_despesa.cod_pre_empenho&#xd;&#xa;	                                       , recurso.cod_fonte&#xd;&#xa;	                                       , uniorcam.cgm_ordenador&#xd;&#xa;	                                       , uniorcam.num_unidade AS num_unidade_uniorcam&#xd;&#xa;	                                       , uniorcam.num_orgao AS num_orgao_uniorcam&#xd;&#xa;	                                    FROM empenho.pre_empenho_despesa&#xd;&#xa;	                              INNER JOIN orcamento.despesa&#xd;&#xa;	                                      ON despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;	                                     AND despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;	                              INNER JOIN orcamento.conta_despesa&#xd;&#xa;	                                      ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;	                                     AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;	                              INNER JOIN orcamento.recurso&#xd;&#xa;	                                      ON despesa.cod_recurso &#x3d; recurso.cod_recurso&#xd;&#xa;	                                     AND despesa.exercicio   &#x3d; recurso.exercicio&#xd;&#xa;	                              INNER JOIN tcemg.uniorcam&#xd;&#xa;	                                      ON uniorcam.exercicio &#x3d; despesa.exercicio&#xd;&#xa;	                                     AND uniorcam.num_orgao &#x3d; despesa.num_orgao&#xd;&#xa;	                                     AND uniorcam.num_unidade &#x3d; despesa.num_unidade&#xd;&#xa;	                                 &#x29; AS despesa&#xd;&#xa;	                              ON despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                             AND despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                      INNER JOIN administracao.configuracao_entidade&#xd;&#xa;	                              ON configuracao_entidade.cod_entidade  &#x3d; nota_liquidacao.cod_entidade&#xd;&#xa;	                             AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                             AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;	                             AND configuracao_entidade.exercicio &#x3d; nota_liquidacao.exercicio&#xd;&#xa;	                           WHERE nota_liquidacao.exercicio &#x3d; stExercicio  &#xd;&#xa;	                             AND TO_CHAR&#x28;nota_liquidacao.dt_liquidacao,&#x27;mmyyyy&#x27;&#x29; &#x3d; &#x28;lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; stExercicio&#x29;   &#xd;&#xa;	                             AND nota_liquidacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;	                             AND pre_empenho.implantado &#x3d; &#x27;t&#x27;&#xd;&#xa;	                        GROUP BY empenho.cod_entidade&#xd;&#xa;	                               , nota_liquidacao.cod_nota&#xd;&#xa;	                               , nota_liquidacao.exercicio_empenho&#xd;&#xa;	                               , empenho.cod_empenho&#xd;&#xa;	                               , configuracao_entidade.valor&#xd;&#xa;	                               , despesa.num_unidade&#xd;&#xa;	                               , despesa.num_orgao&#xd;&#xa;	                               , empenho.dt_empenho&#xd;&#xa;	                               , nota_liquidacao.dt_liquidacao&#xd;&#xa;	                               , restos_pre_empenho.recurso&#xd;&#xa;	                               , nota_liquidacao.exercicio&#xd;&#xa;	                               , despesa.num_unidade_uniorcam&#xd;&#xa;	                               , despesa.num_orgao_uniorcam&#xd;&#xa;	                               , cod_unidade&#xd;&#xa;	                               , restos_pre_empenho.num_unidade&#xd;&#xa;	                           &#x29; AS tabela&#xd;&#xa;	                  ORDER BY num_empenho&#xd;&#xa;			&#x29;,&#xd;&#xa;			lqd12 as&#xd;&#xa;			&#x28;&#xd;&#xa;				      SELECT 12 AS tipo_registro&#xd;&#xa;	                       , LPAD&#x28;&#x28;nota_liquidacao.cod_nota&#x3a;&#x3a;VARCHAR &#x7c;&#x7c; nota_liquidacao.exercicio&#x29;, 15, &#x27;0&#x27;&#x29; as cod_reduzido&#xd;&#xa;	                       , SUBSTR&#x28;TO_CHAR&#x28;nota_liquidacao.dt_liquidacao,&#x27;ddmmyyyy&#x27;&#x29;,3,2&#x29; AS mes_competencia&#xd;&#xa;	                       , nota_liquidacao.exercicio&#x3a;&#x3a;integer AS exercicio_competencia&#xd;&#xa;	                       , empenho.cod_empenho as num_empenho&#xd;&#xa;	                       , TCEMG.numero_nota_liquidacao&#x28;stExercicio, empenho.cod_entidade, nota_liquidacao.cod_nota, nota_liquidacao.exercicio_empenho, empenho.cod_empenho &#x29; AS num_liquidacao&#xd;&#xa;	                       , REPLACE&#x28;SUM&#x28;nota_liquidacao_item.vl_total&#x29;&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29; AS vl_despesa_anterior&#xd;&#xa;	                    FROM empenho.empenho&#xd;&#xa;	              INNER JOIN empenho.nota_liquidacao&#xd;&#xa;	                      ON nota_liquidacao.exercicio_empenho &#x3d; empenho.exercicio&#xd;&#xa;	                     AND nota_liquidacao.cod_entidade      &#x3d; empenho.cod_entidade&#xd;&#xa;	                     AND nota_liquidacao.cod_empenho       &#x3d; empenho.cod_empenho&#xd;&#xa;	              INNER JOIN empenho.nota_liquidacao_item&#xd;&#xa;	                      ON nota_liquidacao_item.exercicio &#x3d; nota_liquidacao.exercicio&#xd;&#xa;	                     AND nota_liquidacao_item.cod_entidade &#x3d; nota_liquidacao.cod_entidade&#xd;&#xa;	                     AND nota_liquidacao_item.cod_nota &#x3d; nota_liquidacao.cod_nota&#xd;&#xa;	              INNER JOIN empenho.pre_empenho&#xd;&#xa;	                      ON pre_empenho.exercicio &#x3d; empenho.exercicio&#xd;&#xa;	                     AND pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;	               LEFT JOIN &#x28;&#xd;&#xa;	                          SELECT restos_pre_empenho.exercicio&#xd;&#xa;	                               , restos_pre_empenho.cod_pre_empenho&#xd;&#xa;	                               , substring&#x28;restos_pre_empenho.cod_estrutural from 6 for 2&#x29; AS elemento&#xd;&#xa;	                            FROM empenho.restos_pre_empenho&#xd;&#xa;	                           WHERE substring&#x28;restos_pre_empenho.cod_estrutural from 6 for 2&#x29;&#x3a;&#x3a;INTEGER IN &#x28;91,92&#x29;&#xd;&#xa;	                             AND substring&#x28;restos_pre_empenho.cod_estrutural from 2 for 1&#x29;&#x3a;&#x3a;INTEGER IN &#x28;1&#x29;&#xd;&#xa;	                         &#x29; AS restos_pre_empenho&#xd;&#xa;	                      ON restos_pre_empenho.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                     AND restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	               LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;	                      ON pre_empenho_despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                     AND pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	               LEFT JOIN &#x28;&#xd;&#xa;	                          SELECT pre_empenho_despesa.cod_pre_empenho&#xd;&#xa;	                               , pre_empenho_despesa.exercicio&#xd;&#xa;	                               , despesa.cod_entidade&#xd;&#xa;	                               , substring&#x28;conta_despesa.cod_estrutural from 9 for 2&#x29; AS elemento&#xd;&#xa;	                            FROM empenho.pre_empenho_despesa&#xd;&#xa;	                      INNER JOIN orcamento.despesa&#xd;&#xa;	                              ON despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;	                             AND despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;	                      INNER JOIN orcamento.conta_despesa&#xd;&#xa;	                              ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;	                             AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;	                           WHERE substring&#x28;conta_despesa.cod_estrutural from 9 for 2&#x29;&#x3a;&#x3a;INTEGER IN &#x28;91,92&#x29;&#xd;&#xa;	                             AND substring&#x28;conta_despesa.cod_estrutural from 3 for 1&#x29;&#x3a;&#x3a;INTEGER IN &#x28;1&#x29;&#xd;&#xa;	                        &#x29; AS despesa&#xd;&#xa;	                      ON despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                     AND despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                     AND despesa.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;	                   WHERE nota_liquidacao.dt_liquidacao BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;  &#xd;&#xa;					                                           AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;  &#xd;&#xa;	                     AND nota_liquidacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;	                     AND &#x28; despesa.elemento IS NOT NULL OR restos_pre_empenho.elemento IS NOT NULL &#x29;&#xd;&#xa;	                GROUP BY tipo_registro&#xd;&#xa;	                       , cod_reduzido&#xd;&#xa;	                       , mes_competencia&#xd;&#xa;	                       , exercicio_competencia&#xd;&#xa;	                       , num_empenho&#xd;&#xa;	                       , num_liquidacao&#xd;&#xa;			&#x29;,&#xd;&#xa;			  lqd_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_reduzido,&#xd;&#xa;							num_empenho,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; &#x28;coalesce&#x28;cod_reduzido&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x29;&#x3a;&#x3a;bigint					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_liquidacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; &#x28;coalesce&#x28;num_empenho&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_empenho&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_liquidacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; &#x28;coalesce&#x28;num_liquidacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_liquidado&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cpf_liquidante&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 11, &#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from lqd10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_reduzido,&#xd;&#xa;							num_empenho,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; &#x28;coalesce&#x28;cod_reduzido&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_font_recursos&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_fonte&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#xd;&#xa;					as d&#xd;&#xa;				from lqd11  &#xd;&#xa;				union all&#xd;&#xa;						select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_reduzido,&#xd;&#xa;							num_empenho,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; &#x28;coalesce&#x28;cod_reduzido&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;mes_competencia&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_competencia&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_despesa_anterior&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from lqd12  &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;LQD.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from lqd_format order by num_empenho, cod_reduzido, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;LAO.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with lao10 as&#xd;&#xa;			&#x28;&#xd;&#xa;					 SELECT 10 AS tipo_registro&#xd;&#xa;		                         , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;		                         , norma.num_norma AS nro_lei_alteracao&#xd;&#xa;		                         , TO_CHAR&#x28;suplementacao.dt_suplementacao,&#x27;ddmmyyyy&#x27;&#x29; AS dt_lei_alteracao&#xd;&#xa;		                      FROM orcamento.suplementacao&#xd;&#xa;		                 LEFT JOIN orcamento.suplementacao_suplementada&#xd;&#xa;		                        ON suplementacao_suplementada.exercicio &#x3d; suplementacao.exercicio&#xd;&#xa;		                       AND suplementacao_suplementada.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;		                 LEFT JOIN orcamento.suplementacao_reducao&#xd;&#xa;		                        ON suplementacao_reducao.exercicio &#x3d; suplementacao.exercicio&#xd;&#xa;		                       AND suplementacao_reducao.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;		                INNER JOIN orcamento.despesa&#xd;&#xa;		                        ON despesa.exercicio &#x3d; suplementacao_suplementada.exercicio&#xd;&#xa;		                       AND despesa.cod_despesa &#x3d; suplementacao_suplementada.cod_despesa&#xd;&#xa;		                INNER JOIN normas.norma&#xd;&#xa;		                        ON norma.cod_norma &#x3d; suplementacao.cod_norma&#xd;&#xa;		                INNER JOIN administracao.configuracao_entidade&#xd;&#xa;		                        ON configuracao_entidade.cod_entidade  &#x3d; despesa.cod_entidade&#xd;&#xa;		                       AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;		                       AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;		                       AND configuracao_entidade.exercicio &#x3d; despesa.exercicio&#xd;&#xa;		                INNER JOIN tcemg.norma_detalhe&#xd;&#xa;		                        ON norma_detalhe.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;		                       AND norma_detalhe.tipo_lei_origem_decreto &#x3d; 3&#xd;&#xa;		                     WHERE suplementacao.exercicio &#x3d; stExercicio                                                              &#xd;&#xa;		                       AND despesa.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;            &#xd;&#xa;		                       AND suplementacao.dt_suplementacao BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;		          	          &#xd;&#xa;		                       AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;             &#xd;&#xa;		                       AND NOT EXISTS&#xd;&#xa;		                           &#x28;&#xd;&#xa;		                            SELECT 1&#xd;&#xa;		                              FROM orcamento.suplementacao_anulada&#xd;&#xa;		                             WHERE &#x28;&#xd;&#xa;		                                         suplementacao_anulada.cod_suplementacao_anulacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;		                                    OR&#xd;&#xa;		                                         suplementacao_anulada.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;		                                   &#x29;&#xd;&#xa;		                               AND suplementacao_anulada.exercicio &#x3d; suplementacao.exercicio&#xd;&#xa;		                           &#x29;&#xd;&#xa;		                  GROUP BY nro_lei_alteracao, dt_lei_alteracao, cod_orgao, tipo_registro&#xd;&#xa;		                  ORDER BY dt_lei_alteracao, nro_lei_alteracao&#xd;&#xa;			&#x29;,&#xd;&#xa;			lao11 as&#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT tabela.tipo_registro&#xd;&#xa;		                        , tabela.nro_lei_alteracao&#xd;&#xa;		                        , tabela.tipo_lei_alteracao&#xd;&#xa;		                        , tabela.vl_autorizacao_alteracao&#xd;&#xa;		                        , CASE WHEN tabela.artigo_lei_alteracao IS NOT NULL THEN&#xd;&#xa;		                                        regexp_replace&#x28;remove_acentos&#x28;REPLACE&#x28;&#x28;REPLACE&#x28;REPLACE&#x28;tabela.artigo_lei_alteracao,Chr&#x28;39&#x29;, &#x27;&#x27;&#x29;, Chr&#x28;10&#x29;, &#x27;&#x27;&#x29;&#x29;, Chr&#x28;13&#x29;, &#x27; &#x27;&#x29;&#x29;,&#x27;&#x5b;&#xba;&#x7c;&#xb0;&#x5d;&#x27;, &#x27;&#x27;, &#x27;gi&#x27;&#x29;&#xd;&#xa;		                          END AS artigo_lei_alteracao&#xd;&#xa;		                        , CASE WHEN tabela.descricao_artigo IS NOT NULL THEN&#xd;&#xa;		                                        TRIM&#x28;regexp_replace&#x28;remove_acentos&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;tabela.descricao_artigo,Chr&#x28;39&#x29;, &#x27;&#x27;&#x29;, Chr&#x28;10&#x29;, &#x27;&#x27;&#x29;, Chr&#x28;13&#x29;, &#x27; &#x27;&#x29;, Chr&#x28;9&#x29;, &#x27; &#x27;&#x29;&#x29;,&#x27;&#x5b;&#xba;&#x7c;&#xb0;&#x7c;&#x25;&#x7c;&#xa7;&#x5d;&#x27;, &#x27;&#x27;, &#x27;gi&#x27;&#x29;&#x29;&#xd;&#xa;		                          END AS descricao_artigo&#xd;&#xa;		                    FROM &#x28;&#xd;&#xa;		                            SELECT 11 AS tipo_registro&#xd;&#xa;		                                 , norma.num_norma AS nro_lei_alteracao&#xd;&#xa;		                                 , tipo_lei_alteracao_orcamentaria.cod_tipo_lei AS tipo_lei_alteracao&#xd;&#xa;		                                 , CASE WHEN tipo_transferencia.cod_tipo &#x3d; 15 THEN LPAD&#x28;&#x27;0,00&#x27;, 14, &#x27;0&#x27;&#x29;&#xd;&#xa;		                                        WHEN tipo_transferencia.cod_tipo &#x3d; 16 THEN LPAD&#x28;&#x27;0,00&#x27;, 14, &#x27;0&#x27;&#x29;&#xd;&#xa;		                                        ELSE LPAD&#x28;REPLACE&#x28;SUM&#x28;coalesce&#x28; suplementacao_suplementada.valor, 0.00 &#x29;&#x29;&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;, 14,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                   END AS vl_autorizacao_alteracao&#xd;&#xa;		                                 , &#x28; SELECT atributo_norma_valor.valor&#xd;&#xa;		                                       FROM normas.atributo_norma_valor&#xd;&#xa;		                                 INNER JOIN normas.atributo_tipo_norma&#xd;&#xa;		                                         ON atributo_tipo_norma.cod_tipo_norma &#x3d; atributo_norma_valor.cod_tipo_norma&#xd;&#xa;		                                        AND atributo_tipo_norma.cod_modulo     &#x3d; atributo_norma_valor.cod_modulo&#xd;&#xa;		                                        AND atributo_tipo_norma.cod_cadastro   &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;		                                        AND atributo_tipo_norma.cod_atributo   &#x3d; atributo_norma_valor.cod_atributo&#xd;&#xa;		                                 INNER JOIN administracao.atributo_dinamico&#xd;&#xa;		                                         ON atributo_dinamico.cod_modulo     &#x3d; atributo_tipo_norma.cod_modulo&#xd;&#xa;		                                        AND atributo_dinamico.cod_cadastro   &#x3d; atributo_tipo_norma.cod_cadastro&#xd;&#xa;		                                        AND atributo_dinamico.cod_atributo   &#x3d; atributo_tipo_norma.cod_atributo&#xd;&#xa;		                                      WHERE atributo_tipo_norma.ativo &#x3d; TRUE&#xd;&#xa;		                                        AND atributo_dinamico.nom_atributo ILIKE &#x27;Artigo da Lei&#x27;&#xd;&#xa;		                                        AND atributo_norma_valor.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;		                                        AND atributo_norma_valor.timestamp &#x3d; &#x28; SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;		                                                                                 FROM normas.atributo_norma_valor AS anv&#xd;&#xa;		                                                                                WHERE cod_norma &#x3d; atributo_norma_valor.cod_norma&#xd;&#xa;		                                                                                  AND cod_cadastro &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;		                                                                                  AND cod_modulo &#x3d;  atributo_norma_valor.cod_modulo&#xd;&#xa;		                                                                                  AND cod_atributo &#x3d;  atributo_norma_valor.cod_atributo&#xd;&#xa;		                                                                              &#x29;&#xd;&#xa;		                                   &#x29; AS artigo_lei_alteracao&#xd;&#xa;		                                 , COALESCE &#x28; &#x28;   SELECT atributo_norma_valor.valor&#xd;&#xa;		                                                    FROM normas.atributo_norma_valor&#xd;&#xa;		                                              INNER JOIN normas.atributo_tipo_norma&#xd;&#xa;		                                                      ON atributo_tipo_norma.cod_tipo_norma &#x3d; atributo_norma_valor.cod_tipo_norma&#xd;&#xa;		                                                     AND atributo_tipo_norma.cod_modulo     &#x3d; atributo_norma_valor.cod_modulo&#xd;&#xa;		                                                     AND atributo_tipo_norma.cod_cadastro   &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;		                                                     AND atributo_tipo_norma.cod_atributo   &#x3d; atributo_norma_valor.cod_atributo&#xd;&#xa;		                                              INNER JOIN administracao.atributo_dinamico&#xd;&#xa;		                                                      ON atributo_dinamico.cod_modulo     &#x3d; atributo_tipo_norma.cod_modulo&#xd;&#xa;		                                                     AND atributo_dinamico.cod_cadastro   &#x3d; atributo_tipo_norma.cod_cadastro&#xd;&#xa;		                                                     AND atributo_dinamico.cod_atributo   &#x3d; atributo_tipo_norma.cod_atributo&#xd;&#xa;		                                                   WHERE atributo_tipo_norma.ativo &#x3d; TRUE&#xd;&#xa;		                                                     AND atributo_dinamico.cod_atributo &#x3d; 5004&#xd;&#xa;		                                                     AND atributo_norma_valor.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;		                                                     AND atributo_norma_valor.timestamp &#x3d; &#x28; SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;		                                                                                              FROM normas.atributo_norma_valor AS anv&#xd;&#xa;		                                                                                             WHERE cod_norma &#x3d; atributo_norma_valor.cod_norma&#xd;&#xa;		                                                                                               AND cod_cadastro &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;		                                                                                               AND cod_modulo &#x3d;  atributo_norma_valor.cod_modulo&#xd;&#xa;		                                                                                               AND cod_atributo &#x3d;  atributo_norma_valor.cod_atributo&#xd;&#xa;		                                                                                           &#x29;&#xd;&#xa;		                                              &#x29; , &#x27; &#x27;&#x29; AS descricao_artigo&#xd;&#xa;		                              FROM orcamento.suplementacao&#xd;&#xa;		                        INNER JOIN normas.norma&#xd;&#xa;		                                ON norma.cod_norma &#x3d; suplementacao.cod_norma&#xd;&#xa;		                         LEFT JOIN tcemg.norma_artigo&#xd;&#xa;		                                ON norma_artigo.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;		                         LEFT JOIN &#x28; SELECT OSS.exercicio&#xd;&#xa;		                                           , OSS.cod_suplementacao&#xd;&#xa;		                                           , MAX&#x28; OSS.cod_despesa &#x29; as cod_despesa&#xd;&#xa;		                                           , MAX&#x28; RECURSO.cod_recurso &#x29; as cod_recurso&#xd;&#xa;		                                           , sum&#x28; OSS.valor &#x29; as valor&#xd;&#xa;		                                           , OD.cod_entidade&#xd;&#xa;		                                        FROM orcamento.suplementacao_suplementada AS OSS&#xd;&#xa;		                                           , orcamento.despesa                    AS OD&#xd;&#xa;		                                           , orcamento.recurso&#x28;stExercicio&#x29;  AS RECURSO            &#xd;&#xa;		                                       WHERE OSS.cod_despesa &#x3d; OD.cod_despesa&#xd;&#xa;		                                         AND OSS.exercicio   &#x3d; OD.exercicio&#xd;&#xa;		                                         AND OD.cod_recurso  &#x3d; RECURSO.cod_recurso&#xd;&#xa;		                                         AND OD.exercicio    &#x3d; RECURSO.exercicio&#xd;&#xa;		                                    GROUP BY OSS.exercicio&#xd;&#xa;		                                           , OSS.cod_suplementacao&#xd;&#xa;		                                           , RECURSO.cod_recurso&#xd;&#xa;		                                           , OD.cod_entidade&#xd;&#xa;		                                    ORDER BY OSS.exercicio&#xd;&#xa;		                                           , OSS.cod_suplementacao&#xd;&#xa;		                                           , RECURSO.cod_recurso&#xd;&#xa;		                                   &#x29; AS suplementacao_suplementada&#xd;&#xa;		                                ON suplementacao.exercicio         &#x3d; suplementacao_suplementada.exercicio&#xd;&#xa;		                               AND suplementacao.cod_suplementacao &#x3d; suplementacao_suplementada.cod_suplementacao&#xd;&#xa;		                         LEFT JOIN &#x28; SELECT OSR.exercicio&#xd;&#xa;		                                           , OSR.cod_suplementacao&#xd;&#xa;		                                           , MAX&#x28; OSR.cod_despesa &#x29; as cod_despesa&#xd;&#xa;		                                           , sum&#x28; OSR.valor &#x29; AS valor&#xd;&#xa;		                                           , OD.cod_entidade&#xd;&#xa;		                                        FROM orcamento.suplementacao_reducao AS OSR&#xd;&#xa;		                                  INNER JOIN orcamento.despesa AS OD&#xd;&#xa;		                                          ON OSR.cod_despesa &#x3d; OD.cod_despesa&#xd;&#xa;		                                         AND OSR.exercicio   &#x3d; OD.exercicio&#xd;&#xa;		                                    GROUP BY OSR.exercicio&#xd;&#xa;		                                           , OSR.cod_suplementacao&#xd;&#xa;		                                           , OD.cod_entidade&#xd;&#xa;		                                    ORDER BY OSR.exercicio&#xd;&#xa;		                                           , OSR.cod_suplementacao&#xd;&#xa;		                                   &#x29; AS suplementacao_reducao&#xd;&#xa;		                                ON suplementacao.exercicio         &#x3d; suplementacao_reducao.exercicio&#xd;&#xa;		                               AND suplementacao.cod_suplementacao &#x3d; suplementacao_reducao.cod_suplementacao&#xd;&#xa;		                         LEFT JOIN contabilidade.tipo_transferencia&#xd;&#xa;		                                ON suplementacao.cod_tipo          &#x3d; tipo_transferencia.cod_tipo&#xd;&#xa;		                               AND suplementacao.exercicio         &#x3d; tipo_transferencia.exercicio&#xd;&#xa;		                         LEFT JOIN contabilidade.transferencia_despesa&#xd;&#xa;		                                ON suplementacao.cod_tipo          &#x3d; transferencia_despesa.cod_tipo&#xd;&#xa;		                               AND suplementacao.exercicio         &#x3d; transferencia_despesa.exercicio&#xd;&#xa;		                               AND suplementacao.cod_suplementacao &#x3d; transferencia_despesa.cod_suplementacao&#xd;&#xa;		                        INNER JOIN tcemg.norma_detalhe&#xd;&#xa;		                                ON norma_detalhe.cod_norma                 &#x3d; norma.cod_norma&#xd;&#xa;		                               AND norma_detalhe.tipo_lei_origem_decreto   &#x3d; 3&#xd;&#xa;		                         LEFT JOIN tcemg.tipo_lei_alteracao_orcamentaria&#xd;&#xa;		                                ON tipo_lei_alteracao_orcamentaria.cod_tipo_lei &#x3d; norma_detalhe.tipo_lei_alteracao_orcamentaria&#xd;&#xa;		                             WHERE suplementacao.exercicio &#x3d; stExercicio        &#xd;&#xa;		                               AND &#x28;suplementacao_suplementada.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29; OR suplementacao_reducao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;&#x29;   &#xd;&#xa;		                               AND suplementacao.dt_suplementacao BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                        &#xd;&#xa;		                               AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;          &#xd;&#xa;		                               AND suplementacao.cod_tipo in &#x28;1,2,3,4,5,6,7,8,9,10,11,12,13,14&#x29;&#xd;&#xa;		                               AND NOT EXISTS&#xd;&#xa;		                                   &#x28;&#xd;&#xa;		                                    SELECT 1&#xd;&#xa;		                                      FROM orcamento.suplementacao_anulada&#xd;&#xa;		                                     WHERE &#x28;&#xd;&#xa;		                                                suplementacao_anulada.cod_suplementacao_anulacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;		                                            OR&#xd;&#xa;		                                                suplementacao_anulada.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;		                                           &#x29;&#xd;&#xa;		                                       AND suplementacao_anulada.exercicio &#x3d; suplementacao.exercicio&#xd;&#xa;		                                   &#x29;&#xd;&#xa;		                          GROUP BY nro_lei_alteracao&#xd;&#xa;		                                 , tipo_lei_alteracao&#xd;&#xa;		                                 , tipo_transferencia.cod_tipo&#xd;&#xa;		                                 , norma.cod_norma&#xd;&#xa;		                          ORDER BY nro_lei_alteracao&#xd;&#xa;		                                 , tipo_lei_alteracao&#xd;&#xa;		                         &#x29; AS tabela&#xd;&#xa;			&#x29;,&#xd;&#xa;			lao20 as&#xd;&#xa;			&#x28;&#xd;&#xa;	                    SELECT&#xd;&#xa;	                           &#x27;20&#x27; AS tipo_registro&#xd;&#xa;	                         , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;	                         , COALESCE &#x28; &#x28;   SELECT DISTINCT atributo_norma_valor.valor&#xd;&#xa;	                                            FROM normas.atributo_norma_valor&#xd;&#xa;	                                      INNER JOIN normas.atributo_tipo_norma&#xd;&#xa;	                                              ON atributo_tipo_norma.cod_tipo_norma &#x3d; atributo_norma_valor.cod_tipo_norma&#xd;&#xa;	                                             AND atributo_tipo_norma.cod_modulo     &#x3d; atributo_norma_valor.cod_modulo&#xd;&#xa;	                                             AND atributo_tipo_norma.cod_cadastro   &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;	                                             AND atributo_tipo_norma.cod_atributo   &#x3d; atributo_norma_valor.cod_atributo&#xd;&#xa;	                                      INNER JOIN administracao.atributo_dinamico&#xd;&#xa;	                                              ON atributo_dinamico.cod_modulo     &#x3d; atributo_tipo_norma.cod_modulo&#xd;&#xa;	                                             AND atributo_dinamico.cod_cadastro   &#x3d; atributo_tipo_norma.cod_cadastro&#xd;&#xa;	                                             AND atributo_dinamico.cod_atributo   &#x3d; atributo_tipo_norma.cod_atributo&#xd;&#xa;	                                           WHERE atributo_tipo_norma.ativo &#x3d; TRUE&#xd;&#xa;	                                             AND atributo_dinamico.cod_atributo &#x3d; 103&#xd;&#xa;	                                             AND atributo_norma_valor.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;	                                             AND atributo_norma_valor.timestamp &#x3d; &#x28; SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;	                                                                                      FROM normas.atributo_norma_valor AS anv&#xd;&#xa;	                                                                                     WHERE cod_norma &#x3d; atributo_norma_valor.cod_norma&#xd;&#xa;	                                                                                       AND cod_cadastro &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;	                                                                                       AND cod_modulo &#x3d;  atributo_norma_valor.cod_modulo&#xd;&#xa;	                                                                                       AND cod_atributo &#x3d;  atributo_norma_valor.cod_atributo&#xd;&#xa;	                                                                                       AND atributo_dinamico.cod_atributo &#x3d; 103 &#x29;&#xd;&#xa;	                                       &#x29; , &#x27; &#x27;&#x29;  AS nro_lei_alter_orcam&#xd;&#xa;	                         , &#x28; SELECT DISTINCT REPLACE&#x28;atributo_norma_valor.valor,&#x27;&#x2f;&#x27;,&#x27;&#x27;&#x29; as valor&#xd;&#xa;	                               FROM normas.atributo_norma_valor&#xd;&#xa;	                         INNER JOIN normas.atributo_tipo_norma&#xd;&#xa;	                                 ON atributo_tipo_norma.cod_tipo_norma &#x3d; atributo_norma_valor.cod_tipo_norma&#xd;&#xa;	                                AND atributo_tipo_norma.cod_modulo     &#x3d; atributo_norma_valor.cod_modulo&#xd;&#xa;	                                AND atributo_tipo_norma.cod_cadastro   &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;	                                AND atributo_tipo_norma.cod_atributo   &#x3d; atributo_norma_valor.cod_atributo&#xd;&#xa;	                         INNER JOIN administracao.atributo_dinamico&#xd;&#xa;	                                 ON atributo_dinamico.cod_modulo     &#x3d; atributo_tipo_norma.cod_modulo&#xd;&#xa;	                                AND atributo_dinamico.cod_cadastro   &#x3d; atributo_tipo_norma.cod_cadastro&#xd;&#xa;	                                AND atributo_dinamico.cod_atributo   &#x3d; atributo_tipo_norma.cod_atributo&#xd;&#xa;	                              WHERE atributo_tipo_norma.ativo &#x3d; TRUE&#xd;&#xa;	                                AND atributo_dinamico.cod_atributo &#x3d; 104&#xd;&#xa;	                                AND atributo_norma_valor.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;	                                AND atributo_norma_valor.timestamp &#x3d; &#x28; SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;	                                                                         FROM normas.atributo_norma_valor AS anv&#xd;&#xa;	                                                                        WHERE cod_norma &#x3d; atributo_norma_valor.cod_norma&#xd;&#xa;	                                                                          AND cod_cadastro &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;	                                                                          AND cod_modulo &#x3d;  atributo_norma_valor.cod_modulo&#xd;&#xa;	                                                                          AND cod_atributo &#x3d;  atributo_norma_valor.cod_atributo&#xd;&#xa;	                                                                          AND atributo_dinamico.cod_atributo &#x3d; 104 &#x29;&#xd;&#xa;	                           &#x29; AS dt_lei_alter_orcam&#xd;&#xa;	                      FROM orcamento.suplementacao&#xd;&#xa;	                 LEFT JOIN orcamento.suplementacao_suplementada&#xd;&#xa;	                        ON suplementacao_suplementada.exercicio &#x3d; suplementacao.exercicio&#xd;&#xa;	                       AND suplementacao_suplementada.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;	                 LEFT JOIN orcamento.suplementacao_reducao&#xd;&#xa;	                        ON suplementacao_reducao.exercicio &#x3d; suplementacao.exercicio&#xd;&#xa;	                       AND suplementacao_reducao.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;	                INNER JOIN orcamento.despesa&#xd;&#xa;	                        ON despesa.exercicio &#x3d; suplementacao_suplementada.exercicio&#xd;&#xa;	                       AND despesa.cod_despesa &#x3d; suplementacao_suplementada.cod_despesa&#xd;&#xa;	                INNER JOIN normas.norma&#xd;&#xa;	                        ON norma.cod_norma &#x3d; suplementacao.cod_norma&#xd;&#xa;	                INNER JOIN normas.atributo_norma_valor&#xd;&#xa;	                        ON atributo_norma_valor.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;	                INNER JOIN normas.atributo_tipo_norma&#xd;&#xa;	                        ON atributo_tipo_norma.cod_tipo_norma &#x3d; atributo_norma_valor.cod_tipo_norma&#xd;&#xa;	                       AND atributo_tipo_norma.cod_modulo     &#x3d; atributo_norma_valor.cod_modulo&#xd;&#xa;	                       AND atributo_tipo_norma.cod_cadastro   &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;	                       AND atributo_tipo_norma.cod_atributo   &#x3d; atributo_norma_valor.cod_atributo&#xd;&#xa;	                INNER JOIN administracao.atributo_dinamico&#xd;&#xa;	                        ON atributo_dinamico.cod_modulo     &#x3d; atributo_tipo_norma.cod_modulo&#xd;&#xa;	                       AND atributo_dinamico.cod_cadastro   &#x3d; atributo_tipo_norma.cod_cadastro&#xd;&#xa;	                       AND atributo_dinamico.cod_atributo   &#x3d; atributo_tipo_norma.cod_atributo&#xd;&#xa;	                INNER JOIN administracao.configuracao_entidade&#xd;&#xa;	                        ON configuracao_entidade.cod_entidade  &#x3d; despesa.cod_entidade&#xd;&#xa;	                       AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                       AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;	                       AND configuracao_entidade.exercicio &#x3d; despesa.exercicio&#xd;&#xa;	                INNER JOIN tcemg.norma_detalhe&#xd;&#xa;	                        ON norma_detalhe.cod_norma                 &#x3d; norma.cod_norma&#xd;&#xa;	                       AND norma_detalhe.tipo_lei_origem_decreto   &#x3d; 3&#xd;&#xa;	                     WHERE suplementacao.exercicio &#x3d; stExercicio                                                      &#xd;&#xa;	                       AND despesa.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;	                       AND suplementacao.dt_suplementacao BETWEEN TO_DATE&#x28;&#x27;01&#x2f;02&#x2f;2015&#x27;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                 &#xd;&#xa;	                       AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29; 	  &#xd;&#xa;	                       AND atributo_tipo_norma.ativo &#x3d; TRUE&#xd;&#xa;	                       AND TRIM&#x28;atributo_dinamico.nom_atributo&#x29; ILIKE &#x27;Altera Percentual Suplementa&#xe7;&#xf5;es&#x27;&#xd;&#xa;	                       AND atributo_norma_valor.valor &#x3d; &#x27;1&#x27;&#xd;&#xa;	                       AND NOT EXISTS&#xd;&#xa;	                            &#x28;&#xd;&#xa;	                             SELECT 1&#xd;&#xa;	                               FROM orcamento.suplementacao_anulada&#xd;&#xa;	                              WHERE &#x28;&#xd;&#xa;	                                         suplementacao_anulada.cod_suplementacao_anulacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;	                                     OR&#xd;&#xa;	                                         suplementacao_anulada.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;	                                    &#x29;&#xd;&#xa;	                                AND suplementacao_anulada.exercicio &#x3d; suplementacao.exercicio&#xd;&#xa;	                            &#x29;&#xd;&#xa;	                  GROUP BY tipo_registro, cod_orgao, nro_lei_alter_orcam, dt_lei_alter_orcam&#xd;&#xa;	                  ORDER BY nro_lei_alter_orcam, dt_lei_alter_orcam, cod_orgao&#xd;&#xa;			&#x29;,&#xd;&#xa;			lao21 as&#xd;&#xa;			&#x28;&#xd;&#xa;			        SELECT DISTINCT tabela.tipo_registro&#xd;&#xa;	             , nro_lei_alter_orcam&#xd;&#xa;	             , CASE WHEN tabela.artigo_lei_alter_orcamento IS NOT NULL THEN&#xd;&#xa;	                            regexp_replace&#x28;remove_acentos&#x28;REPLACE&#x28;&#x28;REPLACE&#x28;REPLACE&#x28;tabela.artigo_lei_alter_orcamento,Chr&#x28;39&#x29;, &#x27;&#x27;&#x29;, Chr&#x28;10&#x29;, &#x27;&#x27;&#x29;&#x29;, Chr&#x28;13&#x29;, &#x27; &#x27;&#x29;&#x29;,&#x27;&#x5b;&#xba;&#x7c;&#xb0;&#x5d;&#x27;, &#x27;&#x27;, &#x27;gi&#x27;&#x29;&#xd;&#xa;	               END AS artigo_lei_alter_orcamento&#xd;&#xa;	             , CASE WHEN tabela.descricao_artigo IS NOT NULL THEN&#xd;&#xa;	                            TRIM&#x28;regexp_replace&#x28;remove_acentos&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;REPLACE&#x28;tabela.descricao_artigo,Chr&#x28;39&#x29;, &#x27;&#x27;&#x29;, Chr&#x28;10&#x29;, &#x27;&#x27;&#x29;, Chr&#x28;13&#x29;, &#x27; &#x27;&#x29;, Chr&#x28;9&#x29;, &#x27; &#x27;&#x29;&#x29;,&#x27;&#x5b;&#xba;&#x7c;&#xb0;&#x7c;&#x25;&#x7c;&#xa7;&#x5d;&#x27;, &#x27;&#x27;, &#x27;gi&#x27;&#x29;&#x29;&#xd;&#xa;	               END AS descricao_artigo&#xd;&#xa;	             , tabela.novo_percentual&#xd;&#xa;	             , tabela.tipo_autorizacao&#x3a;&#x3a;VARCHAR&#xd;&#xa;	          FROM &#x28;&#xd;&#xa;			                SELECT &#x27;21&#x27; AS tipo_registro&#xd;&#xa;			                     , COALESCE &#x28;&#x28; SELECT DISTINCT atributo_norma_valor.valor&#xd;&#xa;			                                     FROM normas.atributo_norma_valor&#xd;&#xa;			                               INNER JOIN normas.atributo_tipo_norma&#xd;&#xa;			                                       ON atributo_tipo_norma.cod_tipo_norma &#x3d; atributo_norma_valor.cod_tipo_norma&#xd;&#xa;			                                      AND atributo_tipo_norma.cod_modulo     &#x3d; atributo_norma_valor.cod_modulo&#xd;&#xa;			                                      AND atributo_tipo_norma.cod_cadastro   &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;			                                      AND atributo_tipo_norma.cod_atributo   &#x3d; atributo_norma_valor.cod_atributo&#xd;&#xa;			                               INNER JOIN administracao.atributo_dinamico&#xd;&#xa;			                                       ON atributo_dinamico.cod_modulo     &#x3d; atributo_tipo_norma.cod_modulo&#xd;&#xa;			                                      AND atributo_dinamico.cod_cadastro   &#x3d; atributo_tipo_norma.cod_cadastro&#xd;&#xa;			                                      AND atributo_dinamico.cod_atributo   &#x3d; atributo_tipo_norma.cod_atributo&#xd;&#xa;			                                    WHERE atributo_tipo_norma.ativo &#x3d; TRUE&#xd;&#xa;			                                      AND atributo_dinamico.cod_atributo &#x3d; 103&#xd;&#xa;			                                      AND atributo_norma_valor.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;			                                      AND atributo_norma_valor.timestamp &#x3d; &#x28; SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;			                                                                               FROM normas.atributo_norma_valor AS anv&#xd;&#xa;			                                                                              WHERE cod_norma &#x3d; atributo_norma_valor.cod_norma&#xd;&#xa;			                                                                                AND cod_cadastro &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;			                                                                                AND cod_modulo &#x3d;  atributo_norma_valor.cod_modulo&#xd;&#xa;			                                                                                AND cod_atributo &#x3d;  atributo_norma_valor.cod_atributo&#xd;&#xa;			                                                                                AND atributo_dinamico.cod_atributo &#x3d; 103 &#x29;&#xd;&#xa;			                                 &#x29; , &#x27; &#x27;&#x29; AS nro_lei_alter_orcam&#xd;&#xa;			                     , &#x28; SELECT atributo_norma_valor.valor&#xd;&#xa;			                           FROM normas.atributo_norma_valor&#xd;&#xa;			                     INNER JOIN normas.atributo_tipo_norma&#xd;&#xa;			                             ON atributo_tipo_norma.cod_tipo_norma &#x3d; atributo_norma_valor.cod_tipo_norma&#xd;&#xa;			                            AND atributo_tipo_norma.cod_modulo     &#x3d; atributo_norma_valor.cod_modulo&#xd;&#xa;			                            AND atributo_tipo_norma.cod_cadastro   &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;			                            AND atributo_tipo_norma.cod_atributo   &#x3d; atributo_norma_valor.cod_atributo&#xd;&#xa;			                     INNER JOIN administracao.atributo_dinamico&#xd;&#xa;			                             ON atributo_dinamico.cod_modulo     &#x3d; atributo_tipo_norma.cod_modulo&#xd;&#xa;			                            AND atributo_dinamico.cod_cadastro   &#x3d; atributo_tipo_norma.cod_cadastro&#xd;&#xa;			                            AND atributo_dinamico.cod_atributo   &#x3d; atributo_tipo_norma.cod_atributo&#xd;&#xa;			                          WHERE atributo_tipo_norma.ativo &#x3d; TRUE&#xd;&#xa;			                            AND TRIM&#x28;atributo_dinamico.nom_atributo&#x29; ILIKE &#x27;Artigo da Lei&#x27;&#xd;&#xa;			                            AND atributo_norma_valor.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;			                            AND atributo_norma_valor.timestamp &#x3d; &#x28; SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;			                                                                     FROM normas.atributo_norma_valor AS anv&#xd;&#xa;			                                                                    WHERE cod_norma &#x3d; atributo_norma_valor.cod_norma&#xd;&#xa;			                                                                      AND cod_cadastro &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;			                                                                      AND cod_modulo &#x3d;  atributo_norma_valor.cod_modulo&#xd;&#xa;			                                                                      AND cod_atributo &#x3d;  atributo_norma_valor.cod_atributo &#x29;&#xd;&#xa;			                       &#x29; AS artigo_lei_alter_orcamento&#xd;&#xa;			                     , COALESCE &#x28;&#x28; SELECT atributo_norma_valor.valor&#xd;&#xa;			                                     FROM normas.atributo_norma_valor&#xd;&#xa;			                               INNER JOIN normas.atributo_tipo_norma&#xd;&#xa;			                                       ON atributo_tipo_norma.cod_tipo_norma &#x3d; atributo_norma_valor.cod_tipo_norma&#xd;&#xa;			                                      AND atributo_tipo_norma.cod_modulo     &#x3d; atributo_norma_valor.cod_modulo&#xd;&#xa;			                                      AND atributo_tipo_norma.cod_cadastro   &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;			                                      AND atributo_tipo_norma.cod_atributo   &#x3d; atributo_norma_valor.cod_atributo&#xd;&#xa;			                               INNER JOIN administracao.atributo_dinamico&#xd;&#xa;			                                       ON atributo_dinamico.cod_modulo     &#x3d; atributo_tipo_norma.cod_modulo&#xd;&#xa;			                                      AND atributo_dinamico.cod_cadastro   &#x3d; atributo_tipo_norma.cod_cadastro&#xd;&#xa;			                                      AND atributo_dinamico.cod_atributo   &#x3d; atributo_tipo_norma.cod_atributo&#xd;&#xa;			                                    WHERE atributo_tipo_norma.ativo &#x3d; TRUE&#xd;&#xa;			                                      AND atributo_dinamico.cod_atributo &#x3d; 5004&#xd;&#xa;			                                      AND atributo_norma_valor.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;			                                      AND atributo_norma_valor.timestamp &#x3d; &#x28; SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;			                                                                               FROM normas.atributo_norma_valor AS anv&#xd;&#xa;			                                                                              WHERE cod_norma &#x3d; atributo_norma_valor.cod_norma&#xd;&#xa;			                                                                                AND cod_cadastro &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;			                                                                                AND cod_modulo &#x3d;  atributo_norma_valor.cod_modulo&#xd;&#xa;			                                                                                AND cod_atributo &#x3d;  atributo_norma_valor.cod_atributo &#x29;&#xd;&#xa;			                                 &#x29;, &#x27; &#x27; &#x29; AS descricao_artigo&#xd;&#xa;			                     , COALESCE &#x28;&#x28; SELECT atributo_norma_valor.valor AS valor&#xd;&#xa;			                                     FROM normas.atributo_norma_valor&#xd;&#xa;			                               INNER JOIN normas.atributo_tipo_norma&#xd;&#xa;			                                       ON atributo_tipo_norma.cod_tipo_norma &#x3d; atributo_norma_valor.cod_tipo_norma&#xd;&#xa;			                                      AND atributo_tipo_norma.cod_modulo     &#x3d; atributo_norma_valor.cod_modulo&#xd;&#xa;			                                      AND atributo_tipo_norma.cod_cadastro   &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;			                                      AND atributo_tipo_norma.cod_atributo   &#x3d; atributo_norma_valor.cod_atributo&#xd;&#xa;			                               INNER JOIN administracao.atributo_dinamico&#xd;&#xa;			                                       ON atributo_dinamico.cod_modulo     &#x3d; atributo_tipo_norma.cod_modulo&#xd;&#xa;			                                      AND atributo_dinamico.cod_cadastro   &#x3d; atributo_tipo_norma.cod_cadastro&#xd;&#xa;			                                      AND atributo_dinamico.cod_atributo   &#x3d; atributo_tipo_norma.cod_atributo&#xd;&#xa;			                                    WHERE atributo_tipo_norma.ativo &#x3d; TRUE&#xd;&#xa;			                                      AND TRIM&#x28;atributo_dinamico.nom_atributo&#x29; ILIKE &#x27;Novo Percentual Suplementa&#xe7;&#xf5;es&#x27;&#xd;&#xa;			                                      AND atributo_norma_valor.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;			                                      AND atributo_norma_valor.timestamp &#x3d; &#x28; SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;			                                                                               FROM normas.atributo_norma_valor AS anv&#xd;&#xa;			                                                                              WHERE cod_norma &#x3d; atributo_norma_valor.cod_norma&#xd;&#xa;			                                                                                AND cod_cadastro &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;			                                                                                AND cod_modulo &#x3d;  atributo_norma_valor.cod_modulo&#xd;&#xa;			                                                                                AND cod_atributo &#x3d;  atributo_norma_valor.cod_atributo &#x29;&#xd;&#xa;			                                 &#x29;, &#x27;0.00&#x27;&#x29; AS novo_percentual&#xd;&#xa;			                     , CASE WHEN suplementacao.cod_tipo IN &#x28;1,2,3,4,5&#x29; THEN&#xd;&#xa;			                                     1&#xd;&#xa;			                            ELSE&#xd;&#xa;			                                     2&#xd;&#xa;			                       END AS tipo_autorizacao&#xd;&#xa;			                  FROM orcamento.suplementacao&#xd;&#xa;			             LEFT JOIN orcamento.suplementacao_suplementada&#xd;&#xa;			                    ON suplementacao_suplementada.exercicio &#x3d; suplementacao.exercicio&#xd;&#xa;			                   AND suplementacao_suplementada.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;			             LEFT JOIN orcamento.suplementacao_reducao&#xd;&#xa;			                    ON suplementacao_reducao.exercicio &#x3d; suplementacao.exercicio&#xd;&#xa;			                   AND suplementacao_reducao.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;			            INNER JOIN orcamento.despesa&#xd;&#xa;			                    ON despesa.exercicio &#x3d; suplementacao_suplementada.exercicio&#xd;&#xa;			                   AND despesa.cod_despesa &#x3d; suplementacao_suplementada.cod_despesa&#xd;&#xa;			            INNER JOIN normas.norma&#xd;&#xa;			                    ON norma.cod_norma &#x3d; suplementacao.cod_norma&#xd;&#xa;			                   AND suplementacao.cod_suplementacao &#x3d; &#x28;select max&#x28;oc.cod_suplementacao&#x29; from orcamento.suplementacao as oc where oc.cod_norma &#x3d; norma.cod_norma AND oc.exercicio &#x3d; suplementacao.exercicio&#x29;&#xd;&#xa;			            INNER JOIN normas.atributo_norma_valor&#xd;&#xa;			                    ON atributo_norma_valor.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;			            INNER JOIN normas.atributo_tipo_norma&#xd;&#xa;			                    ON atributo_tipo_norma.cod_tipo_norma &#x3d; atributo_norma_valor.cod_tipo_norma&#xd;&#xa;			                   AND atributo_tipo_norma.cod_modulo     &#x3d; atributo_norma_valor.cod_modulo&#xd;&#xa;			                   AND atributo_tipo_norma.cod_cadastro   &#x3d; atributo_norma_valor.cod_cadastro&#xd;&#xa;			                   AND atributo_tipo_norma.cod_atributo   &#x3d; atributo_norma_valor.cod_atributo&#xd;&#xa;			            INNER JOIN administracao.atributo_dinamico&#xd;&#xa;			                    ON atributo_dinamico.cod_modulo     &#x3d; atributo_tipo_norma.cod_modulo&#xd;&#xa;			                   AND atributo_dinamico.cod_cadastro   &#x3d; atributo_tipo_norma.cod_cadastro&#xd;&#xa;			                   AND atributo_dinamico.cod_atributo   &#x3d; atributo_tipo_norma.cod_atributo&#xd;&#xa;			            INNER JOIN administracao.configuracao_entidade&#xd;&#xa;			                    ON configuracao_entidade.cod_entidade  &#x3d; despesa.cod_entidade&#xd;&#xa;			                   AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			                   AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;			                   AND configuracao_entidade.exercicio &#x3d; despesa.exercicio&#xd;&#xa;			            INNER JOIN tcemg.norma_detalhe&#xd;&#xa;			                    ON norma_detalhe.cod_norma                 &#x3d; norma.cod_norma&#xd;&#xa;			                   AND norma_detalhe.tipo_lei_origem_decreto   &#x3d; 3&#xd;&#xa;			                 WHERE suplementacao.exercicio &#x3d; stExercicio                                                                   &#xd;&#xa;			                   AND despesa.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                 &#xd;&#xa;			                   AND suplementacao.dt_suplementacao BETWEEN TO_DATE&#x28;stExercicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                               &#xd;&#xa;			                   AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;                  &#xd;&#xa;			                   AND atributo_tipo_norma.ativo &#x3d; TRUE&#xd;&#xa;			                   AND TRIM&#x28;atributo_dinamico.nom_atributo&#x29; ILIKE &#x27;Altera Percentual Suplementa&#xe7;&#xf5;es&#x27;&#xd;&#xa;			                   AND TRIM&#x28;atributo_norma_valor.valor&#x29; &#x3d; &#x27;1&#x27;&#xd;&#xa;			                   AND NOT EXISTS&#xd;&#xa;			                        &#x28;&#xd;&#xa;			                         SELECT 1&#xd;&#xa;			                           FROM orcamento.suplementacao_anulada&#xd;&#xa;			                          WHERE &#x28;&#xd;&#xa;			                                     suplementacao_anulada.cod_suplementacao_anulacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;			                                 OR&#xd;&#xa;			                                     suplementacao_anulada.cod_suplementacao &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;			                                &#x29;&#xd;&#xa;			                            AND suplementacao_anulada.exercicio &#x3d; suplementacao.exercicio&#xd;&#xa;			                        &#x29;&#xd;&#xa;			              GROUP BY tipo_registro,  nro_lei_alter_orcam, norma.cod_norma, suplementacao.cod_tipo&#xd;&#xa;			               &#x29; AS tabela&#xd;&#xa;			      GROUP BY 1,2,3,4,5,6&#xd;&#xa;			&#x29;,&#xd;&#xa;			  lao_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							nro_lei_alteracao,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_lei_alteracao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_lei_alteracao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from lao10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							nro_lei_alteracao,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_lei_alteracao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_lei_alteracao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;artigo_lei_alteracao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;descricao_artigo&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,512&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_autorizacao_alteracao&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from lao11&#xd;&#xa;				union all&#xd;&#xa;						select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							nro_lei_alter_orcam as nro_lei_alteracao,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27; &#x27;&#x29;		&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_lei_alter_orcam&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_lei_alter_orcam&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from lao20&#xd;&#xa;				union all&#xd;&#xa;						select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							nro_lei_alter_orcam as nro_lei_alteracao,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_lei_alter_orcam&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_autorizacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;artigo_lei_alter_orcamento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;descricao_artigo&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,512&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;novo_percentual&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from lao21&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;LAO.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from lao_format order by nro_lei_alteracao, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;	&#xd;&#xa;&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;OPS.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with ops10 as&#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT &#x27;10&#x27; AS tipo_registro&#xd;&#xa;	                       , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS codorgao&#xd;&#xa;	                       , CASE WHEN pre_empenho.cod_pre_empenho &#x3d; restos_pre_empenho.cod_pre_empenho AND pre_empenho.implantado &#x3d; &#x27;t&#x27;&#xd;&#xa;	                              THEN CASE WHEN uniorcam_restos_atual.num_orgao IS NOT NULL&#xd;&#xa;	                                        THEN LPAD&#x28;LPAD&#x28;uniorcam_restos_atual.num_orgao&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;uniorcam_restos_atual.num_unidade&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#xd;&#xa;	                                        ELSE LPAD&#x28;restos_pre_empenho.num_unidade&#x3a;&#x3a;VARCHAR,5,&#x27;0&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#xd;&#xa;	                                    END&#xd;&#xa;	                              ELSE LPAD&#x28;&#x28;lpad&#x28;despesa.num_orgao&#x3a;&#x3a;VARCHAR, 3, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;despesa.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x29;,5,&#x27;0&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#xd;&#xa;	                          END AS codunidadesub&#xd;&#xa;	                       , TO_CHAR&#x28;nlp.timestamp,&#x27;yyyymmddHH24MI&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;ordem_pagamento.cod_ordem&#x3a;&#x3a;VARCHAR,10,&#x27;0&#x27;&#x29; AS nroop &#xd;&#xa;	                       , TO_CHAR&#x28;nlp.timestamp,&#x27;ddmmyyyy&#x27;&#x29; AS dtpagamento&#xd;&#xa;	                       , empenho.cod_empenho&#xd;&#xa;	                       , SUM&#x28;nlp.vl_pago&#x29; AS vlop&#xd;&#xa;	                       , CASE WHEN ordem_pagamento.observacao &#x3c;&#x3e; &#x27;&#x27;&#xd;&#xa;	                              THEN trim&#x28;regexp_replace&#x28;sem_acentos&#x28;ordem_pagamento.observacao&#x29;, &#x27;&#x5b;&#xba;&#x7c;&#xb0;&#x5d;&#x27;, &#x27;&#x27;, &#x27;gi&#x27;&#x29;&#x29;&#xd;&#xa;	                              ELSE &#x27;pagamento OP&#x27; &#x7c;&#x7c; ordem_pagamento.cod_ordem&#x3a;&#x3a;varchar&#xd;&#xa;	                          END AS especificacaoop&#xd;&#xa;	                       , sw_cgm_pessoa_fisica.cpf AS cpfresppgto&#xd;&#xa;	                    FROM empenho.nota_liquidacao_paga AS nlp&#xd;&#xa;	               LEFT JOIN empenho.nota_liquidacao_paga_anulada AS nlpa&#xd;&#xa;	                      ON nlpa.exercicio    &#x3d; nlp.exercicio&#xd;&#xa;	                     AND nlpa.cod_nota     &#x3d; nlp.cod_nota&#xd;&#xa;	                     AND nlpa.cod_entidade &#x3d; nlp.cod_entidade&#xd;&#xa;	                     AND nlpa.timestamp    &#x3d; nlp.timestamp&#xd;&#xa;	               LEFT JOIN empenho.pagamento_liquidacao_nota_liquidacao_paga AS plnlp&#xd;&#xa;	                      ON nlp.cod_entidade &#x3d; plnlp.cod_entidade&#xd;&#xa;	                     AND nlp.cod_nota     &#x3d; plnlp.cod_nota&#xd;&#xa;	                     AND nlp.exercicio    &#x3d; plnlp.exercicio_liquidacao&#xd;&#xa;	                     AND nlp.timestamp    &#x3d; plnlp.timestamp&#xd;&#xa;	               LEFT JOIN empenho.pagamento_liquidacao AS pl&#xd;&#xa;	                      ON pl.cod_entidade         &#x3d; plnlp.cod_entidade&#xd;&#xa;	                     AND pl.cod_nota             &#x3d; plnlp.cod_nota&#xd;&#xa;	                     AND pl.exercicio            &#x3d; plnlp.exercicio&#xd;&#xa;	                     AND pl.exercicio_liquidacao &#x3d; plnlp.exercicio_liquidacao&#xd;&#xa;	                     AND pl.cod_ordem            &#x3d; plnlp.cod_ordem&#xd;&#xa;	               LEFT JOIN empenho.nota_liquidacao AS nl&#xd;&#xa;	                      ON nl.exercicio    &#x3d; pl.exercicio_liquidacao&#xd;&#xa;	                     AND nl.cod_nota     &#x3d; pl.cod_nota&#xd;&#xa;	                     AND nl.cod_entidade &#x3d; pl.cod_entidade&#xd;&#xa;	               LEFT JOIN empenho.empenho&#xd;&#xa;	                      ON empenho.exercicio    &#x3d; nl.exercicio_empenho&#xd;&#xa;	                     AND empenho.cod_entidade &#x3d; nl.cod_entidade&#xd;&#xa;	                     AND empenho.cod_empenho  &#x3d; nl.cod_empenho&#xd;&#xa;	               LEFT JOIN administracao.configuracao_entidade&#xd;&#xa;	                      ON configuracao_entidade.cod_entidade &#x3d; nlp.cod_entidade&#xd;&#xa;	                     AND configuracao_entidade.exercicio    &#x3d; stExercicio                 &#xd;&#xa;	                     AND configuracao_entidade.cod_modulo   &#x3d; 55&#xd;&#xa;	                     AND configuracao_entidade.parametro    &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	               LEFT JOIN empenho.ordem_pagamento&#xd;&#xa;	                      ON pl.exercicio    &#x3d; ordem_pagamento.exercicio&#xd;&#xa;	                     AND pl.cod_entidade &#x3d; ordem_pagamento.cod_entidade&#xd;&#xa;	                     AND pl.cod_ordem    &#x3d; ordem_pagamento.cod_ordem&#xd;&#xa;	               LEFT JOIN empenho.pre_empenho&#xd;&#xa;	                      ON pre_empenho.exercicio       &#x3d; empenho.exercicio&#xd;&#xa;	                     AND pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;	               LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;	                      ON pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                     AND pre_empenho_despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	               LEFT JOIN empenho.restos_pre_empenho&#xd;&#xa;	                      ON pre_empenho.cod_pre_empenho &#x3d; restos_pre_empenho.cod_pre_empenho&#xd;&#xa;	                     AND pre_empenho.exercicio &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;	               LEFT JOIN tcemg.uniorcam AS uniorcam_restos&#xd;&#xa;	                      ON uniorcam_restos.num_unidade &#x3d; restos_pre_empenho.num_unidade&#xd;&#xa;	                     AND uniorcam_restos.num_orgao   &#x3d; restos_pre_empenho.num_orgao&#xd;&#xa;	                     AND uniorcam_restos.exercicio   &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;	                     AND uniorcam_restos.num_orgao_atual IS NOT NULL&#xd;&#xa;	               LEFT JOIN tcemg.uniorcam AS uniorcam_restos_atual&#xd;&#xa;	                      ON uniorcam_restos_atual.num_unidade &#x3d; uniorcam_restos.num_unidade_atual&#xd;&#xa;	                     AND uniorcam_restos_atual.num_orgao   &#x3d; uniorcam_restos.num_orgao_atual&#xd;&#xa;	                     AND uniorcam_restos_atual.exercicio   &#x3d; stExercicio                              &#xd;&#xa;	               LEFT JOIN orcamento.despesa&#xd;&#xa;	                      ON despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;	                     AND despesa.exercicio   &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;	               LEFT JOIN tesouraria.pagamento&#xd;&#xa;	                      ON pagamento.exercicio    &#x3d; nlp.exercicio&#xd;&#xa;	                     AND pagamento.cod_nota     &#x3d; nlp.cod_nota&#xd;&#xa;	                     AND pagamento.cod_entidade &#x3d; nlp.cod_entidade&#xd;&#xa;	                     AND pagamento.timestamp    &#x3d; nlp.timestamp&#xd;&#xa;	               LEFT JOIN sw_cgm_pessoa_fisica&#xd;&#xa;	                      ON sw_cgm_pessoa_fisica.numcgm &#x3d; pagamento.cgm_usuario&#xd;&#xa;	                   WHERE nlp.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                                            &#xd;&#xa;	                     AND TO_DATE&#x28;nlp.timestamp&#x3a;&#x3a;varchar, &#x27;YYYY-MM-DD&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;	                GROUP BY tipo_registro&#xd;&#xa;	                       , codorgao&#xd;&#xa;	                       , codunidadesub&#xd;&#xa;	                       , nroop&#xd;&#xa;	                       , empenho.cod_empenho&#xd;&#xa;	                       , dtpagamento&#xd;&#xa;	                       , especificacaoop&#xd;&#xa;	                       , cpfresppgto&#xd;&#xa;	                ORDER BY nroop&#xd;&#xa;			&#x29;,&#xd;&#xa;			ops11 as&#xd;&#xa;			&#x28;&#xd;&#xa;					     SELECT &#x27;11&#x27; AS tipo_registro&#xd;&#xa;		                       , LPAD&#x28;ordem_pagamento.cod_ordem&#x3a;&#x3a;VARCHAR,7,&#x27;0&#x27;&#x29;&#x7c;&#x7c;ordem_pagamento.exercicio&#x7c;&#x7c;TO_CHAR&#x28;nlp.timestamp,&#x27;HH24MI&#x27;&#x29; AS codreduzidoop &#xd;&#xa;		                       , CASE WHEN pre_empenho.cod_pre_empenho &#x3d; restos_pre_empenho.cod_pre_empenho AND pre_empenho.implantado &#x3d; &#x27;t&#x27;&#xd;&#xa;		                              THEN CASE WHEN uniorcam_restos_atual.num_orgao IS NOT NULL&#xd;&#xa;		                                        THEN LPAD&#x28;LPAD&#x28;uniorcam_restos_atual.num_orgao&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;uniorcam_restos_atual.num_unidade&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#xd;&#xa;		                                        ELSE LPAD&#x28;restos_pre_empenho.num_unidade&#x3a;&#x3a;VARCHAR,5,&#x27;0&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#xd;&#xa;		                                    END&#xd;&#xa;		                              ELSE LPAD&#x28;&#x28;lpad&#x28;despesa.num_orgao&#x3a;&#x3a;VARCHAR, 3, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;despesa.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x29;,5,&#x27;0&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#xd;&#xa;		                          END AS codunidadesub&#xd;&#xa;		                       , TO_CHAR&#x28;nlp.timestamp,&#x27;yyyymmddHH24MI&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;ordem_pagamento.cod_ordem&#x3a;&#x3a;VARCHAR,10,&#x27;0&#x27;&#x29; AS nroop &#xd;&#xa;		                       , TO_CHAR&#x28;nlp.timestamp,&#x27;ddmmyyyy&#x27;&#x29; AS dtpagamento&#xd;&#xa;		                       , CASE WHEN TO_CHAR&#x28;empenho.dt_empenho, &#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3c; 2015 AND TO_CHAR&#x28;nl.dt_liquidacao, &#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3c; 2015 AND TO_CHAR&#x28;plnlp.timestamp,&#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3d; 2015&#xd;&#xa;		                              THEN &#x27;3&#x27;&#xd;&#xa;		                              WHEN TO_CHAR&#x28;empenho.dt_empenho, &#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3c; 2015 AND TO_CHAR&#x28;nl.dt_liquidacao, &#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3d; 2015 AND TO_CHAR&#x28;plnlp.timestamp,&#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3d; 2015&#xd;&#xa;		                              THEN &#x27;4&#x27;&#xd;&#xa;		                              WHEN TO_CHAR&#x28;empenho.dt_empenho, &#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3d; 2015 AND TO_CHAR&#x28;nl.dt_liquidacao, &#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3d; 2015 AND TO_CHAR&#x28;plnlp.timestamp,&#x27;yyyy&#x27;&#x29;&#x3a;&#x3a;INTEGER &#x3d; 2015 AND conta_despesa.cod_estrutural ILIKE &#x27;4.6&#x25;&#x27;&#xd;&#xa;		                              THEN &#x27;2&#x27;&#xd;&#xa;		                              ELSE &#x27;1&#x27;&#xd;&#xa;		                          END AS tipopagamento&#xd;&#xa;		                       , empenho.cod_empenho AS nroempenho&#xd;&#xa;		                       , empenho.dt_empenho AS dtempenho&#xd;&#xa;		                       , TCEMG.numero_nota_liquidacao&#x28; stExercicio                              &#xd;&#xa;		                                                     , empenho.cod_entidade&#xd;&#xa;		                                                     , nl.cod_nota&#xd;&#xa;		                                                     , nl.exercicio_empenho&#xd;&#xa;		                                                     , empenho.cod_empenho&#xd;&#xa;		                         &#x29; AS nroliquidacao&#xd;&#xa;		                       , nl.dt_liquidacao AS dtliquidacao&#xd;&#xa;		                       , CASE WHEN restos_pre_empenho.recurso IS NOT NULL&#xd;&#xa;		                              THEN restos_pre_empenho.recurso&#xd;&#xa;		                              ELSE despesa.cod_recurso&#xd;&#xa;		                          END AS codfontrecursos&#xd;&#xa;		                       , SUM&#x28;nlp.vl_pago&#x29; AS valorfonte         &#xd;&#xa;		                       , CASE WHEN documento_cgm.numero IS NOT NULL OR TRIM&#x28;documento_cgm.numero&#x29; &#x3c;&#x3e; &#x27;&#x27;&#xd;&#xa;		                              THEN documento_cgm.tipo&#xd;&#xa;		                              ELSE 2&#xd;&#xa;		                          END AS tipodocumentocredor&#xd;&#xa;		                       , CASE WHEN documento_cgm.numero IS NOT NULL OR TRIM&#x28;documento_cgm.numero&#x29; &#x3c;&#x3e; &#x27;&#x27;&#xd;&#xa;		                              THEN documento_cgm.numero&#xd;&#xa;		                              else&#xd;&#xa;		                                &#x27; &#x27;  &#xd;&#xa;		                                &#xd;&#xa;	                             		&#xd;&#xa;		                            END AS nrodocumento  &#xd;&#xa;		                    FROM empenho.nota_liquidacao_paga AS nlp&#xd;&#xa;		               LEFT JOIN empenho.nota_liquidacao_paga_anulada AS nlpa&#xd;&#xa;		                      ON nlpa.exercicio    &#x3d; nlp.exercicio&#xd;&#xa;		                     AND nlpa.cod_nota     &#x3d; nlp.cod_nota&#xd;&#xa;		                     AND nlpa.cod_entidade &#x3d; nlp.cod_entidade&#xd;&#xa;		                     AND nlpa.timestamp    &#x3d; nlp.timestamp&#xd;&#xa;		               LEFT JOIN empenho.pagamento_liquidacao_nota_liquidacao_paga AS plnlp&#xd;&#xa;		                      ON nlp.cod_entidade &#x3d; plnlp.cod_entidade&#xd;&#xa;		                     AND nlp.cod_nota     &#x3d; plnlp.cod_nota&#xd;&#xa;		                     AND nlp.exercicio    &#x3d; plnlp.exercicio_liquidacao&#xd;&#xa;		                     AND nlp.timestamp    &#x3d; plnlp.timestamp&#xd;&#xa;		               LEFT JOIN empenho.pagamento_liquidacao AS pl&#xd;&#xa;		                      ON pl.cod_entidade         &#x3d; plnlp.cod_entidade&#xd;&#xa;		                     AND pl.cod_nota             &#x3d; plnlp.cod_nota&#xd;&#xa;		                     AND pl.exercicio            &#x3d; plnlp.exercicio&#xd;&#xa;		                     AND pl.exercicio_liquidacao &#x3d; plnlp.exercicio_liquidacao&#xd;&#xa;		                     AND pl.cod_ordem            &#x3d; plnlp.cod_ordem&#xd;&#xa;		               LEFT JOIN empenho.nota_liquidacao AS nl&#xd;&#xa;		                      ON nl.exercicio    &#x3d; pl.exercicio_liquidacao&#xd;&#xa;		                     AND nl.cod_nota     &#x3d; pl.cod_nota&#xd;&#xa;		                     AND nl.cod_entidade &#x3d; pl.cod_entidade&#xd;&#xa;		               LEFT JOIN empenho.empenho&#xd;&#xa;		                      ON empenho.exercicio    &#x3d; nl.exercicio_empenho&#xd;&#xa;		                     AND empenho.cod_entidade &#x3d; nl.cod_entidade&#xd;&#xa;		                     AND empenho.cod_empenho  &#x3d; nl.cod_empenho&#xd;&#xa;		               LEFT JOIN administracao.configuracao_entidade&#xd;&#xa;		                      ON configuracao_entidade.cod_entidade &#x3d; nlp.cod_entidade&#xd;&#xa;		                     AND configuracao_entidade.exercicio    &#x3d; stExercicio                                        &#xd;&#xa;		                     AND configuracao_entidade.cod_modulo   &#x3d; 55&#xd;&#xa;		                     AND configuracao_entidade.parametro    &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;		               LEFT JOIN empenho.ordem_pagamento&#xd;&#xa;		                      ON pl.exercicio    &#x3d; ordem_pagamento.exercicio&#xd;&#xa;		                     AND pl.cod_entidade &#x3d; ordem_pagamento.cod_entidade&#xd;&#xa;		                     AND pl.cod_ordem    &#x3d; ordem_pagamento.cod_ordem&#xd;&#xa;		               LEFT JOIN empenho.pre_empenho&#xd;&#xa;		                      ON pre_empenho.exercicio       &#x3d; empenho.exercicio&#xd;&#xa;		                     AND pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;		               LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;		                      ON pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;		                     AND pre_empenho_despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;		               LEFT JOIN empenho.restos_pre_empenho&#xd;&#xa;		                      ON pre_empenho.cod_pre_empenho &#x3d; restos_pre_empenho.cod_pre_empenho&#xd;&#xa;		                     AND pre_empenho.exercicio &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;		               LEFT JOIN tcemg.uniorcam AS uniorcam_restos&#xd;&#xa;		                      ON uniorcam_restos.num_unidade &#x3d; restos_pre_empenho.num_unidade&#xd;&#xa;		                     AND uniorcam_restos.num_orgao   &#x3d; restos_pre_empenho.num_orgao&#xd;&#xa;		                     AND uniorcam_restos.exercicio   &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;		                     AND uniorcam_restos.num_orgao_atual IS NOT NULL&#xd;&#xa;		               LEFT JOIN tcemg.uniorcam AS uniorcam_restos_atual&#xd;&#xa;		                      ON uniorcam_restos_atual.num_unidade &#x3d; uniorcam_restos.num_unidade_atual&#xd;&#xa;		                     AND uniorcam_restos_atual.num_orgao   &#x3d; uniorcam_restos.num_orgao_atual&#xd;&#xa;		                     AND uniorcam_restos_atual.exercicio   &#x3d; &#x27;2015&#x27;&#xd;&#xa;		               LEFT JOIN orcamento.despesa&#xd;&#xa;		                      ON despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;		                     AND despesa.exercicio   &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;		               LEFT JOIN orcamento.conta_despesa&#xd;&#xa;		                      ON conta_despesa.cod_conta &#x3d; pre_empenho_despesa.cod_conta&#xd;&#xa;		                     AND conta_despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;		              INNER JOIN &#x28;&#xd;&#xa;		                          SELECT numcgm&#xd;&#xa;		                               , cpf AS numero&#xd;&#xa;		                               , 1 AS tipo&#xd;&#xa;		                            FROM sw_cgm_pessoa_fisica&#xd;&#xa;		                           UNION&#xd;&#xa;		                          SELECT numcgm&#xd;&#xa;		                               , cnpj AS numero&#xd;&#xa;		                               , 2 AS tipo&#xd;&#xa;		                            FROM sw_cgm_pessoa_juridica&#xd;&#xa;		                         &#x29; AS documento_cgm&#xd;&#xa;		                      ON documento_cgm.numcgm &#x3d; pre_empenho.cgm_beneficiario&#xd;&#xa;		               LEFT JOIN tesouraria.pagamento&#xd;&#xa;		                      ON pagamento.exercicio    &#x3d; nlp.exercicio&#xd;&#xa;		                     AND pagamento.cod_nota     &#x3d; nlp.cod_nota&#xd;&#xa;		                     AND pagamento.cod_entidade &#x3d; nlp.cod_entidade&#xd;&#xa;		                     AND pagamento.timestamp    &#x3d; nlp.timestamp&#xd;&#xa;		               LEFT JOIN sw_cgm_pessoa_fisica&#xd;&#xa;		                      ON sw_cgm_pessoa_fisica.numcgm &#x3d; pagamento.cgm_usuario&#xd;&#xa;		                   WHERE nlp.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                                               &#xd;&#xa;		                     AND TO_DATE&#x28;nlp.timestamp&#x3a;&#x3a;varchar, &#x27;YYYY-MM-DD&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;  AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;         &#xd;&#xa;		                GROUP BY tipo_registro&#xd;&#xa;		                       , codreduzidoop&#xd;&#xa;		                       , codunidadesub&#xd;&#xa;		                       , nroop&#xd;&#xa;		                       , dtpagamento&#xd;&#xa;		                       , tipopagamento&#xd;&#xa;		                       , nroempenho&#xd;&#xa;		                       , dtempenho&#xd;&#xa;		                       , nroliquidacao&#xd;&#xa;		                       , dtliquidacao&#xd;&#xa;		                       , codfontrecursos&#xd;&#xa;		                       , tipodocumentocredor&#xd;&#xa;		                       , nrodocumento&#xd;&#xa;		                ORDER BY nroop&#xd;&#xa;			&#x29;,&#xd;&#xa;			ops12 as&#xd;&#xa;			&#x28;&#xd;&#xa;		                  SELECT &#x27;12&#x27; AS tipo_registro&#xd;&#xa;		                       , LPAD&#x28;ordem_pagamento.cod_ordem&#x3a;&#x3a;VARCHAR,7,&#x27;0&#x27;&#x29;&#x7c;&#x7c;ordem_pagamento.exercicio&#x7c;&#x7c;TO_CHAR&#x28;nlp.timestamp,&#x27;HH24MI&#x27;&#x29; AS codreduzidoop &#xd;&#xa;		                       , CASE WHEN plano_conta.cod_estrutural like &#x27;1.1.1.1.1.01&#x25;&#x27;&#xd;&#xa;		                              THEN &#x27;05&#x27;&#xd;&#xa;		                              ELSE CASE WHEN pagamento_tipo_documento.cod_tipo_documento IS NOT NULL&#xd;&#xa;		                                        THEN pagamento_tipo_documento.cod_tipo_documento&#x3a;&#x3a;varchar&#xd;&#xa;		                                        ELSE &#x27;99&#x27;&#xd;&#xa;		                                    END&#xd;&#xa;		                          END AS tipodocumentoop&#xd;&#xa;		                       , CASE WHEN plano_conta.cod_estrutural like &#x27;1.1.1.1.1.01&#x25;&#x27;&#xd;&#xa;		                              THEN &#x27;&#x27;&#xd;&#xa;		                              ELSE CASE WHEN pagamento_tipo_documento.num_documento IS NULL&#xd;&#xa;		                                        THEN &#x27;0000&#x27;&#xd;&#xa;		                                        ELSE pagamento_tipo_documento.num_documento&#xd;&#xa;		                                    END&#xd;&#xa;		                          END AS nrodocumento&#xd;&#xa;		                       , CASE WHEN conta_bancaria.cod_ctb_anterior IS NULL&#xd;&#xa;		                              THEN plano_analitica.cod_plano&#xd;&#xa;		                              ELSE conta_bancaria.cod_ctb_anterior&#xd;&#xa;		                          END AS codctb&#xd;&#xa;		                       , plano_recurso.cod_recurso AS codfontectb&#xd;&#xa;		                       , CASE WHEN plano_conta.cod_estrutural like &#x27;1.1.1.1.1.01&#x25;&#x27;&#xd;&#xa;		                              THEN &#x27; &#x27;&#xd;&#xa;		                              ELSE CASE WHEN pagamento_tipo_documento.cod_tipo_documento &#x3d; 99&#xd;&#xa;		                                        THEN &#x28;SELECT td.descricao FROM tcemg.tipo_documento AS td WHERE td.cod_tipo &#x3d; pagamento_tipo_documento.cod_tipo_documento&#x29;&#xd;&#xa;		                                        WHEN pagamento_tipo_documento.cod_tipo_documento IS NULL&#xd;&#xa;		                                        THEN &#x27;Outros&#x27;&#xd;&#xa;		                                        ELSE &#x27; &#x27;&#xd;&#xa;		                                    END&#xd;&#xa;		                          END AS desc_tipo_documento_op&#xd;&#xa;		                       , TO_CHAR&#x28;plnlp.timestamp,&#x27;ddmmyyyy&#x27;&#x29; AS dtemissao&#xd;&#xa;		                       , SUM&#x28;nlp.vl_pago&#x29; AS vldocumento&#xd;&#xa;		                    FROM empenho.nota_liquidacao_paga AS nlp&#xd;&#xa;		               LEFT JOIN empenho.nota_liquidacao_paga_anulada AS nlpa&#xd;&#xa;		                      ON nlpa.exercicio    &#x3d; nlp.exercicio&#xd;&#xa;		                     AND nlpa.cod_nota     &#x3d; nlp.cod_nota&#xd;&#xa;		                     AND nlpa.cod_entidade &#x3d; nlp.cod_entidade&#xd;&#xa;		                     AND nlpa.timestamp    &#x3d; nlp.timestamp&#xd;&#xa;		               LEFT JOIN empenho.pagamento_liquidacao_nota_liquidacao_paga AS plnlp&#xd;&#xa;		                      ON nlp.cod_entidade &#x3d; plnlp.cod_entidade&#xd;&#xa;		                     AND nlp.cod_nota     &#x3d; plnlp.cod_nota&#xd;&#xa;		                     AND nlp.exercicio    &#x3d; plnlp.exercicio_liquidacao&#xd;&#xa;		                     AND nlp.timestamp    &#x3d; plnlp.timestamp&#xd;&#xa;		               LEFT JOIN empenho.pagamento_liquidacao AS pl&#xd;&#xa;		                      ON pl.cod_entidade         &#x3d; plnlp.cod_entidade&#xd;&#xa;		                     AND pl.cod_nota             &#x3d; plnlp.cod_nota&#xd;&#xa;		                     AND pl.exercicio            &#x3d; plnlp.exercicio&#xd;&#xa;		                     AND pl.exercicio_liquidacao &#x3d; plnlp.exercicio_liquidacao&#xd;&#xa;		                     AND pl.cod_ordem            &#x3d; plnlp.cod_ordem&#xd;&#xa;		               LEFT JOIN empenho.nota_liquidacao AS nl&#xd;&#xa;		                      ON nl.exercicio    &#x3d; pl.exercicio_liquidacao&#xd;&#xa;		                     AND nl.cod_nota     &#x3d; pl.cod_nota&#xd;&#xa;		                     AND nl.cod_entidade &#x3d; pl.cod_entidade&#xd;&#xa;		               LEFT JOIN empenho.empenho&#xd;&#xa;		                      ON empenho.exercicio    &#x3d; nl.exercicio_empenho&#xd;&#xa;		                     AND empenho.cod_entidade &#x3d; nl.cod_entidade&#xd;&#xa;		                     AND empenho.cod_empenho  &#x3d; nl.cod_empenho&#xd;&#xa;		               LEFT JOIN empenho.ordem_pagamento&#xd;&#xa;		                      ON pl.exercicio    &#x3d; ordem_pagamento.exercicio&#xd;&#xa;		                     AND pl.cod_entidade &#x3d; ordem_pagamento.cod_entidade&#xd;&#xa;		                     AND pl.cod_ordem    &#x3d; ordem_pagamento.cod_ordem&#xd;&#xa;		               LEFT JOIN empenho.pre_empenho&#xd;&#xa;		                      ON pre_empenho.exercicio       &#x3d; empenho.exercicio&#xd;&#xa;		                     AND pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;		               LEFT JOIN empenho.restos_pre_empenho&#xd;&#xa;		                      ON pre_empenho.cod_pre_empenho &#x3d; restos_pre_empenho.cod_pre_empenho&#xd;&#xa;		                     AND pre_empenho.exercicio &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;		               LEFT JOIN empenho.nota_liquidacao_conta_pagadora&#xd;&#xa;		                      ON nota_liquidacao_conta_pagadora.exercicio_liquidacao &#x3d; nlp.exercicio&#xd;&#xa;		                     AND nota_liquidacao_conta_pagadora.cod_entidade         &#x3d; nlp.cod_entidade&#xd;&#xa;		                     AND nota_liquidacao_conta_pagadora.cod_nota             &#x3d; nlp.cod_nota&#xd;&#xa;		                     AND nota_liquidacao_conta_pagadora.timestamp            &#x3d; nlp.timestamp&#xd;&#xa;		               LEFT JOIN contabilidade.plano_analitica&#xd;&#xa;		                      ON plano_analitica.cod_plano &#x3d; nota_liquidacao_conta_pagadora.cod_plano&#xd;&#xa;		                     AND plano_analitica.exercicio &#x3d; nota_liquidacao_conta_pagadora.exercicio&#xd;&#xa;		               LEFT JOIN contabilidade.plano_recurso&#xd;&#xa;		                      ON plano_recurso.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;		                     AND plano_recurso.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;		              INNER JOIN contabilidade.plano_conta&#xd;&#xa;		                      ON plano_analitica.cod_conta &#x3d; plano_conta.cod_conta&#xd;&#xa;		                     AND plano_analitica.exercicio &#x3d; plano_conta.exercicio&#xd;&#xa;		               LEFT JOIN tcemg.conta_bancaria&#xd;&#xa;		                      ON conta_bancaria.cod_conta &#x3d; plano_conta.cod_conta&#xd;&#xa;		                     AND conta_bancaria.exercicio &#x3d; plano_conta.exercicio&#xd;&#xa;		               LEFT JOIN tesouraria.pagamento&#xd;&#xa;		                      ON pagamento.exercicio    &#x3d; nlp.exercicio&#xd;&#xa;		                     AND pagamento.cod_nota     &#x3d; nlp.cod_nota&#xd;&#xa;		                     AND pagamento.cod_entidade &#x3d; nlp.cod_entidade&#xd;&#xa;		                     AND pagamento.timestamp    &#x3d; nlp.timestamp&#xd;&#xa;		               LEFT JOIN tcemg.pagamento_tipo_documento&#xd;&#xa;		                      ON pagamento_tipo_documento.exercicio    &#x3d; nlp.exercicio&#xd;&#xa;		                     AND pagamento_tipo_documento.cod_nota     &#x3d; nlp.cod_nota&#xd;&#xa;		                     AND pagamento_tipo_documento.cod_entidade &#x3d; nlp.cod_entidade&#xd;&#xa;		                     AND pagamento_tipo_documento.timestamp    &#x3d; nlp.timestamp&#xd;&#xa;		                   WHERE nlp.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                                                  &#xd;&#xa;		                     AND TO_DATE&#x28;nlp.timestamp&#x3a;&#x3a;varchar, &#x27;YYYY-MM-DD&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;  AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;		                GROUP BY tipo_registro&#xd;&#xa;		                       , codreduzidoop&#xd;&#xa;		                       , tipodocumentoop&#xd;&#xa;		                       , nrodocumento&#xd;&#xa;		                       , codctb&#xd;&#xa;		                       , codfontectb&#xd;&#xa;		                       , desc_tipo_documento_op&#xd;&#xa;		                       , dtemissao&#xd;&#xa;		                ORDER BY codreduzidoop&#xd;&#xa;			&#x29;,&#xd;&#xa;			  ops_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							nroop,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroop&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dtpagamento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vlop&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;especificacaoop&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,512&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cpfresppgto&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 11, &#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from ops10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							nroop,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codreduzidoop&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 5, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroop&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dtpagamento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipopagamento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroempenho&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dtempenho&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroliquidacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dtliquidacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codfontrecursos&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,3,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;valorfonte&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipodocumentocredor&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nrodocumento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;    &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; &#x27;  &#x27;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; &#x27;     &#x27;   &#xd;&#xa;					as d&#xd;&#xa;				from ops11&#xd;&#xa;				union all&#xd;&#xa;						select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							nrodocumento as nroop,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codreduzidoop&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipodocumentoop&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,2,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nrodocumento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codctb&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#x3a;&#x3a;bigint&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codfontectb&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,3,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;desc_tipo_documento_op&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dtemissao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vldocumento&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					as d&#xd;&#xa;				from ops12  &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;OPS.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from ops_format order by nroop, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;RESPLIC.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with resplic10 as&#xd;&#xa;			&#x28;&#xd;&#xa;								SELECT 10 as tipo_registro&#xd;&#xa;					                       , LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;orgao_sicom.valor,2, &#x27;0&#x27;&#x29; as cod_orgao&#xd;&#xa;					                       , LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;licitacao.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;licitacao.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29; AS codunidadesub&#xd;&#xa;					                       , config_licitacao.exercicio_licitacao&#xd;&#xa;					                       , config_licitacao.num_licitacao AS num_processo_licitatorio&#xd;&#xa;					                       , dadosResponsaveis.tipo_responsabilidade&#xd;&#xa;					                       , dadosResponsaveis.cpf&#xd;&#xa;					                    FROM licitacao.licitacao&#xd;&#xa;					              INNER JOIN tcemg.resplic&#xd;&#xa;					                      ON tcemg.resplic.exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;					                     AND tcemg.resplic.cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;					                     AND tcemg.resplic.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;					                     AND tcemg.resplic.cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;					              INNER JOIN &#x28;&#xd;&#xa;					                            SELECT sw_cgm_pessoa_fisica.cpf&#xd;&#xa;					                               , 1 AS tipo_responsabilidade&#xd;&#xa;					                               , resplic.exercicio&#xd;&#xa;					                               , resplic.cod_entidade&#xd;&#xa;					                               , resplic.cod_modalidade&#xd;&#xa;					                               , resplic.cod_licitacao&#xd;&#xa;					                           FROM tcemg.resplic&#xd;&#xa;					                     INNER JOIN sw_cgm_pessoa_fisica&#xd;&#xa;					                             ON sw_cgm_pessoa_fisica.numcgm &#x3d;  resplic.cgm_resp_abertura_licitacao&#xd;&#xa;					                       UNION ALL&#xd;&#xa;					                            SELECT sw_cgm_pessoa_fisica.cpf&#xd;&#xa;					                               , 2 AS tipo_responsabilidade&#xd;&#xa;					                               , resplic.exercicio&#xd;&#xa;					                               , resplic.cod_entidade&#xd;&#xa;					                               , resplic.cod_modalidade&#xd;&#xa;					                               , resplic.cod_licitacao&#xd;&#xa;					                           FROM tcemg.resplic&#xd;&#xa;					                     INNER JOIN sw_cgm_pessoa_fisica&#xd;&#xa;					                             ON sw_cgm_pessoa_fisica.numcgm &#x3d;  resplic.cgm_resp_edital&#xd;&#xa;					                       UNION ALL&#xd;&#xa;					                            SELECT sw_cgm_pessoa_fisica.cpf&#xd;&#xa;					                               , 3 AS tipo_responsabilidade&#xd;&#xa;					                               , resplic.exercicio&#xd;&#xa;					                               , resplic.cod_entidade&#xd;&#xa;					                               , resplic.cod_modalidade&#xd;&#xa;					                               , resplic.cod_licitacao&#xd;&#xa;					                           FROM tcemg.resplic&#xd;&#xa;					                     INNER JOIN sw_cgm_pessoa_fisica&#xd;&#xa;					                             ON sw_cgm_pessoa_fisica.numcgm &#x3d;  resplic.cgm_resp_pesquisa&#xd;&#xa;					                       UNION ALL&#xd;&#xa;					                            SELECT sw_cgm_pessoa_fisica.cpf&#xd;&#xa;					                               , 4 AS tipo_responsabilidade&#xd;&#xa;					                               , resplic.exercicio&#xd;&#xa;					                               , resplic.cod_entidade&#xd;&#xa;					                               , resplic.cod_modalidade&#xd;&#xa;					                               , resplic.cod_licitacao&#xd;&#xa;					                           FROM tcemg.resplic&#xd;&#xa;					                     INNER JOIN sw_cgm_pessoa_fisica&#xd;&#xa;					                             ON sw_cgm_pessoa_fisica.numcgm &#x3d;  resplic.cgm_resp_recurso_orcamentario&#xd;&#xa;					                       UNION ALL&#xd;&#xa;					                            SELECT sw_cgm_pessoa_fisica.cpf&#xd;&#xa;					                               , 5 AS tipo_responsabilidade&#xd;&#xa;					                               , resplic.exercicio&#xd;&#xa;					                               , resplic.cod_entidade&#xd;&#xa;					                               , resplic.cod_modalidade&#xd;&#xa;					                               , resplic.cod_licitacao&#xd;&#xa;					                           FROM tcemg.resplic&#xd;&#xa;					                     INNER JOIN sw_cgm_pessoa_fisica&#xd;&#xa;					                             ON sw_cgm_pessoa_fisica.numcgm &#x3d;  resplic.cgm_resp_conducao_licitacao&#xd;&#xa;					                       UNION ALL&#xd;&#xa;					                            SELECT sw_cgm_pessoa_fisica.cpf&#xd;&#xa;					                               , 6 AS tipo_responsabilidade&#xd;&#xa;					                               , resplic.exercicio&#xd;&#xa;					                               , resplic.cod_entidade&#xd;&#xa;					                               , resplic.cod_modalidade&#xd;&#xa;					                               , resplic.cod_licitacao&#xd;&#xa;					                           FROM tcemg.resplic&#xd;&#xa;					                     INNER JOIN sw_cgm_pessoa_fisica&#xd;&#xa;					                             ON sw_cgm_pessoa_fisica.numcgm &#x3d; resplic.cgm_resp_homologacao&#xd;&#xa;					                        UNION ALL&#xd;&#xa;					                            SELECT sw_cgm_pessoa_fisica.cpf&#xd;&#xa;					                               , 7 AS tipo_responsabilidade&#xd;&#xa;					                               , resplic.exercicio&#xd;&#xa;					                               , resplic.cod_entidade&#xd;&#xa;					                               , resplic.cod_modalidade&#xd;&#xa;					                               , resplic.cod_licitacao&#xd;&#xa;					                           FROM tcemg.resplic&#xd;&#xa;					                     INNER JOIN sw_cgm_pessoa_fisica&#xd;&#xa;					                             ON sw_cgm_pessoa_fisica.numcgm &#x3d;  resplic.cgm_resp_adjudicacao&#xd;&#xa;					                       UNION ALL&#xd;&#xa;					                            SELECT sw_cgm_pessoa_fisica.cpf&#xd;&#xa;					                               , 8 AS tipo_responsabilidade&#xd;&#xa;					                               , resplic.exercicio&#xd;&#xa;					                               , resplic.cod_entidade&#xd;&#xa;					                               , resplic.cod_modalidade&#xd;&#xa;					                               , resplic.cod_licitacao&#xd;&#xa;					                           FROM tcemg.resplic&#xd;&#xa;					                     INNER JOIN sw_cgm_pessoa_fisica&#xd;&#xa;					                             ON sw_cgm_pessoa_fisica.numcgm &#x3d;  resplic.cgm_resp_publicacao&#xd;&#xa;					                       UNION ALL&#xd;&#xa;					                            SELECT sw_cgm_pessoa_fisica.cpf&#xd;&#xa;					                               , 9 AS tipo_responsabilidade&#xd;&#xa;					                               , resplic.exercicio&#xd;&#xa;					                               , resplic.cod_entidade&#xd;&#xa;					                               , resplic.cod_modalidade&#xd;&#xa;					                               , resplic.cod_licitacao&#xd;&#xa;					                           FROM tcemg.resplic&#xd;&#xa;					                     INNER JOIN sw_cgm_pessoa_fisica&#xd;&#xa;					                             ON sw_cgm_pessoa_fisica.numcgm &#x3d;  resplic.cgm_resp_avaliacao_bens&#xd;&#xa;					                        &#x29; AS dadosResponsaveis&#xd;&#xa;							       ON tcemg.resplic.exercicio      &#x3d; dadosResponsaveis.exercicio&#xd;&#xa;					                      AND tcemg.resplic.cod_licitacao  &#x3d; dadosResponsaveis.cod_licitacao&#xd;&#xa;					                      AND tcemg.resplic.cod_modalidade &#x3d; dadosResponsaveis.cod_modalidade&#xd;&#xa;					                      AND tcemg.resplic.cod_entidade   &#x3d; dadosResponsaveis.cod_entidade&#xd;&#xa;					            JOIN compras.mapa_cotacao&#xd;&#xa;					              ON mapa_cotacao.exercicio_mapa &#x3d; licitacao.exercicio&#xd;&#xa;					             AND mapa_cotacao.cod_mapa &#x3d; licitacao.cod_mapa&#xd;&#xa;					            JOIN compras.cotacao&#xd;&#xa;					              ON cotacao.exercicio &#x3d; mapa_cotacao.exercicio_cotacao&#xd;&#xa;					             AND cotacao.cod_cotacao &#x3d; mapa_cotacao.cod_cotacao&#xd;&#xa;					            JOIN compras.julgamento&#xd;&#xa;					              ON julgamento.exercicio &#x3d; cotacao.exercicio&#xd;&#xa;					             AND julgamento.cod_cotacao &#x3d; cotacao.cod_cotacao&#xd;&#xa;					            JOIN licitacao.homologacao&#xd;&#xa;					              ON homologacao.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;					             AND homologacao.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;					             AND homologacao.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;					             AND homologacao.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;					             AND &#x28;&#xd;&#xa;					                     SELECT homologacao_anulada.num_homologacao FROM licitacao.homologacao_anulada&#xd;&#xa;					                     WHERE homologacao_anulada.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;					                     AND homologacao_anulada.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;					                     AND homologacao_anulada.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;					                     AND homologacao_anulada.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;					                     AND homologacao.num_homologacao&#x3d;homologacao_anulada.num_homologacao&#xd;&#xa;					                     AND homologacao.cod_item&#x3d;homologacao_anulada.cod_item&#xd;&#xa;					                     AND homologacao.lote&#x3d;homologacao_anulada.lote&#xd;&#xa;					                 &#x29; IS NULL&#xd;&#xa;					      INNER JOIN &#x28;SELECT valor&#x3a;&#x3a;integer&#xd;&#xa;					                        , configuracao_entidade.exercicio&#xd;&#xa;					                        , configuracao_entidade.cod_entidade&#xd;&#xa;					                    FROM tcemg.orgao&#xd;&#xa;					              INNER JOIN administracao.configuracao_entidade&#xd;&#xa;					                      ON configuracao_entidade.valor&#x3a;&#x3a;integer &#x3d; orgao.num_orgao&#xd;&#xa;					                   WHERE configuracao_entidade.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;  AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;   &#xd;&#xa;					                &#x29;  AS orgao_sicom&#xd;&#xa;					              ON orgao_sicom.exercicio&#x3d;stExercicio                                                   &#xd;&#xa;					             AND orgao_sicom.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;					            JOIN &#x28;&#xd;&#xa;					                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;     &#xd;&#xa;																				VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																				   ,cod_modalidade		INTEGER&#xd;&#xa;																				   ,cod_entidade		INTEGER&#xd;&#xa;																				   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																				   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																				   ,num_licitacao		TEXT &#x29;&#xd;&#xa;					                 &#x29; AS config_licitacao&#xd;&#xa;					              ON config_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;					             AND config_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;					             AND config_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;					             AND config_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;					           WHERE TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;    &#xd;&#xa;					             AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;                          &#xd;&#xa;					             AND licitacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                       &#xd;&#xa;					             AND licitacao.cod_modalidade NOT IN &#x28;8,9&#x29;&#xd;&#xa;					             AND NOT EXISTS&#x28; SELECT 1&#xd;&#xa;					                             FROM licitacao.licitacao_anulada&#xd;&#xa;					                             WHERE licitacao_anulada.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;					                               AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;					                               AND licitacao_anulada.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;					                               AND licitacao_anulada.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;					                         &#x29;&#xd;&#xa;					         AND &#x28; CASE WHEN licitacao.cod_tipo_objeto &#x21;&#x3d; 4 THEN dadosResponsaveis.tipo_responsabilidade &#x21;&#x3d; 9 ELSE TRUE END &#x29;&#xd;&#xa;					        GROUP BY 1,2,3,4,5,6,7&#xd;&#xa;					        ORDER BY num_processo_licitatorio&#xd;&#xa;			&#x29;,&#xd;&#xa;			resplic20 as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 20 as tipo_registro&#xd;&#xa;	                        , LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;orgao_sicom.valor,2, &#x27;0&#x27;&#x29; as cod_orgao&#xd;&#xa;	                        , LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;licitacao.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;licitacao.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29; AS codunidadesub&#xd;&#xa;	                        , config_licitacao.exercicio_licitacao&#xd;&#xa;	                        , config_licitacao.num_licitacao AS num_processo_licitatorio&#xd;&#xa;	                        , CASE WHEN comissao.cod_tipo_comissao &#x3d; 1 THEN 2&#xd;&#xa;	                               WHEN comissao.cod_tipo_comissao &#x3d; 2 THEN 1&#xd;&#xa;	                               WHEN comissao.cod_tipo_comissao &#x3d; 3 THEN 2&#xd;&#xa;	                          END AS cod_tipo_comissao&#xd;&#xa;	                        , CASE WHEN &#x28;norma.cod_tipo_norma &#x3d; 4&#x29; THEN&#xd;&#xa;	                                        1&#xd;&#xa;	                               ELSE&#xd;&#xa;	                                        2&#xd;&#xa;	                          END AS cod_tipo_norma&#xd;&#xa;	                        , norma.num_norma&#xd;&#xa;	                        , to_char&#x28;norma.dt_assinatura,&#x27;ddmmyyyy&#x27;&#x29; as dt_nomeacao&#xd;&#xa;	                        , to_char&#x28;norma.dt_publicacao,&#x27;ddmmyyyy&#x27;&#x29; as ini_vigencia&#xd;&#xa;	                        , to_char&#x28;norma_data_termino.dt_termino,&#x27;ddmmyyyy&#x27;&#x29; as fim_vigencia&#xd;&#xa;	                        , tipo_membro.cpf as cpf_membro&#xd;&#xa;	                        , tipo_membro.cod_tipo_membro as cod_atribuicao&#xd;&#xa;	                        , CASE WHEN &#x28;comissao_membros.numcgm &#x3d; tipo_membro.numcgm&#x29; THEN&#xd;&#xa;	                                        comissao_membros.cargo&#xd;&#xa;	                               WHEN &#x28;membro_adicional.numcgm &#x3d; tipo_membro.numcgm&#x29; THEN&#xd;&#xa;	                                        membro_adicional.cargo&#xd;&#xa;	                          END AS cargo&#xd;&#xa;	                        , CASE WHEN &#x28;comissao_membros.numcgm &#x3d; tipo_membro.numcgm&#x29; THEN&#xd;&#xa;	                                        comissao_membros.natureza_cargo&#xd;&#xa;	                               WHEN &#x28;membro_adicional.numcgm &#x3d; tipo_membro.numcgm&#x29; THEN&#xd;&#xa;	                                        membro_adicional.natureza_cargo&#xd;&#xa;	                          END AS natureza_cargo&#xd;&#xa;	                    FROM licitacao.licitacao&#xd;&#xa;			    JOIN licitacao.comissao_licitacao&#xd;&#xa;	                      ON comissao_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;	                     AND comissao_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;	                     AND comissao_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;	                     AND comissao_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			    JOIN licitacao.comissao&#xd;&#xa;	                      ON comissao.cod_comissao &#x3d; comissao_licitacao.cod_comissao&#xd;&#xa;	                     AND &#x28; comissao.cod_tipo_comissao &#x3d; 1&#xd;&#xa;	                           OR comissao.cod_tipo_comissao &#x3d; 2&#xd;&#xa;	                           OR comissao.cod_tipo_comissao &#x3d; 3 &#x29;&#xd;&#xa;	                    JOIN normas.norma&#xd;&#xa;	                      ON norma.cod_norma &#x3d; comissao.cod_norma&#xd;&#xa;	                     AND &#x28; norma.cod_tipo_norma &#x3d; 2&#xd;&#xa;	                           OR norma.cod_tipo_norma &#x3d; 4 &#x29;&#xd;&#xa;		            JOIN normas.norma_data_termino&#xd;&#xa;		              ON norma_data_termino.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;			    JOIN licitacao.comissao_membros&#xd;&#xa;		              ON comissao_licitacao.cod_comissao &#x3d; comissao_membros.cod_comissao&#xd;&#xa;		       LEFT JOIN licitacao.membro_adicional&#xd;&#xa;	                      ON membro_adicional.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;	                     AND membro_adicional.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;	                     AND membro_adicional.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;	                     AND membro_adicional.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			    JOIN &#x28;SELECT  pf.numcgm&#xd;&#xa;					, pf.CPF&#xd;&#xa;					, CASE  WHEN &#x28;membro_adicional.numcgm &#x3d; pf.numcgm&#x29; THEN 2&#xd;&#xa;			           		WHEN &#x28;comissao_membros.cod_tipo_membro &#x3d; 1&#x29; THEN 2&#xd;&#xa;						WHEN &#x28;comissao_membros.cod_tipo_membro &#x3d; 2&#x29; THEN 3&#xd;&#xa;						WHEN &#x28;comissao_membros.cod_tipo_membro &#x3d; 3&#x29; THEN 6&#xd;&#xa;					  END AS cod_tipo_membro&#xd;&#xa;			  	    FROM licitacao.licitacao&#xd;&#xa;			  	    JOIN licitacao.comissao_licitacao &#xd;&#xa;			  	      ON comissao_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			  	     AND comissao_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			  	     AND comissao_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			  	     AND comissao_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			  	    JOIN licitacao.comissao_membros&#xd;&#xa;			  	      ON comissao_licitacao.cod_comissao &#x3d; comissao_membros.cod_comissao&#xd;&#xa;			       LEFT JOIN licitacao.membro_adicional&#xd;&#xa;			  	      ON membro_adicional.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			  	     AND membro_adicional.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			  	     AND membro_adicional.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			  	     AND membro_adicional.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			       LEFT JOIN sw_cgm_pessoa_fisica as pf&#xd;&#xa;			  	      ON pf.numcgm &#x3d; comissao_membros.numcgm&#xd;&#xa;			  	      OR pf.numcgm &#x3d; membro_adicional.numcgm&#xd;&#xa;			        GROUP BY 1,2,3&#xd;&#xa;	                        &#x29; AS tipo_membro&#xd;&#xa;			      ON comissao_membros.numcgm &#x3d; tipo_membro.numcgm&#xd;&#xa;			      OR membro_adicional.numcgm &#x3d; tipo_membro.numcgm&#xd;&#xa;	                    JOIN compras.mapa_cotacao&#xd;&#xa;	                      ON mapa_cotacao.exercicio_mapa &#x3d; licitacao.exercicio&#xd;&#xa;	                     AND mapa_cotacao.cod_mapa &#x3d; licitacao.cod_mapa&#xd;&#xa;	                    JOIN compras.cotacao&#xd;&#xa;	                      ON cotacao.exercicio &#x3d; mapa_cotacao.exercicio_cotacao&#xd;&#xa;	                     AND cotacao.cod_cotacao &#x3d; mapa_cotacao.cod_cotacao&#xd;&#xa;	                    JOIN compras.julgamento&#xd;&#xa;	                      ON julgamento.exercicio &#x3d; cotacao.exercicio&#xd;&#xa;	                     AND julgamento.cod_cotacao &#x3d; cotacao.cod_cotacao&#xd;&#xa;	                    JOIN licitacao.homologacao&#xd;&#xa;	                      ON homologacao.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;	                     AND homologacao.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;	                     AND homologacao.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;	                     AND homologacao.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;	                     AND &#x28;&#xd;&#xa;	                             SELECT homologacao_anulada.num_homologacao FROM licitacao.homologacao_anulada&#xd;&#xa;	                             WHERE homologacao_anulada.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;	                             AND homologacao_anulada.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;	                             AND homologacao_anulada.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;	                             AND homologacao_anulada.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;	                             AND homologacao.num_homologacao&#x3d;homologacao_anulada.num_homologacao&#xd;&#xa;	                             AND homologacao.cod_item&#x3d;homologacao_anulada.cod_item&#xd;&#xa;	                             AND homologacao.lote&#x3d;homologacao_anulada.lote&#xd;&#xa;	                         &#x29; IS NULL&#xd;&#xa;	                    JOIN &#x28;  SELECT valor&#x3a;&#x3a;integer&#xd;&#xa;	                                 , configuracao_entidade.exercicio&#xd;&#xa;	                                 , configuracao_entidade.cod_entidade&#xd;&#xa;	                              FROM tcemg.orgao&#xd;&#xa;	                        INNER JOIN administracao.configuracao_entidade&#xd;&#xa;	                                ON configuracao_entidade.valor&#x3a;&#x3a;integer &#x3d; orgao.num_orgao&#xd;&#xa;	                             WHERE configuracao_entidade.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29; AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;     &#xd;&#xa;	                        &#x29;  AS orgao_sicom&#xd;&#xa;	                      ON orgao_sicom.exercicio&#x3d; stExercicio                                               &#xd;&#xa;	                     AND orgao_sicom.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;	            JOIN &#x28;&#xd;&#xa;	                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;          &#xd;&#xa;																VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																   ,cod_modalidade		INTEGER&#xd;&#xa;																   ,cod_entidade		INTEGER&#xd;&#xa;																   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																   ,num_licitacao		TEXT &#x29;&#xd;&#xa;	                 &#x29; AS config_licitacao&#xd;&#xa;	              ON config_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;	             AND config_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;	             AND config_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;	             AND config_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;	                   WHERE TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;             &#xd;&#xa;	                     AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;                                   &#xd;&#xa;	                     AND licitacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                                &#xd;&#xa;	                     AND licitacao.cod_modalidade NOT IN &#x28;8,9&#x29;&#xd;&#xa;	                     AND NOT EXISTS&#x28; SELECT 1&#xd;&#xa;	                                     FROM licitacao.licitacao_anulada&#xd;&#xa;	                                     WHERE licitacao_anulada.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;	                                         AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;	                                         AND licitacao_anulada.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;	                                         AND licitacao_anulada.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;	                                 &#x29;&#xd;&#xa;	                    AND NOT EXISTS&#x28; SELECT 1&#xd;&#xa;	                                     FROM licitacao.membro_excluido&#xd;&#xa;	                                     WHERE membro_excluido.numcgm &#x3d; tipo_membro.numcgm&#xd;&#xa;	                                 &#x29;&#xd;&#xa;	                  GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15&#xd;&#xa;	                  ORDER BY num_processo_licitatorio&#xd;&#xa;			&#x29;,&#xd;&#xa;			  resplic_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							num_processo_licitatorio,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo_licitatorio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_responsabilidade&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cpf&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 11, &#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from resplic10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							num_processo_licitatorio,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesub&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 5, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo_licitatorio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_tipo_comissao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_tipo_norma&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_norma&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_nomeacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;ini_vigencia&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;fim_vigencia&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cpf_membro&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 11, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_atribuicao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;cargo&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;natureza_cargo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from resplic20&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;RESPLIC.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from resplic_format order by num_processo_licitatorio, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;HABLIC.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with hablic10 as&#xd;&#xa;			&#x28;&#xd;&#xa;						 SELECT 10 AS tipo_registro&#xd;&#xa;			                   , LPAD&#x28;orgao.valor&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;			                   , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade&#xd;&#xa;			                   , &#x28; SELECT exercicio_licitacao&#xd;&#xa;			                         FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;  &#xd;&#xa;			                                                           VALUES &#x28;cod_licitacao       INTEGER&#xd;&#xa;			                                                                  ,cod_modalidade      INTEGER&#xd;&#xa;			                                                                  ,cod_entidade        INTEGER&#xd;&#xa;			                                                                  ,exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;			                                                                  ,exercicio_licitacao VARCHAR&#xd;&#xa;			                                                                  ,num_licitacao       TEXT &#x29;&#xd;&#xa;			                        WHERE cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			                          AND cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                          AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                          AND exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			                     &#x29; AS exercicio_licitacao&#xd;&#xa;			                   , &#x28; SELECT num_licitacao&#xd;&#xa;			                         FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;    &#xd;&#xa;			                                                           VALUES &#x28;cod_licitacao       INTEGER&#xd;&#xa;			                                                                  ,cod_modalidade      INTEGER&#xd;&#xa;			                                                                  ,cod_entidade        INTEGER&#xd;&#xa;			                                                                  ,exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;			                                                                  ,exercicio_licitacao VARCHAR&#xd;&#xa;			                                                                  ,num_licitacao       TEXT &#x29;&#xd;&#xa;			                        WHERE cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			                          AND cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                          AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                          AND exercicio &#x3d; licitacao.exercicio&#xd;&#xa;			                     &#x29; AS num_processo_licitatorio&#xd;&#xa;			                   , documento_cgm.tipo AS tipo_documento&#xd;&#xa;			                   , documento_cgm.numero AS nro_documento&#xd;&#xa;			                   , sw_cgm_pessoa_juridica.objeto_social AS objeto_social&#xd;&#xa;			                   , CASE WHEN documento_cgm.tipo &#x3d; 2&#xd;&#xa;			                          THEN sw_cgm_pessoa_juridica.cod_orgao_registro&#x3a;&#x3a;VARCHAR&#xd;&#xa;			                          ELSE &#x27;&#x27;&#xd;&#xa;			                      END AS orgao_resp_registro&#xd;&#xa;			                   , CASE WHEN documento_cgm.tipo &#x3d; 2&#xd;&#xa;			                          THEN sw_cgm_pessoa_juridica.num_registro&#x3a;&#x3a;VARCHAR&#xd;&#xa;			                          ELSE &#x27;&#x27;&#xd;&#xa;			                      END AS nro_registro&#xd;&#xa;			                   , TO_CHAR&#x28;sw_cgm_pessoa_juridica.dt_registro,&#x27;ddmmyyyy&#x27;&#x29; AS dt_registro&#xd;&#xa;			                   , TO_CHAR&#x28;sw_cgm_pessoa_juridica.dt_registro_cvm, &#x27;ddmmyyyy&#x27;&#x29; AS dt_registro_cvm&#xd;&#xa;			                   , sw_cgm_pessoa_juridica.num_registro_cvm&#xd;&#xa;			                   , sw_cgm_pessoa_juridica.insc_estadual AS num_inscricao_estadual&#xd;&#xa;			                   , sw_uf.sigla_uf AS uf_inscricao_estadual&#xd;&#xa;			                   , &#x28;&#xd;&#xa;			                      SELECT num_documento&#xd;&#xa;			                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;			                       WHERE l_cd.cod_documento &#x3d; 5&#xd;&#xa;			                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;			                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;			                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;			                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;			                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;			                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;			                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;			                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;			                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;			                                              &#x29;&#xd;&#xa;			                     &#x29; AS num_certidao_regularidade_inss&#xd;&#xa;			                   , &#x28;&#xd;&#xa;			                      SELECT dt_emissao&#xd;&#xa;			                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;			                       WHERE l_cd.cod_documento &#x3d; 5&#xd;&#xa;			                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;			                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;			                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;			                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;			                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;			                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;			                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;			                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;			                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;			                                              &#x29;&#xd;&#xa;			                     &#x29; AS dt_emissao_certidao_regularidade_inss&#xd;&#xa;			                   , &#x28;&#xd;&#xa;			                      SELECT dt_validade&#xd;&#xa;			                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;			                       WHERE l_cd.cod_documento &#x3d; 5&#xd;&#xa;			                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;			                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;			                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;			                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;			                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;			                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;			                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;			                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;			                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;			                                              &#x29;&#xd;&#xa;			                     &#x29; AS dt_validade_certidao_regularidade_inss&#xd;&#xa;			                   , &#x28;&#xd;&#xa;			                      SELECT num_documento&#xd;&#xa;			                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;			                       WHERE l_cd.cod_documento &#x3d; 6&#xd;&#xa;			                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;			                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;			                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;			                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;			                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;			                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;			                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;			                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;			                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;			                                              &#x29;&#xd;&#xa;			                     &#x29; AS num_certidao_regularidade_fgts&#xd;&#xa;			                   , &#x28;&#xd;&#xa;			                      SELECT dt_emissao&#xd;&#xa;			                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;			                       WHERE l_cd.cod_documento &#x3d; 6&#xd;&#xa;			                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;			                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;			                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;			                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;			                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;			                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;			                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;			                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;			                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;			                                              &#x29;&#xd;&#xa;			                     &#x29; AS dt_emissao_certidao_regularidade_fgts&#xd;&#xa;			                   , &#x28;&#xd;&#xa;			                      SELECT dt_validade&#xd;&#xa;			                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;			                       WHERE l_cd.cod_documento &#x3d; 6&#xd;&#xa;			                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;			                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;			                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;			                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;			                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;			                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;			                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;			                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;			                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;			                                              &#x29;&#xd;&#xa;			                     &#x29; AS dt_validade_certidao_regularidade_fgts&#xd;&#xa;			                   , &#x28;&#xd;&#xa;			                      SELECT num_documento&#xd;&#xa;			                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;			                       WHERE l_cd.cod_documento &#x3d; 7&#xd;&#xa;			                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;			                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;			                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;			                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;			                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;			                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;			                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;			                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;			                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;			                                              &#x29;&#xd;&#xa;			                     &#x29; AS num_cndt&#xd;&#xa;			                   , &#x28;&#xd;&#xa;			                      SELECT dt_emissao&#xd;&#xa;			                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;			                       WHERE l_cd.cod_documento &#x3d; 7&#xd;&#xa;			                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;			                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;			                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;			                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;			                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;			                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;			                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;			                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;			                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;			                                              &#x29;&#xd;&#xa;			                     &#x29; AS dt_emissao_cndt&#xd;&#xa;			                   , &#x28;&#xd;&#xa;			                      SELECT dt_validade&#xd;&#xa;			                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;			                       WHERE l_cd.cod_documento &#x3d; 7&#xd;&#xa;			                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;			                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;			                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;			                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;			                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;			                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;			                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;			                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;			                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;			                                              &#x29;&#xd;&#xa;			                     &#x29; AS dt_validade_cndt&#xd;&#xa;			                   &#xd;&#xa;			                   , TO_CHAR&#x28;licitacao.timestamp,&#x27;ddmmyyyy&#x27;&#x29; AS dt_habilitacao&#xd;&#xa;			                   , CASE WHEN participante.cgm_fornecedor&#x3a;&#x3a;VARCHAR &#x3c;&#x3e; &#x27;&#x27;&#xd;&#xa;			                          THEN 1&#xd;&#xa;			                          ELSE 2&#xd;&#xa;			                      END AS presenca_licitantes&#xd;&#xa;			                   , CASE WHEN participante.renuncia_recurso &#x3d; &#x27;t&#x27;&#xd;&#xa;			                          THEN 1&#xd;&#xa;			                          ELSE 2&#xd;&#xa;			                      END AS renuncia_recurso&#xd;&#xa;			                FROM licitacao.licitacao&#xd;&#xa;			           LEFT JOIN licitacao.licitacao_anulada&#xd;&#xa;			                  ON licitacao_anulada.cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                 AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                 AND licitacao_anulada.cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;			                 AND licitacao_anulada.exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;			          INNER JOIN licitacao.cotacao_licitacao&#xd;&#xa;			                  ON cotacao_licitacao.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                 AND cotacao_licitacao.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                 AND cotacao_licitacao.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;			                 AND cotacao_licitacao.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;			          INNER JOIN licitacao.adjudicacao&#xd;&#xa;			                  ON adjudicacao.cod_licitacao       &#x3d; cotacao_licitacao.cod_licitacao&#xd;&#xa;			                 AND adjudicacao.cod_modalidade      &#x3d; cotacao_licitacao.cod_modalidade&#xd;&#xa;			                 AND adjudicacao.cod_entidade        &#x3d; cotacao_licitacao.cod_entidade&#xd;&#xa;			                 AND adjudicacao.exercicio_licitacao &#x3d; cotacao_licitacao.exercicio_licitacao&#xd;&#xa;			                 AND adjudicacao.lote                &#x3d; cotacao_licitacao.lote&#xd;&#xa;			                 AND adjudicacao.cod_cotacao         &#x3d; cotacao_licitacao.cod_cotacao&#xd;&#xa;			                 AND adjudicacao.cod_item            &#x3d; cotacao_licitacao.cod_item&#xd;&#xa;			                 AND adjudicacao.exercicio_cotacao   &#x3d; cotacao_licitacao.exercicio_cotacao&#xd;&#xa;			                 AND adjudicacao.cgm_fornecedor      &#x3d; cotacao_licitacao.cgm_fornecedor&#xd;&#xa;			          INNER JOIN licitacao.homologacao&#xd;&#xa;			                  ON homologacao.num_adjudicacao     &#x3d; adjudicacao.num_adjudicacao&#xd;&#xa;			                 AND homologacao.cod_entidade        &#x3d; adjudicacao.cod_entidade&#xd;&#xa;			                 AND homologacao.cod_modalidade      &#x3d; adjudicacao.cod_modalidade&#xd;&#xa;			                 AND homologacao.cod_licitacao       &#x3d; adjudicacao.cod_licitacao&#xd;&#xa;			                 AND homologacao.exercicio_licitacao &#x3d; adjudicacao.exercicio_licitacao&#xd;&#xa;			                 AND homologacao.cod_item            &#x3d; adjudicacao.cod_item&#xd;&#xa;			                 AND homologacao.cod_cotacao         &#x3d; adjudicacao.cod_cotacao&#xd;&#xa;			                 AND homologacao.lote                &#x3d; adjudicacao.lote&#xd;&#xa;			                 AND homologacao.exercicio_cotacao   &#x3d; adjudicacao.exercicio_cotacao&#xd;&#xa;			                 AND homologacao.cgm_fornecedor      &#x3d; adjudicacao.cgm_fornecedor&#xd;&#xa;			           LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;			                  ON homologacao_anulada.num_homologacao     &#x3d; homologacao.num_homologacao&#xd;&#xa;			                 AND homologacao_anulada.cod_licitacao       &#x3d; homologacao.cod_licitacao&#xd;&#xa;			                 AND homologacao_anulada.cod_modalidade      &#x3d; homologacao.cod_modalidade&#xd;&#xa;			                 AND homologacao_anulada.cod_entidade        &#x3d; homologacao.cod_entidade&#xd;&#xa;			                 AND homologacao_anulada.num_adjudicacao     &#x3d; homologacao.num_adjudicacao&#xd;&#xa;			                 AND homologacao_anulada.exercicio_licitacao &#x3d; homologacao.exercicio_licitacao&#xd;&#xa;			                 AND homologacao_anulada.lote                &#x3d; homologacao.lote&#xd;&#xa;			                 AND homologacao_anulada.cod_cotacao         &#x3d; homologacao.cod_cotacao&#xd;&#xa;			                 AND homologacao_anulada.cod_item            &#x3d; homologacao.cod_item&#xd;&#xa;			                 AND homologacao_anulada.exercicio_cotacao   &#x3d; homologacao.exercicio_cotacao&#xd;&#xa;			                 AND homologacao_anulada.cgm_fornecedor      &#x3d; homologacao.cgm_fornecedor&#xd;&#xa;			           LEFT JOIN &#x28;&#xd;&#xa;			                      SELECT cotacao_licitacao.cod_licitacao&#xd;&#xa;			                           , cotacao_licitacao.cod_modalidade&#xd;&#xa;			                           , cotacao_licitacao.cod_entidade&#xd;&#xa;			                           , cotacao_licitacao.exercicio_licitacao&#xd;&#xa;			                           , cotacao_licitacao.cgm_fornecedor&#xd;&#xa;			                           , participante_certificacao.num_certificacao&#xd;&#xa;			                           , participante_certificacao.exercicio&#xd;&#xa;			                           , participante_certificacao.dt_registro&#xd;&#xa;			                        FROM licitacao.cotacao_licitacao&#xd;&#xa;			                  INNER JOIN compras.cotacao_fornecedor_item&#xd;&#xa;			                          ON cotacao_licitacao.exercicio_cotacao &#x3d; cotacao_fornecedor_item.exercicio&#xd;&#xa;			                         AND cotacao_licitacao.cod_cotacao       &#x3d; cotacao_fornecedor_item.cod_cotacao&#xd;&#xa;			                         AND cotacao_licitacao.cod_item          &#x3d; cotacao_fornecedor_item.cod_item&#xd;&#xa;			                         AND cotacao_licitacao.cgm_fornecedor    &#x3d; cotacao_fornecedor_item.cgm_fornecedor&#xd;&#xa;			                         AND cotacao_licitacao.lote              &#x3d; cotacao_fornecedor_item.lote&#xd;&#xa;			                  INNER JOIN compras.julgamento_item&#xd;&#xa;			                          ON julgamento_item.exercicio      &#x3d; cotacao_fornecedor_item.exercicio&#xd;&#xa;			                         AND julgamento_item.cod_cotacao    &#x3d; cotacao_fornecedor_item.cod_cotacao&#xd;&#xa;			                         AND julgamento_item.cod_item       &#x3d; cotacao_fornecedor_item.cod_item&#xd;&#xa;			                         AND julgamento_item.cgm_fornecedor &#x3d; cotacao_fornecedor_item.cgm_fornecedor&#xd;&#xa;			                         AND julgamento_item.lote           &#x3d; cotacao_fornecedor_item.lote&#xd;&#xa;			                         AND julgamento_item.ordem          &#x3d; 1&#xd;&#xa;			                   LEFT JOIN licitacao.participante_certificacao_licitacao&#xd;&#xa;			                          ON participante_certificacao_licitacao.cod_licitacao       &#x3d; cotacao_licitacao.cod_licitacao&#xd;&#xa;			                         AND participante_certificacao_licitacao.cod_modalidade      &#x3d; cotacao_licitacao.cod_modalidade&#xd;&#xa;			                         AND participante_certificacao_licitacao.cod_entidade        &#x3d; cotacao_licitacao.cod_entidade&#xd;&#xa;			                         AND participante_certificacao_licitacao.exercicio_licitacao &#x3d; cotacao_licitacao.exercicio_licitacao&#xd;&#xa;			                         AND participante_certificacao_licitacao.cgm_fornecedor      &#x3d; cotacao_licitacao.cgm_fornecedor&#xd;&#xa;			                   LEFT JOIN licitacao.participante_certificacao&#xd;&#xa;			                          ON participante_certificacao.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;			                         AND participante_certificacao.exercicio        &#x3d; participante_certificacao_licitacao.exercicio_certificacao&#xd;&#xa;			                         AND participante_certificacao.cgm_fornecedor   &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;			                       WHERE cotacao_licitacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;			                         AND cotacao_licitacao.exercicio_licitacao &#x3d; stExercicio                                                 &#xd;&#xa;			                    GROUP BY cotacao_licitacao.cod_licitacao&#xd;&#xa;			                           , cotacao_licitacao.cod_modalidade&#xd;&#xa;			                           , cotacao_licitacao.cod_entidade&#xd;&#xa;			                           , cotacao_licitacao.exercicio_licitacao&#xd;&#xa;			                           , cotacao_licitacao.cgm_fornecedor&#xd;&#xa;			                           , participante_certificacao.num_certificacao&#xd;&#xa;			                           , participante_certificacao.exercicio&#xd;&#xa;			                           , participante_certificacao.dt_registro&#xd;&#xa;			                     &#x29; AS participante_certificacao_licitacao&#xd;&#xa;			                  ON participante_certificacao_licitacao.cod_licitacao       &#x3d; cotacao_licitacao.cod_licitacao&#xd;&#xa;			                 AND participante_certificacao_licitacao.cod_modalidade      &#x3d; cotacao_licitacao.cod_modalidade&#xd;&#xa;			                 AND participante_certificacao_licitacao.cod_entidade        &#x3d; cotacao_licitacao.cod_entidade&#xd;&#xa;			                 AND participante_certificacao_licitacao.exercicio_licitacao &#x3d; cotacao_licitacao.exercicio_licitacao&#xd;&#xa;			                 AND participante_certificacao_licitacao.cgm_fornecedor      &#x3d; cotacao_licitacao.cgm_fornecedor&#xd;&#xa;			          INNER JOIN sw_cgm&#xd;&#xa;			                  ON sw_cgm.numcgm &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;			          INNER JOIN sw_uf&#xd;&#xa;			                  ON sw_cgm.cod_uf &#x3d; sw_uf.cod_uf&#xd;&#xa;			           LEFT JOIN licitacao.participante&#xd;&#xa;			                  ON participante.cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                 AND participante.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                 AND participante.cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;			                 AND participante.exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;			                 AND participante.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;			          INNER JOIN &#x28;&#xd;&#xa;			                      SELECT numcgm&#xd;&#xa;			                           , cpf AS numero&#xd;&#xa;			                           , 1 AS tipo&#xd;&#xa;			                        FROM sw_cgm_pessoa_fisica&#xd;&#xa;			                       UNION&#xd;&#xa;			                      SELECT numcgm&#xd;&#xa;			                           , cnpj AS numero&#xd;&#xa;			                           , 2 AS tipo&#xd;&#xa;			                        FROM sw_cgm_pessoa_juridica&#xd;&#xa;			                     &#x29; AS documento_cgm&#xd;&#xa;			                  ON documento_cgm.numcgm &#x3d; sw_cgm.numcgm&#xd;&#xa;			           LEFT JOIN sw_cgm_pessoa_juridica&#xd;&#xa;			                  ON sw_cgm_pessoa_juridica.numcgm &#x3d; documento_cgm.numcgm&#xd;&#xa;			          INNER JOIN &#x28;&#xd;&#xa;			                      SELECT &#x2a;&#xd;&#xa;			                        FROM administracao.configuracao_entidade&#xd;&#xa;			                       WHERE configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;			                         AND configuracao_entidade.exercicio &#x3d; stExercicio                                      &#xd;&#xa;			                         AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			                     &#x29; AS orgao&#xd;&#xa;			                  ON orgao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			                 AND orgao.exercicio    &#x3d; licitacao.exercicio&#xd;&#xa;			               WHERE licitacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                      &#xd;&#xa;			                 AND TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;			                                                                                            AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;       &#xd;&#xa;			                 AND licitacao.cod_modalidade NOT IN &#x28;8,9,10&#x29;&#xd;&#xa;			                 AND licitacao_anulada.cod_licitacao IS NULL&#xd;&#xa;			                 AND homologacao_anulada.num_homologacao IS NULL&#xd;&#xa;			             GROUP BY tipo_registro&#xd;&#xa;			                   , cod_orgao&#xd;&#xa;			                   , cod_unidade&#xd;&#xa;			                   , tipo_documento&#xd;&#xa;			                   , nro_documento&#xd;&#xa;			                   , objeto_social&#xd;&#xa;			                   , orgao_resp_registro&#xd;&#xa;			                   , nro_registro&#xd;&#xa;			                   , sw_cgm_pessoa_juridica.dt_registro&#xd;&#xa;			                   , dt_registro_cvm&#xd;&#xa;			                   , sw_cgm_pessoa_juridica.num_registro_cvm&#xd;&#xa;			                   , num_inscricao_estadual&#xd;&#xa;			                   , uf_inscricao_estadual&#xd;&#xa;			                   , num_certidao_regularidade_inss&#xd;&#xa;			                   , dt_emissao_certidao_regularidade_inss&#xd;&#xa;			                   , dt_validade_certidao_regularidade_inss&#xd;&#xa;			                   , num_certidao_regularidade_fgts&#xd;&#xa;			                   , dt_emissao_certidao_regularidade_fgts&#xd;&#xa;			                   , dt_validade_certidao_regularidade_fgts&#xd;&#xa;			                   , num_cndt&#xd;&#xa;			                   , dt_emissao_cndt&#xd;&#xa;			                   , dt_validade_cndt&#xd;&#xa;			                   , dt_habilitacao&#xd;&#xa;			                   , presenca_licitantes&#xd;&#xa;			                   , renuncia_recurso&#xd;&#xa;			                   , licitacao.cod_entidade&#xd;&#xa;			                   , licitacao.cod_licitacao&#xd;&#xa;			                   , licitacao.cod_modalidade&#xd;&#xa;			                   , licitacao.exercicio&#xd;&#xa;			            ORDER BY licitacao.cod_entidade&#xd;&#xa;			                   , licitacao.cod_licitacao&#xd;&#xa;			                   , licitacao.cod_modalidade&#xd;&#xa;			                   , licitacao.exercicio&#xd;&#xa;			                   , num_processo_licitatorio&#xd;&#xa;			&#x29;,&#xd;&#xa;			 hablic11 as&#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT&#xd;&#xa;		                    11 AS tipo_registro&#xd;&#xa;		                  , LPAD&#x28;orgao.valor,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;		                  , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade&#xd;&#xa;		                  , &#x28; SELECT exercicio_licitacao&#xd;&#xa;		                         FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;    &#xd;&#xa;		                                                           VALUES &#x28;cod_licitacao       INTEGER&#xd;&#xa;		                                                                  ,cod_modalidade      INTEGER&#xd;&#xa;		                                                                  ,cod_entidade        INTEGER&#xd;&#xa;		                                                                  ,exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;		                                                                  ,exercicio_licitacao VARCHAR&#xd;&#xa;		                                                                  ,num_licitacao       TEXT &#x29;&#xd;&#xa;		                        WHERE cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;		                          AND cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                          AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                          AND exercicio &#x3d; licitacao.exercicio&#xd;&#xa;		                     &#x29; AS exercicio_licitacao&#xd;&#xa;		                   , &#x28; SELECT num_licitacao&#xd;&#xa;		                         FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;    &#xd;&#xa;		                                                           VALUES &#x28;cod_licitacao       INTEGER&#xd;&#xa;		                                                                  ,cod_modalidade      INTEGER&#xd;&#xa;		                                                                  ,cod_entidade        INTEGER&#xd;&#xa;		                                                                  ,exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;		                                                                  ,exercicio_licitacao VARCHAR&#xd;&#xa;		                                                                  ,num_licitacao       TEXT &#x29;&#xd;&#xa;		                        WHERE cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;		                          AND cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                          AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                          AND exercicio &#x3d; licitacao.exercicio&#xd;&#xa;		                     &#x29; AS num_processo_licitatorio&#xd;&#xa;		                   , documento_cgm_participante.tipo AS tipo_documento&#xd;&#xa;		                   , documento_cgm_participante.numero AS cnpj_empresa_hablic&#xd;&#xa;		                   , documento_socio.tipo_documento_socio&#xd;&#xa;		                   , documento_socio.num_documento_socio&#xd;&#xa;		                  , fornecedor_socio.cod_tipo AS tipo_participacao&#xd;&#xa;		             FROM licitacao.licitacao&#xd;&#xa;		           LEFT JOIN licitacao.licitacao_anulada&#xd;&#xa;		                  ON licitacao_anulada.cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                 AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                 AND licitacao_anulada.cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;		                 AND licitacao_anulada.exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;		          INNER JOIN licitacao.cotacao_licitacao&#xd;&#xa;		                  ON cotacao_licitacao.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                 AND cotacao_licitacao.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                 AND cotacao_licitacao.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;		                 AND cotacao_licitacao.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;		          INNER JOIN licitacao.adjudicacao&#xd;&#xa;		                  ON adjudicacao.cod_licitacao       &#x3d; cotacao_licitacao.cod_licitacao&#xd;&#xa;		                 AND adjudicacao.cod_modalidade      &#x3d; cotacao_licitacao.cod_modalidade&#xd;&#xa;		                 AND adjudicacao.cod_entidade        &#x3d; cotacao_licitacao.cod_entidade&#xd;&#xa;		                 AND adjudicacao.exercicio_licitacao &#x3d; cotacao_licitacao.exercicio_licitacao&#xd;&#xa;		                 AND adjudicacao.lote                &#x3d; cotacao_licitacao.lote&#xd;&#xa;		                 AND adjudicacao.cod_cotacao         &#x3d; cotacao_licitacao.cod_cotacao&#xd;&#xa;		                 AND adjudicacao.cod_item            &#x3d; cotacao_licitacao.cod_item&#xd;&#xa;		                 AND adjudicacao.exercicio_cotacao   &#x3d; cotacao_licitacao.exercicio_cotacao&#xd;&#xa;		                 AND adjudicacao.cgm_fornecedor      &#x3d; cotacao_licitacao.cgm_fornecedor&#xd;&#xa;		          INNER JOIN licitacao.homologacao&#xd;&#xa;		                  ON homologacao.num_adjudicacao     &#x3d; adjudicacao.num_adjudicacao&#xd;&#xa;		                 AND homologacao.cod_entidade        &#x3d; adjudicacao.cod_entidade&#xd;&#xa;		                 AND homologacao.cod_modalidade      &#x3d; adjudicacao.cod_modalidade&#xd;&#xa;		                 AND homologacao.cod_licitacao       &#x3d; adjudicacao.cod_licitacao&#xd;&#xa;		                 AND homologacao.exercicio_licitacao &#x3d; adjudicacao.exercicio_licitacao&#xd;&#xa;		                 AND homologacao.cod_item            &#x3d; adjudicacao.cod_item&#xd;&#xa;		                 AND homologacao.cod_cotacao         &#x3d; adjudicacao.cod_cotacao&#xd;&#xa;		                 AND homologacao.lote                &#x3d; adjudicacao.lote&#xd;&#xa;		                 AND homologacao.exercicio_cotacao   &#x3d; adjudicacao.exercicio_cotacao&#xd;&#xa;		                 AND homologacao.cgm_fornecedor      &#x3d; adjudicacao.cgm_fornecedor&#xd;&#xa;		           LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;		                  ON homologacao_anulada.num_homologacao     &#x3d; homologacao.num_homologacao&#xd;&#xa;		                 AND homologacao_anulada.cod_licitacao       &#x3d; homologacao.cod_licitacao&#xd;&#xa;		                 AND homologacao_anulada.cod_modalidade      &#x3d; homologacao.cod_modalidade&#xd;&#xa;		                 AND homologacao_anulada.cod_entidade        &#x3d; homologacao.cod_entidade&#xd;&#xa;		                 AND homologacao_anulada.num_adjudicacao     &#x3d; homologacao.num_adjudicacao&#xd;&#xa;		                 AND homologacao_anulada.exercicio_licitacao &#x3d; homologacao.exercicio_licitacao&#xd;&#xa;		                 AND homologacao_anulada.lote                &#x3d; homologacao.lote&#xd;&#xa;		                 AND homologacao_anulada.cod_cotacao         &#x3d; homologacao.cod_cotacao&#xd;&#xa;		                 AND homologacao_anulada.cod_item            &#x3d; homologacao.cod_item&#xd;&#xa;		                 AND homologacao_anulada.exercicio_cotacao   &#x3d; homologacao.exercicio_cotacao&#xd;&#xa;		                 AND homologacao_anulada.cgm_fornecedor      &#x3d; homologacao.cgm_fornecedor&#xd;&#xa;		          INNER JOIN licitacao.participante_certificacao_licitacao&#xd;&#xa;		                  ON participante_certificacao_licitacao.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                 AND participante_certificacao_licitacao.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                 AND participante_certificacao_licitacao.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;		                 AND participante_certificacao_licitacao.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;		          INNER JOIN licitacao.participante_certificacao&#xd;&#xa;		                  ON participante_certificacao.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;		                 AND participante_certificacao.exercicio        &#x3d; participante_certificacao_licitacao.exercicio_certificacao&#xd;&#xa;		                 AND participante_certificacao.cgm_fornecedor   &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;		          INNER JOIN licitacao.certificacao_documentos&#xd;&#xa;		                  ON participante_certificacao.num_certificacao &#x3d; certificacao_documentos.num_certificacao&#xd;&#xa;		                 AND participante_certificacao.exercicio        &#x3d; certificacao_documentos.exercicio&#xd;&#xa;		                 AND participante_certificacao.cgm_fornecedor   &#x3d; certificacao_documentos.cgm_fornecedor&#xd;&#xa;		          INNER JOIN sw_cgm&#xd;&#xa;		                  ON sw_cgm.numcgm &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;		          INNER JOIN sw_uf&#xd;&#xa;		                  ON sw_cgm.cod_uf &#x3d; sw_uf.cod_uf&#xd;&#xa;		          INNER JOIN licitacao.participante&#xd;&#xa;		                  ON participante.cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                 AND participante.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                 AND participante.cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;		                 AND participante.exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;		                 AND participante.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;		          INNER JOIN compras.fornecedor&#xd;&#xa;		                  ON fornecedor.cgm_fornecedor &#x3d; participante.cgm_fornecedor&#xd;&#xa;		          INNER JOIN compras.fornecedor_socio&#xd;&#xa;		                  ON fornecedor_socio.cgm_fornecedor &#x3d; fornecedor.cgm_fornecedor&#xd;&#xa;		          INNER JOIN&#x28;&#xd;&#xa;		                      SELECT numcgm&#xd;&#xa;		                           , cpf AS num_documento_socio&#xd;&#xa;		                           , 1 AS tipo_documento_socio&#xd;&#xa;		                        FROM sw_cgm_pessoa_fisica&#xd;&#xa;		                       UNION&#xd;&#xa;		                      SELECT numcgm&#xd;&#xa;		                           , cnpj AS num_documento_socio&#xd;&#xa;		                           , 2 AS tipo_documento_socio&#xd;&#xa;		                        FROM sw_cgm_pessoa_juridica&#xd;&#xa;		                    &#x29; AS documento_socio&#xd;&#xa;		                  ON documento_socio.numcgm &#x3d; fornecedor_socio.cgm_socio&#xd;&#xa;		          INNER JOIN &#x28;&#xd;&#xa;	&#xd;&#xa;		                      SELECT numcgm&#xd;&#xa;		                           , cnpj AS numero&#xd;&#xa;		                           , 2 AS tipo&#xd;&#xa;		                        FROM sw_cgm_pessoa_juridica&#xd;&#xa;		                     &#x29; AS documento_cgm_participante&#xd;&#xa;		                  ON documento_cgm_participante.numcgm &#x3d; sw_cgm.numcgm&#xd;&#xa;		          INNER JOIN &#x28;&#xd;&#xa;		                     SELECT &#x2a;&#xd;&#xa;		                       FROM administracao.configuracao_entidade&#xd;&#xa;		                      WHERE configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;		                        AND configuracao_entidade.exercicio &#x3d; stExercicio                                &#xd;&#xa;		                        AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;		                    &#x29; AS orgao&#xd;&#xa;		                  ON orgao.valor&#x3a;&#x3a;integer &#x3d; licitacao.cod_entidade&#xd;&#xa;		                 AND orgao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;		               WHERE licitacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                        &#xd;&#xa;		                 AND TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;		                                                                                            AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;         &#xd;&#xa;		                 AND licitacao.cod_modalidade NOT IN &#x28;8,9,10&#x29;&#xd;&#xa;		                 AND licitacao_anulada.cod_licitacao IS NULL&#xd;&#xa;		                 AND homologacao_anulada.num_homologacao IS NULL&#xd;&#xa;		               GROUP BY tipo_registro&#xd;&#xa;		                   , cod_orgao&#xd;&#xa;		                   , cod_unidade&#xd;&#xa;		                   , tipo_documento&#xd;&#xa;		                   , cnpj_empresa_hablic&#xd;&#xa;		                   , documento_socio.tipo_documento_socio&#xd;&#xa;		                   , documento_socio.num_documento_socio&#xd;&#xa;		                   , tipo_participacao&#xd;&#xa;		                   , licitacao.cod_entidade&#xd;&#xa;		                   , licitacao.cod_licitacao&#xd;&#xa;		                   , licitacao.cod_modalidade&#xd;&#xa;		                   , licitacao.exercicio&#xd;&#xa;		            ORDER BY num_processo_licitatorio, cnpj_empresa_hablic&#xd;&#xa;			&#x29;,&#xd;&#xa;			 hablic20 as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 20 AS tipo_registro&#xd;&#xa;		                   , LPAD&#x28;orgao.valor&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;		                   , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade&#xd;&#xa;		                   , &#x28; SELECT exercicio_licitacao&#xd;&#xa;		                         FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;        &#xd;&#xa;		                                                           VALUES &#x28;cod_licitacao       INTEGER&#xd;&#xa;		                                                                  ,cod_modalidade      INTEGER&#xd;&#xa;		                                                                  ,cod_entidade        INTEGER&#xd;&#xa;		                                                                  ,exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;		                                                                  ,exercicio_licitacao VARCHAR&#xd;&#xa;		                                                                  ,num_licitacao       TEXT &#x29;&#xd;&#xa;		                        WHERE cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;		                          AND cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                          AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                          AND exercicio &#x3d; licitacao.exercicio&#xd;&#xa;		                     &#x29; AS exercicio_licitacao&#xd;&#xa;		                   , &#x28; SELECT num_licitacao&#xd;&#xa;		                         FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;      &#xd;&#xa;		                                                           VALUES &#x28;cod_licitacao       INTEGER&#xd;&#xa;		                                                                  ,cod_modalidade      INTEGER&#xd;&#xa;		                                                                  ,cod_entidade        INTEGER&#xd;&#xa;		                                                                  ,exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;		                                                                  ,exercicio_licitacao VARCHAR&#xd;&#xa;		                                                                  ,num_licitacao       TEXT &#x29;&#xd;&#xa;		                        WHERE cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;		                          AND cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                          AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                          AND exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;		                     &#x29; AS num_processo_licitatorio&#xd;&#xa;	&#xd;&#xa;		                   , documento_cgm.tipo AS tipo_documento&#xd;&#xa;		                   , documento_cgm.numero AS nro_documento&#xd;&#xa;		                   , TO_CHAR &#x28;participante_certificacao_licitacao.dt_registro, &#x27;ddmmyyyy&#x27;&#x29; AS dt_credenciamento&#xd;&#xa;	&#xd;&#xa;		                   , CASE WHEN cotacao_licitacao.lote &#x3d; 0&#xd;&#xa;		                          THEN NULL&#xd;&#xa;		                          ELSE cotacao_licitacao.lote&#xd;&#xa;		                      END AS num_lote&#xd;&#xa;		                   , cotacao_licitacao.cod_item&#xd;&#xa;		                   , sw_cgm_pessoa_juridica.insc_estadual AS num_inscricao_estadual&#xd;&#xa;		                   , sw_uf.sigla_uf AS uf_inscricao_estadual&#xd;&#xa;		                   , &#x28;&#xd;&#xa;		                      SELECT num_documento&#xd;&#xa;		                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;		                       WHERE l_cd.cod_documento &#x3d; 5&#xd;&#xa;		                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;		                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;		                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;		                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;		                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;		                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;		                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;		                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;		                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;		                                              &#x29;&#xd;&#xa;		                     &#x29; AS num_certidao_regularidade_inss&#xd;&#xa;		                   , &#x28;&#xd;&#xa;		                      SELECT dt_emissao&#xd;&#xa;		                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;		                       WHERE l_cd.cod_documento &#x3d; 5&#xd;&#xa;		                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;		                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;		                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;		                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;		                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;		                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;		                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;		                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;		                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;		                                              &#x29;&#xd;&#xa;		                     &#x29; AS dt_emissao_certidao_regularidade_inss&#xd;&#xa;		                   , &#x28;&#xd;&#xa;		                      SELECT dt_validade&#xd;&#xa;		                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;		                       WHERE l_cd.cod_documento &#x3d; 5&#xd;&#xa;		                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;		                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;		                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;		                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;		                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;		                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;		                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;		                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;		                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;		                                              &#x29;&#xd;&#xa;		                     &#x29; AS dt_validade_certidao_regularidade_inss&#xd;&#xa;		                   , &#x28;&#xd;&#xa;		                      SELECT num_documento&#xd;&#xa;		                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;		                       WHERE l_cd.cod_documento &#x3d; 6&#xd;&#xa;		                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;		                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;		                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;		                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;		                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;		                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;		                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;		                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;		                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;		                                              &#x29;&#xd;&#xa;		                     &#x29; AS num_certidao_regularidade_fgts&#xd;&#xa;		                   , &#x28;&#xd;&#xa;		                      SELECT dt_emissao&#xd;&#xa;		                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;		                       WHERE l_cd.cod_documento &#x3d; 6&#xd;&#xa;		                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;		                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;		                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;		                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;		                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;		                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;		                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;		                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;		                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;		                                              &#x29;&#xd;&#xa;		                     &#x29; AS dt_emissao_certidao_regularidade_fgts&#xd;&#xa;		                   , &#x28;&#xd;&#xa;		                      SELECT dt_validade&#xd;&#xa;		                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;		                       WHERE l_cd.cod_documento &#x3d; 6&#xd;&#xa;		                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;		                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;		                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;		                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;		                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;		                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;		                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;		                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;		                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;		                                              &#x29;&#xd;&#xa;		                     &#x29; AS dt_validade_certidao_regularidade_fgts&#xd;&#xa;		                   , &#x28;&#xd;&#xa;		                      SELECT num_documento&#xd;&#xa;		                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;		                       WHERE l_cd.cod_documento &#x3d; 7&#xd;&#xa;		                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;		                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;		                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;		                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;		                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;		                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;		                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;		                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;		                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;		                                              &#x29;&#xd;&#xa;		                     &#x29; AS num_cndt&#xd;&#xa;		                   , &#x28;&#xd;&#xa;		                      SELECT dt_emissao&#xd;&#xa;		                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;		                       WHERE l_cd.cod_documento &#x3d; 7&#xd;&#xa;		                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;		                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;		                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;		                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;		                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;		                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;		                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;		                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;		                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;		                                              &#x29;&#xd;&#xa;		                     &#x29; AS dt_emissao_cndt&#xd;&#xa;		                   , &#x28;&#xd;&#xa;		                      SELECT dt_validade&#xd;&#xa;		                        FROM licitacao.certificacao_documentos AS l_cd&#xd;&#xa;		                       WHERE l_cd.cod_documento &#x3d; 7&#xd;&#xa;		                         AND l_cd.exercicio   &#x3d; participante_certificacao_licitacao.exercicio&#xd;&#xa;		                         AND l_cd.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;		                         AND l_cd.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;		                         AND l_cd.timestamp &#x3d; &#x28;&#xd;&#xa;		                                               SELECT MAX&#x28;timestamp&#x29;&#xd;&#xa;		                                                 FROM licitacao.certificacao_documentos AS CD&#xd;&#xa;		                                                WHERE CD.cgm_fornecedor &#x3d; l_cd.cgm_fornecedor&#xd;&#xa;		                                                  AND CD.cod_documento  &#x3d; l_cd.cod_documento&#xd;&#xa;		                                                  AND CD.exercicio      &#x3d; l_cd.exercicio&#xd;&#xa;		                                              &#x29;&#xd;&#xa;		                     &#x29; AS dt_validade_cndt&#xd;&#xa;		                FROM licitacao.licitacao&#xd;&#xa;		           LEFT JOIN licitacao.licitacao_anulada&#xd;&#xa;		                  ON licitacao_anulada.cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                 AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                 AND licitacao_anulada.cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;		                 AND licitacao_anulada.exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;		          INNER JOIN licitacao.cotacao_licitacao&#xd;&#xa;		                  ON cotacao_licitacao.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                 AND cotacao_licitacao.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                 AND cotacao_licitacao.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;		                 AND cotacao_licitacao.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;		          INNER JOIN licitacao.adjudicacao&#xd;&#xa;		                  ON adjudicacao.cod_licitacao       &#x3d; cotacao_licitacao.cod_licitacao&#xd;&#xa;		                 AND adjudicacao.cod_modalidade      &#x3d; cotacao_licitacao.cod_modalidade&#xd;&#xa;		                 AND adjudicacao.cod_entidade        &#x3d; cotacao_licitacao.cod_entidade&#xd;&#xa;		                 AND adjudicacao.exercicio_licitacao &#x3d; cotacao_licitacao.exercicio_licitacao&#xd;&#xa;		                 AND adjudicacao.lote                &#x3d; cotacao_licitacao.lote&#xd;&#xa;		                 AND adjudicacao.cod_cotacao         &#x3d; cotacao_licitacao.cod_cotacao&#xd;&#xa;		                 AND adjudicacao.cod_item            &#x3d; cotacao_licitacao.cod_item&#xd;&#xa;		                 AND adjudicacao.exercicio_cotacao   &#x3d; cotacao_licitacao.exercicio_cotacao&#xd;&#xa;		                 AND adjudicacao.cgm_fornecedor      &#x3d; cotacao_licitacao.cgm_fornecedor&#xd;&#xa;		          INNER JOIN licitacao.homologacao&#xd;&#xa;		                  ON homologacao.num_adjudicacao     &#x3d; adjudicacao.num_adjudicacao&#xd;&#xa;		                 AND homologacao.cod_entidade        &#x3d; adjudicacao.cod_entidade&#xd;&#xa;		                 AND homologacao.cod_modalidade      &#x3d; adjudicacao.cod_modalidade&#xd;&#xa;		                 AND homologacao.cod_licitacao       &#x3d; adjudicacao.cod_licitacao&#xd;&#xa;		                 AND homologacao.exercicio_licitacao &#x3d; adjudicacao.exercicio_licitacao&#xd;&#xa;		                 AND homologacao.cod_item            &#x3d; adjudicacao.cod_item&#xd;&#xa;		                 AND homologacao.cod_cotacao         &#x3d; adjudicacao.cod_cotacao&#xd;&#xa;		                 AND homologacao.lote                &#x3d; adjudicacao.lote&#xd;&#xa;		                 AND homologacao.exercicio_cotacao   &#x3d; adjudicacao.exercicio_cotacao&#xd;&#xa;		                 AND homologacao.cgm_fornecedor      &#x3d; adjudicacao.cgm_fornecedor&#xd;&#xa;		           LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;		                  ON homologacao_anulada.num_homologacao     &#x3d; homologacao.num_homologacao&#xd;&#xa;		                 AND homologacao_anulada.cod_licitacao       &#x3d; homologacao.cod_licitacao&#xd;&#xa;		                 AND homologacao_anulada.cod_modalidade      &#x3d; homologacao.cod_modalidade&#xd;&#xa;		                 AND homologacao_anulada.cod_entidade        &#x3d; homologacao.cod_entidade&#xd;&#xa;		                 AND homologacao_anulada.num_adjudicacao     &#x3d; homologacao.num_adjudicacao&#xd;&#xa;		                 AND homologacao_anulada.exercicio_licitacao &#x3d; homologacao.exercicio_licitacao&#xd;&#xa;		                 AND homologacao_anulada.lote                &#x3d; homologacao.lote&#xd;&#xa;		                 AND homologacao_anulada.cod_cotacao         &#x3d; homologacao.cod_cotacao&#xd;&#xa;		                 AND homologacao_anulada.cod_item            &#x3d; homologacao.cod_item&#xd;&#xa;		                 AND homologacao_anulada.exercicio_cotacao   &#x3d; homologacao.exercicio_cotacao&#xd;&#xa;		                 AND homologacao_anulada.cgm_fornecedor      &#x3d; homologacao.cgm_fornecedor&#xd;&#xa;	&#xd;&#xa;		           LEFT JOIN &#x28;&#xd;&#xa;		                      SELECT cotacao_licitacao.cod_licitacao&#xd;&#xa;		                           , cotacao_licitacao.cod_modalidade&#xd;&#xa;		                           , cotacao_licitacao.cod_entidade&#xd;&#xa;		                           , cotacao_licitacao.exercicio_licitacao&#xd;&#xa;		                           , cotacao_licitacao.cgm_fornecedor&#xd;&#xa;		                           , participante_certificacao.num_certificacao&#xd;&#xa;		                           , participante_certificacao.exercicio&#xd;&#xa;		                           , participante_certificacao.dt_registro&#xd;&#xa;		                        FROM licitacao.cotacao_licitacao&#xd;&#xa;		                  INNER JOIN compras.cotacao_fornecedor_item&#xd;&#xa;		                          ON cotacao_licitacao.exercicio_cotacao &#x3d; cotacao_fornecedor_item.exercicio&#xd;&#xa;		                         AND cotacao_licitacao.cod_cotacao       &#x3d; cotacao_fornecedor_item.cod_cotacao&#xd;&#xa;		                         AND cotacao_licitacao.cod_item          &#x3d; cotacao_fornecedor_item.cod_item&#xd;&#xa;		                         AND cotacao_licitacao.cgm_fornecedor    &#x3d; cotacao_fornecedor_item.cgm_fornecedor&#xd;&#xa;		                         AND cotacao_licitacao.lote              &#x3d; cotacao_fornecedor_item.lote&#xd;&#xa;		                  INNER JOIN compras.julgamento_item&#xd;&#xa;		                          ON julgamento_item.exercicio      &#x3d; cotacao_fornecedor_item.exercicio&#xd;&#xa;		                         AND julgamento_item.cod_cotacao    &#x3d; cotacao_fornecedor_item.cod_cotacao&#xd;&#xa;		                         AND julgamento_item.cod_item       &#x3d; cotacao_fornecedor_item.cod_item&#xd;&#xa;		                         AND julgamento_item.cgm_fornecedor &#x3d; cotacao_fornecedor_item.cgm_fornecedor&#xd;&#xa;		                         AND julgamento_item.lote           &#x3d; cotacao_fornecedor_item.lote&#xd;&#xa;		                         AND julgamento_item.ordem          &#x3d; 1&#xd;&#xa;		                   LEFT JOIN licitacao.participante_certificacao_licitacao&#xd;&#xa;		                          ON participante_certificacao_licitacao.cod_licitacao       &#x3d; cotacao_licitacao.cod_licitacao&#xd;&#xa;		                         AND participante_certificacao_licitacao.cod_modalidade      &#x3d; cotacao_licitacao.cod_modalidade&#xd;&#xa;		                         AND participante_certificacao_licitacao.cod_entidade        &#x3d; cotacao_licitacao.cod_entidade&#xd;&#xa;		                         AND participante_certificacao_licitacao.exercicio_licitacao &#x3d; cotacao_licitacao.exercicio_licitacao&#xd;&#xa;		                         AND participante_certificacao_licitacao.cgm_fornecedor      &#x3d; cotacao_licitacao.cgm_fornecedor&#xd;&#xa;		                   LEFT JOIN licitacao.participante_certificacao&#xd;&#xa;		                          ON participante_certificacao.num_certificacao &#x3d; participante_certificacao_licitacao.num_certificacao&#xd;&#xa;		                         AND participante_certificacao.exercicio        &#x3d; participante_certificacao_licitacao.exercicio_certificacao&#xd;&#xa;		                         AND participante_certificacao.cgm_fornecedor   &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;	&#xd;&#xa;		                       WHERE cotacao_licitacao.cod_entidade in &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;		                         AND cotacao_licitacao.exercicio_licitacao &#x3d; stExercicio             &#xd;&#xa;		                    GROUP BY cotacao_licitacao.cod_licitacao&#xd;&#xa;		                           , cotacao_licitacao.cod_modalidade&#xd;&#xa;		                           , cotacao_licitacao.cod_entidade&#xd;&#xa;		                           , cotacao_licitacao.exercicio_licitacao&#xd;&#xa;		                           , cotacao_licitacao.cgm_fornecedor&#xd;&#xa;		                           , participante_certificacao.num_certificacao&#xd;&#xa;		                           , participante_certificacao.exercicio&#xd;&#xa;		                           , participante_certificacao.dt_registro&#xd;&#xa;		                     &#x29; AS participante_certificacao_licitacao&#xd;&#xa;		                  ON participante_certificacao_licitacao.cod_licitacao       &#x3d; cotacao_licitacao.cod_licitacao&#xd;&#xa;		                 AND participante_certificacao_licitacao.cod_modalidade      &#x3d; cotacao_licitacao.cod_modalidade&#xd;&#xa;		                 AND participante_certificacao_licitacao.cod_entidade        &#x3d; cotacao_licitacao.cod_entidade&#xd;&#xa;		                 AND participante_certificacao_licitacao.exercicio_licitacao &#x3d; cotacao_licitacao.exercicio_licitacao&#xd;&#xa;		                 AND participante_certificacao_licitacao.cgm_fornecedor      &#x3d; cotacao_licitacao.cgm_fornecedor&#xd;&#xa;	&#xd;&#xa;		          INNER JOIN sw_cgm&#xd;&#xa;		                  ON sw_cgm.numcgm &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;		          INNER JOIN sw_uf&#xd;&#xa;		                  ON sw_cgm.cod_uf &#x3d; sw_uf.cod_uf&#xd;&#xa;	&#xd;&#xa;		           LEFT JOIN licitacao.participante&#xd;&#xa;		                  ON participante.cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                 AND participante.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                 AND participante.cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;		                 AND participante.exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;		                 AND participante.cgm_fornecedor &#x3d; participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;		          INNER JOIN &#x28;&#xd;&#xa;		                      SELECT numcgm&#xd;&#xa;		                           , cpf AS numero&#xd;&#xa;		                           , 1 AS tipo&#xd;&#xa;		                        FROM sw_cgm_pessoa_fisica&#xd;&#xa;		                       UNION&#xd;&#xa;		                      SELECT numcgm&#xd;&#xa;		                           , cnpj AS numero&#xd;&#xa;		                           , 2 AS tipo&#xd;&#xa;		                        FROM sw_cgm_pessoa_juridica&#xd;&#xa;		                     &#x29; AS documento_cgm&#xd;&#xa;		                  ON documento_cgm.numcgm &#x3d; sw_cgm.numcgm&#xd;&#xa;	&#xd;&#xa;		           LEFT JOIN sw_cgm_pessoa_juridica&#xd;&#xa;		                  ON sw_cgm_pessoa_juridica.numcgm &#x3d; documento_cgm.numcgm&#xd;&#xa;	&#xd;&#xa;		          INNER JOIN &#x28;&#xd;&#xa;		                      SELECT &#x2a;&#xd;&#xa;		                        FROM administracao.configuracao_entidade&#xd;&#xa;		                       WHERE configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;		                         AND configuracao_entidade.exercicio &#x3d; stExercicio                           &#xd;&#xa;		                         AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;		                     &#x29; AS orgao&#xd;&#xa;		                  ON orgao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;		                 AND orgao.exercicio    &#x3d; licitacao.exercicio&#xd;&#xa;	&#xd;&#xa;		               WHERE licitacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                      &#xd;&#xa;		                 AND TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;		                                                                                            AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;       &#xd;&#xa;		                 AND licitacao.cod_modalidade IN &#x28;10&#x29;&#xd;&#xa;		                 AND licitacao_anulada.cod_licitacao IS NULL&#xd;&#xa;		                 AND homologacao_anulada.num_homologacao IS NULL&#xd;&#xa;	&#xd;&#xa;		            ORDER BY licitacao.cod_entidade&#xd;&#xa;		                   , licitacao.cod_licitacao&#xd;&#xa;		                   , licitacao.cod_modalidade&#xd;&#xa;		                   , licitacao.exercicio&#xd;&#xa;		                   , num_processo_licitatorio&#xd;&#xa;		                   , participante_certificacao_licitacao.cgm_fornecedor&#xd;&#xa;		                   , cotacao_licitacao.cod_item&#xd;&#xa;			&#x29;,&#xd;&#xa;			  hablic_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							num_processo_licitatorio,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo_licitatorio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;			&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;objeto_social&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,200&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;orgao_resp_registro&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_registro&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_registro&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_registro_cvm&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_registro_cvm&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_inscricao_estadual&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;uf_inscricao_estadual&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;,2,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_certidao_regularidade_inss&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_emissao_certidao_regularidade_inss&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_validade_certidao_regularidade_inss&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_certidao_regularidade_fgts&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_emissao_certidao_regularidade_fgts&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_validade_certidao_regularidade_fgts&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_cndt&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_emissao_cndt&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_validade_cndt&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_habilitacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;presenca_licitantes&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;renuncia_recurso&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;					as d&#xd;&#xa;				from hablic10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							num_processo_licitatorio,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo_licitatorio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cnpj_empresa_hablic&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 14, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_documento_socio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_documento_socio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_participacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from hablic11&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							num_processo_licitatorio,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo_licitatorio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_credenciamento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_lote&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_item&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_inscricao_estadual&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;uf_inscricao_estadual&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_certidao_regularidade_inss&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_emissao_certidao_regularidade_inss&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_validade_certidao_regularidade_inss&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_certidao_regularidade_fgts&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_emissao_certidao_regularidade_fgts&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_validade_certidao_regularidade_fgts&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_cndt&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_emissao_cndt&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_validade_cndt&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from hablic20&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;HABLIC.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from hablic_format order by num_processo_licitatorio, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;NTF.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with ntf10 as&#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT DISTINCT ON &#x28;NF.nro_nota&#x3a;&#x3a;NUMERIC, NF.exercicio&#x29;&#xd;&#xa;	                       10 AS tipo_registro&#xd;&#xa;	                       , RPAD&#x28;&#x28;NF.cod_nota&#x7c;&#x7c;&#x27;&#x27;&#x7c;&#x7c;NF.nro_nota&#x7c;&#x7c;&#x27;&#x27;&#x7c;&#x7c;to_char&#x28;data_emissao, &#x27;ddmmyyyy&#x27;&#x29;&#x29;, 15, &#x27;0&#x27;&#x29; AS codnotafiscal&#xd;&#xa;&#xd;&#xa;	                       , &#x28;SELECT valor&#x3a;&#x3a;INTEGER&#xd;&#xa;	                            FROM administracao.configuracao_entidade&#xd;&#xa;	                           WHERE exercicio&#x3d;NF.exercicio&#xd;&#xa;	                             AND parametro&#x3d;&#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                             AND cod_entidade&#x3d;NF.cod_entidade&#x29;&#xd;&#xa;	                          AS codorgao&#xd;&#xa;	                        , NF.nro_nota AS nfnumero&#xd;&#xa;	                        , CASE WHEN tipo_nota_fiscal.cod_tipo &#x21;&#x3d; 4 AND tipo_nota_fiscal.cod_tipo &#x21;&#x3d; 1 THEN&#xd;&#xa;	                                   NF.nro_serie&#xd;&#xa;	                               ELSE&#xd;&#xa;	                                   &#x27; &#x27;&#xd;&#xa;	                          END AS nfserie&#xd;&#xa;&#xd;&#xa;	                        , CASE WHEN CGMPJ_empenho.cnpj&#x21;&#x3d;&#x27;&#x27; THEN&#xd;&#xa;	                                   2&#xd;&#xa;	                               ELSE&#xd;&#xa;	                                   CASE WHEN CGMPF_empenho.cpf&#x21;&#x3d;&#x27;&#x27; THEN&#xd;&#xa;	                                       1&#xd;&#xa;	                                   ELSE&#xd;&#xa;	                                       3&#xd;&#xa;	                                   END&#xd;&#xa;	                          END AS tipodocumento&#xd;&#xa;&#xd;&#xa;	                        , CASE WHEN CGMPJ_empenho.cnpj&#x21;&#x3d;&#x27;&#x27; THEN&#xd;&#xa;	                                   CGMPJ_empenho.cnpj&#xd;&#xa;	                               ELSE&#xd;&#xa;	                                   CASE WHEN CGMPF_empenho.cpf&#x21;&#x3d;&#x27;&#x27; THEN&#xd;&#xa;	                                       CGMPF_empenho.cpf&#xd;&#xa;	                                   ELSE&#xd;&#xa;	                                      &#x27;&#x27;&#xd;&#xa;	                                   END&#xd;&#xa;	                          END AS nrodocumento&#xd;&#xa;&#xd;&#xa;	                        , NF.inscricao_estadual AS nroinscestadual&#xd;&#xa;	                        , NF.inscricao_municipal  AS nroinscmunicipal&#xd;&#xa;	                        , CGMMUN.nom_municipio as nomemunicipio&#xd;&#xa;	                        , &#x28;SELECT cep&#xd;&#xa;	                             FROM sw_cep_logradouro&#xd;&#xa;	                            WHERE cod_logradouro &#x3d; &#x28;SELECT cod_logradouro&#xd;&#xa;	                                                      FROM sw_logradouro&#xd;&#xa;	                                                     WHERE cod_municipio&#x3d;CGM.cod_municipio&#xd;&#xa;	                                                       AND cod_uf&#x3d;CGM.cod_uf&#xd;&#xa;	                                                  ORDER BY cod_logradouro desc limit 1&#x29; &#x29;&#xd;&#xa;	                          AS cepmunicipio&#xd;&#xa;	                        , &#x28; SELECT sw_uf.sigla_uf&#xd;&#xa;	                              FROM empenho.empenho AS EE&#xd;&#xa;	                         LEFT JOIN empenho.pre_empenho AS EPE&#xd;&#xa;	                                ON EPE.exercicio&#x3d;EE.exercicio&#xd;&#xa;	                               AND EPE.cod_pre_empenho&#x3d;EE.cod_pre_empenho&#xd;&#xa;	                         LEFT JOIN sw_cgm&#xd;&#xa;	                                ON sw_cgm.numcgm&#x3d;EPE.cgm_beneficiario&#xd;&#xa;	                         LEFT JOIN sw_uf&#xd;&#xa;	                                ON sw_uf.cod_uf&#x3d;sw_cgm.cod_uf&#xd;&#xa;	                               AND sw_uf.cod_pais&#x3d;sw_cgm.cod_pais&#xd;&#xa;	                             WHERE &#x28;EE.exercicio&#x3d;NFEL.exercicio_empenho&#xd;&#xa;	                                    AND EE.cod_empenho&#x3d;NFEL.cod_empenho&#xd;&#xa;	                                    AND EE.cod_entidade&#x3d;NFEL.cod_entidade&#x29;&#xd;&#xa;	                                OR &#x28;EE.exercicio&#x3d;NFE.exercicio_empenho&#xd;&#xa;	                                    AND EE.cod_empenho&#x3d;NFE.cod_empenho&#xd;&#xa;	                                    AND EE.cod_entidade&#x3d;NFE.cod_entidade&#x29;&#x29;&#xd;&#xa;	                          AS ufcredor&#xd;&#xa;	                        , CASE WHEN NF.cod_tipo &#x3d; 1 THEN 1&#xd;&#xa;	                               WHEN NF.cod_tipo &#x3d; 4 THEN 1&#xd;&#xa;	                               WHEN NF.cod_tipo &#x3d; 2 THEN 2&#xd;&#xa;	                               WHEN NF.cod_tipo &#x3d; 3 THEN 3&#xd;&#xa;	                               ELSE 0&#xd;&#xa;	                          END AS notafiscaleletronica&#xd;&#xa;	                        , NF.chave_acesso AS chaveacesso&#xd;&#xa;	                        , NF.chave_acesso_municipal AS chaveacessomunicipal&#xd;&#xa;	                        , NF.aidf AS nfaidf&#xd;&#xa;	                        , to_char&#x28;data_emissao, &#x27;ddmmyyyy&#x27;&#x29; as dtemissaonf&#xd;&#xa;	                        , CASE WHEN ENL.dt_vencimento &#x3c; NF.data_emissao OR EE.dt_vencimento &#x3c; NF.data_emissao&#xd;&#xa;	                               THEN to_char&#x28;data_emissao, &#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                               ELSE CASE WHEN ENL.dt_vencimento IS NOT NULL&#xd;&#xa;	                                         THEN to_char&#x28;ENL.dt_vencimento, &#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                                         ELSE to_char&#x28;EE.dt_vencimento, &#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;	                                     END&#xd;&#xa;	                                END AS dtvencimentonf&#xd;&#xa;	                        , REPLACE&#x28;NF.vl_total&#x3a;&#x3a;VARCHAR,&#x27;.&#x27;,&#x27;,&#x27;&#x29; as nfvalortotal&#xd;&#xa;	                        , REPLACE&#x28;NF.vl_desconto&#x3a;&#x3a;VARCHAR,&#x27;.&#x27;,&#x27;,&#x27;&#x29; as nfvalordesconto&#xd;&#xa;	                        , REPLACE&#x28;NF.vl_total_liquido&#x3a;&#x3a;VARCHAR,&#x27;.&#x27;,&#x27;,&#x27;&#x29; as nfvalorliquido&#xd;&#xa;	                        , NF.cod_nota&#xd;&#xa;	                        , NF.exercicio&#xd;&#xa;	                        , NF.cod_entidade&#xd;&#xa;	                        FROM tcemg.nota_fiscal AS NF&#xd;&#xa;	                        JOIN tcemg.tipo_nota_fiscal&#xd;&#xa;	                          ON tipo_nota_fiscal.cod_tipo &#x3d; NF.cod_tipo&#xd;&#xa;	                   LEFT JOIN tcemg.nota_fiscal_empenho_liquidacao AS NFEL&#xd;&#xa;	                          ON  NFEL.cod_nota &#x3d; NF.cod_nota&#xd;&#xa;	                         AND NFEL.exercicio &#x3d; NF.exercicio&#xd;&#xa;	                         AND NFEL.cod_entidade &#x3d; NF.cod_entidade&#xd;&#xa;	                   LEFT JOIN tcemg.nota_fiscal_empenho AS NFE&#xd;&#xa;	                          ON  NFE.cod_nota &#x3d; NF.cod_nota&#xd;&#xa;	                         AND NFE.exercicio &#x3d; NF.exercicio&#xd;&#xa;	                         AND NFE.cod_entidade &#x3d; NF.cod_entidade&#xd;&#xa;	                   LEFT JOIN orcamento.entidade AS OE&#xd;&#xa;	                          ON OE.cod_entidade&#x3d;NF.cod_entidade&#xd;&#xa;	                         AND OE.exercicio&#x3d;NF.exercicio&#xd;&#xa;	                   LEFT JOIN sw_cgm AS CGM&#xd;&#xa;	                          ON  CGM.numcgm &#x3d; OE.numcgm&#xd;&#xa;	                   LEFT JOIN sw_cgm_pessoa_juridica AS CGMPJ&#xd;&#xa;	                          ON  CGMPJ.numcgm &#x3d; OE.numcgm&#xd;&#xa;	                   LEFT JOIN sw_cgm_pessoa_fisica AS CGMPF&#xd;&#xa;	                          ON  CGMPF.numcgm &#x3d; OE.numcgm&#xd;&#xa;	                   LEFT JOIN sw_municipio AS CGMMUN&#xd;&#xa;	                          ON  CGMMUN.cod_municipio &#x3d; CGM.cod_municipio&#xd;&#xa;	                         AND CGMMUN.cod_uf &#x3d; CGM.cod_uf&#xd;&#xa;	                   LEFT JOIN empenho.nota_liquidacao AS ENL&#xd;&#xa;	                          ON ENL.exercicio&#x3d;NFEL.exercicio_liquidacao&#xd;&#xa;	                         AND ENL.cod_nota&#x3d;NFEL.cod_nota_liquidacao&#xd;&#xa;	                         AND ENL.cod_entidade&#x3d;NFEL.cod_entidade&#xd;&#xa;	                   LEFT JOIN empenho.empenho AS EE&#xd;&#xa;	                          ON EE.exercicio&#x3d;NFEL.exercicio_empenho&#xd;&#xa;	                         AND EE.cod_empenho&#x3d;NFEL.cod_empenho&#xd;&#xa;	                         AND EE.cod_entidade&#x3d;NFEL.cod_entidade&#xd;&#xa;	                   LEFT JOIN empenho.pre_empenho AS EP&#xd;&#xa;	                          ON EP.exercicio        &#x3d; EE.exercicio&#xd;&#xa;	                         AND EP.cod_pre_empenho  &#x3d; EE.cod_pre_empenho&#xd;&#xa;	                   LEFT JOIN sw_cgm AS CGM_empenho&#xd;&#xa;	                          ON  CGM_empenho.numcgm &#x3d; EP.cgm_beneficiario&#xd;&#xa;	                   LEFT JOIN sw_cgm_pessoa_juridica AS CGMPJ_empenho&#xd;&#xa;	                          ON  CGMPJ_empenho.numcgm &#x3d; CGM_empenho.numcgm&#xd;&#xa;	                   LEFT JOIN sw_cgm_pessoa_fisica AS CGMPF_empenho&#xd;&#xa;	                          ON  CGMPF_empenho.numcgm &#x3d; CGM_empenho.numcgm&#xd;&#xa;	                       WHERE NF.exercicio&#x3d; stExercicio                &#xd;&#xa;	                         AND NF.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;             &#xd;&#xa;	                         AND &#x28;NF.nro_nota IS NOT NULL OR TRIM&#x28;NF.nro_nota&#x29; &#x3c;&#x3e; &#x27;&#x27; &#x29;&#xd;&#xa;	                         AND ENL.dt_liquidacao BETWEEN TO_DATE&#x28; stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27; &#x29; AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2, &#x27;0&#x27;&#x29;  &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;   &#xd;&#xa;			&#x29;,&#xd;&#xa;			 ntf20 as&#xd;&#xa;			&#x28;&#xd;&#xa;		   			SELECT   20 AS tipo_registro&#xd;&#xa;	                       , nota_fiscal.nro_nota AS nfnumero&#xd;&#xa;	                       , CASE WHEN tipo_nota_fiscal.cod_tipo &#x21;&#x3d; 4 AND tipo_nota_fiscal.cod_tipo &#x21;&#x3d; 1 THEN&#xd;&#xa;	                                       nota_fiscal.nro_serie&#xd;&#xa;	                               ELSE&#xd;&#xa;	                                       &#x27; &#x27;&#xd;&#xa;	                         END AS nfserie&#xd;&#xa;	                       , CASE WHEN CGMPJ_empenho.cnpj&#x21;&#x3d;&#x27;&#x27; THEN&#xd;&#xa;	                           2&#xd;&#xa;	                         ELSE&#xd;&#xa;	                           CASE WHEN CGMPF_empenho.cpf&#x21;&#x3d;&#x27;&#x27; THEN&#xd;&#xa;	                               1&#xd;&#xa;	                           ELSE&#xd;&#xa;	                               3&#xd;&#xa;	                           END&#xd;&#xa;	                         END AS tipodocumento&#xd;&#xa;	                       , CASE WHEN CGMPJ_empenho.cnpj&#x21;&#x3d;&#x27;&#x27; THEN&#xd;&#xa;	                           CGMPJ_empenho.cnpj&#xd;&#xa;	                         ELSE&#xd;&#xa;	                           CASE WHEN CGMPF_empenho.cpf&#x21;&#x3d;&#x27;&#x27; THEN&#xd;&#xa;	                               CGMPF_empenho.cpf&#xd;&#xa;	                           ELSE&#xd;&#xa;	                               &#x27;&#x27;&#xd;&#xa;	                           END&#xd;&#xa;	                         END AS nrodocumento&#xd;&#xa;	                       , nota_fiscal.chave_acesso AS chaveacesso&#xd;&#xa;	                       , to_char&#x28;data_emissao, &#x27;ddmmyyyy&#x27;&#x29; as dtemissaonf&#xd;&#xa;	                       , CASE WHEN restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                              THEN CASE WHEN uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;	                                        THEN LPAD&#x28;LPAD&#x28;uniorcam.num_orgao_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;uniorcam.num_unidade_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;	                                        ELSE LPAD&#x28;restos_pre_empenho.num_unidade&#x3a;&#x3a;VARCHAR,5,&#x27;0&#x27;&#x29;&#xd;&#xa;	                                    END&#xd;&#xa;	                              ELSE LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;OD.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;OD.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;	                          END AS codunidadesub&#xd;&#xa;	                       , to_char&#x28;EE.dt_empenho, &#x27;ddmmyyyy&#x27;&#x29; AS dtempenho&#xd;&#xa;	                       , NFEL.cod_empenho AS nroempenho&#xd;&#xa;	                       , to_char&#x28;ENL.dt_liquidacao, &#x27;ddmmyyyy&#x27;&#x29; AS dtliquidacao&#xd;&#xa;	                       , TCEMG.numero_nota_liquidacao&#x28;stExercicio,         &#xd;&#xa;	                                                                        EE.cod_entidade,&#xd;&#xa;	                                                                        ENL.cod_nota,&#xd;&#xa;	                                                                        ENL.exercicio_empenho,&#xd;&#xa;	                                                                        EE.cod_empenho&#xd;&#xa;	                                                                       &#x29; AS nroliquidacao&#xd;&#xa;	                     FROM tcemg.nota_fiscal_empenho_liquidacao AS NFEL&#xd;&#xa;	                LEFT JOIN tcemg.nota_fiscal&#xd;&#xa;	                       ON nota_fiscal.cod_nota        &#x3d; NFEL.cod_nota&#xd;&#xa;	                      AND nota_fiscal.exercicio       &#x3d; NFEL.exercicio&#xd;&#xa;	                      AND nota_fiscal.cod_entidade    &#x3d; NFEL.cod_entidade&#xd;&#xa;	                LEFT JOIN tcemg.tipo_nota_fiscal&#xd;&#xa;	                       ON tipo_nota_fiscal.cod_tipo &#x3d; nota_fiscal.cod_tipo&#xd;&#xa;	                LEFT JOIN orcamento.entidade&#xd;&#xa;	                       ON  entidade.cod_entidade &#x3d; nota_fiscal.cod_entidade&#xd;&#xa;	                      AND entidade.exercicio    &#x3d; nota_fiscal.exercicio&#xd;&#xa;	                LEFT JOIN sw_cgm_pessoa_juridica&#xd;&#xa;	                       ON  sw_cgm_pessoa_juridica.numcgm &#x3d; entidade.numcgm&#xd;&#xa;	                LEFT JOIN sw_cgm_pessoa_fisica&#xd;&#xa;	                       ON  sw_cgm_pessoa_fisica.numcgm &#x3d; entidade.numcgm&#xd;&#xa;	                LEFT JOIN empenho.empenho AS EE&#xd;&#xa;	                       ON  EE.cod_empenho &#x3d; NFEL.cod_empenho&#xd;&#xa;	                      AND EE.exercicio    &#x3d; NFEL.exercicio_empenho&#xd;&#xa;	                      AND EE.cod_entidade &#x3d; NFEL.cod_entidade&#xd;&#xa;	                LEFT JOIN empenho.nota_liquidacao AS ENL&#xd;&#xa;	                       ON  ENL.cod_nota    &#x3d; NFEL.cod_nota_liquidacao&#xd;&#xa;	                      AND ENL.exercicio    &#x3d; NFEL.exercicio_liquidacao&#xd;&#xa;	                      AND ENL.cod_entidade &#x3d; NFEL.cod_entidade&#xd;&#xa;	                LEFT JOIN empenho.pre_empenho_despesa AS EPED&#xd;&#xa;	                       ON  EPED.cod_pre_empenho &#x3d; EE.cod_pre_empenho&#xd;&#xa;	                      AND EPED.exercicio        &#x3d; EE.exercicio&#xd;&#xa;	                LEFT JOIN orcamento.despesa AS OD&#xd;&#xa;	                       ON  OD.exercicio    &#x3d; EPED.exercicio&#xd;&#xa;	                      AND OD.cod_despesa   &#x3d; EPED.cod_despesa&#xd;&#xa;	                LEFT JOIN empenho.pre_empenho&#xd;&#xa;	                       ON pre_empenho.cod_pre_empenho &#x3d; ee.cod_pre_empenho&#xd;&#xa;	                      AND pre_empenho.exercicio &#x3d; ee.exercicio&#xd;&#xa;	                LEFT JOIN empenho.restos_pre_empenho&#xd;&#xa;	                       ON pre_empenho.cod_pre_empenho &#x3d; restos_pre_empenho.cod_pre_empenho&#xd;&#xa;	                      AND pre_empenho.exercicio &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;	                LEFT JOIN tcemg.uniorcam&#xd;&#xa;	                       ON uniorcam.num_unidade &#x3d; restos_pre_empenho.num_unidade&#xd;&#xa;						  AND uniorcam.num_orgao   &#x3d; restos_pre_empenho.num_orgao&#xd;&#xa;	                      AND uniorcam.exercicio   &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;	                      AND uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;	                LEFT JOIN sw_cgm AS CGM_empenho&#xd;&#xa;	                       ON CGM_empenho.numcgm &#x3d; pre_empenho.cgm_beneficiario&#xd;&#xa;	                LEFT JOIN sw_cgm_pessoa_juridica AS CGMPJ_empenho&#xd;&#xa;	                       ON CGMPJ_empenho.numcgm &#x3d; CGM_empenho.numcgm&#xd;&#xa;	                LEFT JOIN sw_cgm_pessoa_fisica AS CGMPF_empenho&#xd;&#xa;	                       ON CGMPF_empenho.numcgm &#x3d; CGM_empenho.numcgm&#xd;&#xa;	                WHERE NFEL.exercicio &#x3d; stExercicio          &#xd;&#xa;	                  AND NFEL.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;         &#xd;&#xa;	                  AND ENL.dt_liquidacao   BETWEEN TO_DATE&#x28; stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27; &#x29;    &#xd;&#xa;	                                        AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;   &#xd;&#xa;			&#x29;,&#xd;&#xa;			  ntf_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							nfnumero&#x3a;&#x3a;bigint,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codnotafiscal&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nfnumero&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nfserie&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipodocumento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nrodocumento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroinscestadual&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroinscmunicipal&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;nomemunicipio&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,120&#x29;,&#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cepmunicipio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 8, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;ufcredor&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;notafiscaleletronica&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;chaveacesso&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 44, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;chaveacessomunicipal&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nfaidf&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dtemissaonf&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dtvencimentonf&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;nfvalortotal&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;nfvalordesconto&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;nfvalorliquido&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from ntf10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							nfnumero&#x3a;&#x3a;bigint,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nfnumero&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nfserie&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipodocumento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nrodocumento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;chaveacesso&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dtemissaonf&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesub&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dtempenho&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroempenho&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dtliquidacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nroliquidacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from ntf20&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;NTF.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from ntf_format order by nfnumero, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;ABERLIC.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with aberlic10 as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 10 AS tipo_registro&#xd;&#xa;			                 , LPAD&#x28;configuracao_entidade.valor,2,&#x27;0&#x27;&#x29; AS cod_orgao_resp&#xd;&#xa;			                 , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade_resp&#xd;&#xa;			                 , licitacao.exercicio_licitacao&#xd;&#xa;			                 , licitacao.num_processo_licitatorio&#xd;&#xa;			                 , CASE licitacao.cod_modalidade&#xd;&#xa;			                        WHEN 4 THEN 7&#xd;&#xa;			                        WHEN 5 THEN 4&#xd;&#xa;			                        WHEN 6 THEN 5&#xd;&#xa;			                        WHEN 7 THEN 6&#xd;&#xa;			                        ELSE licitacao.cod_modalidade&#xd;&#xa;			                    END AS cod_modalidade_licitacao&#xd;&#xa;			                 , licitacao.cod_modalidade AS num_modalidade&#xd;&#xa;			                 , CASE licitacao.cod_modalidade&#xd;&#xa;			                        WHEN 11 THEN 2&#xd;&#xa;			                        WHEN 9  THEN 2&#xd;&#xa;			                        WHEN 10 THEN 3&#xd;&#xa;			                        ELSE 1&#xd;&#xa;			                    END AS natureza_procedimento&#xd;&#xa;			                 , TO_CHAR&#x28;licitacao.timestamp,&#x27;ddmmyyyy&#x27;&#x29; AS dt_abertura&#xd;&#xa;			                 &#xd;&#xa;			                 , TO_CHAR&#x28;licitacao.timestamp,&#x27;ddmmyyyy&#x27;&#x29; AS dt_edital_convite&#xd;&#xa;			                 , diario_oficial.dt_publicacao_edital&#xd;&#xa;			                 , publicacao_edital_veiculo1.dt_publicacao_edital_veiculo1&#xd;&#xa;			                 , publicacao_edital_veiculo1.veiculo1_publicacao&#xd;&#xa;			                 , publicacao_edital_veiculo2.dt_publicacao_edital_veiculo2&#xd;&#xa;			                 , publicacao_edital_veiculo2.veiculo2_publicacao&#xd;&#xa;			                 &#xd;&#xa;			                 , TO_CHAR&#x28;licitacao.timestamp,&#x27;ddmmyyyy&#x27;&#x29; AS dt_recebimento_doc&#xd;&#xa;			                 , licitacao.cod_criterio AS tipo_licitacao&#xd;&#xa;			                 , CASE licitacao.cod_tipo_objeto&#xd;&#xa;			                        WHEN 2 THEN 1&#xd;&#xa;			                        WHEN 1 THEN 2&#xd;&#xa;			                        WHEN 3 THEN 4&#xd;&#xa;			                        WHEN 4 THEN 6&#xd;&#xa;			                    END AS natureza_objeto&#xd;&#xa;			                 , objeto.descricao AS objeto&#xd;&#xa;			                 , CASE WHEN licitacao.cod_tipo_objeto &#x3d; 2&#xd;&#xa;			                        THEN licitacao.cod_regime&#xd;&#xa;			                        ELSE NULL&#xd;&#xa;			                    END AS regime_execucao_obras&#xd;&#xa;			                 , CASE WHEN &#x28;licitacao.cod_modalidade &#x3d; 1&#x29;&#xd;&#xa;			                        THEN convidados.nrm_convidado&#xd;&#xa;			                    END AS num_convidado&#xd;&#xa;			                 , LPAD&#x28;&#x27;&#x27;,250,&#x27;&#x27;&#x29; AS clausula_prorrogacao&#xd;&#xa;			                 , 1 AS undade_medida_prazo_execucao&#xd;&#xa;			                 , &#x28;DATE&#x28;contrato.fim_execucao&#x29;-DATE&#x28;contrato.inicio_execucao&#x29;&#x29; AS prazo_execucao&#xd;&#xa;			                 , regexp_replace&#x28;sem_acentos&#x28;edital.condicoes_pagamento&#x29;,&#x27;&#x5b;&#xba;&#x7c;&#xb0;&#x7c;&#x25;&#x7c;&#xa7;&#x5d;&#x27;, &#x27;&#x27;, &#x27;gi&#x27;&#x29; AS forma_pagamento&#xd;&#xa;			                 , LPAD&#x28;&#x27;&#x27;,80,&#x27;&#x27;&#x29; AS citerio_aceitabilidade&#xd;&#xa;			                 , 2 AS desconto_tabela&#xd;&#xa;			                 , CASE WHEN mapa.cod_tipo_licitacao &#x3d; 2&#xd;&#xa;			                        THEN 1&#xd;&#xa;			                        ELSE 2&#xd;&#xa;			                    END AS processo_lote&#xd;&#xa;			                 , 1 AS criterio_desempate&#xd;&#xa;			                 , 2 AS destinacao_exclusiva&#xd;&#xa;			                 , 2 AS subcontratacao&#xd;&#xa;			                 , 2 AS limite_contratacao&#xd;&#xa;			              FROM licitacao.homologacao&#xd;&#xa;			         LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;			                ON homologacao.num_homologacao     &#x3d; homologacao_anulada.num_homologacao&#xd;&#xa;			               AND homologacao.cod_licitacao       &#x3d; homologacao_anulada.cod_licitacao&#xd;&#xa;			               AND homologacao.cod_modalidade      &#x3d; homologacao_anulada.cod_modalidade&#xd;&#xa;			               AND homologacao.cod_entidade        &#x3d; homologacao_anulada.cod_entidade&#xd;&#xa;			               AND homologacao.num_adjudicacao     &#x3d; homologacao_anulada.num_adjudicacao&#xd;&#xa;			               AND homologacao.exercicio_licitacao &#x3d; homologacao_anulada.exercicio_licitacao&#xd;&#xa;			               AND homologacao.lote                &#x3d; homologacao_anulada.lote&#xd;&#xa;			               AND homologacao.cod_cotacao         &#x3d; homologacao_anulada.cod_cotacao&#xd;&#xa;			               AND homologacao.cod_item            &#x3d; homologacao_anulada.cod_item&#xd;&#xa;			               AND homologacao.exercicio_cotacao   &#x3d; homologacao_anulada.exercicio_cotacao&#xd;&#xa;			               AND homologacao.cgm_fornecedor      &#x3d; homologacao_anulada.cgm_fornecedor&#xd;&#xa;			        INNER JOIN licitacao.adjudicacao&#xd;&#xa;			                ON adjudicacao.num_adjudicacao     &#x3d; homologacao.num_adjudicacao&#xd;&#xa;			               AND adjudicacao.cod_entidade        &#x3d; homologacao.cod_entidade&#xd;&#xa;			               AND adjudicacao.cod_modalidade      &#x3d; homologacao.cod_modalidade&#xd;&#xa;			               AND adjudicacao.cod_licitacao       &#x3d; homologacao.cod_licitacao&#xd;&#xa;			               AND adjudicacao.exercicio_licitacao &#x3d; homologacao.exercicio_licitacao&#xd;&#xa;			               AND adjudicacao.cod_item            &#x3d; homologacao.cod_item&#xd;&#xa;			               AND adjudicacao.cod_cotacao         &#x3d; homologacao.cod_cotacao&#xd;&#xa;			               AND adjudicacao.lote                &#x3d; homologacao.lote&#xd;&#xa;			               AND adjudicacao.exercicio_cotacao   &#x3d; homologacao.exercicio_cotacao&#xd;&#xa;			               AND adjudicacao.cgm_fornecedor      &#x3d; homologacao.cgm_fornecedor&#xd;&#xa;			        INNER JOIN licitacao.cotacao_licitacao&#xd;&#xa;			                ON cotacao_licitacao.cod_modalidade      &#x3d; adjudicacao.cod_modalidade&#xd;&#xa;			               AND cotacao_licitacao.cod_licitacao       &#x3d; adjudicacao.cod_licitacao&#xd;&#xa;			               AND cotacao_licitacao.cod_entidade        &#x3d; adjudicacao.cod_entidade&#xd;&#xa;			               AND cotacao_licitacao.exercicio_licitacao &#x3d; adjudicacao.exercicio_licitacao&#xd;&#xa;			               AND cotacao_licitacao.lote                &#x3d; adjudicacao.lote&#xd;&#xa;			               AND cotacao_licitacao.cod_cotacao         &#x3d; adjudicacao.cod_cotacao&#xd;&#xa;			               AND cotacao_licitacao.cod_item            &#x3d; adjudicacao.cod_item&#xd;&#xa;			               AND cotacao_licitacao.exercicio_cotacao   &#x3d; adjudicacao.exercicio_cotacao&#xd;&#xa;			               AND cotacao_licitacao.cgm_fornecedor      &#x3d; adjudicacao.cgm_fornecedor&#xd;&#xa;			        INNER JOIN &#x28;SELECT licitacao.&#x2a;&#xd;&#xa;			                         , &#x28;SELECT exercicio&#xd;&#xa;			                              FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, StEntidade&#x29;    &#xd;&#xa;			                            VALUES &#x28; cod_licitacao       INTEGER&#xd;&#xa;			                                   , cod_modalidade      INTEGER&#xd;&#xa;			                                   , cod_entidade        INTEGER&#xd;&#xa;			                                   , exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;			                                   , exercicio_licitacao VARCHAR&#xd;&#xa;			                                   , num_licitacao       TEXT &#x29;&#xd;&#xa;			                             WHERE cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;			                               AND cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                               AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                               AND exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;			                           &#x29; AS exercicio_licitacao&#xd;&#xa;			                         , &#x28;SELECT num_licitacao&#xd;&#xa;			                              FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;     &#xd;&#xa;			                            VALUES &#x28; cod_licitacao       INTEGER&#xd;&#xa;			                                   , cod_modalidade      INTEGER&#xd;&#xa;			                                   , cod_entidade        INTEGER&#xd;&#xa;			                                   , exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;			                                   , exercicio_licitacao VARCHAR&#xd;&#xa;			                                   , num_licitacao       TEXT &#x29;&#xd;&#xa;			                             WHERE cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;			                               AND cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                               AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                               AND exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;			                           &#x29; AS num_processo_licitatorio&#xd;&#xa;			                      FROM licitacao.licitacao&#xd;&#xa;			                   &#x29; AS licitacao&#xd;&#xa;			                ON licitacao.cod_licitacao  &#x3d; cotacao_licitacao.cod_licitacao&#xd;&#xa;			               AND licitacao.cod_modalidade &#x3d; cotacao_licitacao.cod_modalidade&#xd;&#xa;			               AND licitacao.cod_entidade   &#x3d; cotacao_licitacao.cod_entidade&#xd;&#xa;			               AND licitacao.exercicio      &#x3d; cotacao_licitacao.exercicio_licitacao&#xd;&#xa;			         LEFT JOIN licitacao.licitacao_anulada&#xd;&#xa;			                ON licitacao.cod_licitacao  &#x3d; licitacao_anulada.cod_licitacao&#xd;&#xa;			               AND licitacao.cod_modalidade &#x3d; licitacao_anulada.cod_modalidade&#xd;&#xa;			               AND licitacao.cod_entidade   &#x3d; licitacao_anulada.cod_entidade&#xd;&#xa;			               AND licitacao.exercicio      &#x3d; licitacao_anulada.exercicio&#xd;&#xa;			        INNER JOIN licitacao.edital&#xd;&#xa;			                ON edital.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;			               AND edital.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;			               AND edital.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;			               AND edital.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;			         LEFT JOIN licitacao.edital_anulado&#xd;&#xa;			                ON edital.num_edital &#x3d; edital_anulado.num_edital&#xd;&#xa;			               AND edital.exercicio  &#x3d; edital_anulado.exercicio&#xd;&#xa;			         LEFT JOIN licitacao.contrato_licitacao&#xd;&#xa;			                ON licitacao.cod_licitacao  &#x3d; contrato_licitacao.cod_licitacao&#xd;&#xa;			               AND licitacao.cod_modalidade &#x3d; contrato_licitacao.cod_modalidade&#xd;&#xa;			               AND licitacao.cod_entidade   &#x3d; contrato_licitacao.cod_entidade&#xd;&#xa;			               AND licitacao.exercicio      &#x3d; contrato_licitacao.exercicio_licitacao&#xd;&#xa;			         LEFT JOIN licitacao.contrato&#xd;&#xa;			                ON contrato_licitacao.num_contrato &#x3d; contrato.num_contrato&#xd;&#xa;			               AND contrato_licitacao.cod_entidade &#x3d; contrato.cod_entidade&#xd;&#xa;			               AND contrato_licitacao.exercicio    &#x3d; contrato.exercicio&#xd;&#xa;			        INNER JOIN compras.objeto&#xd;&#xa;			                ON objeto.cod_objeto &#x3d; licitacao.cod_objeto&#xd;&#xa;			        INNER JOIN compras.mapa&#xd;&#xa;			                ON mapa.exercicio &#x3d; licitacao.exercicio_mapa&#xd;&#xa;			               AND mapa.cod_mapa  &#x3d; licitacao.cod_mapa&#xd;&#xa;			        INNER JOIN compras.mapa_cotacao&#xd;&#xa;			                ON mapa_cotacao.exercicio_mapa &#x3d; mapa.exercicio&#xd;&#xa;			               AND mapa_cotacao.cod_mapa       &#x3d; mapa.cod_mapa&#xd;&#xa;			        INNER JOIN compras.cotacao&#xd;&#xa;			                ON cotacao.exercicio   &#x3d; mapa_cotacao.exercicio_cotacao&#xd;&#xa;			               AND cotacao.cod_cotacao &#x3d; mapa_cotacao.cod_cotacao&#xd;&#xa;			        INNER JOIN compras.julgamento&#xd;&#xa;			                ON julgamento.exercicio   &#x3d; cotacao.exercicio&#xd;&#xa;			               AND julgamento.cod_cotacao &#x3d; cotacao.cod_cotacao&#xd;&#xa;			        INNER JOIN compras.julgamento_item&#xd;&#xa;			                ON julgamento_item.exercicio   &#x3d; julgamento.exercicio&#xd;&#xa;			               AND julgamento_item.cod_cotacao &#x3d; julgamento.cod_cotacao&#xd;&#xa;			               AND julgamento_item.cgm_fornecedor &#x3d; homologacao.cgm_fornecedor&#xd;&#xa;			               AND julgamento_item.lote           &#x3d; homologacao.lote&#xd;&#xa;			               AND julgamento_item.cod_item       &#x3d; homologacao.cod_item&#xd;&#xa;			               AND julgamento_item.ordem &#x3d; 1&#xd;&#xa;			        INNER JOIN compras.cotacao_fornecedor_item&#xd;&#xa;			                ON cotacao_fornecedor_item.exercicio      &#x3d; julgamento_item.exercicio&#xd;&#xa;			               AND cotacao_fornecedor_item.cod_cotacao    &#x3d; julgamento_item.cod_cotacao&#xd;&#xa;			               AND cotacao_fornecedor_item.cod_item       &#x3d; julgamento_item.cod_item&#xd;&#xa;			               AND cotacao_fornecedor_item.cgm_fornecedor &#x3d; julgamento_item.cgm_fornecedor&#xd;&#xa;			               AND cotacao_fornecedor_item.lote           &#x3d; julgamento_item.lote&#xd;&#xa;			        INNER JOIN compras.fornecedor&#xd;&#xa;			                ON fornecedor.cgm_fornecedor &#x3d; cotacao_fornecedor_item.cgm_fornecedor&#xd;&#xa;			               AND fornecedor.ativo IS TRUE&#xd;&#xa;			         LEFT JOIN &#x28;SELECT TO_CHAR&#x28;publicacao_edital.data_publicacao,&#x27;ddmmyyyy&#x27;&#x29; AS dt_publicacao_edital&#xd;&#xa;			                         , publicacao_edital.num_edital&#xd;&#xa;			                         , publicacao_edital.exercicio&#xd;&#xa;			                      FROM licitacao.publicacao_edital&#xd;&#xa;			                INNER JOIN licitacao.veiculos_publicidade&#xd;&#xa;			                        ON veiculos_publicidade.numcgm &#x3d; publicacao_edital.numcgm&#xd;&#xa;			                     WHERE veiculos_publicidade.cod_tipo_veiculos_publicidade &#x3d; 5&#xd;&#xa;			                   &#x29; AS diario_oficial&#xd;&#xa;			                ON diario_oficial.num_edital &#x3d; edital.num_edital&#xd;&#xa;			               AND diario_oficial.exercicio  &#x3d; edital.exercicio&#xd;&#xa;			         LEFT JOIN &#x28;SELECT row_number&#x28;&#x29; OVER&#x28;ORDER BY tipo_veiculos_publicidade.cod_tipo_veiculos_publicidade ASC&#x29; AS pos&#xd;&#xa;			                         , TO_CHAR&#x28;publicacao_edital.data_publicacao,&#x27;ddmmyyyy&#x27;&#x29; AS dt_publicacao_edital_veiculo1&#xd;&#xa;			                         , tipo_veiculos_publicidade.descricao AS veiculo1_publicacao&#xd;&#xa;			                         , publicacao_edital.num_edital&#xd;&#xa;			                         , publicacao_edital.exercicio&#xd;&#xa;			                      FROM licitacao.publicacao_edital&#xd;&#xa;			                INNER JOIN licitacao.veiculos_publicidade&#xd;&#xa;			                        ON veiculos_publicidade.numcgm &#x3d; publicacao_edital.numcgm&#xd;&#xa;			                INNER JOIN licitacao.tipo_veiculos_publicidade&#xd;&#xa;			                        ON tipo_veiculos_publicidade.cod_tipo_veiculos_publicidade &#x3d; veiculos_publicidade.cod_tipo_veiculos_publicidade&#xd;&#xa;			                     WHERE tipo_veiculos_publicidade.cod_tipo_veiculos_publicidade &#x3c;&#x3e; 5&#xd;&#xa;			                   &#x29; AS publicacao_edital_veiculo1&#xd;&#xa;			                ON publicacao_edital_veiculo1.num_edital &#x3d; edital.num_edital&#xd;&#xa;			               AND publicacao_edital_veiculo1.exercicio  &#x3d; edital.exercicio&#xd;&#xa;			               AND publicacao_edital_veiculo1.pos &#x3d; 1&#xd;&#xa;			         LEFT JOIN &#x28;SELECT row_number&#x28;&#x29; OVER&#x28;ORDER BY tipo_veiculos_publicidade.cod_tipo_veiculos_publicidade ASC&#x29; AS pos&#xd;&#xa;			                         , TO_CHAR&#x28;publicacao_edital.data_publicacao,&#x27;ddmmyyyy&#x27;&#x29; AS dt_publicacao_edital_veiculo2&#xd;&#xa;			                         , tipo_veiculos_publicidade.descricao AS veiculo2_publicacao&#xd;&#xa;			                         , publicacao_edital.num_edital&#xd;&#xa;			                         , publicacao_edital.exercicio&#xd;&#xa;			                      FROM licitacao.publicacao_edital&#xd;&#xa;			                INNER JOIN licitacao.veiculos_publicidade&#xd;&#xa;			                        ON veiculos_publicidade.numcgm &#x3d; publicacao_edital.numcgm&#xd;&#xa;			                INNER JOIN licitacao.tipo_veiculos_publicidade&#xd;&#xa;			                        ON tipo_veiculos_publicidade.cod_tipo_veiculos_publicidade &#x3d; veiculos_publicidade.cod_tipo_veiculos_publicidade&#xd;&#xa;			                     WHERE tipo_veiculos_publicidade.cod_tipo_veiculos_publicidade &#x3c;&#x3e; 5&#xd;&#xa;			                   &#x29; AS publicacao_edital_veiculo2&#xd;&#xa;			                ON publicacao_edital_veiculo2.num_edital &#x3d; edital.num_edital&#xd;&#xa;			               AND publicacao_edital_veiculo2.exercicio  &#x3d; edital.exercicio&#xd;&#xa;			               AND publicacao_edital_veiculo2.pos &#x3d; 2&#xd;&#xa;			         LEFT JOIN &#x28;SELECT COUNT &#x28;numcgm_representante&#x29; AS nrm_convidado&#xd;&#xa;			                         , participante.cod_licitacao&#xd;&#xa;			                         , participante.cod_modalidade&#xd;&#xa;			                         , participante.cod_entidade&#xd;&#xa;			                         , participante.exercicio&#xd;&#xa;			                      FROM licitacao.participante&#xd;&#xa;			                  GROUP BY cod_licitacao,cod_modalidade,cod_entidade,exercicio&#xd;&#xa;			                   &#x29; as convidados&#xd;&#xa;			                ON convidados.cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;			               AND convidados.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			               AND convidados.cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;			               AND convidados.exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;			        INNER JOIN administracao.configuracao_entidade&#xd;&#xa;			                ON configuracao_entidade.parametro    &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			               AND configuracao_entidade.cod_modulo   &#x3d; 55&#xd;&#xa;			               AND configuracao_entidade.exercicio    &#x3d; licitacao.exercicio&#xd;&#xa;			               AND configuracao_entidade.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             WHERE TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;         &#xd;&#xa;			                                                                                          AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c;&#x27;-&#x27;&#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c;&#x27;-&#x27;&#x7c;&#x7c;&#x27;01&#x27;, &#x27;yyyy-mm-dd&#x27;&#x29;&#x29;  &#xd;&#xa;			               AND homologacao_anulada.num_homologacao IS NULL&#xd;&#xa;			               AND licitacao_anulada.cod_licitacao IS NULL&#xd;&#xa;			               AND edital_anulado.num_edital IS NULL&#xd;&#xa;			               AND homologacao.homologado IS TRUE&#xd;&#xa;			               AND licitacao.cod_modalidade NOT IN &#x28;8,9&#x29;&#xd;&#xa;			               AND licitacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;			          GROUP BY tipo_registro&#xd;&#xa;			                 , cod_orgao_resp&#xd;&#xa;			                 , cod_unidade_resp&#xd;&#xa;			                 , licitacao.exercicio_licitacao&#xd;&#xa;			                 , licitacao.num_processo_licitatorio&#xd;&#xa;			                 , cod_modalidade_licitacao&#xd;&#xa;			                 , num_modalidade&#xd;&#xa;			                 , natureza_procedimento&#xd;&#xa;			                 , dt_abertura&#xd;&#xa;			                 , dt_edital_convite&#xd;&#xa;			                 , dt_publicacao_edital&#xd;&#xa;			                 , dt_publicacao_edital_veiculo1&#xd;&#xa;			                 , veiculo1_publicacao&#xd;&#xa;			                 , dt_publicacao_edital_veiculo2&#xd;&#xa;			                 , veiculo2_publicacao&#xd;&#xa;			                 , dt_recebimento_doc&#xd;&#xa;			                 , tipo_licitacao&#xd;&#xa;			                 , natureza_objeto&#xd;&#xa;			                 , objeto&#xd;&#xa;			                 , regime_execucao_obras&#xd;&#xa;			                 , num_convidado&#xd;&#xa;			                 , clausula_prorrogacao&#xd;&#xa;			                 , undade_medida_prazo_execucao&#xd;&#xa;			                 , &#x28;DATE&#x28;contrato.fim_execucao&#x29;-DATE&#x28;contrato.inicio_execucao&#x29;&#x29;&#xd;&#xa;			                 , forma_pagamento&#xd;&#xa;			                 , citerio_aceitabilidade&#xd;&#xa;			                 , desconto_tabela&#xd;&#xa;			                 , processo_lote&#xd;&#xa;			                 , criterio_desempate&#xd;&#xa;			                 , destinacao_exclusiva&#xd;&#xa;			                 , subcontratacao&#xd;&#xa;			                 , limite_contratacao&#xd;&#xa;			                 , objeto.descricao&#xd;&#xa;			                 , edital.condicoes_pagamento&#xd;&#xa;			&#x29;,&#xd;&#xa;			 aberlic11 as&#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT 11 AS tipo_registro&#xd;&#xa;				                 , LPAD&#x28;configuracao_entidade.valor,2,&#x27;0&#x27;&#x29; AS cod_orgao_resp&#xd;&#xa;				                 , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade_resp&#xd;&#xa;				                 , config_licitacao.exercicio_licitacao&#xd;&#xa;				                 , config_licitacao.num_licitacao AS num_processo_licitatorio&#xd;&#xa;				                 , homologacao.lote AS num_lote&#xd;&#xa;				                 , homologacao.lote AS desc_lote&#xd;&#xa;				              FROM licitacao.licitacao&#xd;&#xa;				        INNER JOIN sw_processo&#xd;&#xa;				                ON sw_processo.cod_processo &#x3d; licitacao.cod_processo&#xd;&#xa;				               AND sw_processo.ano_exercicio &#x3d; licitacao.exercicio_processo&#xd;&#xa;				        INNER JOIN licitacao.criterio_julgamento&#xd;&#xa;				                ON criterio_julgamento.cod_criterio &#x3d; licitacao.cod_criterio&#xd;&#xa;				        INNER JOIN licitacao.edital&#xd;&#xa;				                ON edital.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;				               AND edital.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;				               AND edital.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;				               AND edital.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;				         LEFT JOIN licitacao.edital_anulado&#xd;&#xa;				                ON edital.num_edital&#x3d;edital_anulado.num_edital&#xd;&#xa;				               AND edital.exercicio &#x3d;edital_anulado.exercicio&#xd;&#xa;				        INNER JOIN compras.objeto&#xd;&#xa;				                ON objeto.cod_objeto &#x3d; licitacao.cod_objeto&#xd;&#xa;				        INNER JOIN compras.tipo_objeto&#xd;&#xa;				                ON tipo_objeto.cod_tipo_objeto &#x3d; licitacao.cod_tipo_objeto&#xd;&#xa;				        INNER JOIN compras.modalidade&#xd;&#xa;				                ON modalidade.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;				        INNER JOIN compras.mapa&#xd;&#xa;				                ON mapa.exercicio &#x3d; licitacao.exercicio_mapa&#xd;&#xa;				               AND mapa.cod_mapa &#x3d; licitacao.cod_mapa&#xd;&#xa;				               AND mapa.cod_tipo_licitacao &#x3d; 2&#xd;&#xa;				        INNER JOIN compras.tipo_licitacao&#xd;&#xa;				                ON tipo_licitacao.cod_tipo_licitacao &#x3d; licitacao.cod_tipo_licitacao&#xd;&#xa;				        INNER JOIN compras.mapa_solicitacao&#xd;&#xa;				                ON mapa_solicitacao.exercicio &#x3d; mapa.exercicio&#xd;&#xa;				               AND mapa_solicitacao.cod_mapa &#x3d; mapa.cod_mapa&#xd;&#xa;				        INNER JOIN compras.mapa_cotacao&#xd;&#xa;				                ON mapa_cotacao.exercicio_mapa &#x3d; mapa.exercicio&#xd;&#xa;				               AND mapa_cotacao.cod_mapa &#x3d; mapa.cod_mapa&#xd;&#xa;				        INNER JOIN compras.cotacao&#xd;&#xa;				                ON cotacao.exercicio &#x3d; mapa_cotacao.exercicio_cotacao&#xd;&#xa;				               AND cotacao.cod_cotacao &#x3d; mapa_cotacao.cod_cotacao&#xd;&#xa;				        INNER JOIN compras.julgamento&#xd;&#xa;				                ON julgamento.exercicio &#x3d; cotacao.exercicio&#xd;&#xa;				               AND julgamento.cod_cotacao &#x3d; cotacao.cod_cotacao&#xd;&#xa;				        INNER JOIN compras.julgamento_item&#xd;&#xa;				                ON julgamento_item.exercicio &#x3d; julgamento.exercicio&#xd;&#xa;				               AND julgamento_item.cod_cotacao &#x3d; julgamento.cod_cotacao&#xd;&#xa;				        INNER JOIN compras.cotacao_fornecedor_item&#xd;&#xa;				                ON cotacao_fornecedor_item.exercicio &#x3d; julgamento_item.exercicio&#xd;&#xa;				               AND cotacao_fornecedor_item.cod_cotacao &#x3d; julgamento_item.cod_cotacao&#xd;&#xa;				               AND cotacao_fornecedor_item.cod_item &#x3d; julgamento_item.cod_item&#xd;&#xa;				               AND cotacao_fornecedor_item.cgm_fornecedor &#x3d; julgamento_item.cgm_fornecedor&#xd;&#xa;				               AND cotacao_fornecedor_item.lote &#x3d; julgamento_item.lote&#xd;&#xa;				        INNER JOIN compras.fornecedor&#xd;&#xa;				                ON fornecedor.cgm_fornecedor &#x3d; cotacao_fornecedor_item.cgm_fornecedor&#xd;&#xa;				        INNER JOIN licitacao.homologacao&#xd;&#xa;				                ON homologacao.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;				               AND homologacao.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;				               AND homologacao.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;				               AND homologacao.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;				               AND homologacao.cod_item&#x3d;julgamento_item.cod_item&#xd;&#xa;				               AND homologacao.lote&#x3d;julgamento_item.lote&#xd;&#xa;				         LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;				                ON homologacao.num_homologacao     &#x3d; homologacao_anulada.num_homologacao&#xd;&#xa;				               AND homologacao.cod_licitacao       &#x3d; homologacao_anulada.cod_licitacao&#xd;&#xa;				               AND homologacao.cod_modalidade      &#x3d; homologacao_anulada.cod_modalidade&#xd;&#xa;				               AND homologacao.cod_entidade        &#x3d; homologacao_anulada.cod_entidade&#xd;&#xa;				               AND homologacao.num_adjudicacao     &#x3d; homologacao_anulada.num_adjudicacao&#xd;&#xa;				               AND homologacao.exercicio_licitacao &#x3d; homologacao_anulada.exercicio_licitacao&#xd;&#xa;				               AND homologacao.lote                &#x3d; homologacao_anulada.lote&#xd;&#xa;				               AND homologacao.cod_cotacao         &#x3d; homologacao_anulada.cod_cotacao&#xd;&#xa;				               AND homologacao.cod_item            &#x3d; homologacao_anulada.cod_item&#xd;&#xa;				               AND homologacao.exercicio_cotacao   &#x3d; homologacao_anulada.exercicio_cotacao&#xd;&#xa;				               AND homologacao.cgm_fornecedor      &#x3d; homologacao_anulada.cgm_fornecedor&#xd;&#xa;				        INNER JOIN compras.solicitacao_homologada&#xd;&#xa;				                ON solicitacao_homologada.exercicio&#x3d;mapa_solicitacao.exercicio_solicitacao&#xd;&#xa;				               AND solicitacao_homologada.cod_entidade&#x3d;mapa_solicitacao.cod_entidade&#xd;&#xa;				               AND solicitacao_homologada.cod_solicitacao&#x3d;mapa_solicitacao.cod_solicitacao&#xd;&#xa;				        LEFT JOIN compras.solicitacao_homologada_reserva&#xd;&#xa;				                ON solicitacao_homologada_reserva.exercicio&#x3d;solicitacao_homologada.exercicio&#xd;&#xa;				               AND solicitacao_homologada_reserva.cod_entidade&#x3d;solicitacao_homologada.cod_entidade&#xd;&#xa;				               AND solicitacao_homologada_reserva.cod_solicitacao&#x3d;solicitacao_homologada.cod_solicitacao&#xd;&#xa;				        LEFT JOIN orcamento.despesa&#xd;&#xa;				                ON despesa.exercicio &#x3d; solicitacao_homologada_reserva.exercicio&#xd;&#xa;				               AND despesa.cod_despesa &#x3d; solicitacao_homologada_reserva.cod_despesa&#xd;&#xa;				        INNER JOIN administracao.configuracao_entidade&#xd;&#xa;				                ON configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;				               AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;				               AND configuracao_entidade.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;				               AND configuracao_entidade.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;				        INNER JOIN sw_cgm AS responsavel&#xd;&#xa;				                ON responsavel.numcgm &#x3d; edital.responsavel_juridico&#xd;&#xa;				        INNER JOIN &#x28; SELECT num_documento, numcgm, tipo_documento&#xd;&#xa;				                       FROM &#x28;&#xd;&#xa;				                              SELECT cpf AS num_documento, numcgm, 1 AS tipo_documento&#xd;&#xa;				                              FROM sw_cgm_pessoa_fisica&#xd;&#xa;				                              UNION&#xd;&#xa;				                              SELECT cnpj AS num_documento, numcgm, 2 AS tipo_documento&#xd;&#xa;				                              FROM sw_cgm_pessoa_juridica&#xd;&#xa;				                           &#x29; AS tabela&#xd;&#xa;				                      GROUP BY numcgm, num_documento, tipo_documento&#xd;&#xa;				                   &#x29; AS documento_pessoa&#xd;&#xa;				                ON documento_pessoa.numcgm &#x3d; responsavel.numcgm&#xd;&#xa;				         LEFT JOIN licitacao.contrato_licitacao&#xd;&#xa;				                ON contrato_licitacao.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;				               AND contrato_licitacao.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;				               AND contrato_licitacao.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;				               AND contrato_licitacao.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;				         LEFT JOIN licitacao.contrato&#xd;&#xa;				                ON contrato.num_contrato&#x3d;contrato_licitacao.num_contrato&#xd;&#xa;				               AND contrato.cod_entidade&#x3d;contrato_licitacao.cod_entidade&#xd;&#xa;				               AND contrato.exercicio&#x3d;contrato_licitacao.exercicio&#xd;&#xa;				        INNER JOIN &#x28;&#xd;&#xa;				                       SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;      &#xd;&#xa;				                                VALUES &#x28;cod_licitacao   INTEGER&#xd;&#xa;				                                   ,cod_modalidade    INTEGER&#xd;&#xa;				                                   ,cod_entidade    INTEGER&#xd;&#xa;				                                   ,exercicio     CHAR&#x28;4&#x29;&#xd;&#xa;				                                   ,exercicio_licitacao VARCHAR&#xd;&#xa;				                                   ,num_licitacao   TEXT &#x29;&#xd;&#xa;				                   &#x29; AS config_licitacao&#xd;&#xa;				                ON config_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;				               AND config_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;				               AND config_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;				               AND config_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;				             WHERE TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; BETWEEN TO_DATE&#x28;&#x27;01&#x2f;02&#x2f;2016&#x27;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;        &#xd;&#xa;				               AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29;  &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;        &#xd;&#xa;				               AND homologacao_anulada.num_homologacao IS NULL&#xd;&#xa;				               AND edital_anulado.num_edital IS NULL&#xd;&#xa;				               AND licitacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;          &#xd;&#xa;				               AND licitacao.cod_modalidade NOT IN &#x28;8,9&#x29;&#xd;&#xa;				               AND NOT EXISTS&#x28; SELECT 1&#xd;&#xa;				                                 FROM licitacao.licitacao_anulada&#xd;&#xa;				                                WHERE licitacao_anulada.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;				                                  AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;				                                  AND licitacao_anulada.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;				                                  AND licitacao_anulada.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;				                             &#x29;&#xd;&#xa;				          GROUP BY licitacao.cod_licitacao, licitacao.cod_modalidade, tipo_registro, cod_orgao_resp, cod_unidade_resp, licitacao.exercicio, num_processo_licitatorio, num_lote, config_licitacao.exercicio_licitacao, config_licitacao.num_licitacao&#xd;&#xa;				          ORDER BY licitacao.cod_licitacao, licitacao.cod_modalidade, num_processo_licitatorio, cod_unidade_resp&#xd;&#xa;			&#x29;,&#xd;&#xa;			aberlic12 as&#xd;&#xa;			&#x28;&#xd;&#xa;		            SELECT 12 AS tipo_registro&#xd;&#xa;			                 , LPAD&#x28;configuracao_entidade.valor,2,&#x27;0&#x27;&#x29; AS cod_orgao_resp&#xd;&#xa;			                 , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade_resp&#xd;&#xa;			                 , licitacao.exercicio_licitacao&#xd;&#xa;			                 , licitacao.num_processo_licitatorio&#xd;&#xa;			                 , homologacao.cod_item AS cod_item&#xd;&#xa;			              FROM licitacao.homologacao&#xd;&#xa;			         LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;			                ON homologacao.num_homologacao     &#x3d; homologacao_anulada.num_homologacao&#xd;&#xa;			               AND homologacao.cod_licitacao       &#x3d; homologacao_anulada.cod_licitacao&#xd;&#xa;			               AND homologacao.cod_modalidade      &#x3d; homologacao_anulada.cod_modalidade&#xd;&#xa;			               AND homologacao.cod_entidade        &#x3d; homologacao_anulada.cod_entidade&#xd;&#xa;			               AND homologacao.num_adjudicacao     &#x3d; homologacao_anulada.num_adjudicacao&#xd;&#xa;			               AND homologacao.exercicio_licitacao &#x3d; homologacao_anulada.exercicio_licitacao&#xd;&#xa;			               AND homologacao.lote                &#x3d; homologacao_anulada.lote&#xd;&#xa;			               AND homologacao.cod_cotacao         &#x3d; homologacao_anulada.cod_cotacao&#xd;&#xa;			               AND homologacao.cod_item            &#x3d; homologacao_anulada.cod_item&#xd;&#xa;			               AND homologacao.exercicio_cotacao   &#x3d; homologacao_anulada.exercicio_cotacao&#xd;&#xa;			               AND homologacao.cgm_fornecedor      &#x3d; homologacao_anulada.cgm_fornecedor&#xd;&#xa;			        INNER JOIN licitacao.adjudicacao&#xd;&#xa;			                ON adjudicacao.num_adjudicacao     &#x3d; homologacao.num_adjudicacao&#xd;&#xa;			               AND adjudicacao.cod_entidade        &#x3d; homologacao.cod_entidade&#xd;&#xa;			               AND adjudicacao.cod_modalidade      &#x3d; homologacao.cod_modalidade&#xd;&#xa;			               AND adjudicacao.cod_licitacao       &#x3d; homologacao.cod_licitacao&#xd;&#xa;			               AND adjudicacao.exercicio_licitacao &#x3d; homologacao.exercicio_licitacao&#xd;&#xa;			               AND adjudicacao.cod_item            &#x3d; homologacao.cod_item&#xd;&#xa;			               AND adjudicacao.cod_cotacao         &#x3d; homologacao.cod_cotacao&#xd;&#xa;			               AND adjudicacao.lote                &#x3d; homologacao.lote&#xd;&#xa;			               AND adjudicacao.exercicio_cotacao   &#x3d; homologacao.exercicio_cotacao&#xd;&#xa;			               AND adjudicacao.cgm_fornecedor      &#x3d; homologacao.cgm_fornecedor&#xd;&#xa;			        INNER JOIN licitacao.cotacao_licitacao&#xd;&#xa;			                ON cotacao_licitacao.cod_modalidade      &#x3d; adjudicacao.cod_modalidade&#xd;&#xa;			               AND cotacao_licitacao.cod_licitacao       &#x3d; adjudicacao.cod_licitacao&#xd;&#xa;			               AND cotacao_licitacao.cod_entidade        &#x3d; adjudicacao.cod_entidade&#xd;&#xa;			               AND cotacao_licitacao.exercicio_licitacao &#x3d; adjudicacao.exercicio_licitacao&#xd;&#xa;			               AND cotacao_licitacao.lote                &#x3d; adjudicacao.lote&#xd;&#xa;			               AND cotacao_licitacao.cod_cotacao         &#x3d; adjudicacao.cod_cotacao&#xd;&#xa;			               AND cotacao_licitacao.cod_item            &#x3d; adjudicacao.cod_item&#xd;&#xa;			               AND cotacao_licitacao.exercicio_cotacao   &#x3d; adjudicacao.exercicio_cotacao&#xd;&#xa;			               AND cotacao_licitacao.cgm_fornecedor      &#x3d; adjudicacao.cgm_fornecedor&#xd;&#xa;			        INNER JOIN &#x28;SELECT licitacao.&#x2a;&#xd;&#xa;			                         , &#x28;SELECT exercicio&#xd;&#xa;			                              FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;      &#xd;&#xa;			                            VALUES &#x28; cod_licitacao       INTEGER&#xd;&#xa;			                                   , cod_modalidade      INTEGER&#xd;&#xa;			                                   , cod_entidade        INTEGER&#xd;&#xa;			                                   , exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;			                                   , exercicio_licitacao VARCHAR&#xd;&#xa;			                                   , num_licitacao       TEXT &#x29;&#xd;&#xa;			                             WHERE cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;			                               AND cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                               AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                               AND exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;			                           &#x29; AS exercicio_licitacao&#xd;&#xa;			                         , &#x28;SELECT num_licitacao&#xd;&#xa;			                              FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;      &#xd;&#xa;			                            VALUES &#x28; cod_licitacao       INTEGER&#xd;&#xa;			                                   , cod_modalidade      INTEGER&#xd;&#xa;			                                   , cod_entidade        INTEGER&#xd;&#xa;			                                   , exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;			                                   , exercicio_licitacao VARCHAR&#xd;&#xa;			                                   , num_licitacao       TEXT &#x29;&#xd;&#xa;			                             WHERE cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;			                               AND cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                               AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                               AND exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;			                           &#x29; AS num_processo_licitatorio&#xd;&#xa;			                      FROM licitacao.licitacao&#xd;&#xa;			                   &#x29; AS licitacao&#xd;&#xa;			                ON licitacao.cod_licitacao  &#x3d; cotacao_licitacao.cod_licitacao&#xd;&#xa;			               AND licitacao.cod_modalidade &#x3d; cotacao_licitacao.cod_modalidade&#xd;&#xa;			               AND licitacao.cod_entidade   &#x3d; cotacao_licitacao.cod_entidade&#xd;&#xa;			               AND licitacao.exercicio      &#x3d; cotacao_licitacao.exercicio_licitacao&#xd;&#xa;			         LEFT JOIN licitacao.licitacao_anulada&#xd;&#xa;			                ON licitacao.cod_licitacao  &#x3d; licitacao_anulada.cod_licitacao&#xd;&#xa;			               AND licitacao.cod_modalidade &#x3d; licitacao_anulada.cod_modalidade&#xd;&#xa;			               AND licitacao.cod_entidade   &#x3d; licitacao_anulada.cod_entidade&#xd;&#xa;			               AND licitacao.exercicio      &#x3d; licitacao_anulada.exercicio&#xd;&#xa;			        INNER JOIN licitacao.edital&#xd;&#xa;			                ON edital.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;			               AND edital.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;			               AND edital.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;			               AND edital.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;			         LEFT JOIN licitacao.edital_anulado&#xd;&#xa;			                ON edital.num_edital&#x3d;edital_anulado.num_edital&#xd;&#xa;			               AND edital.exercicio &#x3d;edital_anulado.exercicio&#xd;&#xa;			        INNER JOIN compras.mapa&#xd;&#xa;			                ON mapa.exercicio &#x3d; licitacao.exercicio_mapa&#xd;&#xa;			               AND mapa.cod_mapa  &#x3d; licitacao.cod_mapa&#xd;&#xa;			        INNER JOIN administracao.configuracao_entidade&#xd;&#xa;			                ON configuracao_entidade.parametro    &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			               AND configuracao_entidade.cod_modulo   &#x3d; 55&#xd;&#xa;			               AND configuracao_entidade.exercicio    &#x3d; licitacao.exercicio&#xd;&#xa;			               AND configuracao_entidade.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;			             WHERE TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;         &#xd;&#xa;			                                                                                          AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c;&#x27;-&#x27;&#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c;&#x27;-&#x27;&#x7c;&#x7c;&#x27;01&#x27;, &#x27;yyyy-mm-dd&#x27;&#x29;&#x29;        &#xd;&#xa;			               AND homologacao_anulada.num_homologacao IS NULL&#xd;&#xa;			               AND homologacao.homologado IS TRUE&#xd;&#xa;			               AND licitacao_anulada.cod_licitacao IS NULL&#xd;&#xa;			               AND edital_anulado.num_edital IS NULL&#xd;&#xa;			               AND licitacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;           &#xd;&#xa;			               AND licitacao.cod_modalidade NOT IN &#x28;8,9&#x29;&#xd;&#xa;			          GROUP BY tipo_registro&#xd;&#xa;			                 , cod_orgao_resp&#xd;&#xa;			                 , cod_unidade_resp&#xd;&#xa;			                 , licitacao.exercicio_licitacao&#xd;&#xa;			                 , licitacao.num_processo_licitatorio&#xd;&#xa;			                 , homologacao.cod_item&#xd;&#xa;			&#x29;,&#xd;&#xa;			 aberlic13 as&#xd;&#xa;			&#x28;&#xd;&#xa;		            SELECT 13 AS tipo_registro&#xd;&#xa;		                 , LPAD&#x28;configuracao_entidade.valor,2,&#x27;0&#x27;&#x29; AS cod_orgao_resp&#xd;&#xa;		                 , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade_resp&#xd;&#xa;		                 , licitacao.exercicio_licitacao&#xd;&#xa;		                 , licitacao.num_processo_licitatorio&#xd;&#xa;		                 , homologacao.lote AS num_lote&#xd;&#xa;		                 , homologacao.cod_item AS cod_item&#xd;&#xa;		              FROM licitacao.homologacao&#xd;&#xa;		&#xd;&#xa;		         LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;		                ON homologacao.num_homologacao     &#x3d; homologacao_anulada.num_homologacao&#xd;&#xa;		               AND homologacao.cod_licitacao       &#x3d; homologacao_anulada.cod_licitacao&#xd;&#xa;		               AND homologacao.cod_modalidade      &#x3d; homologacao_anulada.cod_modalidade&#xd;&#xa;		               AND homologacao.cod_entidade        &#x3d; homologacao_anulada.cod_entidade&#xd;&#xa;		               AND homologacao.num_adjudicacao     &#x3d; homologacao_anulada.num_adjudicacao&#xd;&#xa;		               AND homologacao.exercicio_licitacao &#x3d; homologacao_anulada.exercicio_licitacao&#xd;&#xa;		               AND homologacao.lote                &#x3d; homologacao_anulada.lote&#xd;&#xa;		               AND homologacao.cod_cotacao         &#x3d; homologacao_anulada.cod_cotacao&#xd;&#xa;		               AND homologacao.cod_item            &#x3d; homologacao_anulada.cod_item&#xd;&#xa;		               AND homologacao.exercicio_cotacao   &#x3d; homologacao_anulada.exercicio_cotacao&#xd;&#xa;		               AND homologacao.cgm_fornecedor      &#x3d; homologacao_anulada.cgm_fornecedor&#xd;&#xa;		        INNER JOIN licitacao.adjudicacao&#xd;&#xa;		                ON adjudicacao.num_adjudicacao     &#x3d; homologacao.num_adjudicacao&#xd;&#xa;		               AND adjudicacao.cod_entidade        &#x3d; homologacao.cod_entidade&#xd;&#xa;		               AND adjudicacao.cod_modalidade      &#x3d; homologacao.cod_modalidade&#xd;&#xa;		               AND adjudicacao.cod_licitacao       &#x3d; homologacao.cod_licitacao&#xd;&#xa;		               AND adjudicacao.exercicio_licitacao &#x3d; homologacao.exercicio_licitacao&#xd;&#xa;		               AND adjudicacao.cod_item            &#x3d; homologacao.cod_item&#xd;&#xa;		               AND adjudicacao.cod_cotacao         &#x3d; homologacao.cod_cotacao&#xd;&#xa;		               AND adjudicacao.lote                &#x3d; homologacao.lote&#xd;&#xa;		               AND adjudicacao.exercicio_cotacao   &#x3d; homologacao.exercicio_cotacao&#xd;&#xa;		               AND adjudicacao.cgm_fornecedor      &#x3d; homologacao.cgm_fornecedor&#xd;&#xa;		        INNER JOIN licitacao.cotacao_licitacao&#xd;&#xa;		                ON cotacao_licitacao.cod_modalidade      &#x3d; adjudicacao.cod_modalidade&#xd;&#xa;		               AND cotacao_licitacao.cod_licitacao       &#x3d; adjudicacao.cod_licitacao&#xd;&#xa;		               AND cotacao_licitacao.cod_entidade        &#x3d; adjudicacao.cod_entidade&#xd;&#xa;		               AND cotacao_licitacao.exercicio_licitacao &#x3d; adjudicacao.exercicio_licitacao&#xd;&#xa;		               AND cotacao_licitacao.lote                &#x3d; adjudicacao.lote&#xd;&#xa;		               AND cotacao_licitacao.cod_cotacao         &#x3d; adjudicacao.cod_cotacao&#xd;&#xa;		               AND cotacao_licitacao.cod_item            &#x3d; adjudicacao.cod_item&#xd;&#xa;		               AND cotacao_licitacao.exercicio_cotacao   &#x3d; adjudicacao.exercicio_cotacao&#xd;&#xa;		               AND cotacao_licitacao.cgm_fornecedor      &#x3d; adjudicacao.cgm_fornecedor&#xd;&#xa;		        INNER JOIN &#x28;SELECT licitacao.&#x2a;&#xd;&#xa;		                         , &#x28;SELECT exercicio&#xd;&#xa;		                              FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;       &#xd;&#xa;		                            VALUES &#x28; cod_licitacao       INTEGER&#xd;&#xa;		                                   , cod_modalidade      INTEGER&#xd;&#xa;		                                   , cod_entidade        INTEGER&#xd;&#xa;		                                   , exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;		                                   , exercicio_licitacao VARCHAR&#xd;&#xa;		                                   , num_licitacao       TEXT &#x29;&#xd;&#xa;		                             WHERE cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;		                               AND cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                               AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                               AND exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;		                           &#x29; AS exercicio_licitacao&#xd;&#xa;		                         , &#x28;SELECT num_licitacao&#xd;&#xa;		                              FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;       &#xd;&#xa;		                            VALUES &#x28; cod_licitacao       INTEGER&#xd;&#xa;		                                   , cod_modalidade      INTEGER&#xd;&#xa;		                                   , cod_entidade        INTEGER&#xd;&#xa;		                                   , exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;		                                   , exercicio_licitacao VARCHAR&#xd;&#xa;		                                   , num_licitacao       TEXT &#x29;&#xd;&#xa;		                             WHERE cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;		                               AND cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                               AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                               AND exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;		                           &#x29; AS num_processo_licitatorio&#xd;&#xa;		                      FROM licitacao.licitacao&#xd;&#xa;		                   &#x29; AS licitacao&#xd;&#xa;		                ON licitacao.cod_licitacao  &#x3d; cotacao_licitacao.cod_licitacao&#xd;&#xa;		               AND licitacao.cod_modalidade &#x3d; cotacao_licitacao.cod_modalidade&#xd;&#xa;		               AND licitacao.cod_entidade   &#x3d; cotacao_licitacao.cod_entidade&#xd;&#xa;		               AND licitacao.exercicio      &#x3d; cotacao_licitacao.exercicio_licitacao&#xd;&#xa;		         LEFT JOIN licitacao.licitacao_anulada&#xd;&#xa;		                ON licitacao.cod_licitacao  &#x3d; licitacao_anulada.cod_licitacao&#xd;&#xa;		               AND licitacao.cod_modalidade &#x3d; licitacao_anulada.cod_modalidade&#xd;&#xa;		               AND licitacao.cod_entidade   &#x3d; licitacao_anulada.cod_entidade&#xd;&#xa;		               AND licitacao.exercicio      &#x3d; licitacao_anulada.exercicio&#xd;&#xa;		        INNER JOIN licitacao.edital&#xd;&#xa;		                ON edital.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;		               AND edital.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;		               AND edital.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;		               AND edital.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;		         LEFT JOIN licitacao.edital_anulado&#xd;&#xa;		                ON edital.num_edital&#x3d;edital_anulado.num_edital&#xd;&#xa;		               AND edital.exercicio &#x3d;edital_anulado.exercicio&#xd;&#xa;		        INNER JOIN compras.mapa&#xd;&#xa;		                ON mapa.exercicio &#x3d; licitacao.exercicio_mapa&#xd;&#xa;		               AND mapa.cod_mapa  &#x3d; licitacao.cod_mapa&#xd;&#xa;		               AND mapa.cod_tipo_licitacao &#x3d; 2&#xd;&#xa;		        INNER JOIN compras.mapa_item&#xd;&#xa;		                ON mapa_item.exercicio             &#x3d; licitacao.exercicio_mapa&#xd;&#xa;		               AND mapa_item.cod_mapa              &#x3d; licitacao.cod_mapa&#xd;&#xa;		               AND mapa_item.cod_entidade          &#x3d; homologacao.cod_entidade&#xd;&#xa;		               AND mapa_item.cod_item              &#x3d; homologacao.cod_item&#xd;&#xa;		        INNER JOIN administracao.configuracao_entidade&#xd;&#xa;		                ON configuracao_entidade.parametro    &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;		               AND configuracao_entidade.cod_modulo   &#x3d; 55&#xd;&#xa;		               AND configuracao_entidade.exercicio    &#x3d; licitacao.exercicio&#xd;&#xa;		               AND configuracao_entidade.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;		             WHERE TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;           &#xd;&#xa;		                                                                                          AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c;&#x27;-&#x27;&#x7c;&#x7c;lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c;&#x27;-&#x27;&#x7c;&#x7c;&#x27;01&#x27;, &#x27;yyyy-mm-dd&#x27;&#x29;&#x29;    &#xd;&#xa;		               AND homologacao_anulada.num_homologacao IS NULL&#xd;&#xa;		               AND homologacao.homologado IS TRUE&#xd;&#xa;		               AND licitacao_anulada.cod_licitacao IS NULL&#xd;&#xa;		               AND edital_anulado.num_edital IS NULL&#xd;&#xa;		               AND licitacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;     &#xd;&#xa;		               AND licitacao.cod_modalidade NOT IN &#x28;8,9&#x29;&#xd;&#xa;		          GROUP BY tipo_registro&#xd;&#xa;		                 , cod_orgao_resp&#xd;&#xa;		                 , cod_unidade_resp&#xd;&#xa;		                 , licitacao.exercicio_licitacao&#xd;&#xa;		                 , licitacao.num_processo_licitatorio&#xd;&#xa;		                 , num_lote&#xd;&#xa;		                 , homologacao.cod_item&#xd;&#xa;			&#x29;,&#xd;&#xa;			 aberlic14 as&#xd;&#xa;			&#x28;&#xd;&#xa;		            SELECT 14 AS tipo_registro&#xd;&#xa;		                 , LPAD&#x28;configuracao_entidade.valor,2,&#x27;0&#x27;&#x29; AS cod_orgao_resp&#xd;&#xa;		                 , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade_resp&#xd;&#xa;		                 , licitacao.exercicio_licitacao&#xd;&#xa;		                 , licitacao.num_processo_licitatorio&#xd;&#xa;		                 , CASE WHEN mapa.cod_tipo_licitacao &#x3d; 2&#xd;&#xa;		                        THEN homologacao.lote&#xd;&#xa;		                        ELSE NULL&#xd;&#xa;		                   END AS num_lote&#xd;&#xa;		                 , homologacao.cod_item AS cod_item&#xd;&#xa;		                 &#xd;&#xa;		                 , TO_CHAR&#x28;licitacao.timestamp,&#x27;ddmmyyyy&#x27;&#x29; AS dt_cotacao&#xd;&#xa;		                 , CASE WHEN licitacao.cod_tipo_objeto &#x3d; 4&#xd;&#xa;		                        THEN &#x28;&#x27;0,0000&#x27;&#x29;&#xd;&#xa;		                        ELSE &#x28;&#x28;cotacao_fornecedor_item.vl_cotacao&#x2f;SUM&#x28;&#x28;&#x28;mapa_item.quantidade&#x29;-COALESCE&#x28;mapa_item_anulacao.quantidade, 0.0000&#x29;&#x29;&#x29;&#x29;&#x3a;&#x3a;NUMERIC&#x28;14,4&#x29;&#x29;&#x3a;&#x3a;VARCHAR&#xd;&#xa;		                   END AS vl_cot_precos_unitario&#xd;&#xa;		                 , SUM&#x28;&#x28;mapa_item.quantidade&#x29;-COALESCE&#x28;mapa_item_anulacao.quantidade, 0.0000&#x29;&#x29; AS quantidade&#xd;&#xa;		                 , &#x27;0,00&#x27; AS vl_min_alien_bens&#xd;&#xa;		              FROM licitacao.homologacao&#xd;&#xa;		         LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;		                ON homologacao.num_homologacao     &#x3d; homologacao_anulada.num_homologacao&#xd;&#xa;		               AND homologacao.cod_licitacao       &#x3d; homologacao_anulada.cod_licitacao&#xd;&#xa;		               AND homologacao.cod_modalidade      &#x3d; homologacao_anulada.cod_modalidade&#xd;&#xa;		               AND homologacao.cod_entidade        &#x3d; homologacao_anulada.cod_entidade&#xd;&#xa;		               AND homologacao.num_adjudicacao     &#x3d; homologacao_anulada.num_adjudicacao&#xd;&#xa;		               AND homologacao.exercicio_licitacao &#x3d; homologacao_anulada.exercicio_licitacao&#xd;&#xa;		               AND homologacao.lote                &#x3d; homologacao_anulada.lote&#xd;&#xa;		               AND homologacao.cod_cotacao         &#x3d; homologacao_anulada.cod_cotacao&#xd;&#xa;		               AND homologacao.cod_item            &#x3d; homologacao_anulada.cod_item&#xd;&#xa;		               AND homologacao.exercicio_cotacao   &#x3d; homologacao_anulada.exercicio_cotacao&#xd;&#xa;		               AND homologacao.cgm_fornecedor      &#x3d; homologacao_anulada.cgm_fornecedor&#xd;&#xa;		        INNER JOIN licitacao.adjudicacao&#xd;&#xa;		                ON adjudicacao.num_adjudicacao     &#x3d; homologacao.num_adjudicacao&#xd;&#xa;		               AND adjudicacao.cod_entidade        &#x3d; homologacao.cod_entidade&#xd;&#xa;		               AND adjudicacao.cod_modalidade      &#x3d; homologacao.cod_modalidade&#xd;&#xa;		               AND adjudicacao.cod_licitacao       &#x3d; homologacao.cod_licitacao&#xd;&#xa;		               AND adjudicacao.exercicio_licitacao &#x3d; homologacao.exercicio_licitacao&#xd;&#xa;		               AND adjudicacao.cod_item            &#x3d; homologacao.cod_item&#xd;&#xa;		               AND adjudicacao.cod_cotacao         &#x3d; homologacao.cod_cotacao&#xd;&#xa;		               AND adjudicacao.lote                &#x3d; homologacao.lote&#xd;&#xa;		               AND adjudicacao.exercicio_cotacao   &#x3d; homologacao.exercicio_cotacao&#xd;&#xa;		               AND adjudicacao.cgm_fornecedor      &#x3d; homologacao.cgm_fornecedor&#xd;&#xa;		        INNER JOIN licitacao.cotacao_licitacao&#xd;&#xa;		                ON cotacao_licitacao.cod_modalidade      &#x3d; adjudicacao.cod_modalidade&#xd;&#xa;		               AND cotacao_licitacao.cod_licitacao       &#x3d; adjudicacao.cod_licitacao&#xd;&#xa;		               AND cotacao_licitacao.cod_entidade        &#x3d; adjudicacao.cod_entidade&#xd;&#xa;		               AND cotacao_licitacao.exercicio_licitacao &#x3d; adjudicacao.exercicio_licitacao&#xd;&#xa;		               AND cotacao_licitacao.lote                &#x3d; adjudicacao.lote&#xd;&#xa;		               AND cotacao_licitacao.cod_cotacao         &#x3d; adjudicacao.cod_cotacao&#xd;&#xa;		               AND cotacao_licitacao.cod_item            &#x3d; adjudicacao.cod_item&#xd;&#xa;		               AND cotacao_licitacao.exercicio_cotacao   &#x3d; adjudicacao.exercicio_cotacao&#xd;&#xa;		               AND cotacao_licitacao.cgm_fornecedor      &#x3d; adjudicacao.cgm_fornecedor&#xd;&#xa;		        INNER JOIN &#x28;SELECT licitacao.&#x2a;&#xd;&#xa;		                         , &#x28;SELECT exercicio&#xd;&#xa;		                              FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;        &#xd;&#xa;		                            VALUES &#x28; cod_licitacao       INTEGER&#xd;&#xa;		                                   , cod_modalidade      INTEGER&#xd;&#xa;		                                   , cod_entidade        INTEGER&#xd;&#xa;		                                   , exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;		                                   , exercicio_licitacao VARCHAR&#xd;&#xa;		                                   , num_licitacao       TEXT &#x29;&#xd;&#xa;		                             WHERE cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;		                               AND cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                               AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                               AND exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;		                           &#x29; AS exercicio_licitacao&#xd;&#xa;		                         , &#x28;SELECT num_licitacao&#xd;&#xa;		                              FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;      &#xd;&#xa;		                            VALUES &#x28; cod_licitacao       INTEGER&#xd;&#xa;		                                   , cod_modalidade      INTEGER&#xd;&#xa;		                                   , cod_entidade        INTEGER&#xd;&#xa;		                                   , exercicio           CHAR&#x28;4&#x29;&#xd;&#xa;		                                   , exercicio_licitacao VARCHAR&#xd;&#xa;		                                   , num_licitacao       TEXT &#x29;&#xd;&#xa;		                             WHERE cod_entidade   &#x3d; licitacao.cod_entidade&#xd;&#xa;		                               AND cod_licitacao  &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                               AND cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                               AND exercicio      &#x3d; licitacao.exercicio&#xd;&#xa;		                           &#x29; AS num_processo_licitatorio&#xd;&#xa;		                      FROM licitacao.licitacao&#xd;&#xa;		                   &#x29; AS licitacao&#xd;&#xa;		                ON licitacao.cod_licitacao  &#x3d; cotacao_licitacao.cod_licitacao&#xd;&#xa;		               AND licitacao.cod_modalidade &#x3d; cotacao_licitacao.cod_modalidade&#xd;&#xa;		               AND licitacao.cod_entidade   &#x3d; cotacao_licitacao.cod_entidade&#xd;&#xa;		               AND licitacao.exercicio      &#x3d; cotacao_licitacao.exercicio_licitacao&#xd;&#xa;		         LEFT JOIN licitacao.licitacao_anulada&#xd;&#xa;		                ON licitacao.cod_licitacao  &#x3d; licitacao_anulada.cod_licitacao&#xd;&#xa;		               AND licitacao.cod_modalidade &#x3d; licitacao_anulada.cod_modalidade&#xd;&#xa;		               AND licitacao.cod_entidade   &#x3d; licitacao_anulada.cod_entidade&#xd;&#xa;		               AND licitacao.exercicio      &#x3d; licitacao_anulada.exercicio&#xd;&#xa;		        INNER JOIN licitacao.edital&#xd;&#xa;		                ON edital.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;		               AND edital.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;		               AND edital.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;		               AND edital.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;		         LEFT JOIN licitacao.edital_anulado&#xd;&#xa;		                ON edital.num_edital&#x3d;edital_anulado.num_edital&#xd;&#xa;		               AND edital.exercicio &#x3d;edital_anulado.exercicio&#xd;&#xa;		        INNER JOIN compras.mapa&#xd;&#xa;		                ON mapa.exercicio &#x3d; licitacao.exercicio_mapa&#xd;&#xa;		               AND mapa.cod_mapa  &#x3d; licitacao.cod_mapa&#xd;&#xa;		        INNER JOIN compras.mapa_item&#xd;&#xa;		                ON mapa_item.exercicio             &#x3d; licitacao.exercicio_mapa&#xd;&#xa;		               AND mapa_item.cod_mapa              &#x3d; licitacao.cod_mapa&#xd;&#xa;		               AND mapa_item.cod_entidade          &#x3d; homologacao.cod_entidade&#xd;&#xa;		               AND mapa_item.cod_item              &#x3d; homologacao.cod_item&#xd;&#xa;		         LEFT JOIN compras.mapa_item_anulacao&#xd;&#xa;		                ON mapa_item.exercicio             &#x3d; mapa_item_anulacao.exercicio&#xd;&#xa;		               AND mapa_item.cod_entidade          &#x3d; mapa_item_anulacao.cod_entidade&#xd;&#xa;		               AND mapa_item.cod_solicitacao       &#x3d; mapa_item_anulacao.cod_solicitacao&#xd;&#xa;		               AND mapa_item.cod_mapa              &#x3d; mapa_item_anulacao.cod_mapa&#xd;&#xa;		               AND mapa_item.cod_centro            &#x3d; mapa_item_anulacao.cod_centro&#xd;&#xa;		               AND mapa_item.cod_item              &#x3d; mapa_item_anulacao.cod_item&#xd;&#xa;		               AND mapa_item.exercicio_solicitacao &#x3d; mapa_item_anulacao.exercicio_solicitacao&#xd;&#xa;		               AND mapa_item.lote                  &#x3d; mapa_item_anulacao.lote&#xd;&#xa;		        INNER JOIN administracao.configuracao_entidade&#xd;&#xa;		                ON configuracao_entidade.parametro    &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;		               AND configuracao_entidade.cod_modulo   &#x3d; 55&#xd;&#xa;		               AND configuracao_entidade.exercicio    &#x3d; licitacao.exercicio&#xd;&#xa;		               AND configuracao_entidade.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;		        INNER JOIN compras.mapa_cotacao&#xd;&#xa;		                ON mapa_cotacao.exercicio_mapa &#x3d; mapa.exercicio&#xd;&#xa;		               AND mapa_cotacao.cod_mapa       &#x3d; mapa.cod_mapa&#xd;&#xa;		        INNER JOIN compras.cotacao&#xd;&#xa;		                ON cotacao.exercicio   &#x3d; mapa_cotacao.exercicio_cotacao&#xd;&#xa;		               AND cotacao.cod_cotacao &#x3d; mapa_cotacao.cod_cotacao&#xd;&#xa;		        INNER JOIN compras.julgamento&#xd;&#xa;		                ON julgamento.exercicio   &#x3d; cotacao.exercicio&#xd;&#xa;		               AND julgamento.cod_cotacao &#x3d; cotacao.cod_cotacao&#xd;&#xa;		        INNER JOIN compras.julgamento_item&#xd;&#xa;		                ON julgamento_item.exercicio   &#x3d; julgamento.exercicio&#xd;&#xa;		               AND julgamento_item.cod_cotacao &#x3d; julgamento.cod_cotacao&#xd;&#xa;		               AND julgamento_item.cgm_fornecedor &#x3d; homologacao.cgm_fornecedor&#xd;&#xa;		               AND julgamento_item.lote           &#x3d; homologacao.lote&#xd;&#xa;		               AND julgamento_item.cod_item       &#x3d; homologacao.cod_item&#xd;&#xa;		               AND julgamento_item.ordem &#x3d; 1&#xd;&#xa;		        INNER JOIN compras.cotacao_fornecedor_item&#xd;&#xa;		                ON cotacao_fornecedor_item.exercicio      &#x3d; julgamento_item.exercicio&#xd;&#xa;		               AND cotacao_fornecedor_item.cod_cotacao    &#x3d; julgamento_item.cod_cotacao&#xd;&#xa;		               AND cotacao_fornecedor_item.cod_item       &#x3d; julgamento_item.cod_item&#xd;&#xa;		               AND cotacao_fornecedor_item.cgm_fornecedor &#x3d; julgamento_item.cgm_fornecedor&#xd;&#xa;		               AND cotacao_fornecedor_item.lote           &#x3d; julgamento_item.lote&#xd;&#xa;		             WHERE TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;    &#xd;&#xa;		               AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;         &#xd;&#xa;		               AND licitacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;       &#xd;&#xa;		               AND licitacao.cod_modalidade NOT IN &#x28;8,9&#x29;&#xd;&#xa;		         AND homologacao_anulada.num_homologacao IS NULL&#xd;&#xa;		               AND licitacao_anulada.cod_licitacao IS NULL&#xd;&#xa;		         AND homologacao.homologado IS TRUE&#xd;&#xa;		               AND edital_anulado.num_edital IS NULL&#xd;&#xa;		          GROUP BY tipo_registro&#xd;&#xa;		                 , cod_orgao_resp&#xd;&#xa;		                 , cod_unidade_resp&#xd;&#xa;		                 , licitacao.exercicio_licitacao&#xd;&#xa;		                 , licitacao.num_processo_licitatorio&#xd;&#xa;		                 , num_lote&#xd;&#xa;		                 , dt_cotacao&#xd;&#xa;		                 , homologacao.cod_item&#xd;&#xa;		                 , licitacao.cod_tipo_objeto&#xd;&#xa;		                 , cotacao_fornecedor_item.vl_cotacao&#xd;&#xa;			&#x29;,&#xd;&#xa;			 aberlic16 as&#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT 16 AS tipo_registro&#xd;&#xa;		                 , LPAD&#x28;configuracao_entidade.valor,2,&#x27;0&#x27;&#x29; AS cod_orgao_resp&#xd;&#xa;		                 , LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade_resp&#xd;&#xa;		                 , config_licitacao.exercicio_licitacao&#xd;&#xa;		                 , config_licitacao.num_licitacao AS num_processo_licitatorio&#xd;&#xa;		                 , LPAD&#x28;orgao_despesa.valor&#x3a;&#x3a;varchar,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;		                 , LPAD&#x28;LPAD&#x28;despesa.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; &#x7c;&#x7c; LPAD&#x28;despesa.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29; AS cod_unidade&#xd;&#xa;		                 , despesa.cod_funcao AS cod_funcao&#xd;&#xa;		                 , despesa.cod_subfuncao AS cod_subfuncao&#xd;&#xa;		                 , ppa.programa.num_programa AS cod_programa&#xd;&#xa;		                 , ppa.acao.num_acao AS id_acao&#xd;&#xa;		                 , &#x27;&#x27; AS id_subacao&#xd;&#xa;		                 , &#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;REPLACE&#x28;conta_despesa.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;,6, &#x27;&#x27;&#x29;&#x29; AS natureza_despesa&#xd;&#xa;		                 , COALESCE&#x28;recurso.cod_fonte, &#x27;100&#x27;&#x29; AS cod_font_recursos&#xd;&#xa;		                 , SUM&#x28;mapa_item_dotacao.vl_dotacao&#x29; AS vl_recurso&#xd;&#xa;		              FROM licitacao.licitacao&#xd;&#xa;		        INNER JOIN sw_processo&#xd;&#xa;		                ON sw_processo.cod_processo &#x3d; licitacao.cod_processo&#xd;&#xa;		               AND sw_processo.ano_exercicio &#x3d; licitacao.exercicio_processo&#xd;&#xa;		        INNER JOIN licitacao.criterio_julgamento&#xd;&#xa;		                ON criterio_julgamento.cod_criterio &#x3d; licitacao.cod_criterio&#xd;&#xa;		        INNER JOIN licitacao.edital&#xd;&#xa;		                ON edital.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;		               AND edital.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		               AND edital.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;		               AND edital.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;		         LEFT JOIN licitacao.edital_anulado&#xd;&#xa;		                ON edital_anulado.num_edital&#x3d;edital.num_edital&#xd;&#xa;		               AND edital_anulado.exercicio&#x3d;edital.exercicio&#xd;&#xa;		        INNER JOIN compras.objeto&#xd;&#xa;		                ON objeto.cod_objeto &#x3d; licitacao.cod_objeto&#xd;&#xa;		        INNER JOIN compras.tipo_objeto&#xd;&#xa;		                ON tipo_objeto.cod_tipo_objeto &#x3d; licitacao.cod_tipo_objeto&#xd;&#xa;		        INNER JOIN compras.modalidade&#xd;&#xa;		                ON modalidade.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		        INNER JOIN compras.mapa&#xd;&#xa;		                ON mapa.exercicio &#x3d; licitacao.exercicio_mapa&#xd;&#xa;		               AND mapa.cod_mapa &#x3d; licitacao.cod_mapa&#xd;&#xa;		        INNER JOIN compras.tipo_licitacao&#xd;&#xa;		                ON tipo_licitacao.cod_tipo_licitacao &#x3d; licitacao.cod_tipo_licitacao&#xd;&#xa;		        INNER JOIN compras.mapa_solicitacao&#xd;&#xa;		                ON mapa_solicitacao.exercicio &#x3d; mapa.exercicio&#xd;&#xa;		               AND mapa_solicitacao.cod_mapa &#x3d; mapa.cod_mapa&#xd;&#xa;		        INNER JOIN compras.mapa_cotacao&#xd;&#xa;		                ON mapa_cotacao.exercicio_mapa &#x3d; mapa.exercicio&#xd;&#xa;		               AND mapa_cotacao.cod_mapa &#x3d; mapa.cod_mapa&#xd;&#xa;		        INNER JOIN compras.cotacao&#xd;&#xa;		                ON cotacao.exercicio &#x3d; mapa_cotacao.exercicio_cotacao&#xd;&#xa;		               AND cotacao.cod_cotacao &#x3d; mapa_cotacao.cod_cotacao&#xd;&#xa;		        INNER JOIN compras.julgamento&#xd;&#xa;		                ON julgamento.exercicio &#x3d; cotacao.exercicio&#xd;&#xa;		               AND julgamento.cod_cotacao &#x3d; cotacao.cod_cotacao&#xd;&#xa;		        INNER JOIN compras.julgamento_item&#xd;&#xa;		                ON julgamento_item.exercicio &#x3d; julgamento.exercicio&#xd;&#xa;		               AND julgamento_item.cod_cotacao &#x3d; julgamento.cod_cotacao&#xd;&#xa;		        INNER JOIN compras.cotacao_fornecedor_item&#xd;&#xa;		                ON cotacao_fornecedor_item.exercicio &#x3d; julgamento_item.exercicio&#xd;&#xa;		               AND cotacao_fornecedor_item.cod_cotacao &#x3d; julgamento_item.cod_cotacao&#xd;&#xa;		               AND cotacao_fornecedor_item.cod_item &#x3d; julgamento_item.cod_item&#xd;&#xa;		               AND cotacao_fornecedor_item.cgm_fornecedor &#x3d; julgamento_item.cgm_fornecedor&#xd;&#xa;		               AND cotacao_fornecedor_item.lote &#x3d; julgamento_item.lote&#xd;&#xa;		        INNER JOIN compras.fornecedor&#xd;&#xa;		                ON fornecedor.cgm_fornecedor &#x3d; cotacao_fornecedor_item.cgm_fornecedor&#xd;&#xa;		        INNER JOIN licitacao.homologacao&#xd;&#xa;		                ON homologacao.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;		               AND homologacao.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;		               AND homologacao.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;		               AND homologacao.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;		               AND homologacao.cod_item&#x3d;julgamento_item.cod_item&#xd;&#xa;		         LEFT JOIN licitacao.homologacao_anulada&#xd;&#xa;		                ON homologacao_anulada.cod_licitacao&#x3d;homologacao.cod_licitacao&#xd;&#xa;		               AND homologacao_anulada.cod_modalidade&#x3d;homologacao.cod_modalidade&#xd;&#xa;		               AND homologacao_anulada.cod_entidade&#x3d;homologacao.cod_entidade&#xd;&#xa;		               AND homologacao_anulada.exercicio_licitacao&#x3d;homologacao.exercicio_licitacao&#xd;&#xa;		               AND homologacao_anulada.num_homologacao&#x3d;homologacao.num_homologacao&#xd;&#xa;		               AND homologacao_anulada.cod_item&#x3d;homologacao.cod_item&#xd;&#xa;		        INNER JOIN compras.solicitacao_homologada&#xd;&#xa;		                ON solicitacao_homologada.exercicio&#x3d;mapa_solicitacao.exercicio_solicitacao&#xd;&#xa;		               AND solicitacao_homologada.cod_entidade&#x3d;mapa_solicitacao.cod_entidade&#xd;&#xa;		               AND solicitacao_homologada.cod_solicitacao&#x3d;mapa_solicitacao.cod_solicitacao&#xd;&#xa;		        INNER JOIN compras.mapa_item_dotacao&#xd;&#xa;		                ON mapa_item_dotacao.exercicio&#x3d;solicitacao_homologada.exercicio&#xd;&#xa;		               AND mapa_item_dotacao.cod_entidade&#x3d;solicitacao_homologada.cod_entidade&#xd;&#xa;		               AND mapa_item_dotacao.cod_solicitacao&#x3d;solicitacao_homologada.cod_solicitacao&#xd;&#xa;		               AND mapa_item_dotacao.cod_item&#x3d;homologacao.cod_item&#xd;&#xa;		               AND mapa_item_dotacao.cod_mapa&#x3d;mapa.cod_mapa&#xd;&#xa;		        INNER JOIN orcamento.despesa&#xd;&#xa;		                ON despesa.exercicio &#x3d; mapa_item_dotacao.exercicio&#xd;&#xa;		               AND despesa.cod_despesa &#x3d; mapa_item_dotacao.cod_despesa&#xd;&#xa;		        INNER JOIN orcamento.conta_despesa&#xd;&#xa;		                ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;		               AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;		        INNER JOIN orcamento.programa&#xd;&#xa;		                ON programa.cod_programa &#x3d; despesa.cod_programa&#xd;&#xa;		               AND programa.exercicio    &#x3d; despesa.exercicio&#xd;&#xa;		        INNER JOIN orcamento.programa_ppa_programa&#xd;&#xa;		                ON programa_ppa_programa.cod_programa &#x3d; programa.cod_programa&#xd;&#xa;		               AND programa_ppa_programa.exercicio    &#x3d; programa.exercicio&#xd;&#xa;		        INNER JOIN ppa.programa&#xd;&#xa;		                ON ppa.programa.cod_programa &#x3d; programa_ppa_programa.cod_programa&#xd;&#xa;		        INNER JOIN orcamento.pao&#xd;&#xa;		                ON pao.num_pao   &#x3d; despesa.num_pao&#xd;&#xa;		               AND pao.exercicio &#x3d; despesa.exercicio&#xd;&#xa;		        INNER JOIN orcamento.pao_ppa_acao&#xd;&#xa;		                ON pao_ppa_acao.num_pao &#x3d; pao.num_pao&#xd;&#xa;		               AND pao_ppa_acao.exercicio &#x3d; pao.exercicio&#xd;&#xa;		        INNER JOIN ppa.acao&#xd;&#xa;		                ON acao.cod_acao &#x3d; pao_ppa_acao.cod_acao&#xd;&#xa;		         LEFT JOIN orcamento.recurso&#xd;&#xa;		                ON recurso.cod_recurso &#x3d; despesa.cod_recurso&#xd;&#xa;		               AND recurso.exercicio &#x3d; despesa.exercicio&#xd;&#xa;		        INNER JOIN administracao.configuracao_entidade&#xd;&#xa;		                ON configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;		               AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;		               AND configuracao_entidade.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;		               AND configuracao_entidade.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;		        INNER JOIN administracao.configuracao_entidade AS orgao_despesa&#xd;&#xa;		                ON orgao_despesa.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;		               AND orgao_despesa.cod_modulo &#x3d; 55&#xd;&#xa;		               AND orgao_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;		               AND orgao_despesa.cod_entidade &#x3d; despesa.cod_entidade&#xd;&#xa;		        INNER JOIN sw_cgm AS responsavel&#xd;&#xa;		                ON responsavel.numcgm &#x3d; edital.responsavel_juridico&#xd;&#xa;		        INNER JOIN &#x28; SELECT num_documento, numcgm, tipo_documento&#xd;&#xa;		                      FROM &#x28;&#xd;&#xa;		                              SELECT cpf AS num_documento, numcgm, 1 AS tipo_documento&#xd;&#xa;		                              FROM sw_cgm_pessoa_fisica&#xd;&#xa;		                              UNION&#xd;&#xa;		                              SELECT cnpj AS num_documento, numcgm, 2 AS tipo_documento&#xd;&#xa;		                              FROM sw_cgm_pessoa_juridica&#xd;&#xa;		                           &#x29; AS tabela&#xd;&#xa;		                      GROUP BY numcgm, num_documento, tipo_documento&#xd;&#xa;		                   &#x29; AS documento_pessoa&#xd;&#xa;		                ON documento_pessoa.numcgm &#x3d; responsavel.numcgm&#xd;&#xa;		         LEFT JOIN licitacao.contrato_licitacao&#xd;&#xa;		                ON contrato_licitacao.cod_licitacao&#x3d;licitacao.cod_licitacao&#xd;&#xa;		               AND contrato_licitacao.cod_modalidade&#x3d;licitacao.cod_modalidade&#xd;&#xa;		               AND contrato_licitacao.cod_entidade&#x3d;licitacao.cod_entidade&#xd;&#xa;		               AND contrato_licitacao.exercicio_licitacao&#x3d;licitacao.exercicio&#xd;&#xa;		         LEFT JOIN licitacao.contrato&#xd;&#xa;		                ON contrato.num_contrato&#x3d;contrato_licitacao.num_contrato&#xd;&#xa;		               AND contrato.cod_entidade&#x3d;contrato_licitacao.cod_entidade&#xd;&#xa;		               AND contrato.exercicio&#x3d;contrato_licitacao.exercicio&#xd;&#xa;		        INNER JOIN &#x28;&#xd;&#xa;		                       SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;stExercicio, stEntidade&#x29;       &#xd;&#xa;		                                VALUES &#x28;cod_licitacao   INTEGER&#xd;&#xa;		                                   ,cod_modalidade    INTEGER&#xd;&#xa;		                                   ,cod_entidade    INTEGER&#xd;&#xa;		                                   ,exercicio     CHAR&#x28;4&#x29;&#xd;&#xa;		                                   ,exercicio_licitacao VARCHAR&#xd;&#xa;		                                   ,num_licitacao   TEXT &#x29;&#xd;&#xa;		                   &#x29; AS config_licitacao&#xd;&#xa;		                ON config_licitacao.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;		               AND config_licitacao.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;		               AND config_licitacao.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		               AND config_licitacao.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;		             WHERE TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;    &#xd;&#xa;		               AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stmes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;    &#xd;&#xa;		               AND homologacao_anulada.cod_licitacao IS NULL&#xd;&#xa;		               AND edital_anulado.num_edital IS NULL&#xd;&#xa;		               AND licitacao.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;		               AND licitacao.cod_modalidade NOT IN &#x28;8,9&#x29;&#xd;&#xa;		               AND NOT EXISTS&#x28; SELECT 1&#xd;&#xa;		                                 FROM licitacao.licitacao_anulada&#xd;&#xa;		                                WHERE licitacao_anulada.cod_licitacao &#x3d; licitacao.cod_licitacao&#xd;&#xa;		                                  AND licitacao_anulada.cod_modalidade &#x3d; licitacao.cod_modalidade&#xd;&#xa;		                                  AND licitacao_anulada.cod_entidade &#x3d; licitacao.cod_entidade&#xd;&#xa;		                                  AND licitacao_anulada.exercicio &#x3d; licitacao.exercicio&#xd;&#xa;		                             &#x29;&#xd;&#xa;		          GROUP BY tipo_registro&#xd;&#xa;		                 , cod_orgao_resp&#xd;&#xa;		                 , cod_unidade_resp&#xd;&#xa;		                 , config_licitacao.exercicio_licitacao&#xd;&#xa;		                 , num_processo_licitatorio&#xd;&#xa;		                 , cod_orgao&#xd;&#xa;		                 , cod_unidade&#xd;&#xa;		                 , cod_funcao&#xd;&#xa;		                 , cod_subfuncao&#xd;&#xa;		                 , ppa.programa.num_programa&#xd;&#xa;		                 , id_acao&#xd;&#xa;		                 , natureza_despesa&#xd;&#xa;		                 , cod_font_recursos&#xd;&#xa;			&#x29;,&#xd;&#xa;			  aberlic_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							num_processo_licitatorio,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo_licitatorio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_modalidade_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_modalidade&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;natureza_procedimento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_publicacao_edital&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_publicacao_edital_veiculo1&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;veiculo1_publicacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_publicacao_edital_veiculo2&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;veiculo2_publicacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_recebimento_doc&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;natureza_objeto&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;objeto&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,500&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;regime_execucao_obras&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_convidado&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;clausula_prorrogacao&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,250&#x29;,&#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;undade_medida_prazo_execucao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;prazo_execucao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;forma_pagamento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;citerio_aceitabilidade&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;desconto_tabela&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;processo_lote&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;criterio_desempate&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;destinacao_exclusiva&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;subcontratacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;limite_contratacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;					as d&#xd;&#xa;				from aberlic10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							num_processo_licitatorio,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo_licitatorio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_lote&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;desc_lote&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,120&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from aberlic11&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							num_processo_licitatorio,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo_licitatorio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_item&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from aberlic12&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							num_processo_licitatorio,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo_licitatorio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_lote&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_item&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from aberlic13&#xd;&#xa;				tipo_registro						&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							num_processo_licitatorio,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo_licitatorio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_lote&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_item&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_cotacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_cot_precos_unitario&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;quantidade&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_min_alien_bens&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from aberlic14&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							num_processo_licitatorio,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_resp&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_processo_licitatorio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_funcao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_subfuncao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_programa&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;id_acao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;id_subacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;natureza_despesa&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 6, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_font_recursos&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_recurso&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					as d&#xd;&#xa;				from aberlic16&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;ABERLIC.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from aberlic_format order by num_processo_licitatorio, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;	&#xd;&#xa;&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;EXT.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with ext10 as&#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT  tipo_registro&#xd;&#xa;		                        , cod_plano AS cod_ext&#xd;&#xa;		                        , cod_orgao&#xd;&#xa;		                        , tipo_lancamento&#xd;&#xa;		                        , sub_tipo&#xd;&#xa;		                        , desdobra_sub_tipo&#xd;&#xa;		                        , desc_extra_orc&#xd;&#xa;		                        , lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; as mes      &#xd;&#xa;		                        , stExercicio as ano            &#xd;&#xa;	&#xd;&#xa;		                    FROM &#x28;&#xd;&#xa;		                          SELECT 10 AS tipo_registro&#xd;&#xa;		                               , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;		                               , LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; as tipo_lancamento&#xd;&#xa;		                               , LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29; AS sub_tipo&#xd;&#xa;		                               , CASE WHEN &#x28;balancete_extmmaa.tipo_lancamento &#x3d; 1&#x29;&#xd;&#xa;		                                          THEN CASE WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 1&#xd;&#xa;		                                                      THEN LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                                    WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 2&#xd;&#xa;		                                                      THEN LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                                    WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 3&#xd;&#xa;		                                                      THEN LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                                    WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 4&#xd;&#xa;		                                                      THEN LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                                    ELSE &#x27;&#x27;&#xd;&#xa;		                                              END&#xd;&#xa;		                                        WHEN &#x28;balancete_extmmaa.tipo_lancamento &#x3d; 4&#x29;&#xd;&#xa;		                                          THEN CASE WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 1&#xd;&#xa;		                                                      THEN LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                                    WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 2&#xd;&#xa;		                                                      THEN LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                                    ELSE &#x27;&#x27;&#xd;&#xa;		                                              END&#xd;&#xa;		                                      ELSE &#x27;&#x27;&#xd;&#xa;		                               END AS desdobra_sub_tipo&#xd;&#xa;		                              , CASE WHEN &#x28;balancete_extmmaa.tipo_lancamento &#x3d; 1&#x29;&#xd;&#xa;		                                        THEN CASE WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 1&#xd;&#xa;		                                                    THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                                  WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 2&#xd;&#xa;		                                                    THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                                  WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 3&#xd;&#xa;		                                                    THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                                  WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 4&#xd;&#xa;		                                                    THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                                  ELSE plano_analitica.cod_plano&#x3a;&#x3a;VARCHAR&#xd;&#xa;		                                              END&#xd;&#xa;		                                     WHEN &#x28;balancete_extmmaa.tipo_lancamento &#x3d; 4&#x29;&#xd;&#xa;		                                        THEN CASE WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 1&#xd;&#xa;		                                                    THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                                  WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 2&#xd;&#xa;		                                                    THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                                  ELSE plano_analitica.cod_plano&#x3a;&#x3a;VARCHAR&#xd;&#xa;		                                          END&#xd;&#xa;		                                     ELSE plano_analitica.cod_plano&#x3a;&#x3a;VARCHAR&#xd;&#xa;		                               END AS cod_plano&#xd;&#xa;		                               , CASE WHEN &#x28;balancete_extmmaa.tipo_lancamento &#x3d; 1&#x29;&#xd;&#xa;		                                        THEN CASE WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 1&#xd;&#xa;		                                                    THEN &#x27;INSS&#x27;&#xd;&#xa;		                                                  WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 2&#xd;&#xa;		                                                    THEN &#x27;RPPS&#x27;&#xd;&#xa;		                                                  WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 3&#xd;&#xa;		                                                    THEN &#x27;IRRF&#x27;&#xd;&#xa;		                                                  WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 4&#xd;&#xa;		                                                    THEN &#x27;ISSQN&#x27;&#xd;&#xa;		                                                  ELSE remove_acentos&#x28;plano_conta.nom_conta&#x29;&#xd;&#xa;		                                            END&#xd;&#xa;		                                      WHEN &#x28;balancete_extmmaa.tipo_lancamento &#x3d; 4&#x29;&#xd;&#xa;		                                        THEN CASE WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 1&#xd;&#xa;		                                                    THEN &#x27;Repasse &#xe0; C&#xe2;mara&#x27;&#xd;&#xa;		                                                  WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 2&#xd;&#xa;		                                                    THEN &#x27;Devolu&#xe7;&#xe3;o de numer&#xe1;rio para a prefeitura&#x27;&#xd;&#xa;		                                                  ELSE remove_acentos&#x28;plano_conta.nom_conta&#x29;&#xd;&#xa;		                                            END&#xd;&#xa;		                                      ELSE remove_acentos&#x28;plano_conta.nom_conta&#x29;&#xd;&#xa;		                               END AS desc_extra_orc&#xd;&#xa;		                            FROM contabilidade.plano_analitica&#xd;&#xa;		                       LEFT JOIN tcemg.balancete_extmmaa&#xd;&#xa;		                              ON plano_analitica.cod_plano &#x3d; balancete_extmmaa.cod_plano&#xd;&#xa;		                             AND plano_analitica.exercicio &#x3d; balancete_extmmaa.exercicio&#xd;&#xa;		                      INNER JOIN contabilidade.plano_conta&#xd;&#xa;		                              ON plano_analitica.exercicio &#x3d; plano_conta.exercicio&#xd;&#xa;		                             AND plano_analitica.cod_conta &#x3d; plano_conta.cod_conta&#xd;&#xa;		                      INNER JOIN administracao.configuracao_entidade&#xd;&#xa;		                              ON configuracao_entidade.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;     &#xd;&#xa;		                             AND configuracao_entidade.exercicio &#x3d; stExercicio                                                             &#xd;&#xa;		                             AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;		                             AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;		                      INNER JOIN tcemg.arquivo_ext&#xd;&#xa;		                              ON plano_analitica.cod_plano &#x3d; arquivo_ext.cod_plano&#xd;&#xa;		                             AND plano_analitica.exercicio &#x3d; arquivo_ext.exercicio&#xd;&#xa;		                           WHERE balancete_extmmaa.exercicio &#x3d; stExercicio                  &#xd;&#xa;		                             AND arquivo_ext.mes &#x3d; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29;                        &#xd;&#xa;		                        &#x29; AS resultado&#xd;&#xa;		                GROUP BY tipo_registro&#xd;&#xa;		                       , cod_orgao&#xd;&#xa;		                       , tipo_lancamento&#xd;&#xa;		                       , sub_tipo&#xd;&#xa;		                       , desdobra_sub_tipo&#xd;&#xa;		                       , cod_plano&#xd;&#xa;		                       , desc_extra_orc&#xd;&#xa;		                ORDER BY  cod_plano&#xd;&#xa;			&#x29;,&#xd;&#xa;			 ext20 as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT tipo_registro&#xd;&#xa;		                   , cod_orgao&#xd;&#xa;		                   , cod_ext&#xd;&#xa;		                   , natureza_conta&#xd;&#xa;		                   , cod_font_recurso&#xd;&#xa;		                   , ABS&#x28;vl_saldo_ant&#x29; AS vl_saldo_ant&#xd;&#xa;		                   , ABS&#x28;vl_saldo_atual&#x29; AS vl_saldo_atual&#xd;&#xa;		                   , CASE WHEN natureza_anterior &#x21;&#x3d; &#x27; &#x27;&#xd;&#xa;		                          THEN natureza_anterior&#xd;&#xa;		                          &#xd;&#xa;		                          &#xd;&#xa;		                          &#xd;&#xa;		                          &#xd;&#xa;		                     	  ELSE CASE&#xd;&#xa;			             	  			WHEN natureza_conta &#x3d; &#x27;D&#x27; AND vl_saldo_ant &#x3c; 0.00 THEN &#x27;C&#x27;&#xd;&#xa;			                            WHEN vl_saldo_ant &#x3c; 0.00 THEN &#x27;D&#x27;&#xd;&#xa;			             	   			ELSE &#x27;C&#x27;&#xd;&#xa;			                      END&#xd;&#xa;			                  END AS nat_saldo_anterior_fonte&#xd;&#xa;		                   , CASE WHEN natureza_atual &#x21;&#x3d; &#x27; &#x27;&#xd;&#xa;		                          THEN natureza_atual&#xd;&#xa;		                          &#xd;&#xa;		                          &#xd;&#xa;		                          &#xd;&#xa;		                          &#xd;&#xa;								  ELSE CASE&#xd;&#xa;								        WHEN natureza_conta &#x3d; &#x27;D&#x27; and vl_saldo_atual &#x3c; 0.00 THEN &#x27;C&#x27;&#xd;&#xa;			                            WHEN vl_saldo_atual &#x3c; 0.00 THEN &#x27;D&#x27;&#xd;&#xa;			             	   			ELSE &#x27;C&#x27;&#xd;&#xa;			                      END&#xd;&#xa;		                      END AS nat_saldo_atual_fonte&#xd;&#xa;		                   , ABS&#x28;vl_saldo_debitos&#x29; AS total_debitos&#xd;&#xa;		                   , ABS&#x28;vl_saldo_creditos&#x29; AS total_creditos&#xd;&#xa;		                FROM &#x28;&#xd;&#xa;		                      SELECT tipo_registro&#xd;&#xa;		                           , cod_orgao&#xd;&#xa;		                           , cod_ext&#xd;&#xa;		                           , cod_unidade&#xd;&#xa;		                           , tipo_lancamento&#xd;&#xa;		                           , sub_tipo&#xd;&#xa;		                           , &#x28;&#xd;&#xa;		                           		select pla.natureza_saldo from contabilidade.plano_analitica pla where pla.exercicio &#x3d; stExercicio and pla.cod_plano &#x3d; cod_ext&#x3a;&#x3a;numeric    &#xd;&#xa;		                           	 &#x29; as natureza_conta&#xd;&#xa;		                           , cod_recurso AS cod_font_recurso&#xd;&#xa;		                           , SUM&#x28;vl_saldo_anterior&#x29; AS vl_saldo_ant&#xd;&#xa;		                           , SUM&#x28;vl_saldo_atual&#x29; AS vl_saldo_atual&#xd;&#xa;		                           , SUM&#x28;vl_saldo_debitos&#x29; AS vl_saldo_debitos&#xd;&#xa;		                           , SUM&#x28;vl_saldo_creditos&#x29; AS vl_saldo_creditos&#xd;&#xa;		                           , nat_saldo_anterior_fonte AS natureza_anterior&#xd;&#xa;		                           , nat_saldo_atual_fonte AS natureza_atual&#xd;&#xa;		                        FROM tcemg.fn_arquivo_ext_registro20&#x28; stExercicio                               &#xd;&#xa;		                                                            , &#x27;cod_entidade IN &#x28;&#x27;&#x7c;&#x7c; stEntidade &#x7c;&#x7c; &#x27;&#x29;&#x27;   &#xd;&#xa;		                                                            , stDtinicio                                &#xd;&#xa;		                                                            , stDtfim 		  			                &#xd;&#xa;		                                                            , &#x27;A&#x27;&#x3a;&#x3a;CHAR &#x29;&#xd;&#xa;		                          AS retorno&#x28; cod_estrutural             VARCHAR&#xd;&#xa;		                                    , tipo_registro              INTEGER&#xd;&#xa;		                                    , cod_orgao                  VARCHAR&#xd;&#xa;		                                              , cod_unidade                TEXT&#xd;&#xa;		                                    , tipo_lancamento            TEXT&#xd;&#xa;		                                    , sub_tipo                   TEXT&#xd;&#xa;		                                    , cod_ext                    VARCHAR&#xd;&#xa;		                                    , cod_recurso                INTEGER&#xd;&#xa;		                                    , vl_saldo_anterior          NUMERIC&#xd;&#xa;		                                    , vl_saldo_debitos           NUMERIC&#xd;&#xa;		                                    , vl_saldo_creditos          NUMERIC&#xd;&#xa;		                                    , vl_saldo_atual             NUMERIC&#xd;&#xa;		                                    , nat_saldo_anterior_fonte   CHAR&#xd;&#xa;		                                    , nat_saldo_atual_fonte      CHAR&#xd;&#xa;		                                    &#x29;&#xd;&#xa;		                    GROUP BY tipo_registro&#xd;&#xa;		                           , cod_orgao&#xd;&#xa;		                           , cod_unidade&#xd;&#xa;		                           , tipo_lancamento&#xd;&#xa;		                           , sub_tipo&#xd;&#xa;		                           , cod_ext&#xd;&#xa;		                           , cod_font_recurso&#xd;&#xa;		                           , nat_saldo_anterior_fonte&#xd;&#xa;		                           , nat_saldo_atual_fonte&#xd;&#xa;		                     &#x29; AS registro20&#xd;&#xa;			&#x29;,&#xd;&#xa;			ext30 as&#xd;&#xa;			&#x28;&#xd;&#xa;	                  SELECT 30 AS tipo_registro&#xd;&#xa;		                       , LPAD&#x28;&#x28;LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;configuracao_entidade.cod_entidade&#x3a;&#x3a;VARCHAR,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29; AS cod_unidade_sub&#xd;&#xa;		                       , CASE WHEN &#x28;balancete_extmmaa.tipo_lancamento &#x3d; 1&#x29;&#xd;&#xa;		                              THEN CASE WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 1&#xd;&#xa;		                                        THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                        WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 2&#xd;&#xa;		                                        THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                        WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 3&#xd;&#xa;		                                        THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                        WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 4&#xd;&#xa;		                                        THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                        ELSE plano_analitica.cod_plano&#x3a;&#x3a;VARCHAR&#xd;&#xa;		                                    END&#xd;&#xa;		                              WHEN &#x28;balancete_extmmaa.tipo_lancamento &#x3d; 4&#x29;&#xd;&#xa;		                              THEN CASE WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 1&#xd;&#xa;		                                        THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                        WHEN balancete_extmmaa.sub_tipo_lancamento &#x3d; 2&#xd;&#xa;		                                        THEN LPAD&#x28;balancete_extmmaa.tipo_lancamento&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;balancete_extmmaa.sub_tipo_lancamento&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#xd;&#xa;		                                        ELSE plano_analitica.cod_plano&#x3a;&#x3a;VARCHAR&#xd;&#xa;		                                    END&#xd;&#xa;		                              ELSE plano_analitica.cod_plano&#x3a;&#x3a;VARCHAR&#xd;&#xa;		                          END AS cod_ext&#xd;&#xa;		                       , CASE WHEN transferencia.cod_tipo &#x3d; 1 AND transferencia.cod_plano_credito &#x3d; 3274&#xd;&#xa;		                                   THEN COALESCE&#x28;&#x28;&#xd;&#xa;		                                         SELECT plano_recurso.cod_recurso&#xd;&#xa;		                                           FROM contabilidade.plano_conta&#xd;&#xa;		                                     INNER JOIN contabilidade.plano_analitica&#xd;&#xa;		                                             ON plano_conta.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;		                                            AND plano_conta.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;		                                     INNER JOIN contabilidade.plano_recurso&#xd;&#xa;		                                             ON plano_recurso.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;		                                            AND plano_recurso.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;		                                          WHERE plano_analitica.cod_plano &#x3d; cod_ctb_caixa.caixa_credito&#xd;&#xa;		                                            AND plano_analitica.exercicio &#x3d; transferencia.exercicio&#xd;&#xa;		                                            &#x29;,&#x27;100&#x27;&#x29;&#xd;&#xa;		                                   ELSE CASE WHEN plano_recurso.cod_recurso IS NOT NULL&#xd;&#xa;		                                             THEN COALESCE&#x28;plano_recurso.cod_recurso,&#x27;100&#x27;&#x29;&#xd;&#xa;		                                             ELSE COALESCE&#x28;plano_recurso.cod_recurso,&#x27;100&#x27;&#x29;&#xd;&#xa;		                                         END&#xd;&#xa;		                               END AS cod_font_recurso&#xd;&#xa;		                       , COALESCE&#x28;lote.vl_lancamento,0.00&#x29; AS vl_op&#xd;&#xa;		                       , tcemg.seq_num_op_extra&#x28;transferencia.exercicio,transferencia.cod_entidade,transferencia.cod_tipo,transferencia.cod_lote&#x29;&#x3a;&#x3a;varchar AS cod_reduzido_op&#xd;&#xa;		                       , tcemg.seq_num_op_extra&#x28;transferencia.exercicio,transferencia.cod_entidade,transferencia.cod_tipo,transferencia.cod_lote&#x29;&#x3a;&#x3a;varchar&#x7c;&#x7c;COALESCE&#x28;balancete_extmmaa.cod_plano, &#x27;0&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;TO_CHAR&#x28;lote.dt_lote, &#x27;ddmmyyyy&#x27;&#x29;&#x3a;&#x3a;VARCHAR AS num_op&#xd;&#xa;		                       , COALESCE&#x28;documento.nro_documento&#x3a;&#x3a;VARCHAR,&#x28;SELECT cnpj&#xd;&#xa;		                                                                      FROM sw_cgm_pessoa_juridica&#xd;&#xa;		                                                                     WHERE numcgm &#x3d; &#x28;SELECT numcgm&#xd;&#xa;		                                                                                       FROM orcamento.entidade&#xd;&#xa;		                                                                                      WHERE exercicio &#x3d; transferencia.exercicio&#xd;&#xa;		                                                                                        AND cod_entidade &#x3d; transferencia.cod_entidade&#xd;&#xa;		                                                                                    &#x29;&#xd;&#xa;		                                                                   &#x29;&#xd;&#xa;		                         &#x29; AS num_documento_credor&#xd;&#xa;		                       , remove_acentos&#x28;plano_conta.nom_conta&#x29; AS especificacao_op&#xd;&#xa;		                       , cpfrespop.cpf AS cpf_responsavel&#xd;&#xa;		                       , COALESCE&#x28;documento.tipo,2&#x29; AS tipo_documento_credor&#xd;&#xa;		                       , TO_CHAR&#x28;lote.dt_lote, &#x27;ddmmyyyy&#x27;&#x29; AS dt_pagamento&#xd;&#xa;		                       , lote.cod_lote&#xd;&#xa;		                    FROM &#x28;&#xd;&#xa;		                          SELECT lote.cod_lote&#xd;&#xa;		                               , lote.dt_lote&#xd;&#xa;		                               , lote.exercicio&#xd;&#xa;		                               , conta_debito.cod_plano&#xd;&#xa;		                               , lote.tipo&#xd;&#xa;		                               , lote.cod_entidade&#xd;&#xa;		                               , valor_lancamento.vl_lancamento&#xd;&#xa;		                            FROM contabilidade.lote&#xd;&#xa;		                      INNER JOIN contabilidade.lancamento&#xd;&#xa;		                              ON lancamento.exercicio    &#x3d; lote.exercicio&#xd;&#xa;		                             AND lancamento.cod_entidade &#x3d; lote.cod_entidade&#xd;&#xa;		                             AND lancamento.tipo         &#x3d; lote.tipo&#xd;&#xa;		                             AND lancamento.cod_lote     &#x3d; lote.cod_lote&#xd;&#xa;		                      INNER JOIN contabilidade.valor_lancamento&#xd;&#xa;		                              ON valor_lancamento.exercicio    &#x3d; lancamento.exercicio&#xd;&#xa;		                             AND valor_lancamento.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;		                             AND valor_lancamento.tipo         &#x3d; lancamento.tipo&#xd;&#xa;		                             AND valor_lancamento.cod_lote     &#x3d; lancamento.cod_lote&#xd;&#xa;		                             AND valor_lancamento.sequencia    &#x3d; lancamento.sequencia&#xd;&#xa;		                             AND valor_lancamento.tipo_valor &#x3d; &#x27;D&#x27;&#xd;&#xa;		                      INNER JOIN contabilidade.conta_debito&#xd;&#xa;		                              ON conta_debito.exercicio &#x3d; valor_lancamento.exercicio&#xd;&#xa;		                             AND conta_debito.cod_entidade &#x3d; valor_lancamento.cod_entidade&#xd;&#xa;		                             AND conta_debito.tipo &#x3d; valor_lancamento.tipo&#xd;&#xa;		                             AND conta_debito.cod_lote &#x3d; valor_lancamento.cod_lote&#xd;&#xa;		                             AND conta_debito.sequencia &#x3d; valor_lancamento.sequencia&#xd;&#xa;		                             AND conta_debito.tipo_valor &#x3d; valor_lancamento.tipo_valor&#xd;&#xa;		                             AND valor_lancamento.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;		                           WHERE lote.exercicio &#x3d; stExercicio                                                            &#xd;&#xa;		                             AND lote.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;		                             AND lote.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;		                             AND lote.dt_lote BETWEEN TO_DATE &#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                 &#xd;&#xa;		                                                  AND TO_DATE &#x28;stDtfim, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                    &#xd;&#xa;		                        ORDER BY lote.cod_lote&#xd;&#xa;		                         &#x29; AS lote&#xd;&#xa;		               LEFT JOIN tesouraria.transferencia&#xd;&#xa;		                      ON lote.exercicio     &#x3d; transferencia.exercicio&#xd;&#xa;		                     AND lote.tipo          &#x3d; transferencia.tipo&#xd;&#xa;		                     AND lote.cod_entidade  &#x3d; transferencia.cod_entidade&#xd;&#xa;		                     AND lote.cod_lote      &#x3d; transferencia.cod_lote&#xd;&#xa;		                     AND lote.cod_plano     &#x3d; transferencia.cod_plano_debito&#xd;&#xa;		              INNER JOIN contabilidade.plano_analitica&#xd;&#xa;		                      ON plano_analitica.cod_plano &#x3d; transferencia.cod_plano_debito&#xd;&#xa;		                     AND plano_analitica.exercicio &#x3d; transferencia.exercicio&#xd;&#xa;		              INNER JOIN contabilidade.plano_conta&#xd;&#xa;		                      ON plano_analitica.exercicio &#x3d; plano_conta.exercicio&#xd;&#xa;		                     AND plano_analitica.cod_conta &#x3d; plano_conta.cod_conta&#xd;&#xa;		               LEFT JOIN tcemg.balancete_extmmaa&#xd;&#xa;		                      ON balancete_extmmaa.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;		                     AND balancete_extmmaa.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;		               LEFT JOIN tcemg.contabilidade_lote_transferencia AS de_para_lote&#xd;&#xa;		                      ON de_para_lote.exercicio_credito    &#x3d; lote.exercicio&#xd;&#xa;		                     AND de_para_lote.cod_entidade_credito &#x3d; lote.cod_entidade&#xd;&#xa;		                     AND de_para_lote.tipo_credito         &#x3d; lote.tipo&#xd;&#xa;		                     AND de_para_lote.cod_lote_credito     &#x3d; lote.cod_lote&#xd;&#xa;		               LEFT JOIN &#x28;&#xd;&#xa;		                          SELECT conta_debito.tipo&#xd;&#xa;		                               , transferencia.cod_tipo&#xd;&#xa;		                               , conta_debito.exercicio&#xd;&#xa;		                               , conta_debito.cod_entidade&#xd;&#xa;		                               , CASE WHEN &#x28;conta_bancaria.cod_ctb_anterior is null&#x29;&#xd;&#xa;		                                      THEN transferencia.cod_plano_credito&#xd;&#xa;		                                      Else conta_bancaria.cod_ctb_anterior&#xd;&#xa;		                                  END AS cod_ctb_anterior&#xd;&#xa;		                               , transferencia.cod_plano_credito AS caixa_credito&#xd;&#xa;		                               , transferencia.cod_plano_debito  AS caixa_debito&#xd;&#xa;		                               , valor_lancamento.vl_lancamento&#xd;&#xa;		                               , lo.cod_lote&#xd;&#xa;		                               , lo.dt_lote&#xd;&#xa;		                            FROM contabilidade.conta_debito&#xd;&#xa;		                      INNER JOIN contabilidade.valor_lancamento&#xd;&#xa;		                              ON valor_lancamento.exercicio    &#x3d; conta_debito.exercicio&#xd;&#xa;		                             AND valor_lancamento.cod_entidade &#x3d; conta_debito.cod_entidade&#xd;&#xa;		                             AND valor_lancamento.tipo         &#x3d; conta_debito.tipo&#xd;&#xa;		                             AND valor_lancamento.cod_lote     &#x3d; conta_debito.cod_lote&#xd;&#xa;		                             AND valor_lancamento.sequencia    &#x3d; conta_debito.sequencia&#xd;&#xa;		                             AND valor_lancamento.tipo_valor   &#x3d; conta_debito.tipo_valor&#xd;&#xa;		                             AND valor_lancamento.tipo_valor &#x3d; &#x27;D&#x27;&#xd;&#xa;		                      INNER JOIN contabilidade.lote AS lo&#xd;&#xa;		                              ON conta_debito.cod_lote     &#x3d; lo.cod_lote&#xd;&#xa;		                             AND conta_debito.tipo         &#x3d; lo.tipo&#xd;&#xa;		                             AND conta_debito.exercicio    &#x3d; lo.exercicio&#xd;&#xa;		                             AND conta_debito.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;		                      INNER JOIN tesouraria.transferencia&#xd;&#xa;		                              ON transferencia.cod_plano_debito &#x3d; conta_debito.cod_plano&#xd;&#xa;		                             AND lo.cod_lote &#x3d; transferencia.cod_lote&#xd;&#xa;		                             AND transferencia.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;		                             AND transferencia.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;		                             AND transferencia.exercicio &#x3d; conta_debito.exercicio&#xd;&#xa;		                      INNER JOIN contabilidade.plano_analitica&#xd;&#xa;		                              ON plano_analitica.cod_plano &#x3d; transferencia.cod_plano_credito&#xd;&#xa;		                             &#xd;&#xa;		                             AND plano_analitica.exercicio &#x3d; conta_debito.exercicio&#xd;&#xa;		                       LEFT JOIN tcemg.conta_bancaria&#xd;&#xa;		                              ON conta_bancaria.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;		                             AND conta_bancaria.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;		                           WHERE conta_debito.exercicio &#x3d; stExercicio                                                                   &#xd;&#xa;		                             AND conta_debito.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;           &#xd;&#xa;		                             AND lo.dt_lote BETWEEN TO_DATE &#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE &#x28;stDtfim, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;              &#xd;&#xa;		                             AND conta_debito.tipo      &#x3d; &#x27;T&#x27;&#xd;&#xa;		                             AND transferencia.cod_tipo &#x3d; 5&#xd;&#xa;		                             AND conta_debito.cod_plano &#x3d; 3274&#xd;&#xa;		                        GROUP BY conta_debito.tipo&#xd;&#xa;		                               , transferencia.cod_tipo&#xd;&#xa;		                               , conta_debito.exercicio&#xd;&#xa;		                               , conta_debito.cod_entidade&#xd;&#xa;		                               , transferencia.cod_plano_credito&#xd;&#xa;		                               , transferencia.cod_plano_debito&#xd;&#xa;		                               , valor_lancamento.vl_lancamento&#xd;&#xa;		                               , lo.cod_lote&#xd;&#xa;		                               , lo.dt_lote&#xd;&#xa;		                               , cod_ctb_anterior&#xd;&#xa;		                         &#x29; AS cod_ctb_caixa&#xd;&#xa;		                      ON de_para_lote.exercicio_debito    &#x3d; cod_ctb_caixa.exercicio&#xd;&#xa;		                     AND de_para_lote.cod_entidade_debito &#x3d; cod_ctb_caixa.cod_entidade&#xd;&#xa;		                     AND de_para_lote.tipo_debito         &#x3d; cod_ctb_caixa.tipo&#xd;&#xa;		                     AND de_para_lote.cod_lote_debito     &#x3d; cod_ctb_caixa.cod_lote&#xd;&#xa;		              INNER JOIN administracao.configuracao_entidade&#xd;&#xa;		                      ON configuracao_entidade.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;     &#xd;&#xa;		                     AND configuracao_entidade.exercicio &#x3d; stExercicio                                                             &#xd;&#xa;		                     AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;		                     AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;		               LEFT JOIN &#x28;&#xd;&#xa;		                          SELECT cpf&#xd;&#xa;		                               , uniorcam.exercicio&#xd;&#xa;		                            FROM sw_cgm_pessoa_fisica&#xd;&#xa;		                      INNER JOIN tcemg.uniorcam&#xd;&#xa;		                              ON uniorcam.cgm_ordenador &#x3d; sw_cgm_pessoa_fisica.numcgm&#xd;&#xa;		                             AND uniorcam.num_orgao &#x3d; 02&#xd;&#xa;		                             AND uniorcam.num_unidade &#x3d; 01&#xd;&#xa;		                         &#x29; AS cpfrespop&#xd;&#xa;		                      ON cpfrespop.exercicio &#x3d; transferencia.exercicio&#xd;&#xa;		               LEFT JOIN tesouraria.recibo_extra_transferencia AS RET&#xd;&#xa;		                      ON RET.exercicio     &#x3d; plano_analitica.exercicio&#xd;&#xa;		                     AND RET.cod_lote      &#x3d; transferencia.cod_lote&#xd;&#xa;		                     AND RET.tipo          &#x3d; transferencia.tipo&#xd;&#xa;		                     AND RET.cod_entidade  &#x3d; transferencia.cod_entidade&#xd;&#xa;		               LEFT JOIN tesouraria.recibo_extra AS RE&#xd;&#xa;		                      ON RE.exercicio               &#x3d; RET.exercicio&#xd;&#xa;		                     AND RE.cod_entidade          &#x3d; RET.cod_entidade&#xd;&#xa;		                     AND RE.cod_recibo_extra     &#x3d; RET.cod_recibo_extra&#xd;&#xa;		                     AND RE.tipo_recibo           &#x3d; &#x27;D&#x27;&#xd;&#xa;		               LEFT JOIN tesouraria.recibo_extra_credor AS REC&#xd;&#xa;		                      ON REC.exercicio        &#x3d; RE.exercicio&#xd;&#xa;		                     AND REC.cod_entidade     &#x3d; RE.cod_entidade&#xd;&#xa;		                     AND REC.cod_recibo_extra &#x3d; RE.cod_recibo_extra&#xd;&#xa;		                     AND REC.tipo_recibo      &#x3d; &#x27;D&#x27;&#xd;&#xa;		               LEFT JOIN &#x28;&#xd;&#xa;		                          SELECT sw_cgm.numcgm&#xd;&#xa;		                               , CASE WHEN &#x28;sw_cgm.numcgm &#x3d; sw_cgm_pessoa_fisica.numcgm&#x29; THEN 1&#xd;&#xa;		                                      WHEN &#x28;sw_cgm.numcgm &#x3d; sw_cgm_pessoa_juridica.numcgm&#x29; THEN 2&#xd;&#xa;		                                      WHEN &#x28;sw_cgm.cod_pais &#x21;&#x3d; sw_pais.cod_pais&#x29; THEN 3&#xd;&#xa;		                                  END AS tipo&#xd;&#xa;		                               , CASE WHEN &#x28;sw_cgm.numcgm &#x3d; sw_cgm_pessoa_fisica.numcgm&#x29; THEN sw_cgm_pessoa_fisica.cpf&#xd;&#xa;		                                      WHEN &#x28;sw_cgm.numcgm &#x3d; sw_cgm_pessoa_juridica.numcgm&#x29; THEN sw_cgm_pessoa_juridica.cnpj&#xd;&#xa;		                                      WHEN &#x28;sw_cgm.cod_pais &#x21;&#x3d; sw_pais.cod_pais&#x29; THEN 0000000000&#x3a;&#x3a;TEXT&#xd;&#xa;		                                  END AS nro_documento&#xd;&#xa;		                            FROM sw_cgm&#xd;&#xa;		                      INNER JOIN sw_pais&#xd;&#xa;		                              ON sw_pais.cod_pais &#x3d; sw_cgm.cod_pais&#xd;&#xa;		                       LEFT JOIN sw_cgm_pessoa_fisica&#xd;&#xa;		                              ON sw_cgm_pessoa_fisica.numcgm &#x3d; sw_cgm.numcgm&#xd;&#xa;		                       LEFT JOIN sw_cgm_pessoa_juridica&#xd;&#xa;		                              ON sw_cgm_pessoa_juridica.numcgm &#x3d; sw_cgm.numcgm&#xd;&#xa;		                         &#x29; AS documento&#xd;&#xa;		                      ON documento.numcgm &#x3d; REC.numcgm&#xd;&#xa;		               LEFT JOIN contabilidade.plano_recurso&#xd;&#xa;		                      ON plano_recurso.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;		                     AND plano_recurso.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;		                   WHERE transferencia.exercicio &#x3d; stExercicio                                                            &#xd;&#xa;		                     AND transferencia.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;		                     AND transferencia.cod_tipo IN &#x28;1&#x29;&#xd;&#xa;		                GROUP BY tipo_registro&#xd;&#xa;		                       , cod_unidade_sub&#xd;&#xa;		                       , cod_ext&#xd;&#xa;		                       , cod_font_recurso&#xd;&#xa;		                       , vl_op&#xd;&#xa;		                       , cod_reduzido_op&#xd;&#xa;		                       , num_op&#xd;&#xa;		                       , num_documento_credor&#xd;&#xa;		                       , remove_acentos&#x28;plano_conta.nom_conta&#x29;&#xd;&#xa;		                       , cpf_responsavel&#xd;&#xa;		                       , tipo_documento_credor&#xd;&#xa;		                       , dt_pagamento&#xd;&#xa;		                       , lote.cod_lote&#xd;&#xa;		                ORDER BY cod_ext&#xd;&#xa;			&#x29;,&#xd;&#xa;			 ext31 as&#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT 31 AS tipo_registro&#xd;&#xa;		                       , tcemg.seq_num_op_extra&#x28;transferencia.exercicio,transferencia.cod_entidade,transferencia.cod_tipo,transferencia.cod_lote&#x29;&#x3a;&#x3a;varchar AS cod_reduzido_op&#xd;&#xa;		                       , CASE WHEN transferencia_tipo_documento.cod_tipo_documento IS NULL&#xd;&#xa;		                               AND SUBSTR&#x28;cod_ctb_transferencia.cod_estrutural, 1, 7&#x29; &#x3c;&#x3e; &#x27;1111101&#x27;&#xd;&#xa;		                              THEN &#x27;99&#x27;&#xd;&#xa;		                              WHEN SUBSTR&#x28;cod_ctb_transferencia.cod_estrutural, 1, 7&#x29; &#x3d; &#x27;1111101&#x27;&#xd;&#xa;		                              THEN &#x27;05&#x27;&#xd;&#xa;		                              ELSE transferencia_tipo_documento.cod_tipo_documento&#x3a;&#x3a;VARCHAR&#xd;&#xa;		                          END AS tipo_documento_op&#xd;&#xa;		                       , transferencia_tipo_documento.num_documento AS num_documento&#xd;&#xa;		                            , CASE WHEN SUBSTR&#x28;cod_ctb_transferencia.cod_estrutural, 1, 7&#x29; &#x3d; &#x27;1111101&#x27;&#xd;&#xa;		                                   THEN &#x27;&#x27;&#xd;&#xa;		                                   ELSE CASE WHEN cod_ctb_transferencia.cod_ctb_anterior IS NULL&#xd;&#xa;		                                             THEN transferencia.cod_plano_credito&#x3a;&#x3a;VARCHAR&#xd;&#xa;		                                             ELSE cod_ctb_transferencia.cod_ctb_anterior&#x3a;&#x3a;varchar&#xd;&#xa;		                                         END&#xd;&#xa;		                              END AS cod_ctb&#xd;&#xa;		                            , CASE WHEN transferencia.cod_plano_credito &#x3d; 3274&#xd;&#xa;		                                   THEN &#x28;&#xd;&#xa;		                                         SELECT COALESCE&#x28;plano_recurso.cod_recurso, &#x27;100&#x27;&#x29;&#xd;&#xa;		                                           FROM contabilidade.plano_conta&#xd;&#xa;		                                     INNER JOIN contabilidade.plano_analitica&#xd;&#xa;		                                             ON plano_conta.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;		                                            AND plano_conta.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;		                                     INNER JOIN contabilidade.plano_recurso&#xd;&#xa;		                                             ON plano_recurso.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;		                                            AND plano_recurso.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;		                                          WHERE plano_analitica.cod_plano &#x3d; cod_ctb_caixa.caixa_credito&#xd;&#xa;		                                            AND plano_analitica.exercicio &#x3d; transferencia.exercicio&#xd;&#xa;		                                            &#x29;&#xd;&#xa;		                                   ELSE CASE WHEN cod_ctb_transferencia.cod_recurso IS NOT NULL&#xd;&#xa;		                                             THEN COALESCE&#x28;cod_ctb_transferencia.cod_recurso, &#x27;100&#x27;&#x29;&#xd;&#xa;		                                             ELSE COALESCE&#x28;plano_recurso.cod_recurso,&#x27;100&#x27;&#x29;&#xd;&#xa;		                                         END&#xd;&#xa;		                               END AS cod_fonte_ctb&#xd;&#xa;		                             , CASE WHEN transferencia_tipo_documento.cod_tipo_documento &#x3d; 99 AND SUBSTR&#x28;cod_ctb_transferencia.cod_estrutural, 1, 7&#x29; &#x3c;&#x3e; &#x27;1111101&#x27; THEN &#x27;Outros&#x27;&#xd;&#xa;		                                   WHEN transferencia_tipo_documento.cod_tipo_documento IS NULL AND SUBSTR&#x28;cod_ctb_transferencia.cod_estrutural, 1, 7&#x29; &#x3c;&#x3e; &#x27;1111101&#x27; THEN &#x27;Outros&#x27;&#xd;&#xa;		                                   WHEN SUBSTR&#x28;cod_ctb_transferencia.cod_estrutural, 1, 7&#x29; &#x3d; &#x27;1111101&#x27; THEN &#x27;&#x27;&#xd;&#xa;		                                   ELSE tipo_documento.descricao&#xd;&#xa;		                              END AS desctipodocumentoop&#xd;&#xa;		                            , TO_CHAR&#x28;transferencia.dt_autenticacao, &#x27;ddmmyyyy&#x27;&#x29; AS dt_emissao&#xd;&#xa;		                            , COALESCE&#x28;lote.vl_lancamento, 0.00&#x29; AS vl_documento&#xd;&#xa;									, lote.cod_plano&#x3a;&#x3a;varchar&#xd;&#xa;		                    FROM &#x28;&#xd;&#xa;		                          SELECT lote.cod_lote&#xd;&#xa;		                               , lote.dt_lote&#xd;&#xa;		                               , lote.exercicio&#xd;&#xa;		                               , conta_debito.cod_plano&#xd;&#xa;		                               , lote.tipo&#xd;&#xa;		                               , lote.cod_entidade&#xd;&#xa;		                               , valor_lancamento.vl_lancamento&#xd;&#xa;		                            FROM contabilidade.lote&#xd;&#xa;		                      INNER JOIN contabilidade.lancamento&#xd;&#xa;		                              ON lancamento.exercicio    &#x3d; lote.exercicio&#xd;&#xa;		                             AND lancamento.cod_entidade &#x3d; lote.cod_entidade&#xd;&#xa;		                             AND lancamento.tipo         &#x3d; lote.tipo&#xd;&#xa;		                             AND lancamento.cod_lote     &#x3d; lote.cod_lote&#xd;&#xa;		                      INNER JOIN contabilidade.valor_lancamento&#xd;&#xa;		                              ON valor_lancamento.exercicio    &#x3d; lancamento.exercicio&#xd;&#xa;		                             AND valor_lancamento.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;		                             AND valor_lancamento.tipo         &#x3d; lancamento.tipo&#xd;&#xa;		                             AND valor_lancamento.cod_lote     &#x3d; lancamento.cod_lote&#xd;&#xa;		                             AND valor_lancamento.sequencia    &#x3d; lancamento.sequencia&#xd;&#xa;		                             AND valor_lancamento.tipo_valor &#x3d; &#x27;D&#x27;&#xd;&#xa;		                      INNER JOIN contabilidade.conta_debito&#xd;&#xa;		                              ON conta_debito.exercicio &#x3d; valor_lancamento.exercicio&#xd;&#xa;		                             AND conta_debito.cod_entidade &#x3d; valor_lancamento.cod_entidade&#xd;&#xa;		                             AND conta_debito.tipo &#x3d; valor_lancamento.tipo&#xd;&#xa;		                             AND conta_debito.cod_lote &#x3d; valor_lancamento.cod_lote&#xd;&#xa;		                             AND conta_debito.sequencia &#x3d; valor_lancamento.sequencia&#xd;&#xa;		                             AND conta_debito.tipo_valor &#x3d; valor_lancamento.tipo_valor&#xd;&#xa;		                             AND valor_lancamento.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;		                           WHERE lote.exercicio &#x3d; stExercicio                                                                 &#xd;&#xa;		                             AND lote.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;		                             AND lote.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;         &#xd;&#xa;		                             AND lote.dt_lote BETWEEN TO_DATE &#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                      &#xd;&#xa;		                                                  AND TO_DATE &#x28;stDtfim, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                         &#xd;&#xa;		                        ORDER BY lote.cod_lote&#xd;&#xa;		                         &#x29; AS lote&#xd;&#xa;		              INNER JOIN tesouraria.transferencia&#xd;&#xa;		                      ON lote.exercicio     &#x3d; transferencia.exercicio&#xd;&#xa;		                     AND lote.tipo          &#x3d; transferencia.tipo&#xd;&#xa;		                     AND lote.cod_entidade  &#x3d; transferencia.cod_entidade&#xd;&#xa;		                     AND lote.cod_lote      &#x3d; transferencia.cod_lote&#xd;&#xa;		                     AND lote.cod_plano     &#x3d; transferencia.cod_plano_debito&#xd;&#xa;		              INNER JOIN contabilidade.plano_analitica&#xd;&#xa;		                      ON plano_analitica.cod_plano &#x3d; transferencia.cod_plano_debito&#xd;&#xa;		                     AND plano_analitica.exercicio &#x3d; transferencia.exercicio&#xd;&#xa;		               LEFT JOIN tcemg.balancete_extmmaa&#xd;&#xa;		                      ON balancete_extmmaa.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;		                     AND balancete_extmmaa.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;		               LEFT JOIN tcemg.transferencia_tipo_documento&#xd;&#xa;		                      ON transferencia_tipo_documento.exercicio    &#x3d; lote.exercicio&#xd;&#xa;		                     AND transferencia_tipo_documento.cod_entidade &#x3d; lote.cod_entidade&#xd;&#xa;		                     AND transferencia_tipo_documento.tipo         &#x3d; lote.tipo&#xd;&#xa;		                     AND transferencia_tipo_documento.cod_lote     &#x3d; lote.cod_lote&#xd;&#xa;		               LEFT JOIN tcemg.tipo_documento&#xd;&#xa;		                      ON tipo_documento.cod_tipo &#x3d; transferencia_tipo_documento.cod_tipo_documento&#xd;&#xa;		               LEFT JOIN contabilidade.plano_recurso&#xd;&#xa;		                      ON plano_recurso.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;		                     AND plano_recurso.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;		                 LEFT JOIN &#x28;&#xd;&#xa;		                            SELECT conta_debito.cod_lote&#xd;&#xa;		                                       , conta_debito.tipo&#xd;&#xa;		                                       , conta_debito.exercicio&#xd;&#xa;		                                       , conta_debito.cod_entidade&#xd;&#xa;		                                 , plano_recurso.cod_recurso&#xd;&#xa;		                                       , conta_bancaria.cod_ctb_anterior&#xd;&#xa;		                                       , transferencia.cod_plano_credito&#xd;&#xa;		                                       , transferencia.cod_plano_debito&#xd;&#xa;		                                       , conta_debito.sequencia&#xd;&#xa;		                                 , REPLACE&#x28;plano_conta.cod_estrutural , &#x27;.&#x27;, &#x27;&#x27;&#x29; as cod_estrutural&#xd;&#xa;		                              FROM contabilidade.conta_debito&#xd;&#xa;		                        INNER JOIN contabilidade.lote AS lo&#xd;&#xa;		                                ON conta_debito.cod_lote     &#x3d; lo.cod_lote&#xd;&#xa;		                                   AND conta_debito.tipo         &#x3d; lo.tipo&#xd;&#xa;		                                   AND conta_debito.exercicio    &#x3d; lo.exercicio&#xd;&#xa;		                                   AND conta_debito.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;		                        INNER JOIN tesouraria.transferencia&#xd;&#xa;		                                      ON transferencia.cod_plano_debito &#x3d; conta_debito.cod_plano&#xd;&#xa;		                                   AND lo.cod_lote                &#x3d; transferencia.cod_lote&#xd;&#xa;		                                   AND transferencia.exercicio    &#x3d; lo.exercicio&#xd;&#xa;		                                   AND transferencia.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;		                                   AND transferencia.tipo         &#x3d; &#x27;T&#x27;&#xd;&#xa;		                                   AND transferencia.cod_tipo     &#x3d; 1&#xd;&#xa;		                        INNER JOIN contabilidade.plano_analitica&#xd;&#xa;		                                ON plano_analitica.cod_plano      &#x3d; transferencia.cod_plano_credito&#xd;&#xa;		                               AND plano_analitica.natureza_saldo &#x3d; &#x27;D&#x27;&#xd;&#xa;		                               AND plano_analitica.exercicio      &#x3d; conta_debito.exercicio&#xd;&#xa;		                        INNER JOIN contabilidade.plano_conta&#xd;&#xa;		                                ON plano_analitica.exercicio &#x3d; plano_conta.exercicio&#xd;&#xa;		                               AND plano_analitica.cod_conta &#x3d; plano_conta.cod_conta&#xd;&#xa;		                         LEFT JOIN contabilidade.plano_recurso&#xd;&#xa;		                                ON plano_recurso.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;		                               AND plano_recurso.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;		                         LEFT JOIN tcemg.conta_bancaria&#xd;&#xa;		                                      ON conta_bancaria.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;		                                   AND conta_bancaria.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;		                             WHERE conta_debito.exercicio &#x3d; stExercicio                                                             &#xd;&#xa;		                               AND conta_debito.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;		&#xd;&#xa;		                               AND lo.dt_lote BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                             &#xd;&#xa;		                                                  AND TO_DATE&#x28;stDtfim, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;	                                            &#xd;&#xa;		                               AND lo.exercicio &#x3d; stExercicio                                                                       &#xd;&#xa;		                                   AND conta_debito.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;		                           &#x29; AS cod_ctb_transferencia&#xd;&#xa;		                        ON cod_ctb_transferencia.exercicio        &#x3d; lote.exercicio&#xd;&#xa;		                       AND cod_ctb_transferencia.cod_lote         &#x3d; lote.cod_lote&#xd;&#xa;		                       AND cod_ctb_transferencia.tipo             &#x3d; lote.tipo&#xd;&#xa;		                       AND cod_ctb_transferencia.cod_plano_debito &#x3d; lote.cod_plano&#xd;&#xa;		               LEFT JOIN tcemg.contabilidade_lote_transferencia AS de_para_lote&#xd;&#xa;		                      ON de_para_lote.exercicio_credito    &#x3d; lote.exercicio&#xd;&#xa;		                     AND de_para_lote.cod_entidade_credito &#x3d; lote.cod_entidade&#xd;&#xa;		                     AND de_para_lote.tipo_credito         &#x3d; lote.tipo&#xd;&#xa;		                     AND de_para_lote.cod_lote_credito     &#x3d; lote.cod_lote&#xd;&#xa;		                   LEFT JOIN &#x28;&#xd;&#xa;		                              SELECT conta_debito.tipo&#xd;&#xa;		                                   , transferencia.cod_tipo&#xd;&#xa;		                                        , conta_debito.exercicio&#xd;&#xa;		                                        , conta_debito.cod_entidade&#xd;&#xa;		                                       , CASE WHEN &#x28;conta_bancaria.cod_ctb_anterior is null&#x29; THEN transferencia.cod_plano_credito&#xd;&#xa;		                                                                Else conta_bancaria.cod_ctb_anterior&#xd;&#xa;		                                                                END AS cod_ctb_anterior&#xd;&#xa;		                                        , transferencia.cod_plano_credito AS caixa_credito&#xd;&#xa;		                                        , transferencia.cod_plano_debito  AS caixa_debito&#xd;&#xa;		                                        , valor_lancamento.vl_lancamento&#xd;&#xa;		                                        , lo.cod_lote&#xd;&#xa;		                                        , lo.dt_lote&#xd;&#xa;		                                     FROM contabilidade.conta_debito&#xd;&#xa;		                               INNER JOIN contabilidade.valor_lancamento&#xd;&#xa;		                                       ON valor_lancamento.exercicio    &#x3d; conta_debito.exercicio&#xd;&#xa;		                                      AND valor_lancamento.cod_entidade &#x3d; conta_debito.cod_entidade&#xd;&#xa;		                                      AND valor_lancamento.tipo         &#x3d; conta_debito.tipo&#xd;&#xa;		                                      AND valor_lancamento.cod_lote     &#x3d; conta_debito.cod_lote&#xd;&#xa;		                                      AND valor_lancamento.sequencia    &#x3d; conta_debito.sequencia&#xd;&#xa;		                                      AND valor_lancamento.tipo_valor   &#x3d; conta_debito.tipo_valor&#xd;&#xa;		                                      AND valor_lancamento.tipo_valor &#x3d; &#x27;D&#x27;&#xd;&#xa;		                               INNER JOIN contabilidade.lote AS lo&#xd;&#xa;		                                       ON conta_debito.cod_lote     &#x3d; lo.cod_lote&#xd;&#xa;		                                      AND conta_debito.tipo         &#x3d; lo.tipo&#xd;&#xa;		                                      AND conta_debito.exercicio    &#x3d; lo.exercicio&#xd;&#xa;		                                      AND conta_debito.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;		                               INNER JOIN tesouraria.transferencia&#xd;&#xa;		                                       ON transferencia.cod_plano_debito &#x3d; conta_debito.cod_plano&#xd;&#xa;		                                      AND lo.cod_lote &#x3d; transferencia.cod_lote&#xd;&#xa;		                                      AND transferencia.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;		                                      AND transferencia.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;		                                      AND transferencia.exercicio &#x3d; conta_debito.exercicio&#xd;&#xa;		                               INNER JOIN contabilidade.plano_analitica&#xd;&#xa;		                                       ON plano_analitica.cod_plano &#x3d; transferencia.cod_plano_credito&#xd;&#xa;		                                      &#xd;&#xa;		                                      AND plano_analitica.exercicio &#x3d; conta_debito.exercicio&#xd;&#xa;		                                LEFT JOIN tcemg.conta_bancaria&#xd;&#xa;		                                       ON conta_bancaria.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;		                                      AND conta_bancaria.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;		                                   WHERE conta_debito.exercicio &#x3d; stExercicio                                                                 &#xd;&#xa;		                                     AND conta_debito.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;         &#xd;&#xa;		                                     AND lo.dt_lote BETWEEN TO_DATE &#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE &#x28;stDtfim, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;            &#xd;&#xa;		                                     AND conta_debito.tipo      &#x3d; &#x27;T&#x27;&#xd;&#xa;		                                     AND transferencia.cod_tipo &#x3d; 5&#xd;&#xa;		                                     AND conta_debito.cod_plano &#x3d; 3274&#xd;&#xa;		                                GROUP BY conta_debito.tipo&#xd;&#xa;		                                       , transferencia.cod_tipo&#xd;&#xa;		                                       , conta_debito.exercicio&#xd;&#xa;		                                       , conta_debito.cod_entidade&#xd;&#xa;		                                       , transferencia.cod_plano_credito&#xd;&#xa;		                                       , transferencia.cod_plano_debito&#xd;&#xa;		                                       , valor_lancamento.vl_lancamento&#xd;&#xa;		                                       , lo.cod_lote&#xd;&#xa;		                                       , lo.dt_lote&#xd;&#xa;		                                       , cod_ctb_anterior&#xd;&#xa;		                             &#x29; AS cod_ctb_caixa&#xd;&#xa;		                          ON de_para_lote.exercicio_debito    &#x3d; cod_ctb_caixa.exercicio&#xd;&#xa;		                         AND de_para_lote.cod_entidade_debito &#x3d; cod_ctb_caixa.cod_entidade&#xd;&#xa;		                         AND de_para_lote.tipo_debito         &#x3d; cod_ctb_caixa.tipo&#xd;&#xa;		                         AND de_para_lote.cod_lote_debito     &#x3d; cod_ctb_caixa.cod_lote&#xd;&#xa;		                     WHERE balancete_extmmaa.exercicio &#x3d; stExercicio                                                       &#xd;&#xa;		                       AND transferencia.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;		                       AND transferencia.cod_tipo &#x3d; 1&#xd;&#xa;		                  GROUP BY tipo_registro&#xd;&#xa;		                         , tipo_documento_op&#xd;&#xa;		                         , num_documento&#xd;&#xa;		                         , cod_reduzido_op&#xd;&#xa;		                         , cod_ctb&#xd;&#xa;		                         , cod_fonte_ctb&#xd;&#xa;		                         , desctipodocumentoop&#xd;&#xa;		                         , dt_emissao&#xd;&#xa;		                         , vl_documento&#xd;&#xa;								 , lote.cod_plano&#xd;&#xa;		                  ORDER BY lote.cod_plano &#xd;&#xa;			&#x29;,&#xd;&#xa;			  ext_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_ext,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_ext&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipo_lancamento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;sub_tipo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;desdobra_sub_tipo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;desc_extra_orc&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from ext10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_ext,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_ext&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_font_recurso&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_saldo_ant&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;natureza_conta&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;total_debitos&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;total_creditos&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_saldo_atual&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nat_saldo_atual_fonte&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from ext20&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_ext,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_ext&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					    &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_font_recurso&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_reduzido_op&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_op&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_sub&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_pagamento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_documento_credor&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_documento_credor&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_op&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;especificacao_op&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,200&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cpf_responsavel&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 11, &#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from ext30&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_plano as cod_ext,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_reduzido_op&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipo_documento_op&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_ctb&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_fonte_ctb&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;desctipodocumentoop&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_emissao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_documento&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from ext31&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;EXT.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from ext_format order by cod_ext, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;REGADESAO.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with regadesao10 as&#xd;&#xa;			&#x28;&#xd;&#xa;					 SELECT  parp.cod_entidade&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;parp.numero_registro_precos&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;parp.exercicio&#x3a;&#x3a;VARCHAR AS chave10&#xd;&#xa;			                  ,  10 AS tipo_registro&#xd;&#xa;			                  ,  &#x28;SELECT valor FROM administracao.configuracao_entidade WHERE exercicio &#x3d; parp.exercicio AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27; AND cod_entidade &#x3d; parp.cod_entidade&#x29; AS cod_orgao&#xd;&#xa;			                  ,  CASE WHEN registro_precos_orgao.numero_registro_precos IS NOT NULL&#xd;&#xa;			                                THEN LPAD&#x28;LPAD&#x28;registro_precos_orgao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;registro_precos_orgao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;			                                ELSE LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;			                     END AS cod_unidade_sub&#xd;&#xa;			                  ,  parp.numero_registro_precos&#xd;&#xa;			                  ,  parp.exercicio AS exercicio_adesao&#xd;&#xa;			                  ,  TO_CHAR&#x28;parp.data_abertura_registro_precos, &#x27;ddmmyyyy&#x27;&#x29; AS data_abertura_processo_adesao&#xd;&#xa;			                  ,  CASE WHEN RPO.nome_orgao_gerenciador IS NOT NULL&#xd;&#xa;			                                THEN RPO.nome_orgao_gerenciador&#xd;&#xa;			                                ELSE sw_cgm.nom_cgm&#xd;&#xa;			                     END AS nome_orgao_gerenciador&#xd;&#xa;			                  ,  parp.exercicio_licitacao&#xd;&#xa;			                  ,  parp.numero_processo_licitacao AS numero_processo_licitacao&#xd;&#xa;			                  &#xd;&#xa;			                  &#xd;&#xa;			                  ,  CASE WHEN parp.codigo_modalidade_licitacao &#x3d; 3 THEN 1&#xd;&#xa;			                          WHEN parp.codigo_modalidade_licitacao IN &#x28;6,7&#x29; THEN 2&#xd;&#xa;						              ELSE parp.codigo_modalidade_licitacao&#xd;&#xa;			                     END AS codigo_modalidade_licitacao&#xd;&#xa;			                  ,  parp.numero_modalidade&#xd;&#xa;			                  ,  TO_CHAR&#x28;homologacao.timestamp,&#x27;ddmmyyyy&#x27;&#x29; AS data_homologacao_licitacao&#xd;&#xa;			                  ,  TO_CHAR&#x28;parp.data_ata_registro_preco, &#x27;ddmmyyyy&#x27;&#x29; AS data_ata_registro_preco&#xd;&#xa;			                  ,  TO_CHAR&#x28;parp.data_ata_registro_preco_validade, &#x27;ddmmyyyy&#x27;&#x29; AS data_ata_registro_preco_validade&#xd;&#xa;			                  ,  CASE WHEN registro_precos_orgao.participante &#x3d; TRUE THEN 1&#xd;&#xa;			                          WHEN registro_precos_orgao.participante &#x3d; FALSE THEN 2&#xd;&#xa;			                     END AS natureza_procedimento&#xd;&#xa;			                  ,  TO_CHAR&#x28;registro_precos_orgao.dt_publicacao_aviso_intencao, &#x27;ddmmyyyy&#x27;&#x29; AS data_publicacao_aviso_intencao&#xd;&#xa;			                  ,  parp.objeto AS objeto_adesao&#xd;&#xa;			                  ,  &#x28;SELECT cpf FROM sw_cgm_pessoa_fisica WHERE sw_cgm_pessoa_fisica.numcgm &#x3d; parp.cgm_responsavel&#x29; AS cpf_responsavel&#xd;&#xa;			                  ,  parp.desconto_tabela&#xd;&#xa;			                  ,  parp.processo_lote&#xd;&#xa;			              FROM  tcemg.registro_precos AS parp&#xd;&#xa;			        INNER JOIN  sw_cgm&#xd;&#xa;			                ON  sw_cgm.numcgm &#x3d; parp.numcgm_gerenciador&#xd;&#xa;			         LEFT JOIN  tcemg.registro_precos_orgao&#xd;&#xa;			                ON  registro_precos_orgao.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;			               AND  registro_precos_orgao.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;			               AND  registro_precos_orgao.exercicio_registro_precos &#x3d; parp.exercicio&#xd;&#xa;			               AND  registro_precos_orgao.interno &#x3d; parp.interno&#xd;&#xa;			               AND  registro_precos_orgao.numcgm_gerenciador &#x3d; parp.numcgm_gerenciador&#xd;&#xa;			         LEFT JOIN  &#x28;&#xd;&#xa;			                       SELECT orgao.nom_orgao&#x7c;&#x7c;&#x27; - &#x27;&#x7c;&#x7c;unidade.nom_unidade AS nome_orgao_gerenciador&#xd;&#xa;			                            , RPO.&#x2a;&#xd;&#xa;			                         FROM tcemg.registro_precos_orgao AS RPO&#xd;&#xa;			                       INNER JOIN orcamento.orgao&#xd;&#xa;			                           ON orgao.num_orgao &#x3d; RPO.num_orgao&#xd;&#xa;			                          AND orgao.exercicio &#x3d; RPO.exercicio_unidade&#xd;&#xa;			                       INNER JOIN orcamento.unidade&#xd;&#xa;			                           ON unidade.num_orgao &#x3d; RPO.num_orgao&#xd;&#xa;			                          AND unidade.num_unidade &#x3d; RPO.num_unidade&#xd;&#xa;			                          AND unidade.exercicio &#x3d; RPO.exercicio_unidade&#xd;&#xa;			                        WHERE RPO.gerenciador &#x3d; TRUE&#xd;&#xa;			                 &#x29;  AS RPO&#xd;&#xa;			                ON  RPO.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;			               AND  RPO.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;			               AND  RPO.exercicio_registro_precos &#x3d; parp.exercicio&#xd;&#xa;			               AND  RPO.interno &#x3d; parp.interno&#xd;&#xa;			               AND  RPO.numcgm_gerenciador &#x3d; parp.numcgm_gerenciador&#xd;&#xa;			        INNER JOIN  tcemg.registro_precos_licitacao&#xd;&#xa;			                ON  registro_precos_licitacao.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;			               AND  registro_precos_licitacao.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;			               AND  registro_precos_licitacao.exercicio &#x3d; parp.exercicio&#xd;&#xa;			               AND  registro_precos_licitacao.interno &#x3d; parp.interno&#xd;&#xa;			        INNER JOIN &#x28;&#xd;&#xa;			                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;&#x27;&#x27;, stEntidade&#x29;       &#xd;&#xa;																		VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																		   ,cod_modalidade		INTEGER&#xd;&#xa;																		   ,cod_entidade		INTEGER&#xd;&#xa;																		   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																		   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																		   ,num_licitacao		TEXT &#x29;&#xd;&#xa;			                 &#x29;  config_licitacao&#xd;&#xa;			                ON  config_licitacao.cod_entidade &#x3d; registro_precos_licitacao.cod_entidade_licitacao&#xd;&#xa;			               AND  config_licitacao.cod_licitacao &#x3d; registro_precos_licitacao.cod_licitacao&#xd;&#xa;			               AND  config_licitacao.cod_modalidade &#x3d; registro_precos_licitacao.cod_modalidade&#xd;&#xa;			               AND  config_licitacao.exercicio &#x3d; registro_precos_licitacao.exercicio_licitacao&#xd;&#xa;			        INNER JOIN  licitacao.licitacao&#xd;&#xa;			                ON  licitacao.cod_licitacao &#x3d; config_licitacao.cod_licitacao&#xd;&#xa;			               AND  licitacao.cod_modalidade &#x3d; config_licitacao.cod_modalidade&#xd;&#xa;			               AND  licitacao.cod_entidade &#x3d; config_licitacao.cod_entidade&#xd;&#xa;			               AND  licitacao.exercicio &#x3d; config_licitacao.exercicio&#xd;&#xa;			        INNER JOIN &#x28;       SELECT cod_licitacao&#xd;&#xa;			                                , cod_modalidade&#xd;&#xa;			                                , cod_entidade&#xd;&#xa;			                                , exercicio_licitacao&#xd;&#xa;			                                , MAX&#x28;num_homologacao&#x29; AS num_homologacao&#xd;&#xa;			                                , MAX&#x28;timestamp&#x29; AS timestamp&#xd;&#xa;			                                , MAX&#x28;cod_item&#x29; AS cod_item&#xd;&#xa;			                             FROM licitacao.homologacao&#xd;&#xa;			                         GROUP BY cod_licitacao&#xd;&#xa;			                                , cod_modalidade&#xd;&#xa;			                                , cod_entidade&#xd;&#xa;			                                , exercicio_licitacao&#xd;&#xa;			                 &#x29;  AS homologacao&#xd;&#xa;			                ON  homologacao.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;			               AND  homologacao.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;			               AND  homologacao.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;			               AND  homologacao.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;			               AND  &#x28;      SELECT homologacao_anulada.num_homologacao&#xd;&#xa;			                             FROM licitacao.homologacao_anulada&#xd;&#xa;			                            WHERE homologacao_anulada.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;			                              AND homologacao_anulada.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;			                              AND homologacao_anulada.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;			                              AND homologacao_anulada.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;			                              AND homologacao.num_homologacao             &#x3d; homologacao_anulada.num_homologacao&#xd;&#xa;			                              AND homologacao.cod_item                    &#x3d; homologacao_anulada.cod_item&#xd;&#xa;			                    &#x29; IS NULL&#xd;&#xa;			             WHERE  1&#x3d;1  AND parp.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29; AND TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     &#xd;&#xa;			                      AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29;  &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;                                                               &#xd;&#xa;			&#x29;,&#xd;&#xa;			 regadesao11 as&#xd;&#xa;			&#x28;&#xd;&#xa;							SELECT  lrp.cod_entidade&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;lrp.numero_registro_precos&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;lrp.exercicio&#x3a;&#x3a;VARCHAR AS chave11&#xd;&#xa;				                  ,  11 AS tipo_registro&#xd;&#xa;				                  ,  &#x28;SELECT valor FROM administracao.configuracao_entidade WHERE exercicio &#x3d; parp.exercicio AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27; AND cod_entidade &#x3d; parp.cod_entidade&#x29; AS cod_orgao&#xd;&#xa;				                  ,  CASE WHEN registro_precos_orgao.numero_registro_precos IS NOT NULL&#xd;&#xa;				                                THEN LPAD&#x28;LPAD&#x28;registro_precos_orgao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;registro_precos_orgao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;				                                ELSE LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;				                     END AS cod_unidade_sub&#xd;&#xa;				                  ,  parp.numero_registro_precos&#xd;&#xa;				                  ,  parp.exercicio AS exercicio_adesao&#xd;&#xa;				                  ,  lrp.cod_lote&#xd;&#xa;				                  ,  lrp.descricao_lote&#xd;&#xa;				              FROM  tcemg.registro_precos AS parp&#xd;&#xa;				        INNER JOIN  tcemg.lote_registro_precos lrp&#xd;&#xa;				                ON  lrp.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;				               AND  lrp.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;				               AND  lrp.exercicio &#x3d; parp.exercicio&#xd;&#xa;				         LEFT JOIN  tcemg.registro_precos_orgao&#xd;&#xa;				                ON  registro_precos_orgao.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;				               AND  registro_precos_orgao.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;				               AND  registro_precos_orgao.exercicio_registro_precos &#x3d; parp.exercicio&#xd;&#xa;				               AND  registro_precos_orgao.interno &#x3d; parp.interno&#xd;&#xa;				               AND  registro_precos_orgao.numcgm_gerenciador &#x3d; parp.numcgm_gerenciador&#xd;&#xa;				        INNER JOIN  tcemg.registro_precos_licitacao&#xd;&#xa;				                ON  registro_precos_licitacao.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;				               AND  registro_precos_licitacao.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;				               AND  registro_precos_licitacao.exercicio &#x3d; parp.exercicio&#xd;&#xa;				               AND  registro_precos_licitacao.interno &#x3d; parp.interno&#xd;&#xa;				        INNER JOIN &#x28;&#xd;&#xa;				                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;&#x27;&#x27;, stEntidade&#x29;      &#xd;&#xa;																			VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																			   ,cod_modalidade		INTEGER&#xd;&#xa;																			   ,cod_entidade		INTEGER&#xd;&#xa;																			   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																			   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																			   ,num_licitacao		TEXT &#x29;&#xd;&#xa;				                 &#x29;  config_licitacao&#xd;&#xa;				                ON  config_licitacao.cod_entidade &#x3d; registro_precos_licitacao.cod_entidade_licitacao&#xd;&#xa;				               AND  config_licitacao.cod_licitacao &#x3d; registro_precos_licitacao.cod_licitacao&#xd;&#xa;				               AND  config_licitacao.cod_modalidade &#x3d; registro_precos_licitacao.cod_modalidade&#xd;&#xa;				               AND  config_licitacao.exercicio &#x3d; registro_precos_licitacao.exercicio_licitacao&#xd;&#xa;				        INNER JOIN  licitacao.licitacao&#xd;&#xa;				                ON  licitacao.cod_licitacao &#x3d; config_licitacao.cod_licitacao&#xd;&#xa;				               AND  licitacao.cod_modalidade &#x3d; config_licitacao.cod_modalidade&#xd;&#xa;				               AND  licitacao.cod_entidade &#x3d; config_licitacao.cod_entidade&#xd;&#xa;				               AND  licitacao.exercicio &#x3d; config_licitacao.exercicio&#xd;&#xa;				        INNER JOIN &#x28;       SELECT cod_licitacao&#xd;&#xa;				                                , cod_modalidade&#xd;&#xa;				                                , cod_entidade&#xd;&#xa;				                                , exercicio_licitacao&#xd;&#xa;				                                , MAX&#x28;num_homologacao&#x29; AS num_homologacao&#xd;&#xa;				                                , MAX&#x28;timestamp&#x29; AS timestamp&#xd;&#xa;				                                , MAX&#x28;cod_item&#x29; AS cod_item&#xd;&#xa;				                             FROM licitacao.homologacao&#xd;&#xa;				                         GROUP BY cod_licitacao&#xd;&#xa;				                                , cod_modalidade&#xd;&#xa;				                                , cod_entidade&#xd;&#xa;				                                , exercicio_licitacao&#xd;&#xa;				                 &#x29;  AS homologacao&#xd;&#xa;				                ON  homologacao.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;				               AND  homologacao.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;				               AND  homologacao.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;				               AND  homologacao.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;				               AND  &#x28;      SELECT homologacao_anulada.num_homologacao&#xd;&#xa;				                             FROM licitacao.homologacao_anulada&#xd;&#xa;				                            WHERE homologacao_anulada.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;				                              AND homologacao_anulada.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;				                              AND homologacao_anulada.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;				                              AND homologacao_anulada.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;				                              AND homologacao.num_homologacao             &#x3d; homologacao_anulada.num_homologacao&#xd;&#xa;				                              AND homologacao.cod_item                    &#x3d; homologacao_anulada.cod_item&#xd;&#xa;				                    &#x29; IS NULL&#xd;&#xa;				             WHERE  1&#x3d;1&#xd;&#xa;				 AND parp.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;    &#xd;&#xa;				 AND TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;				                        BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;      &#xd;&#xa;				                            AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;      &#xd;&#xa;				ORDER BY chave11, cod_orgao, cod_unidade_sub, parp.numero_registro_precos, parp.exercicio, lrp.cod_lote&#xd;&#xa;			&#x29;,&#xd;&#xa;			regadesao12 as&#xd;&#xa;			&#x28;&#xd;&#xa;		             SELECT  irp.cod_entidade&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;irp.numero_registro_precos&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;irp.exercicio&#x3a;&#x3a;VARCHAR AS chave12&#xd;&#xa;					                  ,  12 AS tipo_registro&#xd;&#xa;					                  ,  &#x28;SELECT valor FROM administracao.configuracao_entidade WHERE exercicio &#x3d; parp.exercicio AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27; AND cod_entidade &#x3d; parp.cod_entidade&#x29; AS cod_orgao&#xd;&#xa;					                  ,  CASE WHEN registro_precos_orgao.numero_registro_precos IS NOT NULL&#xd;&#xa;					                                THEN LPAD&#x28;LPAD&#x28;registro_precos_orgao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;registro_precos_orgao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;					                                ELSE LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;					                     END AS cod_unidade_sub&#xd;&#xa;					                  ,  parp.numero_registro_precos&#xd;&#xa;					                  ,  parp.exercicio AS exercicio_adesao&#xd;&#xa;					                  ,  irp.cod_item&#xd;&#xa;					                  ,  irp.num_item&#xd;&#xa;					              FROM  tcemg.registro_precos AS parp&#xd;&#xa;					        INNER JOIN  tcemg.item_registro_precos irp&#xd;&#xa;					                ON  irp.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;					               AND  irp.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;					               AND  irp.exercicio &#x3d; parp.exercicio&#xd;&#xa;					        INNER JOIN  tcemg.registro_precos_orgao&#xd;&#xa;					                ON  registro_precos_orgao.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;					               AND  registro_precos_orgao.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;					               AND  registro_precos_orgao.exercicio_registro_precos &#x3d; parp.exercicio&#xd;&#xa;					               AND  registro_precos_orgao.interno &#x3d; parp.interno&#xd;&#xa;					               AND  registro_precos_orgao.numcgm_gerenciador &#x3d; parp.numcgm_gerenciador&#xd;&#xa;					        INNER JOIN  tcemg.registro_precos_orgao_item&#xd;&#xa;					                ON  registro_precos_orgao_item.cod_entidade &#x3d; registro_precos_orgao.cod_entidade&#xd;&#xa;					               AND  registro_precos_orgao_item.numero_registro_precos &#x3d; registro_precos_orgao.numero_registro_precos&#xd;&#xa;					               AND  registro_precos_orgao_item.exercicio_registro_precos &#x3d; registro_precos_orgao.exercicio_registro_precos&#xd;&#xa;					               AND  registro_precos_orgao_item.interno &#x3d; registro_precos_orgao.interno&#xd;&#xa;					               AND  registro_precos_orgao_item.numcgm_gerenciador &#x3d; registro_precos_orgao.numcgm_gerenciador&#xd;&#xa;					               AND  registro_precos_orgao_item.exercicio_unidade &#x3d; registro_precos_orgao.exercicio_unidade&#xd;&#xa;					               AND  registro_precos_orgao_item.num_unidade &#x3d; registro_precos_orgao.num_unidade&#xd;&#xa;					               AND  registro_precos_orgao_item.num_orgao &#x3d; registro_precos_orgao.num_orgao&#xd;&#xa;					               AND  registro_precos_orgao_item.cod_lote &#x3d; irp.cod_lote&#xd;&#xa;					               AND  registro_precos_orgao_item.cod_item &#x3d; irp.cod_item&#xd;&#xa;					               AND  registro_precos_orgao_item.cgm_fornecedor &#x3d; irp.cgm_fornecedor&#xd;&#xa;					        INNER JOIN  tcemg.registro_precos_licitacao&#xd;&#xa;					                ON  registro_precos_licitacao.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;					               AND  registro_precos_licitacao.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;					               AND  registro_precos_licitacao.exercicio &#x3d; parp.exercicio&#xd;&#xa;					               AND  registro_precos_licitacao.interno &#x3d; parp.interno&#xd;&#xa;					        INNER JOIN &#x28;&#xd;&#xa;					                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;&#x27;&#x27;, stEntidade&#x29;    &#xd;&#xa;																				VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																				   ,cod_modalidade		INTEGER&#xd;&#xa;																				   ,cod_entidade		INTEGER&#xd;&#xa;																				   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																				   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																				   ,num_licitacao		TEXT &#x29;&#xd;&#xa;					                 &#x29;  config_licitacao&#xd;&#xa;					                ON  config_licitacao.cod_entidade &#x3d; registro_precos_licitacao.cod_entidade_licitacao&#xd;&#xa;					               AND  config_licitacao.cod_licitacao &#x3d; registro_precos_licitacao.cod_licitacao&#xd;&#xa;					               AND  config_licitacao.cod_modalidade &#x3d; registro_precos_licitacao.cod_modalidade&#xd;&#xa;					               AND  config_licitacao.exercicio &#x3d; registro_precos_licitacao.exercicio_licitacao&#xd;&#xa;					        INNER JOIN  licitacao.licitacao&#xd;&#xa;					                ON  licitacao.cod_licitacao &#x3d; config_licitacao.cod_licitacao&#xd;&#xa;					               AND  licitacao.cod_modalidade &#x3d; config_licitacao.cod_modalidade&#xd;&#xa;					               AND  licitacao.cod_entidade &#x3d; config_licitacao.cod_entidade&#xd;&#xa;					               AND  licitacao.exercicio &#x3d; config_licitacao.exercicio&#xd;&#xa;					        INNER JOIN &#x28;       SELECT cod_licitacao&#xd;&#xa;					                                , cod_modalidade&#xd;&#xa;					                                , cod_entidade&#xd;&#xa;					                                , exercicio_licitacao&#xd;&#xa;					                                , MAX&#x28;num_homologacao&#x29; AS num_homologacao&#xd;&#xa;					                                , MAX&#x28;timestamp&#x29; AS timestamp&#xd;&#xa;					                                , MAX&#x28;cod_item&#x29; AS cod_item&#xd;&#xa;					                             FROM licitacao.homologacao&#xd;&#xa;					                         GROUP BY cod_licitacao&#xd;&#xa;					                                , cod_modalidade&#xd;&#xa;					                                , cod_entidade&#xd;&#xa;					                                , exercicio_licitacao&#xd;&#xa;					                 &#x29;  AS homologacao&#xd;&#xa;					                ON  homologacao.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;					               AND  homologacao.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;					               AND  homologacao.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;					               AND  homologacao.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;					               AND  &#x28;      SELECT homologacao_anulada.num_homologacao&#xd;&#xa;					                             FROM licitacao.homologacao_anulada&#xd;&#xa;					                            WHERE homologacao_anulada.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;					                              AND homologacao_anulada.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;					                              AND homologacao_anulada.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;					                              AND homologacao_anulada.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;					                              AND homologacao.num_homologacao             &#x3d; homologacao_anulada.num_homologacao&#xd;&#xa;					                              AND homologacao.cod_item                    &#x3d; homologacao_anulada.cod_item&#xd;&#xa;					                    &#x29; IS NULL&#xd;&#xa;					             WHERE  1&#x3d;1&#xd;&#xa;					 AND parp.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                                     &#xd;&#xa;					 AND TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;					                        BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                                             &#xd;&#xa;					                            AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;        &#xd;&#xa;					 GROUP BY 1,2,3,4,5,6,7,8,irp.cod_lote&#xd;&#xa;					ORDER BY chave12, cod_orgao, cod_unidade_sub, parp.numero_registro_precos, parp.exercicio, irp.cod_lote, irp.num_item&#xd;&#xa;			&#x29;,&#xd;&#xa;			 regadesao13 as&#xd;&#xa;			&#x28;&#xd;&#xa;		             SELECT  irp.cod_entidade&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;irp.numero_registro_precos&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;irp.exercicio&#x3a;&#x3a;VARCHAR AS chave13&#xd;&#xa;				                  ,  13 AS tipo_registro&#xd;&#xa;				                  ,  &#x28;SELECT valor FROM administracao.configuracao_entidade WHERE exercicio &#x3d; parp.exercicio AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27; AND cod_entidade &#x3d; parp.cod_entidade&#x29; AS cod_orgao&#xd;&#xa;				                  ,  CASE WHEN registro_precos_orgao.numero_registro_precos IS NOT NULL&#xd;&#xa;				                                THEN LPAD&#x28;LPAD&#x28;registro_precos_orgao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;registro_precos_orgao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;				                                ELSE LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;				                     END AS cod_unidade_sub&#xd;&#xa;				                  ,  parp.numero_registro_precos&#xd;&#xa;				                  ,  parp.exercicio AS exercicio_adesao&#xd;&#xa;				                  ,  irp.cod_item&#xd;&#xa;				                  ,  irp.cod_lote&#xd;&#xa;				              FROM  tcemg.registro_precos AS parp&#xd;&#xa;				        INNER JOIN  tcemg.item_registro_precos irp&#xd;&#xa;				                ON  irp.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;				               AND  irp.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;				               AND  irp.exercicio &#x3d; parp.exercicio&#xd;&#xa;				        INNER JOIN  tcemg.registro_precos_orgao&#xd;&#xa;				                ON  registro_precos_orgao.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;				               AND  registro_precos_orgao.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;				               AND  registro_precos_orgao.exercicio_registro_precos &#x3d; parp.exercicio&#xd;&#xa;				               AND  registro_precos_orgao.interno &#x3d; parp.interno&#xd;&#xa;				               AND  registro_precos_orgao.numcgm_gerenciador &#x3d; parp.numcgm_gerenciador&#xd;&#xa;				        INNER JOIN  tcemg.registro_precos_orgao_item&#xd;&#xa;				                ON  registro_precos_orgao_item.cod_entidade &#x3d; registro_precos_orgao.cod_entidade&#xd;&#xa;				               AND  registro_precos_orgao_item.numero_registro_precos &#x3d; registro_precos_orgao.numero_registro_precos&#xd;&#xa;				               AND  registro_precos_orgao_item.exercicio_registro_precos &#x3d; registro_precos_orgao.exercicio_registro_precos&#xd;&#xa;				               AND  registro_precos_orgao_item.interno &#x3d; registro_precos_orgao.interno&#xd;&#xa;				               AND  registro_precos_orgao_item.numcgm_gerenciador &#x3d; registro_precos_orgao.numcgm_gerenciador&#xd;&#xa;				               AND  registro_precos_orgao_item.exercicio_unidade &#x3d; registro_precos_orgao.exercicio_unidade&#xd;&#xa;				               AND  registro_precos_orgao_item.num_unidade &#x3d; registro_precos_orgao.num_unidade&#xd;&#xa;				               AND  registro_precos_orgao_item.num_orgao &#x3d; registro_precos_orgao.num_orgao&#xd;&#xa;				               AND  registro_precos_orgao_item.cod_lote &#x3d; irp.cod_lote&#xd;&#xa;				               AND  registro_precos_orgao_item.cod_item &#x3d; irp.cod_item&#xd;&#xa;				               AND  registro_precos_orgao_item.cgm_fornecedor &#x3d; irp.cgm_fornecedor&#xd;&#xa;				        INNER JOIN  tcemg.registro_precos_licitacao&#xd;&#xa;				                ON  registro_precos_licitacao.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;				               AND  registro_precos_licitacao.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;				               AND  registro_precos_licitacao.exercicio &#x3d; parp.exercicio&#xd;&#xa;				               AND  registro_precos_licitacao.interno &#x3d; parp.interno&#xd;&#xa;				        INNER JOIN &#x28;&#xd;&#xa;				                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;&#x27;&#x27;, stEntidade&#x29;                &#xd;&#xa;																			VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																			   ,cod_modalidade		INTEGER&#xd;&#xa;																			   ,cod_entidade		INTEGER&#xd;&#xa;																			   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																			   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																			   ,num_licitacao		TEXT &#x29;&#xd;&#xa;				                 &#x29;  config_licitacao&#xd;&#xa;				                ON  config_licitacao.cod_entidade &#x3d; registro_precos_licitacao.cod_entidade_licitacao&#xd;&#xa;				               AND  config_licitacao.cod_licitacao &#x3d; registro_precos_licitacao.cod_licitacao&#xd;&#xa;				               AND  config_licitacao.cod_modalidade &#x3d; registro_precos_licitacao.cod_modalidade&#xd;&#xa;				               AND  config_licitacao.exercicio &#x3d; registro_precos_licitacao.exercicio_licitacao&#xd;&#xa;				        INNER JOIN  licitacao.licitacao&#xd;&#xa;				                ON  licitacao.cod_licitacao &#x3d; config_licitacao.cod_licitacao&#xd;&#xa;				               AND  licitacao.cod_modalidade &#x3d; config_licitacao.cod_modalidade&#xd;&#xa;				               AND  licitacao.cod_entidade &#x3d; config_licitacao.cod_entidade&#xd;&#xa;				               AND  licitacao.exercicio &#x3d; config_licitacao.exercicio&#xd;&#xa;				        INNER JOIN &#x28;       SELECT cod_licitacao&#xd;&#xa;				                                , cod_modalidade&#xd;&#xa;				                                , cod_entidade&#xd;&#xa;				                                , exercicio_licitacao&#xd;&#xa;				                                , MAX&#x28;num_homologacao&#x29; AS num_homologacao&#xd;&#xa;				                                , MAX&#x28;timestamp&#x29; AS timestamp&#xd;&#xa;				                                , MAX&#x28;cod_item&#x29; AS cod_item&#xd;&#xa;				                             FROM licitacao.homologacao&#xd;&#xa;				                         GROUP BY cod_licitacao&#xd;&#xa;				                                , cod_modalidade&#xd;&#xa;				                                , cod_entidade&#xd;&#xa;				                                , exercicio_licitacao&#xd;&#xa;				                 &#x29;  AS homologacao&#xd;&#xa;				                ON  homologacao.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;				               AND  homologacao.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;				               AND  homologacao.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;				               AND  homologacao.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;				               AND  &#x28;      SELECT homologacao_anulada.num_homologacao&#xd;&#xa;				                             FROM licitacao.homologacao_anulada&#xd;&#xa;				                            WHERE homologacao_anulada.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;				                              AND homologacao_anulada.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;				                              AND homologacao_anulada.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;				                              AND homologacao_anulada.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;				                              AND homologacao.num_homologacao             &#x3d; homologacao_anulada.num_homologacao&#xd;&#xa;				                              AND homologacao.cod_item                    &#x3d; homologacao_anulada.cod_item&#xd;&#xa;				                    &#x29; IS NULL&#xd;&#xa;				             WHERE  1&#x3d;1&#xd;&#xa;				 AND parp.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                                     &#xd;&#xa;				 AND TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; &#xd;&#xa;				                        BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                                             &#xd;&#xa;				                            AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;        &#xd;&#xa;				 GROUP BY 1,2,3,4,5,6,7,8,irp.num_item&#xd;&#xa;				ORDER BY chave13, cod_orgao, cod_unidade_sub, parp.numero_registro_precos, parp.exercicio, irp.cod_lote, irp.num_item&#xd;&#xa;			&#x29;,&#xd;&#xa;			 regadesao14 as&#xd;&#xa;			&#x28;&#xd;&#xa;				             SELECT  irp.cod_entidade&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;irp.numero_registro_precos&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;irp.exercicio&#x3a;&#x3a;VARCHAR AS chave14&#xd;&#xa;					                  ,  14 AS tipo_registro&#xd;&#xa;					                  ,  &#x28;SELECT valor FROM administracao.configuracao_entidade WHERE exercicio &#x3d; parp.exercicio AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27; AND cod_entidade &#x3d; parp.cod_entidade&#x29; AS cod_orgao&#xd;&#xa;					                  ,  CASE WHEN registro_precos_orgao.numero_registro_precos IS NOT NULL&#xd;&#xa;					                                THEN LPAD&#x28;LPAD&#x28;registro_precos_orgao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;registro_precos_orgao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;					                                ELSE LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;					                     END AS cod_unidade_sub&#xd;&#xa;					                  ,  parp.numero_registro_precos&#xd;&#xa;					                  ,  parp.exercicio AS exercicio_adesao&#xd;&#xa;					                  ,  irp.cod_lote&#xd;&#xa;					                  ,  irp.cod_item&#xd;&#xa;					                  ,  TO_CHAR&#x28;irp.data_cotacao,&#x27;ddmmyyyy&#x27;&#x29; AS data_cotacao&#xd;&#xa;					                  ,  REPLACE&#x28;irp.vl_cotacao_preco_unitario&#x3a;&#x3a;VARCHAR,&#x27;.&#x27;,&#x27;,&#x27;&#x29; AS vl_cotacao_preco_unitario&#xd;&#xa;					                  ,  REPLACE&#x28;irp.quantidade_cotacao&#x3a;&#x3a;VARCHAR,&#x27;.&#x27;,&#x27;,&#x27;&#x29; AS quantidade_cotacao&#xd;&#xa;					              FROM  tcemg.registro_precos AS parp&#xd;&#xa;					        INNER JOIN  tcemg.item_registro_precos irp&#xd;&#xa;					                ON  irp.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;					               AND  irp.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;					               AND  irp.exercicio &#x3d; parp.exercicio&#xd;&#xa;					        INNER JOIN  tcemg.registro_precos_orgao&#xd;&#xa;					                ON  registro_precos_orgao.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;					               AND  registro_precos_orgao.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;					               AND  registro_precos_orgao.exercicio_registro_precos &#x3d; parp.exercicio&#xd;&#xa;					               AND  registro_precos_orgao.interno &#x3d; parp.interno&#xd;&#xa;					               AND  registro_precos_orgao.numcgm_gerenciador &#x3d; parp.numcgm_gerenciador&#xd;&#xa;					        INNER JOIN  tcemg.registro_precos_orgao_item&#xd;&#xa;					                ON  registro_precos_orgao_item.cod_entidade &#x3d; registro_precos_orgao.cod_entidade&#xd;&#xa;					               AND  registro_precos_orgao_item.numero_registro_precos &#x3d; registro_precos_orgao.numero_registro_precos&#xd;&#xa;					               AND  registro_precos_orgao_item.exercicio_registro_precos &#x3d; registro_precos_orgao.exercicio_registro_precos&#xd;&#xa;					               AND  registro_precos_orgao_item.interno &#x3d; registro_precos_orgao.interno&#xd;&#xa;					               AND  registro_precos_orgao_item.numcgm_gerenciador &#x3d; registro_precos_orgao.numcgm_gerenciador&#xd;&#xa;					               AND  registro_precos_orgao_item.exercicio_unidade &#x3d; registro_precos_orgao.exercicio_unidade&#xd;&#xa;					               AND  registro_precos_orgao_item.num_unidade &#x3d; registro_precos_orgao.num_unidade&#xd;&#xa;					               AND  registro_precos_orgao_item.num_orgao &#x3d; registro_precos_orgao.num_orgao&#xd;&#xa;					               AND  registro_precos_orgao_item.cod_lote &#x3d; irp.cod_lote&#xd;&#xa;					               AND  registro_precos_orgao_item.cod_item &#x3d; irp.cod_item&#xd;&#xa;					               AND  registro_precos_orgao_item.cgm_fornecedor &#x3d; irp.cgm_fornecedor&#xd;&#xa;					        INNER JOIN  tcemg.registro_precos_licitacao&#xd;&#xa;					                ON  registro_precos_licitacao.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;					               AND  registro_precos_licitacao.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;					               AND  registro_precos_licitacao.exercicio &#x3d; parp.exercicio&#xd;&#xa;					               AND  registro_precos_licitacao.interno &#x3d; parp.interno&#xd;&#xa;					        INNER JOIN &#x28;&#xd;&#xa;					                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;&#x27;&#x27;, stEntidade&#x29;      &#xd;&#xa; 																				VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																				   ,cod_modalidade		INTEGER&#xd;&#xa;																				   ,cod_entidade		INTEGER&#xd;&#xa;																				   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																				   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																				   ,num_licitacao		TEXT &#x29;&#xd;&#xa;					                 &#x29;  config_licitacao&#xd;&#xa;					                ON  config_licitacao.cod_entidade &#x3d; registro_precos_licitacao.cod_entidade_licitacao&#xd;&#xa;					               AND  config_licitacao.cod_licitacao &#x3d; registro_precos_licitacao.cod_licitacao&#xd;&#xa;					               AND  config_licitacao.cod_modalidade &#x3d; registro_precos_licitacao.cod_modalidade&#xd;&#xa;					               AND  config_licitacao.exercicio &#x3d; registro_precos_licitacao.exercicio_licitacao&#xd;&#xa;					        INNER JOIN  licitacao.licitacao&#xd;&#xa;					                ON  licitacao.cod_licitacao &#x3d; config_licitacao.cod_licitacao&#xd;&#xa;					               AND  licitacao.cod_modalidade &#x3d; config_licitacao.cod_modalidade&#xd;&#xa;					               AND  licitacao.cod_entidade &#x3d; config_licitacao.cod_entidade&#xd;&#xa;					               AND  licitacao.exercicio &#x3d; config_licitacao.exercicio&#xd;&#xa;					        INNER JOIN &#x28;       SELECT cod_licitacao&#xd;&#xa;					                                , cod_modalidade&#xd;&#xa;					                                , cod_entidade&#xd;&#xa;					                                , exercicio_licitacao&#xd;&#xa;					                                , MAX&#x28;num_homologacao&#x29; AS num_homologacao&#xd;&#xa;					                                , MAX&#x28;timestamp&#x29; AS timestamp&#xd;&#xa;					                                , MAX&#x28;cod_item&#x29; AS cod_item&#xd;&#xa;					                             FROM licitacao.homologacao&#xd;&#xa;					                         GROUP BY cod_licitacao&#xd;&#xa;					                                , cod_modalidade&#xd;&#xa;					                                , cod_entidade&#xd;&#xa;					                                , exercicio_licitacao&#xd;&#xa;					                          &#x29; AS homologacao&#xd;&#xa;					                ON  homologacao.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;					               AND  homologacao.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;					               AND  homologacao.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;					               AND  homologacao.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;					               AND  &#x28;      SELECT homologacao_anulada.num_homologacao&#xd;&#xa;					                             FROM licitacao.homologacao_anulada&#xd;&#xa;					                            WHERE homologacao_anulada.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;					                              AND homologacao_anulada.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;					                              AND homologacao_anulada.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;					                              AND homologacao_anulada.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;					                              AND homologacao.num_homologacao             &#x3d; homologacao_anulada.num_homologacao&#xd;&#xa;					                              AND homologacao.cod_item                    &#x3d; homologacao_anulada.cod_item&#xd;&#xa;					                    &#x29; IS NULL&#xd;&#xa;					             WHERE  1&#x3d;1&#xd;&#xa;					 AND parp.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                                       &#xd;&#xa;					 AND TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;					                        BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                                               &#xd;&#xa;					                            AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29;  &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;         &#xd;&#xa;					ORDER BY chave14, cod_orgao, cod_unidade_sub, parp.numero_registro_precos, parp.exercicio, irp.cod_lote, irp.num_item&#xd;&#xa;			&#x29;,&#xd;&#xa;			 regadesao15 as&#xd;&#xa;			&#x28;&#xd;&#xa;		             SELECT  irp.cod_entidade&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;irp.numero_registro_precos&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;irp.exercicio&#x3a;&#x3a;VARCHAR AS chave15&#xd;&#xa;				                  ,  15 AS tipo_registro&#xd;&#xa;				                  ,  &#x28;SELECT valor FROM administracao.configuracao_entidade WHERE exercicio &#x3d; parp.exercicio AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27; AND cod_entidade &#x3d; parp.cod_entidade&#x29; AS cod_orgao&#xd;&#xa;				                  ,  CASE WHEN registro_precos_orgao.numero_registro_precos IS NOT NULL&#xd;&#xa;				                                THEN LPAD&#x28;LPAD&#x28;registro_precos_orgao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;registro_precos_orgao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;				                                ELSE LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;				                     END AS cod_unidade_sub&#xd;&#xa;				                  ,  parp.numero_registro_precos&#xd;&#xa;				                  ,  parp.exercicio AS exercicio_adesao&#xd;&#xa;				                  ,  irp.cod_lote&#xd;&#xa;				                  ,  irp.cod_item&#xd;&#xa;				                  ,  REPLACE&#x28;irp.preco_unitario&#x3a;&#x3a;VARCHAR,&#x27;.&#x27;,&#x27;,&#x27;&#x29; AS preco_unitario&#xd;&#xa;				                  ,  REPLACE&#x28;irp.quantidade_licitada&#x3a;&#x3a;VARCHAR,&#x27;.&#x27;,&#x27;,&#x27;&#x29; AS quantidade_licitada&#xd;&#xa;				                  ,  REPLACE&#x28;irp.quantidade_aderida&#x3a;&#x3a;VARCHAR,&#x27;.&#x27;,&#x27;,&#x27;&#x29; AS quantidade_aderida&#xd;&#xa;				                  ,  CASE WHEN sw_cgm.cod_pais &#x3c;&#x3e; 1 THEN 3&#xd;&#xa;				                          WHEN sw_cgm_pessoa_fisica.cpf IS NOT NULL THEN 1&#xd;&#xa;				                          ELSE 2 END AS tipo_documento&#xd;&#xa;				                  ,  CASE WHEN sw_cgm_pessoa_fisica.cpf IS NOT NULL THEN sw_cgm_pessoa_fisica.cpf&#xd;&#xa;				                          ELSE sw_cgm_pessoa_juridica.cnpj END AS nro_documento&#xd;&#xa;				              FROM  tcemg.registro_precos AS parp&#xd;&#xa;				        INNER JOIN  tcemg.item_registro_precos irp&#xd;&#xa;				                ON  irp.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;				               AND  irp.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;				               AND  irp.exercicio &#x3d; parp.exercicio&#xd;&#xa;				        INNER JOIN  sw_cgm&#xd;&#xa;				                ON  sw_cgm.numcgm &#x3d; irp.cgm_fornecedor&#xd;&#xa;				         LEFT JOIN  sw_cgm_pessoa_fisica&#xd;&#xa;				                ON  sw_cgm.numcgm &#x3d; sw_cgm_pessoa_fisica.numcgm&#xd;&#xa;				         LEFT JOIN  sw_cgm_pessoa_juridica&#xd;&#xa;				                ON  sw_cgm.numcgm &#x3d; sw_cgm_pessoa_juridica.numcgm&#xd;&#xa;				        INNER JOIN  tcemg.registro_precos_orgao&#xd;&#xa;				                ON  registro_precos_orgao.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;				               AND  registro_precos_orgao.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;				               AND  registro_precos_orgao.exercicio_registro_precos &#x3d; parp.exercicio&#xd;&#xa;				               AND  registro_precos_orgao.interno &#x3d; parp.interno&#xd;&#xa;				               AND  registro_precos_orgao.numcgm_gerenciador &#x3d; parp.numcgm_gerenciador&#xd;&#xa;				        INNER JOIN  tcemg.registro_precos_orgao_item&#xd;&#xa;				                ON  registro_precos_orgao_item.cod_entidade &#x3d; registro_precos_orgao.cod_entidade&#xd;&#xa;				               AND  registro_precos_orgao_item.numero_registro_precos &#x3d; registro_precos_orgao.numero_registro_precos&#xd;&#xa;				               AND  registro_precos_orgao_item.exercicio_registro_precos &#x3d; registro_precos_orgao.exercicio_registro_precos&#xd;&#xa;				               AND  registro_precos_orgao_item.interno &#x3d; registro_precos_orgao.interno&#xd;&#xa;				               AND  registro_precos_orgao_item.numcgm_gerenciador &#x3d; registro_precos_orgao.numcgm_gerenciador&#xd;&#xa;				               AND  registro_precos_orgao_item.exercicio_unidade &#x3d; registro_precos_orgao.exercicio_unidade&#xd;&#xa;				               AND  registro_precos_orgao_item.num_unidade &#x3d; registro_precos_orgao.num_unidade&#xd;&#xa;				               AND  registro_precos_orgao_item.num_orgao &#x3d; registro_precos_orgao.num_orgao&#xd;&#xa;				               AND  registro_precos_orgao_item.cod_lote &#x3d; irp.cod_lote&#xd;&#xa;				               AND  registro_precos_orgao_item.cod_item &#x3d; irp.cod_item&#xd;&#xa;				               AND  registro_precos_orgao_item.cgm_fornecedor &#x3d; irp.cgm_fornecedor&#xd;&#xa;				        INNER JOIN  tcemg.registro_precos_licitacao&#xd;&#xa;				                ON  registro_precos_licitacao.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;				               AND  registro_precos_licitacao.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;				               AND  registro_precos_licitacao.exercicio &#x3d; parp.exercicio&#xd;&#xa;				               AND  registro_precos_licitacao.interno &#x3d; parp.interno&#xd;&#xa;				        INNER JOIN &#x28;&#xd;&#xa;				                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;&#x27;&#x27;, stEntidade&#x29;  &#xd;&#xa;																			VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																			   ,cod_modalidade		INTEGER&#xd;&#xa;																			   ,cod_entidade		INTEGER&#xd;&#xa;																			   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																			   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																			   ,num_licitacao		TEXT &#x29;&#xd;&#xa;				                 &#x29;  config_licitacao&#xd;&#xa;				                ON  config_licitacao.cod_entidade &#x3d; registro_precos_licitacao.cod_entidade_licitacao&#xd;&#xa;				               AND  config_licitacao.cod_licitacao &#x3d; registro_precos_licitacao.cod_licitacao&#xd;&#xa;				               AND  config_licitacao.cod_modalidade &#x3d; registro_precos_licitacao.cod_modalidade&#xd;&#xa;				               AND  config_licitacao.exercicio &#x3d; registro_precos_licitacao.exercicio_licitacao&#xd;&#xa;				        INNER JOIN  licitacao.licitacao&#xd;&#xa;				                ON  licitacao.cod_licitacao &#x3d; config_licitacao.cod_licitacao&#xd;&#xa;				               AND  licitacao.cod_modalidade &#x3d; config_licitacao.cod_modalidade&#xd;&#xa;				               AND  licitacao.cod_entidade &#x3d; config_licitacao.cod_entidade&#xd;&#xa;				               AND  licitacao.exercicio &#x3d; config_licitacao.exercicio&#xd;&#xa;				        INNER JOIN &#x28;       SELECT cod_licitacao&#xd;&#xa;				                                , cod_modalidade&#xd;&#xa;				                                , cod_entidade&#xd;&#xa;				                                , exercicio_licitacao&#xd;&#xa;				                                , MAX&#x28;num_homologacao&#x29; AS num_homologacao&#xd;&#xa;				                                , MAX&#x28;timestamp&#x29; AS timestamp&#xd;&#xa;				                                , MAX&#x28;cod_item&#x29; AS cod_item&#xd;&#xa;				                             FROM licitacao.homologacao&#xd;&#xa;				                         GROUP BY cod_licitacao&#xd;&#xa;				                                , cod_modalidade&#xd;&#xa;				                                , cod_entidade&#xd;&#xa;				                                , exercicio_licitacao&#xd;&#xa;				                 &#x29;  AS homologacao&#xd;&#xa;				                ON  homologacao.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;				               AND  homologacao.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;				               AND  homologacao.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;				               AND  homologacao.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;				               AND  &#x28;      SELECT homologacao_anulada.num_homologacao&#xd;&#xa;				                             FROM licitacao.homologacao_anulada&#xd;&#xa;				                            WHERE homologacao_anulada.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;				                              AND homologacao_anulada.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;				                              AND homologacao_anulada.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;				                              AND homologacao_anulada.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;				                              AND homologacao.num_homologacao             &#x3d; homologacao_anulada.num_homologacao&#xd;&#xa;				                              AND homologacao.cod_item                    &#x3d; homologacao_anulada.cod_item&#xd;&#xa;				                    &#x29; IS NULL&#xd;&#xa;				             WHERE  1&#x3d;1&#xd;&#xa;				 AND parp.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                                     &#xd;&#xa;				 AND TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;				                        BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                                             &#xd;&#xa;				                            AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;        &#xd;&#xa;				ORDER BY chave15, cod_orgao, cod_unidade_sub, parp.numero_registro_precos, parp.exercicio, irp.cod_lote, irp.num_item				&#xd;&#xa;			&#x29;,&#xd;&#xa;			 regadesao20 as&#xd;&#xa;			&#x28;&#xd;&#xa;			             SELECT  irp.cod_entidade&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;irp.numero_registro_precos&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;irp.exercicio&#x3a;&#x3a;VARCHAR AS chave20&#xd;&#xa;				                  ,  20 AS tipo_registro&#xd;&#xa;				                  ,  &#x28;SELECT valor FROM administracao.configuracao_entidade WHERE exercicio &#x3d; parp.exercicio AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27; AND cod_entidade &#x3d; parp.cod_entidade&#x29; AS cod_orgao&#xd;&#xa;				                  ,  CASE WHEN registro_precos_orgao.numero_registro_precos IS NOT NULL&#xd;&#xa;				                                THEN LPAD&#x28;LPAD&#x28;registro_precos_orgao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;registro_precos_orgao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;				                                ELSE LPAD&#x28;LPAD&#x28;licitacao.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;licitacao.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;				                     END AS cod_unidade_sub&#xd;&#xa;				                  ,  parp.numero_registro_precos&#xd;&#xa;				                  ,  parp.exercicio AS exercicio_adesao&#xd;&#xa;				                  ,  irp.cod_lote&#xd;&#xa;				                  ,  irp.cod_item&#xd;&#xa;				                  ,  irp.percentual_desconto AS percentual_desconto_item&#xd;&#xa;				                  ,  lrp.percentual_desconto_lote AS percentual_desconto_lote&#xd;&#xa;				                  ,  CASE WHEN sw_cgm.cod_pais &#x3c;&#x3e; 1 THEN 3&#xd;&#xa;				                          WHEN sw_cgm_pessoa_fisica.cpf IS NOT NULL THEN 1&#xd;&#xa;				                          ELSE 2 END AS tipo_documento&#xd;&#xa;				                  ,  CASE WHEN sw_cgm_pessoa_fisica.cpf IS NOT NULL THEN sw_cgm_pessoa_fisica.cpf&#xd;&#xa;				                          ELSE sw_cgm_pessoa_juridica.cnpj END AS nro_documento&#xd;&#xa;				              FROM  tcemg.registro_precos AS parp&#xd;&#xa;				        INNER JOIN  tcemg.item_registro_precos irp&#xd;&#xa;				                ON  irp.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;				               AND  irp.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;				               AND  irp.exercicio &#x3d; parp.exercicio&#xd;&#xa;				         LEFT JOIN  tcemg.lote_registro_precos lrp&#xd;&#xa;				                ON  lrp.cod_entidade &#x3d; irp.cod_entidade&#xd;&#xa;				               AND  lrp.numero_registro_precos &#x3d; irp.numero_registro_precos&#xd;&#xa;				               AND  lrp.exercicio &#x3d; irp.exercicio&#xd;&#xa;				               AND  lrp.cod_lote &#x3d; irp.cod_lote&#xd;&#xa;				        INNER JOIN  sw_cgm&#xd;&#xa;				                ON  sw_cgm.numcgm &#x3d; irp.cgm_fornecedor&#xd;&#xa;				         LEFT JOIN  sw_cgm_pessoa_fisica&#xd;&#xa;				                ON  sw_cgm.numcgm &#x3d; sw_cgm_pessoa_fisica.numcgm&#xd;&#xa;				         LEFT JOIN  sw_cgm_pessoa_juridica&#xd;&#xa;				                ON  sw_cgm.numcgm &#x3d; sw_cgm_pessoa_juridica.numcgm&#xd;&#xa;				        INNER JOIN  tcemg.registro_precos_orgao&#xd;&#xa;				                ON  registro_precos_orgao.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;				               AND  registro_precos_orgao.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;				               AND  registro_precos_orgao.exercicio_registro_precos &#x3d; parp.exercicio&#xd;&#xa;				               AND  registro_precos_orgao.interno &#x3d; parp.interno&#xd;&#xa;				               AND  registro_precos_orgao.numcgm_gerenciador &#x3d; parp.numcgm_gerenciador&#xd;&#xa;				        INNER JOIN  tcemg.registro_precos_orgao_item&#xd;&#xa;				                ON  registro_precos_orgao_item.cod_entidade &#x3d; registro_precos_orgao.cod_entidade&#xd;&#xa;				               AND  registro_precos_orgao_item.numero_registro_precos &#x3d; registro_precos_orgao.numero_registro_precos&#xd;&#xa;				               AND  registro_precos_orgao_item.exercicio_registro_precos &#x3d; registro_precos_orgao.exercicio_registro_precos&#xd;&#xa;				               AND  registro_precos_orgao_item.interno &#x3d; registro_precos_orgao.interno&#xd;&#xa;				               AND  registro_precos_orgao_item.numcgm_gerenciador &#x3d; registro_precos_orgao.numcgm_gerenciador&#xd;&#xa;				               AND  registro_precos_orgao_item.exercicio_unidade &#x3d; registro_precos_orgao.exercicio_unidade&#xd;&#xa;				               AND  registro_precos_orgao_item.num_unidade &#x3d; registro_precos_orgao.num_unidade&#xd;&#xa;				               AND  registro_precos_orgao_item.num_orgao &#x3d; registro_precos_orgao.num_orgao&#xd;&#xa;				               AND  registro_precos_orgao_item.cod_lote &#x3d; irp.cod_lote&#xd;&#xa;				               AND  registro_precos_orgao_item.cod_item &#x3d; irp.cod_item&#xd;&#xa;				               AND  registro_precos_orgao_item.cgm_fornecedor &#x3d; irp.cgm_fornecedor&#xd;&#xa;				        INNER JOIN  tcemg.registro_precos_licitacao&#xd;&#xa;				                ON  registro_precos_licitacao.cod_entidade &#x3d; parp.cod_entidade&#xd;&#xa;				               AND  registro_precos_licitacao.numero_registro_precos &#x3d; parp.numero_registro_precos&#xd;&#xa;				               AND  registro_precos_licitacao.exercicio &#x3d; parp.exercicio&#xd;&#xa;				               AND  registro_precos_licitacao.interno &#x3d; parp.interno&#xd;&#xa;				        INNER JOIN &#x28;&#xd;&#xa;				                     SELECT &#x2a; FROM tcemg.fn_exercicio_numero_licitacao &#x28;&#x27;&#x27;, stEntidade&#x29;    &#xd;&#xa;																			VALUES &#x28;cod_licitacao		INTEGER&#xd;&#xa;																			   ,cod_modalidade		INTEGER&#xd;&#xa;																			   ,cod_entidade		INTEGER&#xd;&#xa;																			   ,exercicio			CHAR&#x28;4&#x29;&#xd;&#xa;																			   ,exercicio_licitacao	VARCHAR&#xd;&#xa;																			   ,num_licitacao		TEXT &#x29;&#xd;&#xa;				                 &#x29;  config_licitacao&#xd;&#xa;				                ON  config_licitacao.cod_entidade &#x3d; registro_precos_licitacao.cod_entidade_licitacao&#xd;&#xa;				               AND  config_licitacao.cod_licitacao &#x3d; registro_precos_licitacao.cod_licitacao&#xd;&#xa;				               AND  config_licitacao.cod_modalidade &#x3d; registro_precos_licitacao.cod_modalidade&#xd;&#xa;				               AND  config_licitacao.exercicio &#x3d; registro_precos_licitacao.exercicio_licitacao&#xd;&#xa;				        INNER JOIN  licitacao.licitacao&#xd;&#xa;				                ON  licitacao.cod_licitacao &#x3d; config_licitacao.cod_licitacao&#xd;&#xa;				               AND  licitacao.cod_modalidade &#x3d; config_licitacao.cod_modalidade&#xd;&#xa;				               AND  licitacao.cod_entidade &#x3d; config_licitacao.cod_entidade&#xd;&#xa;				               AND  licitacao.exercicio &#x3d; config_licitacao.exercicio&#xd;&#xa;				        INNER JOIN &#x28;       SELECT cod_licitacao&#xd;&#xa;				                                , cod_modalidade&#xd;&#xa;				                                , cod_entidade&#xd;&#xa;				                                , exercicio_licitacao&#xd;&#xa;				                                , MAX&#x28;num_homologacao&#x29; AS num_homologacao&#xd;&#xa;				                                , MAX&#x28;timestamp&#x29; AS timestamp&#xd;&#xa;				                                , MAX&#x28;cod_item&#x29; AS cod_item&#xd;&#xa;				                             FROM licitacao.homologacao&#xd;&#xa;				                         GROUP BY cod_licitacao&#xd;&#xa;				                                , cod_modalidade&#xd;&#xa;				                                , cod_entidade&#xd;&#xa;				                                , exercicio_licitacao&#xd;&#xa;				                 &#x29;  AS homologacao&#xd;&#xa;				                ON  homologacao.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;				               AND  homologacao.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;				               AND  homologacao.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;				               AND  homologacao.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;				               AND  &#x28;      SELECT homologacao_anulada.num_homologacao&#xd;&#xa;				                             FROM licitacao.homologacao_anulada&#xd;&#xa;				                            WHERE homologacao_anulada.cod_licitacao       &#x3d; licitacao.cod_licitacao&#xd;&#xa;				                              AND homologacao_anulada.cod_modalidade      &#x3d; licitacao.cod_modalidade&#xd;&#xa;				                              AND homologacao_anulada.cod_entidade        &#x3d; licitacao.cod_entidade&#xd;&#xa;				                              AND homologacao_anulada.exercicio_licitacao &#x3d; licitacao.exercicio&#xd;&#xa;				                              AND homologacao.num_homologacao             &#x3d; homologacao_anulada.num_homologacao&#xd;&#xa;				                              AND homologacao.cod_item                    &#x3d; homologacao_anulada.cod_item&#xd;&#xa;				                    &#x29; IS NULL&#xd;&#xa;				             WHERE  1&#x3d;1&#xd;&#xa;				 AND parp.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                                    &#xd;&#xa;				 AND TO_DATE&#x28;TO_CHAR&#x28;homologacao.timestamp,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;				                        BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;                                                           &#xd;&#xa;				                            AND last_day&#x28;TO_DATE&#x28;stExercicio &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;-&#x27; &#x7c;&#x7c; &#x27;01&#x27;,&#x27;yyyy-mm-dd&#x27;&#x29;&#x29;      &#xd;&#xa;				ORDER BY chave20, cod_orgao, cod_unidade_sub, parp.numero_registro_precos, parp.exercicio, irp.cod_lote, irp.num_item&#xd;&#xa;			&#x29;,&#xd;&#xa;			  regadesao_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							numero_registro_precos,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_sub&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;numero_registro_precos&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_adesao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_abertura_processo_adesao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;nome_orgao_gerenciador&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,100&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;numero_processo_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codigo_modalidade_licitacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;numero_modalidade&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_ata_registro_preco_validade&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_ata_registro_preco&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;natureza_procedimento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_publicacao_aviso_intencao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;objeto_adesao&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,500&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cpf_responsavel&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 11, &#x27; &#x27;&#x29;		&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;desconto_tabela&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;processo_lote&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from regadesao10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							numero_registro_precos,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_sub&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;numero_registro_precos&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_adesao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_lote&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;descricao_lote&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,250&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from regadesao11&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							numero_registro_precos,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_sub&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;numero_registro_precos&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_adesao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_item&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_item&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from regadesao12&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							numero_registro_precos,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_sub&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;numero_registro_precos&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_adesao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_lote&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_item&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from regadesao13&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							numero_registro_precos,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_sub&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;numero_registro_precos&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_adesao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_lote&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_item&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_cotacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_cotacao_preco_unitario&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;quantidade_cotacao&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from regadesao14&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							numero_registro_precos,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_sub&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;numero_registro_precos&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_adesao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_lote&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_item&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;preco_unitario&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;quantidade_licitada&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;quantidade_aderida&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from regadesao15&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							numero_registro_precos,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_sub&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;numero_registro_precos&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_adesao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_lote&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_item&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;percentual_desconto_item&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;percentual_desconto_lote&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from regadesao20&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;REGADESAO.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from regadesao_format order by numero_registro_precos, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;	&#xd;&#xa;    &#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;RSP.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with rsp10 as&#xd;&#xa;			&#x28;&#xd;&#xa;					 SELECT&#xd;&#xa;			                              10 AS tipo_registro&#xd;&#xa;			                            , empenho.cod_empenho&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;empenho.cod_entidade&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;empenho.exercicio&#x3a;&#x3a;VARCHAR AS cod_reduzido&#xd;&#xa;			                            , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;			                            , CASE WHEN uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;			                                        THEN LPAD&#x28;LPAD&#x28;uniorcam.num_orgao_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;uniorcam.num_unidade_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;			                                   ELSE CASE WHEN cnpj_prefeitura.valor &#x3d; &#x27;18301002000186&#x27; AND pre_empenho.implantado &#x3d; TRUE THEN LPAD&#x28;orgao.num_unidade&#x3a;&#x3a;VARCHAR,5,&#x27;0&#x27;&#x29;&#xd;&#xa;			                                             ELSE LPAD&#x28;LPAD&#x28;orgao.num_orgao&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;orgao.num_unidade&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;			                                        END&#xd;&#xa;			                              END AS cod_unidade&#xd;&#xa;			                            , CASE WHEN cnpj_prefeitura.valor &#x3d; &#x27;18301002000186&#x27; AND pre_empenho.implantado &#x3d; TRUE THEN LPAD&#x28;orgao.num_unidade&#x3a;&#x3a;VARCHAR,5,&#x27;0&#x27;&#x29;&#xd;&#xa;			                                   ELSE LPAD&#x28;LPAD&#x28;orgao.num_orgao&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;orgao.num_unidade&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;			                                   END AS cod_unidade_orig&#xd;&#xa;			                            , empenho.cod_empenho AS num_empenho&#xd;&#xa;			                            , TO_CHAR &#x28;empenho.dt_empenho, &#x27;ddmmyyyy&#x27;&#x29; AS dt_empenho&#xd;&#xa;			                            , empenho.exercicio as exercicio_empenho&#xd;&#xa;			                            , CASE WHEN restos_pre_empenho.cod_pre_empenho IS NOT NULL THEN&#xd;&#xa;			                                            CASE WHEN empenho.exercicio &#x3e; &#x27;2012&#x27; THEN &#x27;&#x27;&#xd;&#xa;			                                                 ELSE LPAD&#x28;restos_pre_empenho.cod_funcao&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;restos_pre_empenho.cod_subfuncao&#x3a;&#x3a;VARCHAR,3,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;restos_pre_empenho.cod_programa&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;restos_pre_empenho.num_pao&#x3a;&#x3a;VARCHAR,4,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;restos_pre_empenho.cod_estrutural,8,&#x27;0&#x27;&#x29;&#xd;&#xa;			                                            END&#xd;&#xa;			                              END AS dot_orig&#xd;&#xa;			                            , REPLACE&#x28;&#x28;SELECT COALESCE&#x28;SUM&#x28;item_pre_empenho.vl_total&#x29;,0.00&#x29; FROM empenho.item_pre_empenho&#xd;&#xa;			                                WHERE item_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho AND item_pre_empenho.exercicio &#x3d; pre_empenho.exercicio&#x29;&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29; AS vl_original&#xd;&#xa;			                            , REPLACE&#x28;restos_pagar.valor_processado_nao_pago&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29; AS vl_saldo_ant_proc&#xd;&#xa;			                            , REPLACE&#x28;COALESCE&#x28;&#x28;restos_pagar.valor_nao_processado_exercicio_anterior&#x29;,0.00&#x29;&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29; AS vl_saldo_ant_nao&#xd;&#xa;			                    FROM empenho.empenho&#xd;&#xa;			                    JOIN empenho.pre_empenho&#xd;&#xa;			                      ON pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;			                     AND pre_empenho.exercicio &#x3d; empenho.exercicio&#xd;&#xa;			                    LEFT JOIN empenho.restos_pre_empenho&#xd;&#xa;			                      ON restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;			                     AND restos_pre_empenho.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;			                    JOIN administracao.configuracao_entidade&#xd;&#xa;			                      ON configuracao_entidade.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;			                     AND configuracao_entidade.exercicio &#x3d; stExercicio        &#xd;&#xa;			                     AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;			                     AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			                    JOIN &#x28; SELECT &#x2a; FROM &#x28;&#xd;&#xa;			                                            SELECT  despesa.num_orgao&#xd;&#xa;			                                                    , despesa.num_unidade&#xd;&#xa;			                                                    , despesa.exercicio&#xd;&#xa;			                                                    , pre_empenho_despesa.cod_pre_empenho&#xd;&#xa;			                                            FROM empenho.pre_empenho_despesa&#xd;&#xa;			                                            JOIN orcamento.despesa&#xd;&#xa;			                                              ON despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;			                                             AND despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;			                                            JOIN orcamento.conta_despesa&#xd;&#xa;			                                              ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;			                                             AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;			                                            UNION&#xd;&#xa;			                                            SELECT  restos_pre_empenho.num_orgao&#xd;&#xa;			                                                    , restos_pre_empenho.num_unidade&#xd;&#xa;			                                                    , restos_pre_empenho.exercicio&#xd;&#xa;			                                                    , restos_pre_empenho.cod_pre_empenho&#xd;&#xa;			                                            FROM empenho.restos_pre_empenho&#xd;&#xa;			                                        &#x29; as tbl&#xd;&#xa;			                                GROUP BY num_orgao, exercicio, num_unidade, cod_pre_empenho&#xd;&#xa;			                        &#x29; AS orgao&#xd;&#xa;			                      ON orgao.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;			                     AND orgao.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;			               LEFT JOIN &#x28;SELECT&#xd;&#xa;			                                  despesa.&#x2a;&#xd;&#xa;			                                , conta_despesa.cod_estrutural&#xd;&#xa;			                                , pre_empenho_despesa.cod_pre_empenho&#xd;&#xa;			                            FROM empenho.pre_empenho_despesa&#xd;&#xa;			                            JOIN orcamento.despesa&#xd;&#xa;			                              ON despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;			                             AND despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;			                            JOIN orcamento.conta_despesa&#xd;&#xa;			                              ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;			                             AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;			                        &#x29;   AS  despesa&#xd;&#xa;			                      ON despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;			                     AND despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;			               LEFT JOIN tcemg.uniorcam&#xd;&#xa;			                      ON uniorcam.num_unidade &#x3d; restos_pre_empenho.num_unidade&#xd;&#xa;			                     AND uniorcam.num_orgao   &#x3d; restos_pre_empenho.num_orgao&#xd;&#xa;			                     AND uniorcam.exercicio   &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;			                     AND uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;			               LEFT JOIN &#x28;SELECT &#x2a;&#xd;&#xa;			                               , COALESCE&#x28;&#x28;rp.valor_processado_exercicios_anteriores &#x2b; rp.valor_processado_exercicio_anterior&#x29;,0.00&#x29; AS valor_processado_nao_pago&#xd;&#xa;			                            FROM tcemg.fn_restos_pagar    &#x28;&#xd;&#xa;			                                                            stExercicio,     &#xd;&#xa;			                                                            stEntidade,      &#xd;&#xa;			                                                            01&#xd;&#xa;			                                                        &#x29; as rp &#x28;&#xd;&#xa;			                                                            cod_empenho INTEGER, cod_entidade INTEGER, exercicio CHARACTER&#x28;4&#x29;, valor_processado_exercicios_anteriores NUMERIC,&#xd;&#xa;			                                                            valor_processado_exercicio_anterior NUMERIC, valor_processado_cancelado NUMERIC, valor_processado_pago NUMERIC,&#xd;&#xa;			                                                            valor_nao_processado_exercicios_anteriores NUMERIC, valor_nao_processado_exercicio_anterior NUMERIC,&#xd;&#xa;			                                                            valor_nao_processado_cancelado NUMERIC, valor_nao_processado_pago NUMERIC&#xd;&#xa;			                                                        &#x29;&#xd;&#xa;			                        &#x29; AS restos_pagar&#xd;&#xa;			                      ON restos_pagar.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;			                     AND restos_pagar.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;			                     AND restos_pagar.exercicio &#x3d; empenho.exercicio&#xd;&#xa;			               LEFT JOIN &#x28; SELECT &#x2a;&#xd;&#xa;			                             FROM administracao.configuracao&#xd;&#xa;			                            WHERE configuracao.exercicio &#x3d; stExercicio     &#xd;&#xa;			                              AND configuracao.cod_modulo &#x3d; 2&#xd;&#xa;			                              AND configuracao.parametro &#x3d; &#x27;cnpj&#x27;&#xd;&#xa;			                        &#x29; AS cnpj_prefeitura&#xd;&#xa;			                      ON cnpj_prefeitura.exercicio &#x3d; stExercicio           &#xd;&#xa;			               LEFT JOIN &#x28; SELECT retorno.entidade AS cod_entidade&#xd;&#xa;			                                , retorno.empenho AS cod_empenho&#xd;&#xa;			                                , retorno.exercicio&#xd;&#xa;			                                , sum&#x28;retorno.valor&#x29; AS vl_pago_exercicio_atual&#xd;&#xa;			                             FROM empenho.fn_empenho_restos_pagar_pagamento_estorno_credor&#xd;&#xa;			                                &#x28; &#x27;&#x27;&#xd;&#xa;			                                , &#x27;&#x27;&#xd;&#xa;			                                , &#x27;01&#x2f;01&#x2f;&#x27; &#x7c;&#x7c; stExercicio    &#xd;&#xa;			                                , &#x27;31&#x2f;12&#x2f;&#x27; &#x7c;&#x7c; stExercicio    &#xd;&#xa;			                                , stEntidade                 &#xd;&#xa;			                                , &#x27;&#x27;&#xd;&#xa;			                                , &#x27;&#x27;&#xd;&#xa;			                                , &#x27;&#x27;&#xd;&#xa;			                                , &#x27;&#x27;&#xd;&#xa;			                                , &#x27;&#x27;&#xd;&#xa;			                                , &#x27;&#x27;&#xd;&#xa;			                                , &#x27;&#x27;&#xd;&#xa;			                                , &#x27;1&#x27;&#xd;&#xa;			                                , &#x27;&#x27;&#xd;&#xa;			                                , &#x27;&#x27;&#xd;&#xa;			                                , &#x27;&#x27;&#xd;&#xa;			                                , &#x27;&#x27;&#xd;&#xa;			                                &#x29; AS retorno&#x28;&#xd;&#xa;			                                     entidade            integer,&#xd;&#xa;			                                     empenho             integer,&#xd;&#xa;			                                     exercicio           char&#x28;4&#x29;,&#xd;&#xa;			                                     credor              varchar,&#xd;&#xa;			                                     cod_estrutural      varchar,&#xd;&#xa;			                                     cod_nota            integer,&#xd;&#xa;			                                     data                text,&#xd;&#xa;			                                     conta               integer,&#xd;&#xa;			                                     banco               varchar,&#xd;&#xa;			                                     valor               numeric&#xd;&#xa;			                                     &#x29;&#xd;&#xa;			                         GROUP BY retorno.entidade&#xd;&#xa;			                                , retorno.empenho&#xd;&#xa;			                                , retorno.exercicio&#xd;&#xa;			                        &#x29; AS pagamento_restos&#xd;&#xa;			                      ON pagamento_restos.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;			                     AND pagamento_restos.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;			                     AND pagamento_restos.exercicio &#x3d; empenho.exercicio&#xd;&#xa;			                   WHERE empenho.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                           &#xd;&#xa;			                     AND &#x28;    &#x28;pre_empenho.implantado &#x3d; true AND pre_empenho.exercicio &#x3d; stExercicio_ant &#x29;                                 &#xd;&#xa;			                         OR    &#x28;pagamento_restos.vl_pago_exercicio_atual &#x3e; 0.00 AND pre_empenho.exercicio &#x3c;&#x3d; stExercicio_ant&#x29;              &#xd;&#xa;			                         OR    &#x28;restos_pagar.valor_processado_nao_pago &#x3e; 0.00 AND pre_empenho.exercicio &#x3c;&#x3d; stExercicio_ant&#x29;                &#xd;&#xa;			                         OR    &#x28;restos_pagar.valor_nao_processado_exercicio_anterior &#x3e; 0.00 AND pre_empenho.exercicio &#x3c;&#x3d; stExercicio_ant&#x29;  &#xd;&#xa;			                         &#x29;&#xd;&#xa;			&#x29;,&#xd;&#xa;			 rsp11 as&#xd;&#xa;			&#x28;&#xd;&#xa;		                    SELECT&#xd;&#xa;		                              11 AS tipo_registro&#xd;&#xa;		                            , empenho.cod_empenho&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;empenho.cod_entidade&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;empenho.exercicio&#x3a;&#x3a;VARCHAR AS cod_reduzido&#xd;&#xa;		                            , CASE WHEN pre_empenho.implantado &#x3d; TRUE THEN restos_pre_empenho.recurso&#x3a;&#x3a;VARCHAR&#xd;&#xa;		                                   ELSE recurso.cod_fonte&#xd;&#xa;		                              END AS cod_fonte_recurso&#xd;&#xa;		                            , REPLACE&#x28;&#x28;SELECT COALESCE&#x28;SUM&#x28;item_pre_empenho.vl_total&#x29;,0.00&#x29;&#xd;&#xa;		                                         FROM empenho.item_pre_empenho&#xd;&#xa;		                                        WHERE item_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;		                                          AND item_pre_empenho.exercicio &#x3d; pre_empenho.exercicio&#x29;&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;&#xd;&#xa;		                              AS vl_fonte&#xd;&#xa;		                            , REPLACE&#x28;restos_pagar.valor_processado_nao_pago&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29; AS vl_saldo_ant_proc&#xd;&#xa;		                            , REPLACE&#x28;COALESCE&#x28;&#x28;restos_pagar.valor_nao_processado_exercicio_anterior&#x29;,0.00&#x29;&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29; AS vl_saldo_ant_nao&#xd;&#xa;		                    FROM empenho.empenho&#xd;&#xa;		                    JOIN empenho.pre_empenho&#xd;&#xa;		                      ON pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;		                     AND pre_empenho.exercicio &#x3d; empenho.exercicio&#xd;&#xa;		               LEFT JOIN empenho.restos_pre_empenho&#xd;&#xa;		                      ON restos_pre_empenho.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;		                     AND restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;		                    JOIN administracao.configuracao_entidade&#xd;&#xa;		                      ON configuracao_entidade.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;		                     AND configuracao_entidade.exercicio &#x3d; stExercicio          &#xd;&#xa;		                     AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;		                     AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;		                    JOIN &#x28; SELECT &#x2a; FROM &#x28;&#xd;&#xa;		                                            SELECT  despesa.num_orgao&#xd;&#xa;		                                                    , despesa.num_unidade&#xd;&#xa;		                                                    , despesa.exercicio&#xd;&#xa;		                                                    , pre_empenho_despesa.cod_pre_empenho&#xd;&#xa;		                                            FROM empenho.pre_empenho_despesa&#xd;&#xa;		                                            JOIN orcamento.despesa&#xd;&#xa;		                                              ON despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;		                                             AND despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;		                                            JOIN orcamento.conta_despesa&#xd;&#xa;		                                              ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;		                                             AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;		                                            UNION&#xd;&#xa;		                                            SELECT  restos_pre_empenho.num_orgao&#xd;&#xa;		                                                    , restos_pre_empenho.num_unidade&#xd;&#xa;		                                                    , restos_pre_empenho.exercicio&#xd;&#xa;		                                                    , restos_pre_empenho.cod_pre_empenho&#xd;&#xa;		                                            FROM empenho.restos_pre_empenho&#xd;&#xa;		                                        &#x29; as tbl&#xd;&#xa;		                                GROUP BY num_orgao, exercicio, num_unidade, cod_pre_empenho&#xd;&#xa;		                        &#x29; AS orgao&#xd;&#xa;		                      ON orgao.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;		                     AND orgao.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;		               LEFT JOIN &#x28;SELECT&#xd;&#xa;		                                    despesa.&#x2a;&#xd;&#xa;		                                    , conta_despesa.cod_estrutural&#xd;&#xa;		                                    , pre_empenho_despesa.cod_pre_empenho&#xd;&#xa;		                            FROM empenho.pre_empenho_despesa&#xd;&#xa;		                            JOIN orcamento.despesa&#xd;&#xa;		                              ON despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;		                             AND despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;		                            JOIN orcamento.conta_despesa&#xd;&#xa;		                              ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;		                             AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;		                        &#x29; AS  despesa&#xd;&#xa;		                      ON despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;		                     AND despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;		                    LEFT JOIN orcamento.recurso&#xd;&#xa;		                      ON recurso.exercicio &#x3d; despesa.exercicio&#xd;&#xa;		                     AND recurso.cod_recurso &#x3d; despesa.cod_recurso&#xd;&#xa;		                    LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;		                      ON pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;		                     AND pre_empenho_despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;		                    LEFT JOIN &#x28;SELECT &#x2a;&#xd;&#xa;		                                    , COALESCE&#x28;&#x28;rp.valor_processado_exercicios_anteriores &#x2b; rp.valor_processado_exercicio_anterior&#x29;,0.00&#x29; AS valor_processado_nao_pago&#xd;&#xa;		                                 FROM tcemg.fn_restos_pagar    &#x28;&#xd;&#xa;		                                                                stExercicio,        &#xd;&#xa;		                                                                stEntidade,         &#xd;&#xa;		                                                                01&#xd;&#xa;		                                                            &#x29; as rp &#x28;&#xd;&#xa;		                                                                cod_empenho INTEGER, cod_entidade INTEGER, exercicio CHARACTER&#x28;4&#x29;, valor_processado_exercicios_anteriores NUMERIC,&#xd;&#xa;		                                                                valor_processado_exercicio_anterior NUMERIC, valor_processado_cancelado NUMERIC, valor_processado_pago NUMERIC,&#xd;&#xa;		                                                                valor_nao_processado_exercicios_anteriores NUMERIC, valor_nao_processado_exercicio_anterior NUMERIC,&#xd;&#xa;		                                                                valor_nao_processado_cancelado NUMERIC, valor_nao_processado_pago NUMERIC&#xd;&#xa;		                                                            &#x29;&#xd;&#xa;		                        &#x29; AS restos_pagar&#xd;&#xa;		                      ON restos_pagar.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;		                     AND restos_pagar.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;		                     AND restos_pagar.exercicio &#x3d; empenho.exercicio&#xd;&#xa;		                    LEFT JOIN &#x28; SELECT retorno.entidade AS cod_entidade&#xd;&#xa;		                                , retorno.empenho AS cod_empenho&#xd;&#xa;		                                , retorno.exercicio&#xd;&#xa;		                                , sum&#x28;retorno.valor&#x29; AS vl_pago_exercicio_atual&#xd;&#xa;		                             FROM empenho.fn_empenho_restos_pagar_pagamento_estorno_credor&#xd;&#xa;		                                &#x28; &#x27;&#x27;&#xd;&#xa;		                                , &#x27;&#x27;&#xd;&#xa;		                                , &#x27;01&#x2f;01&#x2f;&#x27; &#x7c;&#x7c; stExercicio     &#xd;&#xa;		                                , &#x27;31&#x2f;12&#x2f;&#x27; &#x7c;&#x7c; stExercicio     &#xd;&#xa;		                                , stEntidade                  &#xd;&#xa;		                                , &#x27;&#x27;&#xd;&#xa;		                                , &#x27;&#x27;&#xd;&#xa;		                                , &#x27;&#x27;&#xd;&#xa;		                                , &#x27;&#x27;&#xd;&#xa;		                                , &#x27;&#x27;&#xd;&#xa;		                                , &#x27;&#x27;&#xd;&#xa;		                                , &#x27;&#x27;&#xd;&#xa;		                                , &#x27;1&#x27;&#xd;&#xa;		                                , &#x27;&#x27;&#xd;&#xa;		                                , &#x27;&#x27;&#xd;&#xa;		                                , &#x27;&#x27;&#xd;&#xa;		                                , &#x27;&#x27;&#xd;&#xa;		                                &#x29; AS retorno&#x28;&#xd;&#xa;		                                     entidade            integer,&#xd;&#xa;		                                     empenho             integer,&#xd;&#xa;		                                     exercicio           char&#x28;4&#x29;,&#xd;&#xa;		                                     credor              varchar,&#xd;&#xa;		                                     cod_estrutural      varchar,&#xd;&#xa;		                                     cod_nota            integer,&#xd;&#xa;		                                     data                text,&#xd;&#xa;		                                     conta               integer,&#xd;&#xa;		                                     banco               varchar,&#xd;&#xa;		                                     valor               numeric&#xd;&#xa;		                                     &#x29;&#xd;&#xa;		                         GROUP BY retorno.entidade&#xd;&#xa;		                                , retorno.empenho&#xd;&#xa;		                                , retorno.exercicio&#xd;&#xa;		                        &#x29; AS pagamento_restos&#xd;&#xa;		                      ON pagamento_restos.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;		                     AND pagamento_restos.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;		                     AND pagamento_restos.exercicio &#x3d; empenho.exercicio&#xd;&#xa;		                   WHERE empenho.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;                           &#xd;&#xa;		                     AND &#x28;    &#x28;pre_empenho.implantado &#x3d; true AND pre_empenho.exercicio &#x3d; stExercicio_ant &#x29;                                 &#xd;&#xa;		                         OR    &#x28;pagamento_restos.vl_pago_exercicio_atual &#x3e; 0.00 AND pre_empenho.exercicio &#x3c;&#x3d; stExercicio_ant&#x29;              &#xd;&#xa;		                         OR    &#x28;restos_pagar.valor_processado_nao_pago &#x3e; 0.00 AND pre_empenho.exercicio &#x3c;&#x3d; stExercicio_ant&#x29;                &#xd;&#xa;		                         OR    &#x28;restos_pagar.valor_nao_processado_exercicio_anterior &#x3e; 0.00 AND pre_empenho.exercicio &#x3c;&#x3d; stExercicio_ant&#x29;  &#xd;&#xa;		                         &#x29;&#xd;&#xa;			&#x29;,&#xd;&#xa;			rsp12 as&#xd;&#xa;			&#x28;&#xd;&#xa;	                    SELECT&#xd;&#xa;	                              12 AS tipo_registro&#xd;&#xa;	                            , empenho.cod_empenho&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;empenho.cod_entidade&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;empenho.exercicio&#x3a;&#x3a;VARCHAR AS cod_reduzido&#xd;&#xa;	                            , CASE WHEN trim&#x28;sw_pais.nom_pais&#x29; &#x3c;&#x3e; &#x27;Brasil&#x27; THEN 3&#xd;&#xa;	                                   WHEN sw_cgm_pessoa_fisica.cpf &#x3c;&#x3e; &#x27;&#x27; THEN 1&#xd;&#xa;	                                   WHEN sw_cgm_pessoa_juridica.cnpj &#x3c;&#x3e; &#x27;&#x27; THEN 2&#xd;&#xa;	                                   ELSE 1&#xd;&#xa;	                              END AS tipo_documento&#xd;&#xa;	                            , CASE WHEN sw_cgm_pessoa_fisica.cpf &#x3c;&#x3e; &#x27;&#x27; THEN sw_cgm_pessoa_fisica.cpf&#xd;&#xa;	                                   WHEN sw_cgm_pessoa_juridica.cnpj &#x3c;&#x3e; &#x27;&#x27; THEN sw_cgm_pessoa_juridica.cnpj&#xd;&#xa;	                                   ELSE &#x27;00000000000000&#x27;&#xd;&#xa;	                              END AS num_documento&#xd;&#xa;	                    FROM empenho.empenho&#xd;&#xa;	                    JOIN empenho.pre_empenho&#xd;&#xa;	                      ON pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;	                     AND pre_empenho.exercicio &#x3d; empenho.exercicio&#xd;&#xa;	                    JOIN empenho.restos_pre_empenho&#xd;&#xa;	                      ON restos_pre_empenho.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                     AND restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                    JOIN administracao.configuracao_entidade&#xd;&#xa;	                      ON configuracao_entidade.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;	                     AND configuracao_entidade.exercicio &#x3d; stExercicio        &#xd;&#xa;	                     AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;	                     AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;	                    LEFT JOIN &#x28;  SELECT pre_empenho.exercicio&#xd;&#xa;	                                 , pre_empenho.cod_pre_empenho&#xd;&#xa;	                                 , CASE WHEN &#x28; pre_empenho.implantado &#x3d; true &#x29;&#xd;&#xa;	                                        THEN restos_pre_empenho.num_orgao&#xd;&#xa;	                                        ELSE despesa.num_orgao&#xd;&#xa;	                                   END AS num_orgao&#xd;&#xa;	                                 , CASE WHEN &#x28; pre_empenho.implantado &#x3d; true &#x29;&#xd;&#xa;	                                        THEN restos_pre_empenho.num_unidade&#xd;&#xa;	                                        ELSE despesa.num_unidade&#xd;&#xa;	                                   END AS num_unidade&#xd;&#xa;	                                 , conta_despesa.cod_estrutural&#xd;&#xa;	                                 , CASE WHEN SUBSTR&#x28;conta_despesa.cod_estrutural, 9, 2&#x29; IN &#x28;&#x27;01&#x27;,&#x27;03&#x27;,&#x27;04&#x27;,&#x27;05&#x27;,&#x27;09&#x27;,&#x27;11&#x27;,&#x27;16&#x27;,&#x27;48&#x27;,&#x27;94&#x27;&#x29;&#xd;&#xa;	                                        THEN true&#xd;&#xa;	                                   WHEN &#x27;&#x27;&#x7c;&#x7c;SUBSTR&#x28;conta_despesa.cod_estrutural, 9, 2&#x29;&#x7c;&#x7c;SUBSTR&#x28;conta_despesa.cod_estrutural, 12, 2&#x29; IN &#x28;&#x27;3626&#x27;,&#x27;3628&#x27;,&#x27;3699&#x27;&#x29;&#xd;&#xa;	                                        THEN true&#xd;&#xa;	                                   WHEN SUBSTR&#x28;conta_despesa.cod_estrutural, 0, 14&#x29; IN &#x28;&#x27;3.1.9.0.92.01&#x27;,&#x27;3.1.9.0.92.02&#x27;,&#x27;3.1.7.1.92.01&#x27;,&#x27;3.1.7.1.92.02&#x27;,&#x27;3.1.9.1.92.01&#x27;,&#x27;3.1.9.1.92.02&#x27;,&#x27;3.3.9.0.36.07&#x27;&#x29;&#xd;&#xa;	                                        THEN true&#xd;&#xa;	                                        ELSE false&#xd;&#xa;	                                   END AS folha&#xd;&#xa;	                              FROM empenho.pre_empenho&#xd;&#xa;	                         LEFT JOIN empenho.restos_pre_empenho&#xd;&#xa;	                                ON restos_pre_empenho.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                               AND restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                         LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;	                                ON pre_empenho_despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                               AND pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                         LEFT JOIN orcamento.despesa&#xd;&#xa;	                                ON despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;	                               AND despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;	                              JOIN orcamento.conta_despesa&#xd;&#xa;	                                ON &#x28;    conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;	                                    AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;	                                   &#x29;&#xd;&#xa;	                                OR &#x28;    replace&#x28; conta_despesa.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29; &#x3d; restos_pre_empenho.cod_estrutural&#xd;&#xa;	                                    AND conta_despesa.exercicio &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;	                                   &#x29;&#xd;&#xa;	                         &#x29; AS orgao&#xd;&#xa;	                      ON orgao.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;	                     AND orgao.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;	                    JOIN sw_cgm&#xd;&#xa;	                      ON sw_cgm.numcgm &#x3d; pre_empenho.cgm_beneficiario&#xd;&#xa;	                    JOIN sw_pais&#xd;&#xa;	                      ON sw_pais.cod_pais &#x3d; sw_cgm.cod_pais&#xd;&#xa;	               LEFT JOIN sw_cgm_pessoa_fisica&#xd;&#xa;	                      ON sw_cgm_pessoa_fisica.numcgm &#x3d; sw_cgm.numcgm&#xd;&#xa;	               LEFT JOIN sw_cgm_pessoa_juridica&#xd;&#xa;	                      ON sw_cgm_pessoa_juridica.numcgm &#x3d; sw_cgm.numcgm&#xd;&#xa;	               LEFT JOIN &#x28;       SELECT &#x2a;&#xd;&#xa;	                                    , COALESCE&#x28;&#x28;rp.valor_processado_exercicios_anteriores &#x2b; rp.valor_processado_exercicio_anterior&#x29;,0.00&#x29; AS valor_processado_nao_pago&#xd;&#xa;	                                 FROM tcemg.fn_restos_pagar    &#x28;&#xd;&#xa;	                                                                stExercicio,    &#xd;&#xa;	                                                                stEntidade,     &#xd;&#xa;	                                                                01&#xd;&#xa;	                                                            &#x29; as rp &#x28;&#xd;&#xa;	                                                                cod_empenho INTEGER, cod_entidade INTEGER, exercicio CHARACTER&#x28;4&#x29;, valor_processado_exercicios_anteriores NUMERIC,&#xd;&#xa;	                                                                valor_processado_exercicio_anterior NUMERIC, valor_processado_cancelado NUMERIC, valor_processado_pago NUMERIC,&#xd;&#xa;	                                                                valor_nao_processado_exercicios_anteriores NUMERIC, valor_nao_processado_exercicio_anterior NUMERIC,&#xd;&#xa;	                                                                valor_nao_processado_cancelado NUMERIC, valor_nao_processado_pago NUMERIC&#xd;&#xa;	                                                            &#x29;&#xd;&#xa;	                        &#x29; AS restos_pagar&#xd;&#xa;	                      ON restos_pagar.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;	                     AND restos_pagar.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;	                     AND restos_pagar.exercicio &#x3d; empenho.exercicio&#xd;&#xa;&#xd;&#xa;	               LEFT JOIN &#x28; SELECT retorno.entidade AS cod_entidade&#xd;&#xa;	                                , retorno.empenho AS cod_empenho&#xd;&#xa;	                                , retorno.exercicio&#xd;&#xa;	                                , sum&#x28;retorno.valor&#x29; AS vl_pago_exercicio_atual&#xd;&#xa;	                             FROM empenho.fn_empenho_restos_pagar_pagamento_estorno_credor&#xd;&#xa;	                                &#x28; &#x27;&#x27;&#xd;&#xa;	                                , &#x27;&#x27;&#xd;&#xa;	                                , &#x27;01&#x2f;01&#x2f;&#x27; &#x7c;&#x7c; stExercicio         &#xd;&#xa;	                                , &#x27;31&#x2f;12&#x2f;&#x27; &#x7c;&#x7c; stExercicio         &#xd;&#xa;	                                , stEntidade                      &#xd;&#xa;	                                , &#x27;&#x27;&#xd;&#xa;	                                , &#x27;&#x27;&#xd;&#xa;	                                , &#x27;&#x27;&#xd;&#xa;	                                , &#x27;&#x27;&#xd;&#xa;	                                , &#x27;&#x27;&#xd;&#xa;	                                , &#x27;&#x27;&#xd;&#xa;	                                , &#x27;&#x27;&#xd;&#xa;	                                , &#x27;1&#x27;&#xd;&#xa;	                                , &#x27;&#x27;&#xd;&#xa;	                                , &#x27;&#x27;&#xd;&#xa;	                                , &#x27;&#x27;&#xd;&#xa;	                                , &#x27;&#x27;&#xd;&#xa;	                                &#x29; AS retorno&#x28;&#xd;&#xa;	                                     entidade            integer,&#xd;&#xa;	                                     empenho             integer,&#xd;&#xa;	                                     exercicio           char&#x28;4&#x29;,&#xd;&#xa;	                                     credor              varchar,&#xd;&#xa;	                                     cod_estrutural      varchar,&#xd;&#xa;	                                     cod_nota            integer,&#xd;&#xa;	                                     data                text,&#xd;&#xa;	                                     conta               integer,&#xd;&#xa;	                                     banco               varchar,&#xd;&#xa;	                                     valor               numeric&#xd;&#xa;	                                     &#x29;&#xd;&#xa;	                         GROUP BY retorno.entidade&#xd;&#xa;	                                , retorno.empenho&#xd;&#xa;	                                , retorno.exercicio&#xd;&#xa;	                        &#x29; AS pagamento_restos&#xd;&#xa;	                      ON pagamento_restos.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;	                     AND pagamento_restos.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;	                     AND pagamento_restos.exercicio &#x3d; empenho.exercicio&#xd;&#xa;	                   WHERE empenho.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;              &#xd;&#xa;	                     AND &#x28;&#xd;&#xa;	                             &#x28;pagamento_restos.vl_pago_exercicio_atual &#x3e; 0.00&#x29;&#xd;&#xa;	                         OR    &#x28;restos_pagar.valor_processado_nao_pago &#x3e; 0.00&#x29;&#xd;&#xa;	                         OR    &#x28;restos_pagar.valor_nao_processado_exercicio_anterior &#x3e; 0.00&#x29;&#xd;&#xa;	                         &#x29;&#xd;&#xa;	                     AND pre_empenho.exercicio &#x3c; &#x27;2013&#x27;&#xd;&#xa;	                     AND empenho.exercicio &#x3c; &#x27;2013&#x27;&#xd;&#xa;	                     AND &#x28;sw_cgm_pessoa_fisica.cpf &#x3c;&#x3e; &#x27;&#x27; OR sw_cgm_pessoa_juridica.cnpj &#x3c;&#x3e; &#x27;&#x27;&#x29;&#xd;&#xa;			&#x29;,&#xd;&#xa;			 rsp20 as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 20 AS tipo_registro&#xd;&#xa;				           , cod_reduzido&#xd;&#xa;				           , cod_orgao&#xd;&#xa;				           , cod_unidade&#xd;&#xa;				           , cod_unidade_orig&#xd;&#xa;				           , num_empenho&#xd;&#xa;				           , exercicio_empenho&#xd;&#xa;				           , dt_empenho&#xd;&#xa;				           , tipo_restos_pagar&#xd;&#xa;				           , tipo_movimento&#xd;&#xa;				           , dt_movimentacao&#xd;&#xa;				           , dot_orig&#xd;&#xa;				           , REPLACE&#x28;SUM&#x28;vl_movimentacao&#x29;&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29; AS vl_movimentacao&#xd;&#xa;				           , cod_orgao_encamp_atrib&#xd;&#xa;				           , cod_unidade_sub_encamp_atrib&#xd;&#xa;				           , justificativa&#xd;&#xa;				           , ato_cancelamento&#xd;&#xa;				           , data_ato_cancelamento&#xd;&#xa;				        FROM &#x28;&#xd;&#xa;				              SELECT TO_CHAR&#x28;empenho_anulado.timestamp, &#x27;yymmdd&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;LPAD&#x28;empenho.cod_entidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;LPAD&#x28;empenho.cod_empenho&#x3a;&#x3a;VARCHAR, 7, &#x27;0&#x27;&#x29;&#x3a;&#x3a;VARCHAR AS cod_reduzido&#xd;&#xa;				                   , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;				                   , CASE WHEN restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;				                           THEN CASE WHEN uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;				                                     THEN LPAD&#x28;LPAD&#x28;uniorcam.num_orgao_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;uniorcam.num_unidade_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;				                                     ELSE LPAD&#x28;restos_pre_empenho.num_unidade&#x3a;&#x3a;VARCHAR,5,&#x27;0&#x27;&#x29;&#xd;&#xa;				                                 END&#xd;&#xa;				                           ELSE LPAD&#x28;&#x28;LPAD&#x28;despesa.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;despesa.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;				                      END AS cod_unidade&#xd;&#xa;				                   , CASE WHEN restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;				                           THEN CASE WHEN uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;				                                     THEN LPAD&#x28;LPAD&#x28;uniorcam.num_orgao_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;uniorcam.num_unidade_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;				                                     ELSE LPAD&#x28;restos_pre_empenho.num_unidade&#x3a;&#x3a;VARCHAR,5,&#x27;0&#x27;&#x29;&#xd;&#xa;				                                 END&#xd;&#xa;				                           ELSE LPAD&#x28;&#x28;LPAD&#x28;despesa.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;despesa.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;				                      END AS cod_unidade_orig&#xd;&#xa;				                   , empenho.cod_empenho AS num_empenho&#xd;&#xa;				                   , empenho.exercicio AS exercicio_empenho&#xd;&#xa;				                   , TO_CHAR&#x28;empenho.dt_empenho, &#x27;ddmmyyyy&#x27;&#x29; AS dt_empenho&#xd;&#xa;				                   , 1 AS tipo_restos_pagar&#xd;&#xa;				                   , 1 tipo_movimento&#xd;&#xa;				                   , TO_CHAR&#x28;empenho_anulado.timestamp, &#x27;ddmmyyyy&#x27;&#x29; AS dt_movimentacao&#xd;&#xa;				                   , &#x27;&#x27; AS dot_orig&#xd;&#xa;				                   , empenho_anulado.vl_anulado AS vl_movimentacao&#xd;&#xa;				                   , &#x27;&#x27; AS cod_orgao_encamp_atrib&#xd;&#xa;				                   , &#x27;&#x27; AS cod_unidade_sub_encamp_atrib&#xd;&#xa;				                   , empenho_anulado.motivo AS justificativa&#xd;&#xa;				                   , &#x27;&#x27; ato_cancelamento&#xd;&#xa;				                   , &#x27;&#x27; AS data_ato_cancelamento&#xd;&#xa;				                FROM empenho.empenho&#xd;&#xa;				          INNER JOIN &#x28;&#xd;&#xa;				                      SELECT empenho_anulado_item.exercicio&#xd;&#xa;				                           , empenho_anulado_item.cod_empenho&#xd;&#xa;				                           , empenho_anulado_item.cod_entidade&#xd;&#xa;				                           , SUM&#x28;empenho_anulado_item.vl_anulado&#x29; AS vl_anulado&#xd;&#xa;				                           , empenho_anulado_item.timestamp&#xd;&#xa;				                           , empenho_anulado.motivo&#xd;&#xa;				                        FROM empenho.empenho_anulado_item&#xd;&#xa;				                  INNER JOIN empenho.empenho_anulado&#xd;&#xa;				                          ON empenho_anulado_item.exercicio    &#x3d; empenho_anulado.exercicio&#xd;&#xa;				                         AND empenho_anulado_item.cod_entidade &#x3d; empenho_anulado.cod_entidade&#xd;&#xa;				                         AND empenho_anulado_item.cod_empenho  &#x3d; empenho_anulado.cod_empenho&#xd;&#xa;				                         AND empenho_anulado_item.timestamp    &#x3d; empenho_anulado.timestamp&#xd;&#xa;				                       WHERE empenho_anulado_item.exercicio &#x3c; stExercicio              &#xd;&#xa;				                         &#xd;&#xa;				                         AND empenho_anulado_item.timestamp&#x3a;&#x3a;date BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;				                    GROUP BY empenho_anulado_item.exercicio&#xd;&#xa;				                           , empenho_anulado_item.cod_empenho&#xd;&#xa;				                           , empenho_anulado_item.cod_entidade&#xd;&#xa;				                           , empenho_anulado_item.timestamp&#xd;&#xa;				                           , empenho_anulado.motivo&#xd;&#xa;				                    ORDER BY empenho_anulado_item.exercicio&#xd;&#xa;				                           , empenho_anulado_item.cod_empenho&#xd;&#xa;				                           , empenho_anulado_item.cod_entidade&#xd;&#xa;				                     &#x29; AS empenho_anulado&#xd;&#xa;				                  ON empenho_anulado.exercicio    &#x3d; empenho.exercicio&#xd;&#xa;				                 AND empenho_anulado.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;				                 AND empenho_anulado.cod_empenho  &#x3d; empenho.cod_empenho&#xd;&#xa;				          INNER JOIN empenho.pre_empenho&#xd;&#xa;				                  ON pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;				                 AND pre_empenho.exercicio &#x3d; empenho.exercicio&#xd;&#xa;				           LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;				                  ON pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;				                 AND pre_empenho_despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;				           LEFT JOIN empenho.restos_pre_empenho&#xd;&#xa;				                  ON pre_empenho.cod_pre_empenho &#x3d; restos_pre_empenho.cod_pre_empenho&#xd;&#xa;				                 AND pre_empenho.exercicio &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;				           LEFT JOIN tcemg.uniorcam&#xd;&#xa;				                  ON uniorcam.num_unidade &#x3d; restos_pre_empenho.num_unidade&#xd;&#xa;				                 AND uniorcam.num_orgao   &#x3d; restos_pre_empenho.num_orgao&#xd;&#xa;				                 AND uniorcam.exercicio   &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;				                 AND uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;				           LEFT JOIN orcamento.despesa&#xd;&#xa;				                  ON despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;				                 AND despesa.exercicio   &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;				          INNER JOIN administracao.configuracao_entidade&#xd;&#xa;				                  ON configuracao_entidade.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;				                 AND configuracao_entidade.exercicio &#x3d; stExercicio                 &#xd;&#xa;				                 AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;				                 AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;				           LEFT JOIN &#x28; SELECT &#x2a;&#xd;&#xa;				                            , COALESCE&#x28;&#x28;rp.valor_processado_exercicios_anteriores &#x2b; rp.valor_processado_exercicio_anterior&#x29;,0.00&#x29; AS valor_processado_nao_pago&#xd;&#xa;				                         FROM tcemg.fn_restos_pagar &#x28;&#xd;&#xa;				                                                                    stExercicio,      &#xd;&#xa;				                                                                    stEntidade,       &#xd;&#xa;				                                                                    02&#xd;&#xa;				                                                    &#x29; as rp &#x28;&#xd;&#xa;				                                                         cod_empenho INTEGER, cod_entidade INTEGER, exercicio CHARACTER&#x28;4&#x29;, valor_processado_exercicios_anteriores NUMERIC,&#xd;&#xa;				                                                         valor_processado_exercicio_anterior NUMERIC, valor_processado_cancelado NUMERIC, valor_processado_pago NUMERIC,&#xd;&#xa;				                                                         valor_nao_processado_exercicios_anteriores NUMERIC, valor_nao_processado_exercicio_anterior NUMERIC,&#xd;&#xa;				                                                         valor_nao_processado_cancelado NUMERIC, valor_nao_processado_pago NUMERIC&#xd;&#xa;				                                                    &#x29;&#xd;&#xa;			&#xd;&#xa;				                        &#xd;&#xa;				                     &#x29; AS restos_pagar&#xd;&#xa;				                  ON restos_pagar.cod_empenho  &#x3d; empenho.cod_empenho&#xd;&#xa;				                 AND restos_pagar.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;				                 AND restos_pagar.exercicio    &#x3d; empenho.exercicio&#xd;&#xa;				           LEFT JOIN &#x28; SELECT retorno.entidade AS cod_entidade&#xd;&#xa;				                            , retorno.empenho AS cod_empenho&#xd;&#xa;				                            , retorno.exercicio&#xd;&#xa;				                            , sum&#x28;retorno.valor&#x29; AS vl_pago_exercicio_atual&#xd;&#xa;				                         FROM empenho.fn_empenho_restos_pagar_pagamento_estorno_credor&#xd;&#xa;				                                       &#x28; &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;01&#x2f;01&#x2f;&#x27; &#x7c;&#x7c; stExercicio            &#xd;&#xa;				                                       , &#x27;31&#x2f;12&#x2f;&#x27; &#x7c;&#x7c; stExercicio            &#xd;&#xa;				                                       , stEntidade                         &#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;1&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                            &#x29; AS retorno&#x28;&#xd;&#xa;				                                 entidade            integer,&#xd;&#xa;				                                 empenho             integer,&#xd;&#xa;				                                 exercicio           char&#x28;4&#x29;,&#xd;&#xa;				                                 credor              varchar,&#xd;&#xa;				                                 cod_estrutural      varchar,&#xd;&#xa;				                                 cod_nota            integer,&#xd;&#xa;				                                 data                text,&#xd;&#xa;				                                 conta               integer,&#xd;&#xa;				                                 banco               varchar,&#xd;&#xa;				                                 valor               numeric&#xd;&#xa;				                                 &#x29;&#xd;&#xa;				                     GROUP BY retorno.entidade&#xd;&#xa;				                            , retorno.empenho&#xd;&#xa;				                            , retorno.exercicio&#xd;&#xa;				                     &#x29; AS pagamento_restos&#xd;&#xa;				                  ON pagamento_restos.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;				                 AND pagamento_restos.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;				                 AND pagamento_restos.exercicio &#x3d; empenho.exercicio&#xd;&#xa;				               WHERE empenho.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;     &#xd;&#xa;				               AND empenho.cod_empenho IN &#x28;4717,3056&#x29;&#xd;&#xa;				                            AND &#x28;    &#x28;pre_empenho.implantado &#x3d; true AND pre_empenho.exercicio &#x3d; stExercicio_ant &#x29;                                  &#xd;&#xa;				                                OR    &#x28;pagamento_restos.vl_pago_exercicio_atual &#x3e; 0.00 AND pre_empenho.exercicio &#x3c;&#x3d; stExercicio_ant&#x29;               &#xd;&#xa;				                                OR    &#x28;restos_pagar.valor_processado_nao_pago &#x3e; 0.00 AND pre_empenho.exercicio &#x3c;&#x3d; stExercicio_ant&#x29;                 &#xd;&#xa;				                                OR    &#x28;restos_pagar.valor_nao_processado_exercicio_anterior &#x3e; 0.00 AND pre_empenho.exercicio &#x3c;&#x3d; stExercicio_ant&#x29;   &#xd;&#xa;				                                &#x29;&#xd;&#xa;				                            &#xd;&#xa;				               UNION&#xd;&#xa;				              SELECT TO_CHAR&#x28;empenho_anulado.timestamp, &#x27;yymmdd&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;LPAD&#x28;empenho.cod_entidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;LPAD&#x28;empenho.cod_empenho&#x3a;&#x3a;VARCHAR, 7, &#x27;0&#x27;&#x29;&#x3a;&#x3a;VARCHAR AS cod_reduzido&#xd;&#xa;				                   , LPAD&#x28;configuracao_entidade.valor&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_orgao&#xd;&#xa;			&#xd;&#xa;				                   , CASE WHEN restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;				                           THEN CASE WHEN uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;				                                     THEN LPAD&#x28;LPAD&#x28;uniorcam.num_orgao_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;uniorcam.num_unidade_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;				                                     ELSE LPAD&#x28;restos_pre_empenho.num_unidade&#x3a;&#x3a;VARCHAR,5,&#x27;0&#x27;&#x29;&#xd;&#xa;				                                 END&#xd;&#xa;				                           ELSE LPAD&#x28;&#x28;LPAD&#x28;despesa.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;despesa.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;				                      END AS cod_unidade&#xd;&#xa;				                   , CASE WHEN restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;				                           THEN CASE WHEN uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;				                                     THEN LPAD&#x28;LPAD&#x28;uniorcam.num_orgao_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;uniorcam.num_unidade_atual&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;&#xd;&#xa;				                                     ELSE LPAD&#x28;restos_pre_empenho.num_unidade&#x3a;&#x3a;VARCHAR,5,&#x27;0&#x27;&#x29;&#xd;&#xa;				                                 END&#xd;&#xa;				                           ELSE LPAD&#x28;&#x28;LPAD&#x28;despesa.num_orgao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;despesa.num_unidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;				                      END AS cod_unidade_orig&#xd;&#xa;				                   , empenho.cod_empenho AS num_empenho&#xd;&#xa;				                   , empenho.exercicio AS exercicio_empenho&#xd;&#xa;				                   , TO_CHAR&#x28;empenho.dt_empenho, &#x27;ddmmyyyy&#x27;&#x29; AS dt_empenho&#xd;&#xa;				                   , 2 AS tipo_restos_pagar&#xd;&#xa;				                   , 1 tipo_movimento&#xd;&#xa;				                   , TO_CHAR&#x28;empenho_anulado.timestamp, &#x27;ddmmyyyy&#x27;&#x29; AS dt_movimentacao&#xd;&#xa;				                   , &#x27;&#x27; AS dot_orig&#xd;&#xa;				                   , empenho_anulado.vl_anulado AS vl_movimentacao&#xd;&#xa;				                   , &#x27;&#x27; AS cod_orgao_encamp_atrib&#xd;&#xa;				                   , &#x27;&#x27; AS cod_unidade_sub_encamp_atrib&#xd;&#xa;				                   , empenho_anulado.motivo AS justificativa&#xd;&#xa;				                   , &#x27;&#x27; ato_cancelamento&#xd;&#xa;				                   , &#x27;&#x27; AS data_ato_cancelamento&#xd;&#xa;				                FROM empenho.empenho&#xd;&#xa;				          INNER JOIN &#x28;&#xd;&#xa;				                      SELECT empenho_anulado_item.exercicio&#xd;&#xa;				                           , empenho_anulado_item.cod_empenho&#xd;&#xa;				                           , empenho_anulado_item.cod_entidade&#xd;&#xa;				                           , SUM&#x28;empenho_anulado_item.vl_anulado&#x29; AS vl_anulado&#xd;&#xa;				                           , empenho_anulado_item.timestamp&#xd;&#xa;				                           , empenho_anulado.motivo&#xd;&#xa;				                        FROM empenho.empenho_anulado_item&#xd;&#xa;				                  INNER JOIN empenho.empenho_anulado&#xd;&#xa;				                          ON empenho_anulado_item.exercicio    &#x3d; empenho_anulado.exercicio&#xd;&#xa;				                         AND empenho_anulado_item.cod_entidade &#x3d; empenho_anulado.cod_entidade&#xd;&#xa;				                         AND empenho_anulado_item.cod_empenho  &#x3d; empenho_anulado.cod_empenho&#xd;&#xa;				                         AND empenho_anulado_item.timestamp    &#x3d; empenho_anulado.timestamp&#xd;&#xa;				                       WHERE empenho_anulado_item.exercicio &#x3c; stExercicio      &#xd;&#xa;				                         &#xd;&#xa;				                         AND empenho_anulado_item.timestamp&#x3a;&#x3a;date BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;      &#xd;&#xa;				                    GROUP BY empenho_anulado_item.exercicio&#xd;&#xa;				                           , empenho_anulado_item.cod_empenho&#xd;&#xa;				                           , empenho_anulado_item.cod_entidade&#xd;&#xa;				                           , empenho_anulado_item.timestamp&#xd;&#xa;				                           , empenho_anulado.motivo&#xd;&#xa;				                     &#x29; AS empenho_anulado&#xd;&#xa;				                  ON empenho_anulado.exercicio    &#x3d; empenho.exercicio&#xd;&#xa;				                 AND empenho_anulado.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;				                 AND empenho_anulado.cod_empenho  &#x3d; empenho.cod_empenho&#xd;&#xa;				          INNER JOIN empenho.pre_empenho&#xd;&#xa;				                  ON pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;				                 AND pre_empenho.exercicio &#x3d; empenho.exercicio&#xd;&#xa;				           LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;				                  ON pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;				                 AND pre_empenho_despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;				           LEFT JOIN empenho.restos_pre_empenho&#xd;&#xa;				                  ON pre_empenho.cod_pre_empenho &#x3d; restos_pre_empenho.cod_pre_empenho&#xd;&#xa;				                 AND pre_empenho.exercicio &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;				           LEFT JOIN tcemg.uniorcam&#xd;&#xa;				                  ON uniorcam.num_unidade &#x3d; restos_pre_empenho.num_unidade&#xd;&#xa;				                 AND uniorcam.num_orgao   &#x3d; restos_pre_empenho.num_orgao&#xd;&#xa;				                 AND uniorcam.exercicio   &#x3d; restos_pre_empenho.exercicio&#xd;&#xa;				                 AND uniorcam.num_orgao_atual IS NOT NULL&#xd;&#xa;				           LEFT JOIN orcamento.despesa&#xd;&#xa;				                  ON despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;				                 AND despesa.exercicio   &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;				          INNER JOIN administracao.configuracao_entidade&#xd;&#xa;				                  ON configuracao_entidade.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;				                 AND configuracao_entidade.exercicio &#x3d; stExercicio        &#xd;&#xa;				                 AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;				                 AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;				           LEFT JOIN &#x28; SELECT &#x2a;&#xd;&#xa;				                            , COALESCE&#x28;&#x28;rp.valor_processado_exercicios_anteriores &#x2b; rp.valor_processado_exercicio_anterior&#x29;,0.00&#x29; AS valor_processado_nao_pago&#xd;&#xa;				                         FROM tcemg.fn_restos_pagar &#x28;&#xd;&#xa;				                                                                    stExercicio,       &#xd;&#xa;				                                                                    stEntidade,        &#xd;&#xa;				                                                                    02&#xd;&#xa;				                                                    &#x29; as rp &#x28;&#xd;&#xa;				                                                         cod_empenho INTEGER, cod_entidade INTEGER, exercicio CHARACTER&#x28;4&#x29;, valor_processado_exercicios_anteriores NUMERIC,&#xd;&#xa;				                                                         valor_processado_exercicio_anterior NUMERIC, valor_processado_cancelado NUMERIC, valor_processado_pago NUMERIC,&#xd;&#xa;				                                                         valor_nao_processado_exercicios_anteriores NUMERIC, valor_nao_processado_exercicio_anterior NUMERIC,&#xd;&#xa;				                                                         valor_nao_processado_cancelado NUMERIC, valor_nao_processado_pago NUMERIC&#xd;&#xa;				                                                    &#x29;&#xd;&#xa;				                      &#xd;&#xa;				                     &#x29; AS restos_pagar&#xd;&#xa;				                  ON restos_pagar.cod_empenho  &#x3d; empenho.cod_empenho&#xd;&#xa;				                 AND restos_pagar.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;				                 AND restos_pagar.exercicio    &#x3d; empenho.exercicio&#xd;&#xa;				           LEFT JOIN &#x28; SELECT retorno.entidade AS cod_entidade&#xd;&#xa;				                            , retorno.empenho AS cod_empenho&#xd;&#xa;				                            , retorno.exercicio&#xd;&#xa;				                            , sum&#x28;retorno.valor&#x29; AS vl_pago_exercicio_atual&#xd;&#xa;				                         FROM empenho.fn_empenho_restos_pagar_pagamento_estorno_credor&#xd;&#xa;				                                       &#x28; &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;01&#x2f;01&#x2f;&#x27; &#x7c;&#x7c; stExercicio    &#xd;&#xa;				                                       , &#x27;31&#x2f;12&#x2f;&#x27; &#x7c;&#x7c; StExercicio    &#xd;&#xa;				                                       , stEntidade      &#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;1&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                                       , &#x27;&#x27;&#xd;&#xa;				                            &#x29; AS retorno&#x28;&#xd;&#xa;				                                 entidade            integer,&#xd;&#xa;				                                 empenho             integer,&#xd;&#xa;				                                 exercicio           char&#x28;4&#x29;,&#xd;&#xa;				                                 credor              varchar,&#xd;&#xa;				                                 cod_estrutural      varchar,&#xd;&#xa;				                                 cod_nota            integer,&#xd;&#xa;				                                 data                text,&#xd;&#xa;				                                 conta               integer,&#xd;&#xa;				                                 banco               varchar,&#xd;&#xa;				                                 valor               numeric&#xd;&#xa;				                                 &#x29;&#xd;&#xa;				                     GROUP BY retorno.entidade&#xd;&#xa;				                            , retorno.empenho&#xd;&#xa;				                            , retorno.exercicio&#xd;&#xa;				                     &#x29; AS pagamento_restos&#xd;&#xa;				                  ON pagamento_restos.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;				                 AND pagamento_restos.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;				                 AND pagamento_restos.exercicio &#x3d; empenho.exercicio&#xd;&#xa;				                          WHERE empenho.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;     &#xd;&#xa;				                            AND empenho.cod_empenho IN &#x28;4717,3056&#x29;&#xd;&#xa;				                            AND &#x28;    &#x28;pre_empenho.implantado &#x3d; true AND pre_empenho.exercicio &#x3d; stExercicio_ant &#x29;                                 &#xd;&#xa;				                                OR    &#x28;pagamento_restos.vl_pago_exercicio_atual &#x3e; 0.00 AND pre_empenho.exercicio &#x3c;&#x3d; stExercicio_ant&#x29;              &#xd;&#xa;				                                OR    &#x28;restos_pagar.valor_processado_nao_pago &#x3e; 0.00 AND pre_empenho.exercicio &#x3c;&#x3d; stExercicio_ant&#x29;                &#xd;&#xa;				                                OR    &#x28;restos_pagar.valor_nao_processado_exercicio_anterior &#x3e; 0.00 AND pre_empenho.exercicio &#x3c;&#x3d; stExercicio_ant&#x29;  &#xd;&#xa;				                                &#x29;&#xd;&#xa;				                            &#xd;&#xa;				             &#x29; AS tabela&#xd;&#xa;				    GROUP BY cod_reduzido&#xd;&#xa;				           , cod_orgao&#xd;&#xa;				           , cod_unidade&#xd;&#xa;				           , cod_unidade_orig&#xd;&#xa;				           , num_empenho&#xd;&#xa;				           , exercicio_empenho&#xd;&#xa;				           , dt_empenho&#xd;&#xa;				           , tipo_restos_pagar&#xd;&#xa;				           , tipo_movimento&#xd;&#xa;				           , dt_movimentacao&#xd;&#xa;				           , dot_orig&#xd;&#xa;				           , cod_orgao_encamp_atrib&#xd;&#xa;				           , cod_unidade_sub_encamp_atrib&#xd;&#xa;				           , justificativa&#xd;&#xa;				           , ato_cancelamento&#xd;&#xa;				           , data_ato_cancelamento&#xd;&#xa;				    ORDER BY num_empenho&#xd;&#xa;			&#x29;,&#xd;&#xa;			 rsp21 as&#xd;&#xa;			&#x28;&#xd;&#xa;							SELECT tipo_registro&#xd;&#xa;			                         , cod_reduzido&#xd;&#xa;			                         , cod_fonte_recurso&#xd;&#xa;			                         , REPLACE&#x28;SUM&#x28;vl_movimentacao_fonte&#x29;&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29; AS vl_movimentacao_fonte&#xd;&#xa;			                         , cod_empenho&#xd;&#xa;			                         , exercicio&#xd;&#xa;			                         , dt_movimentacao&#xd;&#xa;			                      FROM &#x28;&#xd;&#xa;			                                SELECT&#xd;&#xa;			                                    21 AS tipo_registro&#xd;&#xa;			                                    , TO_CHAR&#x28;empenho_anulado.timestamp, &#x27;yymmdd&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;LPAD&#x28;empenho.cod_entidade&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29;&#x3a;&#x3a;VARCHAR&#x7c;&#x7c;LPAD&#x28;empenho.cod_empenho&#x3a;&#x3a;VARCHAR, 7, &#x27;0&#x27;&#x29;&#x3a;&#x3a;VARCHAR AS cod_reduzido&#xd;&#xa;			                                    , CASE WHEN pre_empenho.implantado &#x3d; TRUE THEN restos_pre_empenho.recurso&#x3a;&#x3a;VARCHAR&#xd;&#xa;			                                           ELSE recurso.cod_fonte&#xd;&#xa;			                                      END AS cod_fonte_recurso&#xd;&#xa;			                                    , empenho_anulado.vl_anulado AS vl_movimentacao_fonte&#xd;&#xa;			                                    , empenho.cod_empenho&#xd;&#xa;			                                    , empenho.exercicio&#xd;&#xa;			                                    , TO_CHAR&#x28;empenho_anulado.timestamp, &#x27;ddmmyyyy&#x27;&#x29; AS dt_movimentacao&#xd;&#xa;			                            FROM empenho.empenho&#xd;&#xa;			                            JOIN empenho.pre_empenho&#xd;&#xa;			                              ON pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;			                             AND pre_empenho.exercicio &#x3d; empenho.exercicio&#xd;&#xa;			                            JOIN administracao.configuracao_entidade&#xd;&#xa;			                              ON configuracao_entidade.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;			                             AND configuracao_entidade.exercicio &#x3d; stExercicio            &#xd;&#xa;			                             AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;			                             AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;			                            JOIN &#x28; SELECT &#x2a; FROM &#x28;&#xd;&#xa;			                                                    SELECT  despesa.num_orgao&#xd;&#xa;			                                                            , despesa.num_unidade&#xd;&#xa;			                                                            , despesa.exercicio&#xd;&#xa;			                                                            , pre_empenho_despesa.cod_pre_empenho&#xd;&#xa;			                                                    FROM empenho.pre_empenho_despesa&#xd;&#xa;			                                                    JOIN orcamento.despesa&#xd;&#xa;			                                                      ON despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;			                                                     AND despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;			                                                    JOIN orcamento.conta_despesa&#xd;&#xa;			                                                      ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;			                                                     AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;			                                                    UNION&#xd;&#xa;			                                                    SELECT  restos_pre_empenho.num_orgao&#xd;&#xa;			                                                            , restos_pre_empenho.num_unidade&#xd;&#xa;			                                                            , restos_pre_empenho.exercicio&#xd;&#xa;			                                                            , restos_pre_empenho.cod_pre_empenho&#xd;&#xa;			                                                    FROM empenho.restos_pre_empenho&#xd;&#xa;			                                                &#x29; as tbl&#xd;&#xa;			                                        GROUP BY num_orgao, exercicio, num_unidade, cod_pre_empenho&#xd;&#xa;			                                &#x29; AS orgao&#xd;&#xa;			                              ON orgao.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;			                             AND orgao.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;			                            JOIN tcemg.uniorcam&#xd;&#xa;			                              ON uniorcam.num_orgao &#x3d; orgao.num_orgao&#xd;&#xa;			                             AND uniorcam.num_unidade &#x3d; orgao.num_unidade&#xd;&#xa;			                             AND uniorcam.exercicio &#x3d; orgao.exercicio&#xd;&#xa;			                            JOIN &#x28; SELECT empenho_anulado_item.exercicio&#xd;&#xa;			                                       , empenho_anulado_item.cod_empenho&#xd;&#xa;			                                       , empenho_anulado_item.cod_entidade&#xd;&#xa;			                                       , empenho_anulado_item.vl_anulado&#xd;&#xa;			                                       , empenho_anulado_item.timestamp&#xd;&#xa;			                                       , empenho_anulado.motivo&#xd;&#xa;			                                    FROM empenho.empenho_anulado_item&#xd;&#xa;			                                    JOIN empenho.empenho_anulado&#xd;&#xa;			                                      ON empenho_anulado_item.exercicio &#x3d; empenho_anulado.exercicio&#xd;&#xa;			                                     AND empenho_anulado_item.cod_entidade &#x3d; empenho_anulado.cod_entidade&#xd;&#xa;			                                     AND empenho_anulado_item.cod_empenho &#x3d; empenho_anulado.cod_empenho&#xd;&#xa;			                                     AND empenho_anulado_item.timestamp &#x3d; empenho_anulado.timestamp&#xd;&#xa;			                                   WHERE empenho_anulado_item.exercicio &#x3c; &#x27;2015&#x27;&#xd;&#xa;			                                     &#xd;&#xa;			                                     AND empenho_anulado_item.timestamp&#x3a;&#x3a;date BETWEEN TO_DATE&#x28;stDtinicio, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   &#xd;&#xa;			                                 &#x29; AS empenho_anulado&#xd;&#xa;			                              ON empenho_anulado.exercicio &#x3d; empenho.exercicio&#xd;&#xa;			                             AND empenho_anulado.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;			                             AND empenho_anulado.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;			                       LEFT JOIN empenho.restos_pre_empenho&#xd;&#xa;			                              ON restos_pre_empenho.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;			                             AND restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;			                       LEFT JOIN &#x28;SELECT&#xd;&#xa;			                                         despesa.&#x2a;&#xd;&#xa;			                                       , conta_despesa.cod_estrutural&#xd;&#xa;			                                       , pre_empenho_despesa.cod_pre_empenho&#xd;&#xa;			                                    FROM empenho.pre_empenho_despesa&#xd;&#xa;			                                    JOIN orcamento.despesa&#xd;&#xa;			                                      ON despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;			                                     AND despesa.cod_despesa &#x3d; pre_empenho_despesa.cod_despesa&#xd;&#xa;			                                    JOIN orcamento.conta_despesa&#xd;&#xa;			                                      ON conta_despesa.exercicio &#x3d; despesa.exercicio&#xd;&#xa;			                                     AND conta_despesa.cod_conta &#x3d; despesa.cod_conta&#xd;&#xa;			                                 &#x29; AS despesa&#xd;&#xa;			                              ON despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;			                             AND despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;			                       LEFT JOIN orcamento.recurso&#xd;&#xa;			                              ON recurso.exercicio &#x3d; despesa.exercicio&#xd;&#xa;			                             AND recurso.cod_recurso &#x3d; despesa.cod_recurso&#xd;&#xa;			                       LEFT JOIN empenho.pre_empenho_despesa&#xd;&#xa;			                              ON pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;			                             AND pre_empenho_despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;			                       LEFT JOIN &#x28; SELECT &#x2a;&#xd;&#xa;			                                       , COALESCE&#x28;&#x28;rp.valor_processado_exercicios_anteriores &#x2b; rp.valor_processado_exercicio_anterior&#x29;,0.00&#x29; AS valor_processado_nao_pago&#xd;&#xa;			                                    FROM tcemg.fn_restos_pagar &#x28;&#xd;&#xa;			                                                                    stExercicio,  &#xd;&#xa;			                                                                    stEntidade,   &#xd;&#xa;			                                                                    02&#xd;&#xa;			                                                               &#x29; as rp &#x28;&#xd;&#xa;			                                                                    cod_empenho INTEGER, cod_entidade INTEGER, exercicio CHARACTER&#x28;4&#x29;, valor_processado_exercicios_anteriores NUMERIC,&#xd;&#xa;			                                                                    valor_processado_exercicio_anterior NUMERIC, valor_processado_cancelado NUMERIC, valor_processado_pago NUMERIC,&#xd;&#xa;			                                                                    valor_nao_processado_exercicios_anteriores NUMERIC, valor_nao_processado_exercicio_anterior NUMERIC,&#xd;&#xa;			                                                                    valor_nao_processado_cancelado NUMERIC, valor_nao_processado_pago NUMERIC&#xd;&#xa;			                                                               &#x29;&#xd;&#xa;			                                 &#x29; AS restos_pagar&#xd;&#xa;			                              ON restos_pagar.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;			                             AND restos_pagar.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;			                             AND restos_pagar.exercicio &#x3d; empenho.exercicio&#xd;&#xa;			                       LEFT JOIN &#x28; SELECT retorno.entidade AS cod_entidade&#xd;&#xa;			                                       , retorno.empenho AS cod_empenho&#xd;&#xa;			                                       , retorno.exercicio&#xd;&#xa;			                                       , sum&#x28;retorno.valor&#x29; AS vl_pago_exercicio_atual&#xd;&#xa;			                                    FROM empenho.fn_empenho_restos_pagar_pagamento_estorno_credor&#xd;&#xa;			                                       &#x28; &#x27;&#x27;&#xd;&#xa;			                                       , &#x27;&#x27;&#xd;&#xa;			                                       , &#x27;01&#x2f;01&#x2f;&#x27; &#x7c;&#x7c; stExercicio &#xd;&#xa;			                                       , &#x27;31&#x2f;12&#x2f;&#x27; &#x7c;&#x7c; stExercicio &#xd;&#xa;			                                       , stEntidade              &#xd;&#xa;			                                       , &#x27;&#x27;&#xd;&#xa;			                                       , &#x27;&#x27;&#xd;&#xa;			                                       , &#x27;&#x27;&#xd;&#xa;			                                       , &#x27;&#x27;&#xd;&#xa;			                                       , &#x27;&#x27;&#xd;&#xa;			                                       , &#x27;&#x27;&#xd;&#xa;			                                       , &#x27;&#x27;&#xd;&#xa;			                                       , &#x27;1&#x27;&#xd;&#xa;			                                       , &#x27;&#x27;&#xd;&#xa;			                                       , &#x27;&#x27;&#xd;&#xa;			                                       , &#x27;&#x27;&#xd;&#xa;			                                       , &#x27;&#x27;&#xd;&#xa;			                                       &#x29; AS retorno&#x28;&#xd;&#xa;			                                            entidade            integer,&#xd;&#xa;			                                            empenho             integer,&#xd;&#xa;			                                            exercicio           char&#x28;4&#x29;,&#xd;&#xa;			                                            credor              varchar,&#xd;&#xa;			                                            cod_estrutural      varchar,&#xd;&#xa;			                                            cod_nota            integer,&#xd;&#xa;			                                            data                text,&#xd;&#xa;			                                            conta               integer,&#xd;&#xa;			                                            banco               varchar,&#xd;&#xa;			                                            valor               numeric&#xd;&#xa;			                                            &#x29;&#xd;&#xa;			                                GROUP BY retorno.entidade&#xd;&#xa;			                                       , retorno.empenho&#xd;&#xa;			                                       , retorno.exercicio&#xd;&#xa;			                                 &#x29; AS pagamento_restos&#xd;&#xa;			                              ON pagamento_restos.cod_empenho &#x3d; empenho.cod_empenho&#xd;&#xa;			                             AND pagamento_restos.cod_entidade &#x3d; empenho.cod_entidade&#xd;&#xa;			                             AND pagamento_restos.exercicio &#x3d; empenho.exercicio&#xd;&#xa;			                           WHERE empenho.cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;  		 &#xd;&#xa;			                             AND &#x28;    &#x28;pre_empenho.implantado &#x3d; true AND pre_empenho.exercicio &#x3d; stExercicio_ant &#x29;                                 &#xd;&#xa;			                                OR    &#x28;pagamento_restos.vl_pago_exercicio_atual &#x3e; 0.00 AND pre_empenho.exercicio &#x3c;&#x3d; stExercicio_ant&#x29;               &#xd;&#xa;			                                OR    &#x28;restos_pagar.valor_processado_nao_pago &#x3e; 0.00 AND pre_empenho.exercicio &#x3c;&#x3d; stExercicio_ant&#x29;                 &#xd;&#xa;			                                OR    &#x28;restos_pagar.valor_nao_processado_exercicio_anterior &#x3e; 0.00 AND pre_empenho.exercicio &#x3c;&#x3d; stExercicio_ant&#x29;   &#xd;&#xa;			                                &#x29;&#xd;&#xa;			                            AND &#x28;    &#x28;valor_processado_cancelado  &#x3e; 0.00&#x29;&#xd;&#xa;			                                OR    &#x28;valor_nao_processado_cancelado  &#x3e; 0.00&#x29;&#xd;&#xa;			                                &#x29;&#xd;&#xa;			                           &#x29; AS tabela&#xd;&#xa;			                  GROUP BY tipo_registro&#xd;&#xa;			                         , cod_reduzido&#xd;&#xa;			                         , cod_fonte_recurso&#xd;&#xa;			                         , cod_empenho&#xd;&#xa;			                         , exercicio&#xd;&#xa;			                         , dt_movimentacao&#xd;&#xa;			&#x29;,&#xd;&#xa;			  rsp_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_reduzido,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_reduzido&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_orig&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_empenho&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_empenho&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_empenho&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dot_orig&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 21, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_original&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_saldo_ant_proc&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_saldo_ant_nao&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from rsp10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_reduzido,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_reduzido&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_fonte_recurso&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_fonte&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_saldo_ant_proc&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_saldo_ant_nao&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from rsp11&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_reduzido,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_reduzido&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_documento&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from rsp12&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_reduzido,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_reduzido&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_orig&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_empenho&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_empenho&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_empenho&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_restos_pagar&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_movimento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_movimentacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dot_orig&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 21, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_movimentacao&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao_encamp_atrib&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_unidade_sub_encamp_atrib&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;justificativa&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,500&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;ato_cancelamento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_ato_cancelamento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;					&#xd;&#xa;					as d&#xd;&#xa;				from rsp20&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_reduzido,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_reduzido&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_fonte_recurso&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_movimentacao_fonte&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from rsp21  &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;RSP.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from rsp_format order by cod_reduzido, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;METAREAL.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with metareal as&#xd;&#xa;			&#x28;&#xd;&#xa;							 SELECT 10 AS tipo_registro&#xd;&#xa;					                         , &#x28; SELECT valor&#xd;&#xa;					                              FROM administracao.configuracao_entidade&#xd;&#xa;					                             WHERE exercicio    &#x3d; meta_realizada.exercicio_recurso&#xd;&#xa;					                               AND parametro    &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;					                               AND cod_entidade &#x3d; 2&#xd;&#xa;					                           &#x29; AS codOrgao&#xd;&#xa;					                         , LPAD&#x28;&#x28;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;acao_unidade_executora.num_orgao,2, &#x27;0&#x27;&#x29;&#x7c;&#x7c;LPAD&#x28;&#x27;&#x27;&#x7c;&#x7c;acao_unidade_executora.num_unidade,2, &#x27;0&#x27;&#x29;&#x29;, 5, &#x27;0&#x27;&#x29; AS codunidadesub&#xd;&#xa;					                         , LPAD&#x28;&#x28;acao.num_acao&#x3a;&#x3a;varchar&#x29;, 4, &#x27;0&#x27;&#x29; AS cod_acao&#xd;&#xa;					                         , NULL&#x3a;&#x3a;INTEGER AS cod_sub_acao&#xd;&#xa;					                         , LPAD&#x28;acao_dados.cod_funcao&#x3a;&#x3a;VARCHAR, 2, &#x27;0&#x27;&#x29; AS cod_funcao&#xd;&#xa;					                         , acao_dados.cod_subfuncao&#xd;&#xa;					                         , LPAD&#x28;programa.num_programa&#x3a;&#x3a;VARCHAR, 4, &#x27;0&#x27;&#x29; AS cod_programa&#xd;&#xa;					                         , meta_realizada.valor&#xd;&#xa;					                         , meta_realizada.justificativa&#xd;&#xa;					                      FROM ppa.acao_meta_fisica_realizada AS meta_realizada&#xd;&#xa;					                INNER JOIN ppa.acao_recurso&#xd;&#xa;					                        ON acao_recurso.cod_acao &#x3d; meta_realizada.cod_acao&#xd;&#xa;					                       AND acao_recurso.timestamp_acao_dados &#x3d; meta_realizada.timestamp_acao_dados&#xd;&#xa;					                       AND acao_recurso.cod_recurso &#x3d; meta_realizada.cod_recurso&#xd;&#xa;					                       AND acao_recurso.exercicio_recurso &#x3d; meta_realizada.exercicio_recurso&#xd;&#xa;					                       AND acao_recurso.ano &#x3d; meta_realizada.ano&#xd;&#xa;					                INNER JOIN ppa.acao_dados&#xd;&#xa;					                        ON acao_recurso.cod_acao &#x3d; acao_dados.cod_acao&#xd;&#xa;					                       AND acao_recurso.timestamp_acao_dados &#x3d; acao_dados.timestamp_acao_dados&#xd;&#xa;					                INNER JOIN ppa.acao_unidade_executora&#xd;&#xa;					                        ON acao_unidade_executora.cod_acao &#x3d; acao_dados.cod_acao&#xd;&#xa;					                       AND acao_unidade_executora.timestamp_acao_dados &#x3d; acao_dados.timestamp_acao_dados&#xd;&#xa;					                INNER JOIN ppa.acao&#xd;&#xa;					                        ON acao.cod_acao &#x3d; acao_dados.cod_acao&#xd;&#xa;					                INNER JOIN ppa.programa&#xd;&#xa;					                        ON programa.cod_programa &#x3d; acao.cod_programa&#xd;&#xa;					                     WHERE meta_realizada.exercicio_recurso &#x3d; stExercicio        &#xd;&#xa;						        ORDER BY meta_realizada.cod_acao&#xd;&#xa;			&#x29;, &#xd;&#xa;			  metareal_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;					codorgao, &#xd;&#xa;					tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,2,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codunidadesub&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,5,&#x27;0&#x27;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_funcao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,2,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_subfuncao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,3,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_programa&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,4,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_acao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,4,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_sub_acao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;,4,&#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;valor&#x3a;&#x3a;varchar,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;justificativa&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,1000&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from metareal  &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;METAREAL.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from metareal_format order by codorgao,tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;	&#xd;&#xa;	end if&#x3b;	&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;PAREC.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;		&#xd;&#xa;			with parec as&#xd;&#xa;			&#x28;&#xd;&#xa;				select 99 as registro&#xd;&#xa;			&#x29;,&#xd;&#xa;			  parec_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;					registro &#xd;&#xa;					as d&#xd;&#xa;				from parec  &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;PAREC.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;			    select   d   as d from parec_format&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;		&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;OBELAC.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then				&#xd;&#xa;		&#xd;&#xa;			with obelac as&#xd;&#xa;			&#x28;&#xd;&#xa;				select 99 as registro&#xd;&#xa;			&#x29;,&#xd;&#xa;			  obelac_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;					registro &#xd;&#xa;					as d&#xd;&#xa;				from obelac  &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;OBELAC.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;			    select   d   as d from obelac_format&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;DDC.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then				&#xd;&#xa;		&#xd;&#xa;			with ddc as&#xd;&#xa;			&#x28;&#xd;&#xa;				select 99 as registro&#xd;&#xa;			&#x29;,&#xd;&#xa;			  ddc_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;					registro &#xd;&#xa;					as d&#xd;&#xa;				from ddc  &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;DDC.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;			    select   d   as d from ddc_format&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;    if strpos&#x28;stArquivos,&#x27;&#x22;AOB.csv&#x22;&#x27;&#x29; &#x3e; 0 &#xd;&#xa;		then 	&#xd;&#xa;		&#xd;&#xa;			with aob as&#xd;&#xa;			&#x28;&#xd;&#xa;				select 99 as registro&#xd;&#xa;			&#x29;,&#xd;&#xa;			  aob_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;					registro &#xd;&#xa;					as d&#xd;&#xa;				from aob  &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;AOB.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;			    select   d   as d from aob_format&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;    if strpos&#x28;stArquivos,&#x27;&#x22;CONSID.csv&#x22;&#x27;&#x29; &#x3e; 0 &#xd;&#xa;		then 	&#xd;&#xa;		&#xd;&#xa;			with consid as&#xd;&#xa;			&#x28;&#xd;&#xa;				select 99 as registro&#xd;&#xa;			&#x29;,&#xd;&#xa;			  consid_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;					registro &#xd;&#xa;					as d&#xd;&#xa;				from consid  &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;CONSID.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;			    select   d   as d from consid_format&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;    if strpos&#x28;stArquivos,&#x27;&#x22;CONSOR.csv&#x22;&#x27;&#x29; &#x3e; 0 &#xd;&#xa;		then 	&#xd;&#xa;		&#xd;&#xa;			with consor as&#xd;&#xa;			&#x28;&#xd;&#xa;				select 99 as registro&#xd;&#xa;			&#x29;,&#xd;&#xa;			  consor_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;					registro &#xd;&#xa;					as d&#xd;&#xa;				from consor  &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;CONSOR.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;			    select   d   as d from consor_format&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;	&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;SUPDEF.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with supdef10 as&#xd;&#xa;			&#x28;&#xd;&#xa;						SELECT 10 AS tipo_registro&#xd;&#xa;	                            , CASE WHEN valor_ativo &#x3e; valor_passivo&#xd;&#xa;	                                            THEN &#x27;S&#x27;&#xd;&#xa;	                                            WHEN valor_passivo &#x3e; valor_ativo&#xd;&#xa;	                                            THEN &#x27;D&#x27;&#xd;&#xa;	                                        END AS superavit_deficit&#xd;&#xa;	                            , CASE WHEN valor_ativo &#x3e; valor_passivo&#xd;&#xa;	                                   THEN valor_ativo - valor_passivo&#xd;&#xa;	                                   WHEN valor_passivo &#x3e; valor_ativo&#xd;&#xa;	                                   THEN valor_passivo - valor_ativo&#xd;&#xa;	                                   ELSE 0.00&#xd;&#xa;	                               END AS vl_apurado&#xd;&#xa;	                         FROM &#x28;&#xd;&#xa;	                                SELECT SUM&#x28;valor_ativo&#x29; AS valor_ativo&#xd;&#xa;						                 , SUM&#x28;valor_passivo&#x29; AS valor_passivo&#xd;&#xa;	                                  FROM &#x28;&#xd;&#xa;	                                        SELECT recurso.cod_recurso&#xd;&#xa;	                                             , recurso.nom_recurso&#xd;&#xa;	                                             , COALESCE&#x28;valor_ativo,0.00&#x29; AS valor_ativo&#xd;&#xa;	                                             , COALESCE&#x28;valor_passivo,0.00&#x29; AS valor_passivo&#xd;&#xa;	                                          FROM orcamento.recurso&#x28;&#x27;2014&#x27;&#x29;&#xd;&#xa;	                                     LEFT JOIN &#x28;&#xd;&#xa;	                                                SELECT cod_recurso&#xd;&#xa;	                                                     , COALESCE&#x28;SUM&#x28;valor&#x29;,0.00&#x29; AS valor_ativo&#xd;&#xa;	                                                  FROM &#x28;&#xd;&#xa;	                                                        SELECT cod_recurso&#xd;&#xa;	                                                             , COALESCE&#x28;vl_saldo_atual,0.00&#x29; AS valor&#xd;&#xa;	                                                          FROM contabilidade.fn_rl_apuracao_superavit_defict_conta_banco&#xd;&#xa;	                                                             &#x28; stExercicio &#xd;&#xa;	                                                             , &#x27; cod_entidade IN &#x28;&#x27; &#x7c;&#x7c; stEntidade &#x7c;&#x7c; &#x27;&#x29; AND cod_estrutural NOT ILIKE &#x28;&#x27;&#x27;1.1.3.8&#x25;&#x27;&#x27;&#x29;  AND indicador_superavit &#x3d; &#x27;&#x27;financeiro&#x27;&#x27; &#x27;   &#xd;&#xa;	                                                             , stDtinicio    &#xd;&#xa;	                                                             , stDtfim       &#xd;&#xa;	                                                             , &#x27;A&#x27;&#x3a;&#x3a;CHAR&#xd;&#xa;	                                                             &#x29;&#xd;&#xa;	                                                            AS retorno&#xd;&#xa;	                                                             &#x28; cod_recurso         integer&#xd;&#xa;	                                                             , indicador_superavit char&#x28;12&#x29;&#xd;&#xa;	                                                             , vl_saldo_anterior   numeric&#xd;&#xa;	                                                             , vl_saldo_debitos    numeric&#xd;&#xa;	                                                             , vl_saldo_creditos   numeric&#xd;&#xa;	                                                             , vl_saldo_atual      numeric&#xd;&#xa;	                                                             &#x29;&#xd;&#xa;	                                                         WHERE indicador_superavit &#x3d; &#x27;financeiro&#x27;&#xd;&#xa;	                                                         UNION&#xd;&#xa;	                                                        SELECT cod_recurso&#xd;&#xa;	                                                             , COALESCE&#x28;SUM&#x28;vl_saldo_atual&#x29;,0.00&#x29; AS valor&#xd;&#xa;	                                                          FROM contabilidade.fn_rl_apuracao_superavit_defict_recurso&#xd;&#xa;	                                                             &#x28; stExercicio   &#xd;&#xa;	                                                             , &#x27; cod_entidade IN &#x28;&#x27; &#x7c;&#x7c; stEntidade &#x7c;&#x7c; &#x27;&#x29; AND cod_estrutural ILIKE &#x28;&#x27;&#x27;1.1.3.8&#x25;&#x27;&#x27;&#x29;  AND indicador_superavit &#x3d; &#x27;&#x27;financeiro&#x27;&#x27; &#x27;     &#xd;&#xa;	                                                             , stDtinicio    &#xd;&#xa;	                                                             , stDtfim       &#xd;&#xa;	                                                             , &#x27;A&#x27;&#x3a;&#x3a;CHAR&#xd;&#xa;	                                                             &#x29;&#xd;&#xa;	                                                            AS retorno&#xd;&#xa;	                                                             &#x28; cod_recurso         integer&#xd;&#xa;	                                                             , indicador_superavit char&#x28;12&#x29;&#xd;&#xa;	                                                             , vl_saldo_anterior   numeric&#xd;&#xa;	                                                             , vl_saldo_debitos    numeric&#xd;&#xa;	                                                             , vl_saldo_creditos   numeric&#xd;&#xa;	                                                             , vl_saldo_atual      numeric&#xd;&#xa;	                                                             &#x29;&#xd;&#xa;	                                                         WHERE indicador_superavit &#x3d; &#x27;financeiro&#x27;&#xd;&#xa;	                                                  GROUP BY cod_recurso&#xd;&#xa;	                                                  ORDER BY cod_recurso&#xd;&#xa;	                                                       &#x29; AS execucao&#xd;&#xa;	                                              GROUP BY execucao.cod_recurso&#xd;&#xa;	                                              ORDER BY execucao.cod_recurso&#xd;&#xa;	                                               &#x29; AS ativo&#xd;&#xa;	                                            ON ativo.cod_recurso &#x3d; recurso.cod_recurso&#xd;&#xa;	                                     LEFT JOIN &#x28;&#xd;&#xa;	                                                SELECT cod_recurso&#xd;&#xa;	                                                     , COALESCE&#x28;SUM&#x28;valor&#x29;,0.00&#x29; AS valor_passivo&#xd;&#xa;	                                                  FROM &#x28;&#xd;&#xa;	                                                        SELECT cod_recurso&#xd;&#xa;	                                                             , COALESCE&#x28;SUM&#x28;valor&#x29;,0.00&#x29; AS valor&#xd;&#xa;	                                                          FROM contabilidade.apuracao_empenho_superavit_deficit&#xd;&#xa;	                                                             &#x28; stExercicio       &#xd;&#xa;	                                                             , stDtinicio        &#xd;&#xa;	                                                             , stDtfim           &#xd;&#xa;	                                                             , stEntidade        &#xd;&#xa;	                                                             &#x29;&#xd;&#xa;	                                                             as retorno&#xd;&#xa;	                                                             &#x28; exercicio    CHAR&#x28;4&#x29;&#xd;&#xa;	                                                             , cod_empenho     TEXT&#xd;&#xa;	                                                             , cod_entidade INTEGER&#xd;&#xa;	                                                             , cod_recurso  INTEGER&#xd;&#xa;	                                                             , valor        NUMERIC&#xd;&#xa;	                                                             &#x29;&#xd;&#xa;	                                                      GROUP BY cod_recurso&#xd;&#xa;	                                                         UNION&#xd;&#xa;	                                                        SELECT cod_recurso&#xd;&#xa;	                                                             , ABS&#x28;COALESCE&#x28;SUM&#x28;vl_saldo_atual&#x29;,0.00&#x29;&#x29; AS valor&#xd;&#xa;	                                                          FROM contabilidade.fn_rl_apuracao_superavit_defict_recurso&#xd;&#xa;	                                                               &#x28; stExercicio    &#xd;&#xa;	                                                               , &#x27; cod_entidade IN &#x28;&#x27; &#x7c;&#x7c; stEntidade &#x7c;&#x7c; &#x27;&#x29; AND cod_estrutural ILIKE &#x27;&#x27;2.1.8&#x25;&#x27;&#x27; AND indicador_superavit &#x3d; &#x27;&#x27;financeiro&#x27;&#x27; &#x27;    &#xd;&#xa;	                                                               , stDtinicio    &#xd;&#xa;	                                                               , stDtfim       &#xd;&#xa;	                                                               , &#x27;A&#x27;&#x3a;&#x3a;CHAR&#xd;&#xa;	                                                               &#x29;&#xd;&#xa;	                                                               AS retorno&#xd;&#xa;	                                                               &#x28; cod_recurso      integer&#xd;&#xa;	                                                               , indicador_superavit char&#x28;12&#x29;&#xd;&#xa;	                                                               , vl_saldo_anterior   numeric&#xd;&#xa;	                                                               , vl_saldo_debitos    numeric&#xd;&#xa;	                                                               , vl_saldo_creditos   numeric&#xd;&#xa;	                                                               , vl_saldo_atual      numeric&#xd;&#xa;	                                                               &#x29;&#xd;&#xa;	                                                         WHERE indicador_superavit &#x3d; &#x27;financeiro&#x27;&#xd;&#xa;	                                                      GROUP BY cod_recurso&#xd;&#xa;	                                                       &#x29; AS execucao&#xd;&#xa;	                                                GROUP BY execucao.cod_recurso&#xd;&#xa;	                                                ORDER BY execucao.cod_recurso&#xd;&#xa;	                                               &#x29; AS passivo&#xd;&#xa;	                                            ON passivo.cod_recurso &#x3d; recurso.cod_recurso&#xd;&#xa;	                                      ORDER BY recurso.cod_recurso ASC&#xd;&#xa;	                                       &#x29; AS execucao&#xd;&#xa;	                                 WHERE NOT &#x28;valor_ativo &#x3d; 0.00 AND valor_passivo &#x3d; 0.00&#x29;&#xd;&#xa;	                              &#x29; AS registro10&#xd;&#xa;			&#x29;,&#xd;&#xa;			supdef11 as&#xd;&#xa;			&#x28;&#xd;&#xa;					SELECT 11 AS tipo_registro&#xd;&#xa;	                        , LPAD&#x28;SUBSTR&#x28;cod_recurso&#x3a;&#x3a;varchar,2,3&#x29;,3,&#x27;2&#x27;&#x29; AS cod_recurso&#xd;&#xa;	                        , CASE WHEN valor_ativo &#x3e; valor_passivo&#xd;&#xa;	                               THEN &#x27;S&#x27;&#xd;&#xa;	                               WHEN valor_passivo &#x3e; valor_ativo&#xd;&#xa;	                               THEN &#x27;D&#x27;&#xd;&#xa;	                           END AS superavit_deficit&#xd;&#xa;	                        , CASE WHEN valor_ativo &#x3e; valor_passivo&#xd;&#xa;	                               THEN valor_ativo - valor_passivo&#xd;&#xa;	                               WHEN valor_passivo &#x3e; valor_ativo&#xd;&#xa;	                               THEN valor_passivo - valor_ativo&#xd;&#xa;	                               ELSE 0.00&#xd;&#xa;	                           END AS vl_apurado&#xd;&#xa;	                     FROM &#x28;&#xd;&#xa;	                           SELECT recurso.cod_recurso&#xd;&#xa;	                                , COALESCE&#x28;SUM&#x28;valor_ativo&#x29;,0.00&#x29; AS valor_ativo&#xd;&#xa;	                                , COALESCE&#x28;SUM&#x28;valor_passivo&#x29;,0.00&#x29; AS valor_passivo&#xd;&#xa;	                             FROM orcamento.recurso&#x28;stExercicio&#x29;   &#xd;&#xa;	                        LEFT JOIN &#x28;&#xd;&#xa;	                                   SELECT cod_recurso&#xd;&#xa;	                                        , COALESCE&#x28;SUM&#x28;valor&#x29;,0.00&#x29; AS valor_ativo&#xd;&#xa;	                                     FROM &#x28;&#xd;&#xa;	                                           SELECT cod_recurso&#xd;&#xa;	                                                , COALESCE&#x28;vl_saldo_atual,0.00&#x29; AS valor&#xd;&#xa;	                                             FROM contabilidade.fn_rl_apuracao_superavit_defict_conta_banco&#xd;&#xa;	                                                &#x28; stExercicio        &#xd;&#xa;	                                                , &#x27; cod_entidade IN &#x28;&#x27; &#x7c;&#x7c; stEntidade &#x7c;&#x7c; &#x27;&#x29; AND cod_estrutural NOT ILIKE &#x28;&#x27;&#x27;1.1.3.8&#x25;&#x27;&#x27;&#x29;  AND indicador_superavit &#x3d; &#x27;&#x27;financeiro&#x27;&#x27; &#x27;  &#xd;&#xa;	                                                , stDtinicio       &#xd;&#xa;	                                                , stDtfim          &#xd;&#xa;	                                                , &#x27;A&#x27;&#x3a;&#x3a;CHAR&#xd;&#xa;	                                                &#x29;&#xd;&#xa;	                                               AS retorno&#xd;&#xa;	                                                &#x28; cod_recurso         integer&#xd;&#xa;	                                                , indicador_superavit char&#x28;12&#x29;&#xd;&#xa;	                                                , vl_saldo_anterior   numeric&#xd;&#xa;	                                                , vl_saldo_debitos    numeric&#xd;&#xa;	                                                , vl_saldo_creditos   numeric&#xd;&#xa;	                                                , vl_saldo_atual      numeric&#xd;&#xa;	                                                &#x29;&#xd;&#xa;	                                            WHERE indicador_superavit &#x3d; &#x27;financeiro&#x27;&#xd;&#xa;	                                            UNION&#xd;&#xa;	                                           SELECT cod_recurso&#xd;&#xa;	                                                , COALESCE&#x28;SUM&#x28;vl_saldo_atual&#x29;,0.00&#x29; AS valor&#xd;&#xa;	                                             FROM contabilidade.fn_rl_apuracao_superavit_defict_recurso&#xd;&#xa;	                                                &#x28; stExercicio          &#xd;&#xa;	                                                , &#x27; cod_entidade IN &#x28;&#x27; &#x7c;&#x7c; stEntidade &#x7c;&#x7c; &#x27;&#x29; AND cod_estrutural ILIKE &#x28;&#x27;&#x27;1.1.3.8&#x25;&#x27;&#x27;&#x29;  AND indicador_superavit &#x3d; &#x27;&#x27;financeiro&#x27;&#x27; &#x27;   &#xd;&#xa;	                                                , stDtfim             &#xd;&#xa;	                                                , stDtfim             &#xd;&#xa;	                                                , &#x27;A&#x27;&#x3a;&#x3a;CHAR&#xd;&#xa;	                                                &#x29;&#xd;&#xa;	                                               AS retorno&#xd;&#xa;	                                                &#x28; cod_recurso         integer&#xd;&#xa;	                                                , indicador_superavit char&#x28;12&#x29;&#xd;&#xa;	                                                , vl_saldo_anterior   numeric&#xd;&#xa;	                                                , vl_saldo_debitos    numeric&#xd;&#xa;	                                                , vl_saldo_creditos   numeric&#xd;&#xa;	                                                , vl_saldo_atual      numeric&#xd;&#xa;	                                                &#x29;&#xd;&#xa;	                                            WHERE indicador_superavit &#x3d; &#x27;financeiro&#x27;&#xd;&#xa;	                                     GROUP BY cod_recurso&#xd;&#xa;	                                     ORDER BY cod_recurso&#xd;&#xa;	                                          &#x29; AS execucao&#xd;&#xa;	                                 GROUP BY execucao.cod_recurso&#xd;&#xa;	                                 ORDER BY execucao.cod_recurso&#xd;&#xa;	                                  &#x29; AS ativo&#xd;&#xa;	                               ON ativo.cod_recurso &#x3d; recurso.cod_recurso&#xd;&#xa;	                        LEFT JOIN &#x28;&#xd;&#xa;	                                   SELECT cod_recurso&#xd;&#xa;	                                        , COALESCE&#x28;SUM&#x28;valor&#x29;,0.00&#x29; AS valor_passivo&#xd;&#xa;	                                     FROM &#x28;&#xd;&#xa;	                                           SELECT cod_recurso&#xd;&#xa;	                                                , COALESCE&#x28;SUM&#x28;valor&#x29;,0.00&#x29; AS valor&#xd;&#xa;	                                             FROM contabilidade.apuracao_empenho_superavit_deficit&#xd;&#xa;	                                                &#x28; stExercicio    &#xd;&#xa;	                                                , stDtinicio     &#xd;&#xa;	                                                , stDtfim        &#xd;&#xa;	                                                , stEntidade     &#xd;&#xa;	                                                &#x29;&#xd;&#xa;	                                                as retorno&#xd;&#xa;	                                                &#x28; exercicio    CHAR&#x28;4&#x29;&#xd;&#xa;	                                                , cod_empenho     TEXT&#xd;&#xa;	                                                , cod_entidade INTEGER&#xd;&#xa;	                                                , cod_recurso  INTEGER&#xd;&#xa;	                                                , valor        NUMERIC&#xd;&#xa;	                                                &#x29;&#xd;&#xa;	                                         GROUP BY cod_recurso&#xd;&#xa;	                                            UNION&#xd;&#xa;	                                           SELECT cod_recurso&#xd;&#xa;	                                                , ABS&#x28;COALESCE&#x28;SUM&#x28;vl_saldo_atual&#x29;,0.00&#x29;&#x29; AS valor&#xd;&#xa;	                                             FROM contabilidade.fn_rl_apuracao_superavit_defict_recurso&#xd;&#xa;	                                                  &#x28; stExercicio         &#xd;&#xa;	                                                  , &#x27; cod_entidade IN &#x28;&#x27; &#x7c;&#x7c; stEntidade &#x7c;&#x7c; &#x27;&#x29; AND cod_estrutural ILIKE &#x27;&#x27;2.1.8&#x25;&#x27;&#x27; AND indicador_superavit &#x3d; &#x27;&#x27;financeiro&#x27;&#x27; &#x27;   &#xd;&#xa;	                                                  , stDtinicio          &#xd;&#xa;	                                                  , stDtfim             &#xd;&#xa;	                                                  , &#x27;A&#x27;&#x3a;&#x3a;CHAR&#xd;&#xa;	                                                  &#x29;&#xd;&#xa;	                                                  AS retorno&#xd;&#xa;	                                                  &#x28; cod_recurso      integer&#xd;&#xa;	                                                  , indicador_superavit char&#x28;12&#x29;&#xd;&#xa;	                                                  , vl_saldo_anterior   numeric&#xd;&#xa;	                                                  , vl_saldo_debitos    numeric&#xd;&#xa;	                                                  , vl_saldo_creditos   numeric&#xd;&#xa;	                                                  , vl_saldo_atual      numeric&#xd;&#xa;	                                                  &#x29;&#xd;&#xa;	                                            WHERE indicador_superavit &#x3d; &#x27;financeiro&#x27;&#xd;&#xa;	                                         GROUP BY cod_recurso&#xd;&#xa;	                                          &#x29; AS execucao&#xd;&#xa;	                                   GROUP BY execucao.cod_recurso&#xd;&#xa;	                                   ORDER BY execucao.cod_recurso&#xd;&#xa;	                                  &#x29; AS passivo&#xd;&#xa;	                               ON passivo.cod_recurso &#x3d; recurso.cod_recurso&#xd;&#xa;	                               GROUP BY recurso.cod_recurso&#xd;&#xa;	                         ORDER BY recurso.cod_recurso ASC&#xd;&#xa;	                          &#x29; AS execucao&#xd;&#xa;	                    WHERE NOT &#x28;valor_ativo &#x3d; 0.00 AND valor_passivo &#x3d; 0.00&#x29;&#xd;&#xa;			&#x29;,&#xd;&#xa;			  supdef_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							&#x27; &#x27; as cod_recurso,&#xd;&#xa;							superavit_deficit,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar   &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;superavit_deficit&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 1, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_apurado&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from supdef10&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							cod_recurso,&#xd;&#xa;							superavit_deficit,&#xd;&#xa;					        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_recurso&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;					        &#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;superavit_deficit&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 1, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_apurado&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;					as d&#xd;&#xa;				from supdef11&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;SUPDEF.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from supdef_format order by cod_recurso, superavit_deficit, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;CTB.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			    --&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;  tabelas intermedi&#xe1;rias  &#x28;no final elas s&#xe3;o exclu&#xed;das&#x29; &#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#xd;&#xa;			    CREATE TABLE prestacao_contas.tabctb_10 &#x28;&#xd;&#xa;				tipo_registro 						unknown 	NULL,&#xd;&#xa;				ano 								bpchar&#x28;4&#x29; 	NULL,&#xd;&#xa;				mes 								int4 		NULL,&#xd;&#xa;				cod_ctb 							int4 		NULL,&#xd;&#xa;				cod_ctb_view 						text 		NULL,&#xd;&#xa;				cod_orgao 							int4 		NULL,&#xd;&#xa;				banco 								varchar 	NULL,&#xd;&#xa;				agencia 							text 		NULL,&#xd;&#xa;				digito_verificador_agencia 			text 		NULL,&#xd;&#xa;				digito_verificador_conta_bancaria 	text 		NULL,&#xd;&#xa;				conta_bancaria 						text 		NULL,&#xd;&#xa;				conta_corrente 						text 		NULL,&#xd;&#xa;				tipo_conta 							int4 		NULL,&#xd;&#xa;				tipo_aplicacao 						varchar 	NULL,&#xd;&#xa;				nro_seq_aplicacao 					varchar 	NULL,&#xd;&#xa;				desc_conta_bancaria 				varchar 	NULL,&#xd;&#xa;				conta_convenio 						int4 		NULL,&#xd;&#xa;				num_convenio 						numeric&#x28;30&#x29; NULL,&#xd;&#xa;				dt_assinatura 						date 		NULL&#xd;&#xa;			&#x29;&#xd;&#xa;			WITH &#x28;&#xd;&#xa;				OIDS&#x3d;FALSE&#xd;&#xa;			&#x29; &#x3b;&#xd;&#xa;			&#xd;&#xa;			&#xd;&#xa;			&#xd;&#xa;			CREATE TABLE prestacao_contas.tabctb_20 &#x28;&#xd;&#xa;				tipo_registro 			varchar NULL,&#xd;&#xa;				cod_ctb 				int4 	NULL,&#xd;&#xa;				cod_ctb_view 			text 	NULL,&#xd;&#xa;				tipo_aplicacao 			varchar NULL,&#xd;&#xa;				tipo_conta 				int4 	NULL,&#xd;&#xa;				cod_orgao 				int4 	NULL,&#xd;&#xa;				cod_fonte_recursos 		int4 	NULL,&#xd;&#xa;				vl_saldo_inicial_fonte 	numeric NULL,&#xd;&#xa;				vl_saldo_final_fonte 	numeric NULL&#xd;&#xa;			&#x29;&#xd;&#xa;			WITH &#x28;&#xd;&#xa;				OIDS&#x3d;FALSE&#xd;&#xa;			&#x29; &#x3b;&#xd;&#xa;			&#xd;&#xa;			&#xd;&#xa;			CREATE TABLE prestacao_contas.tabctb_21 &#x28;&#xd;&#xa;				tipo_registro 			int4 		NULL,&#xd;&#xa;				cod_reduzido_mov 		text 		NULL,&#xd;&#xa;				cod_orgao 				int4 		NULL,&#xd;&#xa;				cod_ctb 				int4 		NULL,&#xd;&#xa;				cod_ctb_view 			text 		NULL,&#xd;&#xa;				cod_fonte_recursos 		int4 		NULL,&#xd;&#xa;				exercicio 				bpchar&#x28;4&#x29; 	NULL,&#xd;&#xa;				tipo_movimentacao 		varchar 	NULL,&#xd;&#xa;				tipo_entr_saida 		text 		NULL,&#xd;&#xa;				cod_ctb_transf 			varchar 	NULL,&#xd;&#xa;				cod_ctb_transf_view 	text 		NULL,&#xd;&#xa;				cod_fonte_ctb_transf 	varchar 	NULL,&#xd;&#xa;				tipo_conta 				varchar 	NULL,&#xd;&#xa;				valor_entr_saida 		numeric 	NULL&#xd;&#xa;			&#x29;&#xd;&#xa;			WITH &#x28;&#xd;&#xa;				OIDS&#x3d;FALSE&#xd;&#xa;			&#x29; &#x3b;&#xd;&#xa;			&#xd;&#xa;			CREATE TABLE prestacao_contas.tabctb_22 &#x28;&#xd;&#xa;				tipo_registro 			int4 		NULL,&#xd;&#xa;				cod_reduzido_mov 		unknown 	NULL,&#xd;&#xa;				e_deducao_de_receita 	int4 		NULL,&#xd;&#xa;				identificador_deducao 	int4 		NULL,&#xd;&#xa;				natureza_receita 		int4 		NULL,&#xd;&#xa;				cod_ctb 				int4 		NULL,&#xd;&#xa;				cod_ctb_view 			text 		NULL,&#xd;&#xa;				tipo_aplicacao 			varchar 	NULL,&#xd;&#xa;				tipo_conta 				varchar 	NULL,&#xd;&#xa;				tipo 					bpchar&#x28;1&#x29; 	NULL,&#xd;&#xa;				tipo_entr_saida 		text 		NULL,&#xd;&#xa;				tipo_movimentacao 		varchar 	NULL,&#xd;&#xa;				cod_fonte_recursos 		int4 		NULL,&#xd;&#xa;				vlr_receita_cont 		numeric 	NULL&#xd;&#xa;			&#x29;&#xd;&#xa;			WITH &#x28;&#xd;&#xa;				OIDS&#x3d;FALSE&#xd;&#xa;			&#x29; &#x3b;&#xd;&#xa;		    --&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;			&#xd;&#xa;&#xd;&#xa;			&#xd;&#xa;			-- &#x2a;&#x2a;&#x2a;&#x2a;&#x2a;     Extra&#xe7;&#xe3;o das informa&#xe7;&#xf5;es para as tabelas intermedi&#xe1;rias     &#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#xd;&#xa;			FOR reRecPar IN select &#x28;UNNEST&#x28;ARRAY&#x5b;string_to_array&#x28;stEntidade, &#x27;,&#x27;&#x29;&#x5d;&#x29;&#x3a;&#x3a;VARCHAR&#x29; as ParEntidadeLoop&#xd;&#xa;		    LOOP&#xd;&#xa;							--&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;  10 &#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#xd;&#xa;		    				insert into prestacao_contas.tabctb_10&#xd;&#xa;							SELECT &#x27;10&#x27; AS tipo_registro&#xd;&#xa;				                      , arquivo_ctb.ano&#xd;&#xa;				                      , arquivo_ctb.mes&#xd;&#xa;				                      , retorno.cod_ctb&#xd;&#xa;				                      , retorno.tipo_conta&#x7c;&#x7c;regexp_replace&#x28;&#x28;retorno.conta&#x29;, &#x27;&#x5b;-&#x7c;,&#x7c;.&#x7c;x&#x5d;&#x27;, &#x27;&#x27;, &#x27;gi&#x27;&#x29; AS cod_ctb_view&#xd;&#xa;				                      , retorno.cod_orgao&#xd;&#xa;				                      , retorno.banco&#xd;&#xa;				                      , retorno.agencia&#xd;&#xa;				                      , retorno.digito_verificador_agencia&#xd;&#xa;				                      , retorno.digito_verificador_conta_bancaria&#xd;&#xa;				                      , retorno.conta_bancaria&#xd;&#xa;				                      , retorno.conta_corrente&#xd;&#xa;				                      , retorno.tipo_conta&#xd;&#xa;				                      , retorno.tipo_aplicacao&#xd;&#xa;				                      , &#x27;&#x27;&#x3a;&#x3a;VARCHAR nro_seq_aplicacao&#xd;&#xa;				                      , retorno.desc_conta_bancaria&#xd;&#xa;				                      , CASE WHEN &#x28;convenio_plano_banco.num_convenio &#x3c;&#x3e; NULL&#x29; THEN 1&#xd;&#xa;				                             ELSE 2&#xd;&#xa;				                        END AS conta_convenio&#xd;&#xa;				                      , convenio_plano_banco.num_convenio&#xd;&#xa;				                      , convenio_plano_banco.dt_assinatura&#xd;&#xa;				                  FROM tcemg.contasCTB&#x28;stExercicio, reRecPar.ParEntidadeLoop&#x29; as retorno&#xd;&#xa;				                                                        &#x28;  cod_conta                         INTEGER&#xd;&#xa;				                                                        ,  tipo_aplicacao                    VARCHAR&#xd;&#xa;				                                                        ,  cod_ctb                           INTEGER&#xd;&#xa;				                                                        ,  tipo_conta                        INTEGER&#xd;&#xa;				                                                        ,  exercicio                         CHAR&#x28;4&#x29;&#xd;&#xa;				                                                        ,  conta                             TEXT&#xd;&#xa;				                                                        ,  conta_bancaria                    TEXT&#xd;&#xa;				                                                        ,  conta_corrente                    TEXT&#xd;&#xa;				                                                        ,  cod_orgao                         INTEGER&#xd;&#xa;				                                                        ,  banco                             VARCHAR&#xd;&#xa;				                                                        ,  agencia                           TEXT&#xd;&#xa;				                                                        ,  digito_verificador_agencia        TEXT&#xd;&#xa;				                                                        ,  digito_verificador_conta_bancaria TEXT&#xd;&#xa;				                                                        ,  desc_conta_bancaria               VARCHAR&#xd;&#xa;				                                                        &#x29;&#xd;&#xa;			&#xd;&#xa;				            INNER JOIN contabilidade.plano_analitica&#xd;&#xa;				                    ON retorno.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;				                   AND retorno.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;			&#xd;&#xa;				            INNER JOIN contabilidade.plano_banco&#xd;&#xa;				                    ON plano_analitica.cod_plano &#x3d; plano_banco.cod_plano&#xd;&#xa;				                   AND plano_analitica.exercicio &#x3d; plano_banco.exercicio&#xd;&#xa;			&#xd;&#xa;				             LEFT JOIN tcemg.convenio_plano_banco&#xd;&#xa;				                    ON convenio_plano_banco.cod_plano &#x3d; plano_banco.cod_plano&#xd;&#xa;				                   AND convenio_plano_banco.exercicio &#x3d; stExercicio&#xd;&#xa;			&#xd;&#xa;				             LEFT JOIN tcemg.arquivo_ctb&#xd;&#xa;				                    ON arquivo_ctb.cod_ctb_view &#x3d; retorno.tipo_conta&#x7c;&#x7c;regexp_replace&#x28;&#x28;retorno.conta&#x29;, &#x27;&#x5b;-&#x7c;,&#x7c;.&#x7c;x&#x5d;&#x27;, &#x27;&#x27;, &#x27;gi&#x27;&#x29;&#xd;&#xa;			&#xd;&#xa;				              GROUP BY retorno.cod_ctb&#xd;&#xa;				                     , retorno.conta&#xd;&#xa;				                     , retorno.cod_orgao&#xd;&#xa;				                     , retorno.banco&#xd;&#xa;				                     , retorno.agencia&#xd;&#xa;				                     , retorno.digito_verificador_agencia&#xd;&#xa;				                     , retorno.digito_verificador_conta_bancaria&#xd;&#xa;				                     , retorno.conta_bancaria&#xd;&#xa;				                     , retorno.conta_corrente&#xd;&#xa;				                     , retorno.tipo_conta&#xd;&#xa;				                     , retorno.tipo_aplicacao&#xd;&#xa;				                     , retorno.desc_conta_bancaria&#xd;&#xa;				                     , conta_convenio&#xd;&#xa;				                     , num_convenio&#xd;&#xa;				                     , dt_assinatura&#xd;&#xa;				                     , arquivo_ctb.ano&#xd;&#xa;				                     , arquivo_ctb.mes&#xd;&#xa;				              ORDER BY retorno.cod_ctb&#x3b;&#xd;&#xa;				             &#xd;&#xa;				             --&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;  20&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#xd;&#xa;				             insert into prestacao_contas.tabctb_20&#xd;&#xa;			                   SELECT c.tipo_registro&#xd;&#xa;			                        , c.cod_ctb&#xd;&#xa;			                        , c.cod_ctb_view&#xd;&#xa;			                        , tipo_aplicacao&#xd;&#xa;			                        , c.tipo_conta&#xd;&#xa;			                        , c.cod_orgao&#xd;&#xa;			                        , c.cod_recurso as cod_fonte_recursos&#xd;&#xa;			                        , SUM&#x28;c.vl_saldo_inicial_fonte&#x29; as vl_saldo_inicial_fonte&#xd;&#xa;			                        , SUM&#x28;c.vl_saldo_final_fonte&#x29; as vl_saldo_final_fonte&#xd;&#xa;			                     FROM &#x28;SELECT &#x27;20&#x27;&#x3a;&#x3a;VARCHAR AS tipo_registro&#xd;&#xa;			                                , cod_ctb&#xd;&#xa;			                                , tipo_conta&#x7c;&#x7c;regexp_replace&#x28;&#x28;conta&#x29;, &#x27;&#x5b;-&#x7c;,&#x7c;.&#x7c;x&#x5d;&#x27;, &#x27;&#x27;, &#x27;gi&#x27;&#x29; AS cod_ctb_view&#xd;&#xa;			                                , tipo_aplicacao&#xd;&#xa;			                                , tipo_conta&#xd;&#xa;			                                , cod_orgao&#xd;&#xa;			                                , plano_recurso.cod_recurso&#xd;&#xa;			                                , plano_analitica.cod_plano&#xd;&#xa;			                                , plano_analitica.exercicio&#xd;&#xa;			                                , saldo_inicial.saldo_anterior AS vl_saldo_inicial_fonte&#xd;&#xa;			                                , &#x28;&#x28;saldo_inicial.vl_debito - saldo_inicial.vl_credito&#x29; &#x2b; saldo_inicial.saldo_anterior&#x29; AS vl_saldo_final_fonte&#xd;&#xa;			                                , conta&#xd;&#xa;			                             FROM tesouraria.fn_relatorio_demostrativo_saldos&#x28; stExercicio&#xd;&#xa;																		 , reRecPar.ParEntidadeLoop&#x3a;&#x3a;int&#xd;&#xa;																		 , stDtinicio             --&#x27;01&#x2f;02&#x2f;2015&#x27;&#xd;&#xa;																		 , stDtfim                --&#x27;28&#x2f;02&#x2f;2015&#x27;&#xd;&#xa;																		 , &#x27;&#x27;&#xd;&#xa;																		 , &#x27;&#x27;&#xd;&#xa;																		 , &#x27;&#x27;&#xd;&#xa;																		 , &#x27;&#x27;&#xd;&#xa;																		 , &#x27;&#x27;&#xd;&#xa;																		 , &#x27;S&#x27;&#xd;&#xa;																		 , &#x27;&#x27;&#xd;&#xa;																		 , &#x27;&#x27;&#xd;&#xa;																		 , &#x27;true&#x27;&#xd;&#xa;																		 &#x29;&#xd;&#xa;																		   AS saldo_inicial&#xd;&#xa;																		 &#x28; exercicio         VARCHAR&#xd;&#xa;																		 ,cod_estrutural     VARCHAR&#xd;&#xa;																		 ,cod_plano          INTEGER&#xd;&#xa;																		 ,nom_conta          VARCHAR&#xd;&#xa;																		 ,saldo_anterior     NUMERIC&#xd;&#xa;																		 ,vl_credito         NUMERIC&#xd;&#xa;																		 ,vl_debito          NUMERIC&#xd;&#xa;																		 ,cod_recurso        INTEGER&#xd;&#xa;																		 ,nom_recurso        VARCHAR&#xd;&#xa;																		 &#x29;&#xd;&#xa;			                       INNER JOIN contabilidade.plano_analitica&#xd;&#xa;			                               ON saldo_inicial.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;			                              AND saldo_inicial.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;			                       INNER JOIN contabilidade.plano_banco&#xd;&#xa;			                               ON plano_analitica.cod_plano &#x3d; plano_banco.cod_plano&#xd;&#xa;			                              AND plano_analitica.exercicio &#x3d; plano_banco.exercicio&#xd;&#xa;			                        LEFT JOIN tcemg.convenio_plano_banco&#xd;&#xa;			                               ON convenio_plano_banco.cod_plano &#x3d; plano_banco.cod_plano&#xd;&#xa;			                              AND convenio_plano_banco.exercicio &#x3d; plano_banco.exercicio&#xd;&#xa;			                       INNER JOIN contabilidade.plano_recurso&#xd;&#xa;			                               ON plano_analitica.cod_plano &#x3d; plano_recurso.cod_plano&#xd;&#xa;			                              AND plano_analitica.exercicio &#x3d; plano_recurso.exercicio&#xd;&#xa;			                        LEFT JOIN &#x28;SELECT conta_debito_credito.cod_plano&#xd;&#xa;													, conta_debito_credito.exercicio&#xd;&#xa;													, SUM&#x28;vl.vl_lancamento&#x29; AS vl_lancamento&#xd;&#xa;												 FROM &#x28;SELECT conta_debito.cod_plano&#xd;&#xa;															, conta_debito.exercicio&#xd;&#xa;															, conta_debito.cod_lote&#xd;&#xa;															, conta_debito.tipo&#xd;&#xa;															, conta_debito.sequencia&#xd;&#xa;															, conta_debito.tipo_valor&#xd;&#xa;															, conta_debito.cod_entidade&#xd;&#xa;															, &#x27;1&#x27;&#x3a;&#x3a;VARCHAR AS tipo_movimentacao&#xd;&#xa;														 FROM contabilidade.conta_debito&#xd;&#xa;														WHERE conta_debito.exercicio &#x3d; stExercicio&#xd;&#xa;														  AND conta_debito.cod_entidade IN &#x28;reRecPar.ParEntidadeLoop&#x3a;&#x3a;int&#x29;&#xd;&#xa;													UNION ALL&#xd;&#xa;													   SELECT cod_plano&#xd;&#xa;															, exercicio&#xd;&#xa;															, cod_lote&#xd;&#xa;															, tipo&#xd;&#xa;															, sequencia&#xd;&#xa;															, tipo_valor&#xd;&#xa;															, cod_entidade&#xd;&#xa;															, &#x27;2&#x27;&#x3a;&#x3a;VARCHAR AS tipo_movimentacao&#xd;&#xa;														 FROM contabilidade.conta_credito&#xd;&#xa;													    WHERE conta_credito.exercicio &#x3d; stExercicio&#xd;&#xa;														  AND conta_credito.cod_entidade IN &#x28;reRecPar.ParEntidadeLoop&#x3a;&#x3a;int&#x29;&#xd;&#xa;													  &#x29; AS conta_debito_credito&#xd;&#xa;										   INNER JOIN contabilidade.valor_lancamento AS vl&#xd;&#xa;												   ON conta_debito_credito.cod_lote     &#x3d; vl.cod_lote&#xd;&#xa;												  AND conta_debito_credito.tipo         &#x3d; vl.tipo&#xd;&#xa;												  AND conta_debito_credito.sequencia    &#x3d; vl.sequencia&#xd;&#xa;												  AND conta_debito_credito.exercicio    &#x3d; vl.exercicio&#xd;&#xa;												  AND conta_debito_credito.tipo_valor   &#x3d; vl.tipo_valor&#xd;&#xa;												  AND conta_debito_credito.cod_entidade &#x3d; vl.cod_entidade&#xd;&#xa;										   INNER JOIN contabilidade.lancamento&#xd;&#xa;												   ON lancamento.exercicio    &#x3d; vl.exercicio&#xd;&#xa;												  AND lancamento.cod_entidade &#x3d; vl.cod_entidade&#xd;&#xa;												  AND lancamento.tipo         &#x3d; vl.tipo&#xd;&#xa;												  AND lancamento.cod_lote     &#x3d; vl.cod_lote&#xd;&#xa;												  AND lancamento.sequencia    &#x3d; vl.sequencia&#xd;&#xa;										   INNER JOIN contabilidade.lancamento_receita&#xd;&#xa;												   ON lancamento_receita.exercicio    &#x3d; lancamento.exercicio&#xd;&#xa;												  AND lancamento_receita.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;												  AND lancamento_receita.tipo         &#x3d; lancamento.tipo&#xd;&#xa;												  AND lancamento_receita.cod_lote     &#x3d; lancamento.cod_lote&#xd;&#xa;												  AND lancamento_receita.sequencia    &#x3d; lancamento.sequencia&#xd;&#xa;										   INNER JOIN contabilidade.lote AS lo&#xd;&#xa;												   ON vl.cod_lote     &#x3d; lo.cod_lote&#xd;&#xa;												  AND vl.exercicio    &#x3d; lo.exercicio&#xd;&#xa;												  AND vl.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;												  AND vl.tipo         &#x3d; lo.tipo&#xd;&#xa;												WHERE lo.dt_lote BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;    --&#x27;01&#x2f;02&#x2f;2015&#x27;   &#x27;28&#x2f;02&#x2f;2015&#x27;&#xd;&#xa;												  AND lo.exercicio &#x3d; stExercicio&#xd;&#xa;											 GROUP BY conta_debito_credito.cod_plano&#xd;&#xa;													, conta_debito_credito.exercicio&#xd;&#xa;											  &#x29; AS conta_debito_credito&#xd;&#xa;			                               ON plano_analitica.cod_plano &#x3d; conta_debito_credito.cod_plano&#xd;&#xa;			                              AND plano_analitica.exercicio &#x3d; conta_debito_credito.exercicio&#xd;&#xa;			                       INNER JOIN tcemg.contasCTB&#x28; stExercicio&#xd;&#xa;															 , reRecPar.ParEntidadeLoop&#xd;&#xa;															 &#x29;&#xd;&#xa;															   AS contasCTB&#xd;&#xa;															 &#x28; cod_conta                         INTEGER&#xd;&#xa;															 , tipo_aplicacao                    VARCHAR&#xd;&#xa;															 , cod_ctb                           INTEGER&#xd;&#xa;															 , tipo_conta                        INTEGER&#xd;&#xa;															 , exercicio                         CHAR&#x28;4&#x29;&#xd;&#xa;															 , conta                             TEXT&#xd;&#xa;															 , conta_bancaria                    TEXT&#xd;&#xa;															 , conta_corrente                    TEXT&#xd;&#xa;															 , cod_orgao                         INTEGER&#xd;&#xa;															 , banco                             VARCHAR&#xd;&#xa;															 , agencia                           TEXT&#xd;&#xa;															 , digito_verificador_agencia        TEXT&#xd;&#xa;															 , digito_verificador_conta_bancaria TEXT&#xd;&#xa;															 , desc_conta_bancaria               VARCHAR&#xd;&#xa;															 &#x29;&#xd;&#xa;			                               ON contasCTB.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;			                              AND contasCTB.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;			                            WHERE plano_banco.exercicio &#x3d; stExercicio&#xd;&#xa;			                              AND plano_banco.cod_entidade IN &#x28;reRecPar.ParEntidadeLoop&#x3a;&#x3a;int&#x29;&#xd;&#xa;			                         GROUP BY cod_ctb&#xd;&#xa;			                                , cod_ctb_view&#xd;&#xa;			                                , cod_orgao&#xd;&#xa;			                                , tipo_conta&#xd;&#xa;			                                , tipo_aplicacao&#xd;&#xa;			                                , plano_recurso.cod_recurso&#xd;&#xa;			                                , plano_analitica.cod_plano&#xd;&#xa;			                                , plano_analitica.exercicio&#xd;&#xa;			                                , saldo_inicial.saldo_anterior&#xd;&#xa;			                                , saldo_inicial.vl_debito&#xd;&#xa;			                                , saldo_inicial.vl_credito&#xd;&#xa;			                                , conta&#xd;&#xa;			                         ORDER BY cod_ctb&#xd;&#xa;			                        &#x29; AS c&#xd;&#xa;			                 GROUP BY c.tipo_registro&#xd;&#xa;			                        , c.cod_ctb&#xd;&#xa;			                        , c.cod_ctb_view&#xd;&#xa;			                        , c.tipo_aplicacao&#xd;&#xa;			                        , c.tipo_conta&#xd;&#xa;			                        , c.cod_orgao&#xd;&#xa;			                        , c.cod_recurso&#xd;&#xa;			                        , c.conta&#xd;&#xa;			                 ORDER BY c.cod_ctb&#x3b;&#xd;&#xa;				             &#xd;&#xa;							--&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;  21  &#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#xd;&#xa;							  insert into prestacao_contas.tabctb_21&#xd;&#xa;			                  SELECT a.tipo_registro&#xd;&#xa;			                       , &#x27;&#x27; AS cod_reduzido_mov&#xd;&#xa;			                       , a.cod_orgao&#xd;&#xa;			                       , a.cod_ctb&#xd;&#xa;			                       , LPAD&#x28;a.tipo_conta&#x7c;&#x7c;a.cod_ctb&#x7c;&#x7c;a.tipo_entr_saida&#x7c;&#x7c;a.tipo_movimentacao&#x7c;&#x7c;a.cod_fonte_recursos&#x7c;&#x7c;LPAD&#x28;COALESCE&#x28;a.cod_fonte_ctb_transf&#x3a;&#x3a;VARCHAR,&#x27;0&#x27;&#x29;,3,&#x27;0&#x27;&#x29;,17,&#x27;0&#x27;&#x29; AS cod_ctb_view&#xd;&#xa;			                       , a.cod_fonte_recursos&#xd;&#xa;			                       , a.exercicio&#xd;&#xa;			                       , a.tipo_movimentacao&#xd;&#xa;			                       , a.tipo_entr_saida&#xd;&#xa;			                       , a.cod_ctb_transf AS cod_ctb_transf&#xd;&#xa;			                       , a.tipo_conta&#x7c;&#x7c;a.cod_ctb AS cod_ctb_transf_view&#xd;&#xa;			                       , a.cod_fonte_ctb_transf&#xd;&#xa;			                       , a.tipo_conta  AS tipo_conta&#xd;&#xa;			                       , SUM&#x28;a.valor_entr_saida&#x29; AS valor_entr_saida&#xd;&#xa;			                  FROM &#x28;&#xd;&#xa;			                        SELECT &#x27;21&#x27;&#x3a;&#x3a;int  AS  tipo_registro&#xd;&#xa;			                            , SUM&#x28;vl.vl_lancamento &#x29; AS valor_entr_saida&#xd;&#xa;			                            , plano_banco.cod_entidade as cod_orgao&#xd;&#xa;			                            , conta_bancaria.cod_ctb&#xd;&#xa;			                            , conta_bancaria.tipo_aplicacao&#xd;&#xa;			                            , conta_bancaria.tipo_conta&#x3a;&#x3a;VARCHAR&#xd;&#xa;			                            , pa.exercicio&#xd;&#xa;			                            , plano_recurso.cod_recurso AS cod_fonte_recursos&#xd;&#xa;			                            , &#x27;1&#x27;&#x3a;&#x3a;VARCHAR AS tipo_movimentacao&#xd;&#xa;			                            , CASE&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;A&#x27;&#xd;&#xa;			                                    AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 1&#x29; &#x3c;&#x3e; &#x27;9&#x27;&#xd;&#xa;			                                    AND lancamento_receita.estorno &#x3d; false&#xd;&#xa;			                                    AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 4&#x29; &#x3c;&#x3e; &#x27;1325&#x27;&#xd;&#xa;			                                    THEN &#x27;01&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;A&#x27;&#xd;&#xa;			                                    AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 1&#x29;&#x3d; &#x27;9&#x27;&#xd;&#xa;			                                    AND lancamento_receita.estorno &#x3d; false&#xd;&#xa;			                                    AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 4&#x29; &#x3c;&#x3e; &#x27;1325&#x27;&#xd;&#xa;			                                    AND RDE.vl_estornado IS NULL&#xd;&#xa;			                                    AND &#x28; &#x28;ARR.vl_arrecadacao IS NULL &#x29; OR &#x28;AR.devolucao &#x3d; true&#x29;&#x29;&#xd;&#xa;			                                    THEN &#x27;02&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;A&#x27;&#xd;&#xa;			                                    AND lancamento_receita.estorno &#x3d; true&#xd;&#xa;			                                    AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 1&#x29; &#x3c;&#x3e; &#x27;9&#x27;&#xd;&#xa;			                                    THEN &#x27;03&#x27;&#xd;&#xa;			                                WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 4&#x29; &#x3d; &#x27;1325&#x27;&#xd;&#xa;			                                    THEN &#x27;04&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;			                                    AND transferencia.cod_tipo &#x3d; 5&#xd;&#xa;			                                    THEN &#x27;05&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;			                                    AND transferencia.cod_tipo &#x3d; 4&#xd;&#xa;			                                    THEN &#x27;07&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;P&#x27;&#xd;&#xa;			                                    AND lancamento_receita.estorno &#x3d; false&#xd;&#xa;			                                    THEN &#x27;08&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;			                                    AND transferencia.cod_tipo &#x3d; 3&#xd;&#xa;			                                    THEN &#x27;09&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;P&#x27;&#xd;&#xa;			                                    AND lancamento_receita.estorno &#x3d; true&#xd;&#xa;			                                    THEN &#x27;10&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;			                                    AND transferencia.cod_tipo &#x3d; 5&#xd;&#xa;			                                    AND SUBSTR&#x28;cod_ctb_transferencia.estrutural_ctb_transfer, 1, 7&#x29; &#x3d; &#x27;1111101&#x27;&#xd;&#xa;			                                    THEN &#x27;11&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;			                                    AND transferencia.cod_tipo &#x3d; 2&#xd;&#xa;			                                    AND &#x28;&#xd;&#xa;			                                        SELECT CASE&#xd;&#xa;			                                                WHEN COUNT&#x28;plano_conta.&#x2a;&#x29; &#x3e; 0&#xd;&#xa;			                                                    THEN TRUE&#xd;&#xa;			                                                ELSE FALSE&#xd;&#xa;			                                                END&#xd;&#xa;			                                        FROM contabilidade.plano_conta&#xd;&#xa;			                                        INNER JOIN contabilidade.plano_analitica&#xd;&#xa;			                                            ON plano_conta.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;			                                            AND plano_conta.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;			                                        WHERE plano_analitica.cod_plano &#x3d; transferencia.cod_plano_credito&#xd;&#xa;			                                            AND plano_analitica.exercicio &#x3d; transferencia.exercicio&#xd;&#xa;			                                            AND &#x28;&#xd;&#xa;			                                                SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;451100000&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;451220101&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;451220102&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;451220103&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;451220104&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;451220199&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;451300000&#x27;&#xd;&#xa;			                                                &#x29;&#xd;&#xa;			                                        &#x29;&#xd;&#xa;			                                    THEN &#x27;12&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;A&#x27;&#xd;&#xa;			                                    AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;			                                    AND &#x28; &#x28;RDE.vl_estornado IS NOT NULL&#x29; OR &#x28;ARR.vl_arrecadacao IS NOT NULL AND AR.devolucao &#x3d; false&#x29; &#x29;&#xd;&#xa;			                                    THEN &#x27;16&#x27;&#xd;&#xa;			                                ELSE &#x27;99&#x27;&#xd;&#xa;			                                END AS tipo_entr_saida&#xd;&#xa;			                            , CASE&#xd;&#xa;			                                WHEN &#x28;&#xd;&#xa;			                                        &#x28; lo.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 5 &#x29;&#xd;&#xa;			                                        OR &#x28;lo.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 3&#x29;&#xd;&#xa;			                                        OR &#x28;lo.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 4&#x29;&#xd;&#xa;			                                    &#x29;&#xd;&#xa;			                                    AND SUBSTR&#x28;cod_ctb_transferencia.estrutural_ctb_transfer, 1, 7&#x29; &#x3c;&#x3e; &#x27;1111101&#x27;&#xd;&#xa;			                                    THEN &#x28; cod_ctb_transferencia.cod_ctb_anterior &#x29;&#xd;&#xa;			                                END&#x3a;&#x3a;VARCHAR AS cod_ctb_transf&#xd;&#xa;			                           , CASE&#xd;&#xa;			                                WHEN &#x28;&#xd;&#xa;			                                        &#x28; lo.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 5&#x29;&#xd;&#xa;			                                        OR &#x28;lo.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 3&#x29;&#xd;&#xa;			                                        OR &#x28;lo.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 4&#x29;&#xd;&#xa;			                                    &#x29;&#xd;&#xa;			                                    AND SUBSTR&#x28;cod_ctb_transferencia.estrutural_ctb_transfer, 1, 7&#x29; &#x3c;&#x3e; &#x27;1111101&#x27;&#xd;&#xa;			                                    THEN &#x28;&#xd;&#xa;			                                            SELECT plano_recurso.cod_recurso&#xd;&#xa;			                                              FROM contabilidade.plano_conta&#xd;&#xa;			                                        INNER JOIN contabilidade.plano_analitica&#xd;&#xa;			                                                ON plano_conta.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;			                                               AND plano_conta.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;			                                        INNER JOIN contabilidade.plano_recurso&#xd;&#xa;			                                                ON plano_recurso.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;			                                               AND plano_recurso.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;			                                             WHERE plano_analitica.cod_plano &#x3d; transferencia.cod_plano_credito&#xd;&#xa;			                                               AND plano_analitica.exercicio &#x3d; transferencia.exercicio&#xd;&#xa;			                                        &#x29;&#xd;&#xa;			                                END&#x3a;&#x3a;VARCHAR AS cod_fonte_ctb_transf&#xd;&#xa;			                        FROM contabilidade.plano_conta AS pc&#xd;&#xa;			                  INNER JOIN contabilidade.plano_analitica AS pa&#xd;&#xa;			                          ON pc.cod_conta &#x3d; pa.cod_conta&#xd;&#xa;			                         AND pc.exercicio &#x3d; pa.exercicio&#xd;&#xa;			                  INNER JOIN contabilidade.plano_banco&#xd;&#xa;			                          ON plano_banco.cod_plano &#x3d; pa.cod_plano&#xd;&#xa;			                         AND plano_banco.exercicio &#x3d; pa.exercicio&#xd;&#xa;			                   LEFT JOIN tcemg.contasCTB&#x28;stExercicio, reRecPar.ParEntidadeLoop&#x29; as conta_bancaria&#xd;&#xa;			                                                &#x28;&#xd;&#xa;			                                                    cod_conta                         INTEGER&#xd;&#xa;			                                                  , tipo_aplicacao                    VARCHAR&#xd;&#xa;			                                                  , cod_ctb                           INTEGER&#xd;&#xa;			                                                  , tipo_conta                        INTEGER&#xd;&#xa;			                                                  , exercicio                         CHAR&#x28;4&#x29;&#xd;&#xa;			                                                  , conta                             TEXT&#xd;&#xa;			                                                  , conta_bancaria                    TEXT&#xd;&#xa;			                                                  , conta_corrente                    TEXT&#xd;&#xa;			                                                  , cod_orgao                         INTEGER&#xd;&#xa;			                                                  , banco                             VARCHAR&#xd;&#xa;			                                                  , agencia             		      TEXT&#xd;&#xa;			                                                  , digito_verificador_agencia        TEXT&#xd;&#xa;			                                                  , digito_verificador_conta_bancaria TEXT&#xd;&#xa;			                                                  , desc_conta_bancaria               VARCHAR&#xd;&#xa;			                                                &#x29;&#xd;&#xa;			                          ON conta_bancaria.cod_conta &#x3d; pc.cod_conta&#xd;&#xa;			                         AND conta_bancaria.exercicio &#x3d; pc.exercicio&#xd;&#xa;			                  INNER JOIN contabilidade.conta_debito AS cd&#xd;&#xa;			                          ON pa.cod_plano &#x3d; cd.cod_plano&#xd;&#xa;			                         AND pa.exercicio &#x3d; cd.exercicio&#xd;&#xa;			                  INNER JOIN contabilidade.valor_lancamento AS vl&#xd;&#xa;			                          ON cd.cod_lote     &#x3d; vl.cod_lote&#xd;&#xa;			                         AND cd.tipo         &#x3d; vl.tipo&#xd;&#xa;			                         AND cd.sequencia    &#x3d; vl.sequencia&#xd;&#xa;			                         AND cd.exercicio    &#x3d; vl.exercicio&#xd;&#xa;			                         AND cd.tipo_valor   &#x3d; vl.tipo_valor&#xd;&#xa;			                         AND cd.cod_entidade &#x3d; vl.cod_entidade&#xd;&#xa;			                  INNER JOIN contabilidade.lancamento&#xd;&#xa;			                          ON lancamento.exercicio    &#x3d; vl.exercicio&#xd;&#xa;			                         AND lancamento.cod_entidade &#x3d; vl.cod_entidade&#xd;&#xa;			                         AND lancamento.tipo         &#x3d; vl.tipo&#xd;&#xa;			                         AND lancamento.cod_lote     &#x3d; vl.cod_lote&#xd;&#xa;			                         AND lancamento.sequencia    &#x3d; vl.sequencia&#xd;&#xa;			                   LEFT JOIN contabilidade.lancamento_receita&#xd;&#xa;			                          ON lancamento_receita.exercicio    &#x3d; lancamento.exercicio&#xd;&#xa;			                         AND lancamento_receita.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;			                         AND lancamento_receita.tipo         &#x3d; lancamento.tipo&#xd;&#xa;			                         AND lancamento_receita.cod_lote     &#x3d; lancamento.cod_lote&#xd;&#xa;			                         AND lancamento_receita.sequencia    &#x3d; lancamento.sequencia&#xd;&#xa;			                  INNER JOIN contabilidade.lote AS lo&#xd;&#xa;			                          ON vl.cod_lote     &#x3d; lo.cod_lote&#xd;&#xa;			                         AND vl.tipo         &#x3d; lo.tipo&#xd;&#xa;			                         AND vl.exercicio    &#x3d; lo.exercicio&#xd;&#xa;			                         AND vl.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;			                         AND lo.dt_lote BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;       --&#x27;01&#x2f;02&#x2f;2015&#x27;       &#x27;28&#x2f;02&#x2f;2015&#x27;&#xd;&#xa;			                         AND lo.exercicio &#x3d; stExercicio&#xd;&#xa;			                   LEFT JOIN orcamento.receita&#xd;&#xa;			                          ON receita.cod_receita &#x3d; lancamento_receita.cod_receita&#xd;&#xa;			                         AND receita.exercicio   &#x3d; lancamento_receita.exercicio&#xd;&#xa;			                   LEFT JOIN contabilidade.plano_recurso&#xd;&#xa;			                          ON pa.cod_plano &#x3d; plano_recurso.cod_plano&#xd;&#xa;			                         AND pa.exercicio &#x3d; plano_recurso.exercicio&#xd;&#xa;			                   LEFT JOIN orcamento.recurso&#xd;&#xa;			                          ON recurso.exercicio   &#x3d; plano_recurso.exercicio&#xd;&#xa;			                         AND recurso.cod_recurso &#x3d; plano_recurso.cod_recurso&#xd;&#xa;			                   LEFT JOIN contabilidade.lancamento_empenho&#xd;&#xa;			                          ON lancamento_empenho.exercicio    &#x3d; lancamento.exercicio&#xd;&#xa;			                         AND lancamento_empenho.tipo         &#x3d; lancamento.tipo&#xd;&#xa;			                         AND lancamento_empenho.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;			                         AND lancamento_empenho.cod_lote     &#x3d; lancamento.cod_lote&#xd;&#xa;			                         AND lancamento_empenho.sequencia    &#x3d; lancamento.sequencia&#xd;&#xa;			                   LEFT JOIN orcamento.conta_receita&#xd;&#xa;			                          ON conta_receita.exercicio &#x3d; receita.exercicio&#xd;&#xa;			                         AND conta_receita.cod_conta &#x3d; receita.cod_conta&#xd;&#xa;			                   LEFT JOIN tcemg.receita_indentificadores_peculiar_receita&#xd;&#xa;			                          ON receita_indentificadores_peculiar_receita.exercicio   &#x3d; receita.exercicio&#xd;&#xa;			                         AND receita_indentificadores_peculiar_receita.cod_receita &#x3d; receita.cod_conta&#xd;&#xa;			                   LEFT JOIN tesouraria.transferencia&#xd;&#xa;			                          ON transferencia.cod_lote     &#x3d; lo.cod_lote&#xd;&#xa;			                         AND transferencia.tipo         &#x3d; lo.tipo&#xd;&#xa;			                         AND transferencia.exercicio    &#x3d; lo.exercicio&#xd;&#xa;			                         AND transferencia.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;			                   LEFT JOIN &#x28;&#xd;&#xa;			                            SELECT conta_debito.cod_lote&#xd;&#xa;			                                , conta_debito.tipo&#xd;&#xa;			                                , conta_debito.exercicio&#xd;&#xa;			                                , conta_debito.cod_entidade&#xd;&#xa;			                                , CASE&#xd;&#xa;			                                    WHEN &#x28;conta_bancaria.cod_ctb_anterior is null&#x29;&#xd;&#xa;			                                        THEN transferencia.cod_plano_credito&#xd;&#xa;			                                    Else conta_bancaria.cod_ctb_anterior&#xd;&#xa;			                                    END AS cod_ctb_anterior&#xd;&#xa;			                                , transferencia.cod_plano_credito&#xd;&#xa;			                                , transferencia.cod_plano_debito&#xd;&#xa;			                                , conta_debito.sequencia&#xd;&#xa;			                                , REPLACE&#x28;pc.cod_estrutural,&#x27;.&#x27;, &#x27;&#x27;&#x29; AS estrutural_ctb_transfer&#xd;&#xa;			                             FROM contabilidade.conta_debito&#xd;&#xa;						           INNER JOIN contabilidade.lote AS lo&#xd;&#xa;			                               ON conta_debito.cod_lote     &#x3d; lo.cod_lote&#xd;&#xa;						                  AND conta_debito.tipo         &#x3d; lo.tipo&#xd;&#xa;						                  AND conta_debito.exercicio    &#x3d; lo.exercicio&#xd;&#xa;						                  AND conta_debito.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;			                       INNER JOIN tesouraria.transferencia&#xd;&#xa;							               ON transferencia.cod_plano_debito &#x3d; conta_debito.cod_plano&#xd;&#xa;							              AND lo.cod_lote &#x3d; transferencia.cod_lote&#xd;&#xa;							              AND transferencia.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;							              AND transferencia.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;			                              AND transferencia.exercicio &#x3d; conta_debito.exercicio&#xd;&#xa;						           INNER JOIN contabilidade.plano_analitica&#xd;&#xa;							               ON plano_analitica.cod_plano &#x3d; transferencia.cod_plano_credito&#xd;&#xa;							              AND plano_analitica.natureza_saldo &#x3d; &#x27;D&#x27;&#xd;&#xa;			                              AND plano_analitica.exercicio &#x3d; conta_debito.exercicio&#xd;&#xa;						            LEFT JOIN tcemg.conta_bancaria&#xd;&#xa;							               ON conta_bancaria.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;							              AND conta_bancaria.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;			                       INNER JOIN contabilidade.plano_conta AS pc&#xd;&#xa;			                               ON pc.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;			                              AND pc.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;						                WHERE conta_debito.exercicio &#x3d; stExercicio&#xd;&#xa;							              AND conta_debito.cod_entidade IN &#x28;reRecPar.ParEntidadeLoop&#x3a;&#x3a;int&#x29;&#xd;&#xa;			                              AND lo.dt_lote BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;   --&#x27;01&#x2f;02&#x2f;2015&#x27;   &#x27;28&#x2f;02&#x2f;2015&#x27;&#xd;&#xa;							              AND conta_debito.tipo         &#x3d; &#x27;T&#x27;&#xd;&#xa;			                            &#x29; AS cod_ctb_transferencia&#xd;&#xa;			                          ON cod_ctb_transferencia.exercicio &#x3d; cd.exercicio&#xd;&#xa;			                         AND cod_ctb_transferencia.sequencia &#x3d; cd.sequencia&#xd;&#xa;			                         AND cod_ctb_transferencia.cod_lote &#x3d; cd.cod_lote&#xd;&#xa;			                         AND cod_ctb_transferencia.tipo &#x3d; cd.tipo&#xd;&#xa;			                         AND cod_ctb_transferencia.cod_plano_debito &#x3d; cd.cod_plano&#xd;&#xa;			                   LEFT JOIN tesouraria.arrecadacao_receita_dedutora AS RD&#xd;&#xa;						              ON RD.cod_receita_dedutora &#x3d; lancamento_receita.cod_receita&#xd;&#xa;					                 AND RD.vl_deducao &#x3d; vl.vl_lancamento&#xd;&#xa;			                         AND TO_DATE&#x28;RD.timestamp_arrecadacao&#x3a;&#x3a;VARCHAR,&#x27;yyyy-mm-dd&#x27;&#x29; &#x3d; lo.dt_lote&#xd;&#xa;			                   LEFT JOIN tesouraria.arrecadacao_receita_dedutora_estornada AS RDE&#xd;&#xa;					                  ON RDE.cod_receita_dedutora &#x3d; RD.cod_receita_dedutora&#xd;&#xa;					                 AND RDE.cod_arrecadacao &#x3d; RD.cod_arrecadacao&#xd;&#xa;			                   LEFT JOIN tesouraria.arrecadacao_receita AS ARR&#xd;&#xa;			                          ON ARR.cod_receita &#x3d; RD.cod_receita_dedutora&#xd;&#xa;			                         AND TO_DATE&#x28;ARR.timestamp_arrecadacao&#x3a;&#x3a;VARCHAR,&#x27;yyyy-mm-dd&#x27;&#x29; &#x3d; lo.dt_lote&#xd;&#xa;			                   LEFT JOIN tesouraria.arrecadacao AS AR&#xd;&#xa;			                          ON AR.cod_arrecadacao &#x3d; ARR.cod_arrecadacao&#xd;&#xa;			                         AND AR.timestamp_arrecadacao &#x3d; ARR.timestamp_arrecadacao&#xd;&#xa;			                       WHERE pc.exercicio   &#x3d; stExercicio&#xd;&#xa;			                         AND plano_banco.cod_entidade IN &#x28;reRecPar.ParEntidadeLoop&#x3a;&#x3a;int&#x29;&#xd;&#xa;			                         AND SUBSTR&#x28;REPLACE&#x28;pc.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 7&#x29; &#x3c;&#x3e; &#x27;1111101&#x27;&#xd;&#xa;			                         AND vl.tipo &#x3c;&#x3e; &#x27;I&#x27;&#xd;&#xa;			                    GROUP BY tipo_registro&#xd;&#xa;			                           , cod_ctb&#xd;&#xa;					                   , conta_bancaria.tipo_aplicacao&#xd;&#xa;						               , tipo_conta&#xd;&#xa;			                           , plano_banco.cod_entidade&#xd;&#xa;			                           , plano_recurso.cod_recurso&#xd;&#xa;			                           , pa.exercicio&#xd;&#xa;			                           , tipo_movimentacao&#xd;&#xa;			                           , tipo_entr_saida&#xd;&#xa;			                           , cod_ctb_transf&#xd;&#xa;			                           , cod_fonte_ctb_transf&#xd;&#xa;			                           , conta_receita.cod_estrutural&#xd;&#xa;			                        &#x29; AS a&#xd;&#xa;			                 GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12,13&#xd;&#xa;		&#xd;&#xa;			                    UNION&#xd;&#xa;		&#xd;&#xa;			                   SELECT b.tipo_registro&#xd;&#xa;			                        , &#x27;&#x27; AS cod_reduzido_mov&#xd;&#xa;			                        , b.cod_orgao&#xd;&#xa;			                        , b.cod_ctb&#xd;&#xa;			                        , LPAD&#x28;b.tipo_conta&#x7c;&#x7c;b.cod_ctb&#x7c;&#x7c;b.tipo_entr_saida&#x7c;&#x7c;b.tipo_movimentacao&#x7c;&#x7c;b.cod_fonte_recursos&#x7c;&#x7c;LPAD&#x28;COALESCE&#x28;b.cod_fonte_ctb_transf&#x3a;&#x3a;VARCHAR,&#x27;0&#x27;&#x29;,3,&#x27;0&#x27;&#x29;,17,&#x27;0&#x27;&#x29;  AS cod_ctb_view&#xd;&#xa;			                        , b.cod_fonte_recursos&#xd;&#xa;			                        , b.exercicio&#xd;&#xa;			                        , b.tipo_movimentacao&#xd;&#xa;			                        , b.tipo_entr_saida&#xd;&#xa;			                        , b.cod_ctb_transf AS cod_ctb_transf&#xd;&#xa;			                        , b.tipo_conta&#x7c;&#x7c;b.cod_ctb AS cod_ctb_transf_view&#xd;&#xa;			                        , b.cod_fonte_ctb_transf&#xd;&#xa;			                        , b.tipo_conta AS tipo_conta&#xd;&#xa;			                        , SUM&#x28;b.valor_entr_saida&#x29; AS valor_entr_saida&#xd;&#xa;			                    FROM &#x28;&#xd;&#xa;			                        SELECT &#x27;21&#x27;&#x3a;&#x3a;int  AS  tipo_registro&#xd;&#xa;			                            , SUM&#x28;vl.vl_lancamento&#x29; &#x2a; -1 as valor_entr_saida&#xd;&#xa;			                            , plano_banco.cod_entidade as cod_orgao&#xd;&#xa;			                            , conta_bancaria.cod_ctb&#xd;&#xa;			                            , conta_bancaria.tipo_aplicacao&#xd;&#xa;			                            , conta_bancaria.tipo_conta&#x3a;&#x3a;VARCHAR&#xd;&#xa;			                            , pa.exercicio&#xd;&#xa;			                            , plano_recurso.cod_recurso as cod_fonte_recursos&#xd;&#xa;			                            , &#x27;2&#x27;&#x3a;&#x3a;VARCHAR AS tipo_movimentacao&#xd;&#xa;			                            , CASE&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;A&#x27;&#xd;&#xa;			                                    AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 1&#x29; &#x3c;&#x3e; &#x27;9&#x27;&#xd;&#xa;			                                    AND lancamento_receita.estorno &#x3d; false&#xd;&#xa;			                                    AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 4&#x29; &#x3c;&#x3e; &#x27;1325&#x27;&#xd;&#xa;			                                    THEN &#x27;01&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;A&#x27;&#xd;&#xa;			                                    AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;			                                    AND lancamento_receita.estorno &#x3d; false&#xd;&#xa;			                                    AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 4&#x29; &#x3c;&#x3e; &#x27;1325&#x27;&#xd;&#xa;			                                    AND RDE.vl_estornado IS NULL&#xd;&#xa;			                                    AND &#x28; &#x28;ARR.vl_arrecadacao IS NULL&#x29; OR &#x28;AR.devolucao &#x3d; true&#x29; &#x29;&#xd;&#xa;			                                    THEN &#x27;02&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;A&#x27;&#xd;&#xa;			                                    AND lancamento_receita.estorno &#x3d; true&#xd;&#xa;			                                    AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 1&#x29; &#x3c;&#x3e; &#x27;9&#x27;&#xd;&#xa;			                                    THEN &#x27;03&#x27;&#xd;&#xa;			                                WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 4&#x29; &#x3d; &#x27;1325&#x27;&#xd;&#xa;			                                    THEN &#x27;04&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;			                                    AND transferencia.cod_tipo &#x3d; 5&#xd;&#xa;			                                    AND SUBSTR&#x28;cod_ctb_transferencia.estrutural_ctb_transfer, 1, 7&#x29; &#x3c;&#x3e; &#x27;1111101&#x27;&#xd;&#xa;			                                    THEN &#x27;06&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;			                                    AND transferencia.cod_tipo &#x3d; 4&#xd;&#xa;			                                    THEN &#x27;07&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;P&#x27;&#xd;&#xa;			                                    AND lancamento_empenho.estorno &#x3d; false&#xd;&#xa;			                                    THEN &#x27;08&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;			                                    AND transferencia.cod_tipo &#x3d; 3&#xd;&#xa;			                                    THEN &#x27;09&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;P&#x27;&#xd;&#xa;			                                    AND lancamento_empenho.estorno &#x3d; true&#xd;&#xa;			                                    THEN &#x27;10&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;			                                    AND transferencia.cod_tipo &#x3d; 5&#xd;&#xa;			                                    AND SUBSTR&#x28;cod_ctb_transferencia.estrutural_ctb_transfer, 1, 7&#x29; &#x3d; &#x27;1111101&#x27;&#xd;&#xa;			                                    THEN &#x27;11&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;			                                    AND transferencia.cod_tipo &#x3d; 1&#xd;&#xa;			                                    AND transferencia_estornada.cod_lote_estorno IS NOT NULL&#xd;&#xa;			                                    AND &#x28;&#xd;&#xa;			                                        SELECT CASE&#xd;&#xa;			                                                WHEN COUNT&#x28;plano_conta.&#x2a;&#x29; &#x3e; 0&#xd;&#xa;			                                                    THEN TRUE&#xd;&#xa;			                                                ELSE FALSE&#xd;&#xa;			                                                END&#xd;&#xa;			                                        FROM contabilidade.plano_conta&#xd;&#xa;			                                        INNER JOIN contabilidade.plano_analitica&#xd;&#xa;			                                            ON plano_conta.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;			                                                AND plano_conta.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;			                                        WHERE plano_analitica.cod_plano &#x3d; transferencia.cod_plano_debito&#xd;&#xa;			                                            AND plano_analitica.exercicio &#x3d; transferencia.exercicio&#xd;&#xa;			                                            AND &#x28;&#xd;&#xa;			                                                SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;351100000&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;351220101&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;351220102&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;351220103&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;351220104&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;351220199&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;351300000&#x27;&#xd;&#xa;			                                                &#x29;&#xd;&#xa;			                                        &#x29;&#xd;&#xa;			                                    THEN &#x27;12&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;			                                    AND transferencia.cod_tipo &#x3d; 1&#xd;&#xa;			                                    AND &#x28;&#xd;&#xa;			                                        SELECT CASE&#xd;&#xa;			                                                WHEN COUNT&#x28;plano_conta.&#x2a;&#x29; &#x3e; 0&#xd;&#xa;			                                                    THEN TRUE&#xd;&#xa;			                                                ELSE FALSE&#xd;&#xa;			                                                END&#xd;&#xa;			                                        FROM contabilidade.plano_conta&#xd;&#xa;			                                        INNER JOIN contabilidade.plano_analitica&#xd;&#xa;			                                            ON plano_conta.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;			                                                AND plano_conta.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;			                                        WHERE plano_analitica.cod_plano &#x3d; transferencia.cod_plano_debito&#xd;&#xa;			                                            AND plano_analitica.exercicio &#x3d; transferencia.exercicio&#xd;&#xa;			                                            AND &#x28;&#xd;&#xa;			                                                SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;351100000&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;351220101&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;351220102&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;351220103&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;351220104&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;351220199&#x27;&#xd;&#xa;			                                                OR SUBSTR&#x28;REPLACE&#x28;plano_conta.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 9&#x29; &#x3d; &#x27;351300000&#x27;&#xd;&#xa;			                                                &#x29;&#xd;&#xa;			                                        &#x29;&#xd;&#xa;			                                    THEN &#x27;13&#x27;&#xd;&#xa;			                                WHEN lo.tipo &#x3d; &#x27;A&#x27;&#xd;&#xa;			                                    AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;			                                    AND &#x28;&#xd;&#xa;			                                        &#x28;RDE.vl_estornado IS NOT NULL&#x29;&#xd;&#xa;			                                        OR &#x28; ARR.vl_arrecadacao IS NOT NULL AND AR.devolucao &#x3d; false &#x29;&#xd;&#xa;			                                        &#x29;&#xd;&#xa;			                                    THEN &#x27;16&#x27;&#xd;&#xa;			                                ELSE &#x27;99&#x27;&#xd;&#xa;			                                END AS tipo_entr_saida&#xd;&#xa;			                            , CASE&#xd;&#xa;			                                WHEN &#x28;&#xd;&#xa;			                                        &#x28; lo.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 5 &#x29;&#xd;&#xa;			                                        OR &#x28; lo.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 4 &#x29;&#xd;&#xa;			                                        OR &#x28; lo.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 3 &#x29;&#xd;&#xa;			                                    &#x29;&#xd;&#xa;			                                    AND SUBSTR&#x28;cod_ctb_transferencia.estrutural_ctb_transfer, 1, 7&#x29; &#x3c;&#x3e; &#x27;1111101&#x27;&#xd;&#xa;			                                    THEN &#x28;cod_ctb_transferencia.cod_ctb_anterior&#x29;&#xd;&#xa;			                                END&#x3a;&#x3a;VARCHAR AS cod_ctb_transf&#xd;&#xa;			                            , CASE&#xd;&#xa;			                                WHEN &#x28;&#xd;&#xa;			                                        &#x28; lo.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 5&#x29;&#xd;&#xa;			                                        OR &#x28;lo.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 3&#x29;&#xd;&#xa;			                                        OR &#x28;lo.tipo &#x3d; &#x27;T&#x27; AND transferencia.cod_tipo &#x3d; 4&#x29;&#xd;&#xa;			                                    &#x29;&#xd;&#xa;			                                    AND SUBSTR&#x28;cod_ctb_transferencia.estrutural_ctb_transfer, 1, 7&#x29; &#x3c;&#x3e; &#x27;1111101&#x27;&#xd;&#xa;			                                    THEN &#x28;&#xd;&#xa;			                                            SELECT plano_recurso.cod_recurso&#xd;&#xa;			                                            FROM contabilidade.plano_conta&#xd;&#xa;			                                        INNER JOIN contabilidade.plano_analitica&#xd;&#xa;			                                                ON plano_conta.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;			                                                AND plano_conta.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;			                                        INNER JOIN contabilidade.plano_recurso&#xd;&#xa;			                                                ON plano_recurso.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;			                                                AND plano_recurso.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;			                                            WHERE plano_analitica.cod_plano &#x3d; transferencia.cod_plano_debito&#xd;&#xa;			                                                AND plano_analitica.exercicio &#x3d; transferencia.exercicio&#xd;&#xa;			                                        &#x29;&#xd;&#xa;			                                END&#x3a;&#x3a;VARCHAR AS cod_fonte_ctb_transf&#xd;&#xa;			                        FROM contabilidade.plano_conta AS pc&#xd;&#xa;			                  INNER JOIN contabilidade.plano_analitica AS pa&#xd;&#xa;			                          ON pc.cod_conta &#x3d; pa.cod_conta&#xd;&#xa;			                         AND pc.exercicio &#x3d; pa.exercicio&#xd;&#xa;			                  INNER JOIN contabilidade.plano_banco&#xd;&#xa;			                          ON plano_banco.cod_plano &#x3d; pa.cod_plano&#xd;&#xa;			                         AND plano_banco.exercicio &#x3d; pa.exercicio&#xd;&#xa;			                   LEFT JOIN tcemg.contasCTB&#x28;stExercicio, reRecPar.ParEntidadeLoop&#x29; as conta_bancaria&#xd;&#xa;			                                            &#x28;&#xd;&#xa;			                                                cod_conta                         INTEGER&#xd;&#xa;			                                              , tipo_aplicacao                    VARCHAR&#xd;&#xa;			                                              , cod_ctb                           INTEGER&#xd;&#xa;			                                              , tipo_conta                        INTEGER&#xd;&#xa;			                                              , exercicio                         CHAR&#x28;4&#x29;&#xd;&#xa;			                                              , conta                             TEXT&#xd;&#xa;			                                              , conta_bancaria                    TEXT&#xd;&#xa;			                                              , conta_corrente                    TEXT&#xd;&#xa;			                                              , cod_orgao                         INTEGER&#xd;&#xa;			                                              , banco                             VARCHAR&#xd;&#xa;			                                              , agencia             		      TEXT&#xd;&#xa;			                                              , digito_verificador_agencia        TEXT&#xd;&#xa;			                                              , digito_verificador_conta_bancaria TEXT&#xd;&#xa;			                                              , desc_conta_bancaria               VARCHAR&#xd;&#xa;			                                            &#x29;&#xd;&#xa;			                          ON conta_bancaria.cod_conta &#x3d; pc.cod_conta&#xd;&#xa;			                         AND conta_bancaria.exercicio &#x3d; pc.exercicio&#xd;&#xa;			                  INNER JOIN contabilidade.conta_credito AS cc&#xd;&#xa;			                          ON pa.cod_plano &#x3d; cc.cod_plano&#xd;&#xa;			                         AND pa.exercicio &#x3d; cc.exercicio&#xd;&#xa;			                  INNER JOIN contabilidade.valor_lancamento AS vl&#xd;&#xa;			                          ON cc.cod_lote     &#x3d; vl.cod_lote&#xd;&#xa;			                         AND cc.tipo         &#x3d; vl.tipo&#xd;&#xa;			                         AND cc.sequencia    &#x3d; vl.sequencia&#xd;&#xa;			                         AND cc.exercicio    &#x3d; vl.exercicio&#xd;&#xa;			                         AND cc.tipo_valor   &#x3d; vl.tipo_valor&#xd;&#xa;			                         AND cc.cod_entidade &#x3d; vl.cod_entidade&#xd;&#xa;			                  INNER JOIN contabilidade.lancamento&#xd;&#xa;			                          ON lancamento.exercicio    &#x3d; vl.exercicio&#xd;&#xa;			                         AND lancamento.cod_entidade &#x3d; vl.cod_entidade&#xd;&#xa;			                         AND lancamento.tipo         &#x3d; vl.tipo&#xd;&#xa;			                         AND lancamento.cod_lote     &#x3d; vl.cod_lote&#xd;&#xa;			                         AND lancamento.sequencia    &#x3d; vl.sequencia&#xd;&#xa;			                   LEFT JOIN contabilidade.lancamento_receita&#xd;&#xa;			                          ON lancamento_receita.exercicio    &#x3d; lancamento.exercicio&#xd;&#xa;			                         AND lancamento_receita.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;			                         AND lancamento_receita.tipo         &#x3d; lancamento.tipo&#xd;&#xa;			                         AND lancamento_receita.cod_lote     &#x3d; lancamento.cod_lote&#xd;&#xa;			                         AND lancamento_receita.sequencia    &#x3d; lancamento.sequencia&#xd;&#xa;			                  INNER JOIN contabilidade.lote AS lo&#xd;&#xa;			                          ON vl.cod_lote     &#x3d; lo.cod_lote&#xd;&#xa;			                         AND vl.tipo         &#x3d; lo.tipo&#xd;&#xa;			                         AND vl.exercicio    &#x3d; lo.exercicio&#xd;&#xa;			                         AND vl.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;			                         AND lo.dt_lote BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;      --&#x27;01&#x2f;02&#x2f;2015&#x27;     &#x27;28&#x2f;02&#x2f;2015&#x27;&#xd;&#xa;			                         AND lo.exercicio &#x3d; stExercicio&#xd;&#xa;			                   LEFT JOIN orcamento.receita&#xd;&#xa;			                          ON receita.cod_receita &#x3d; lancamento_receita.cod_receita&#xd;&#xa;			                         AND receita.exercicio   &#x3d; lancamento_receita.exercicio&#xd;&#xa;			                   LEFT JOIN contabilidade.plano_recurso&#xd;&#xa;			                          ON pa.cod_plano &#x3d; plano_recurso.cod_plano&#xd;&#xa;			                         AND pa.exercicio &#x3d; plano_recurso.exercicio&#xd;&#xa;			                   LEFT JOIN orcamento.recurso&#xd;&#xa;			                          ON recurso.exercicio   &#x3d; plano_recurso.exercicio&#xd;&#xa;			                         AND recurso.cod_recurso &#x3d; plano_recurso.cod_recurso&#xd;&#xa;			                   LEFT JOIN contabilidade.lancamento_empenho&#xd;&#xa;			                          ON lancamento_empenho.exercicio    &#x3d; lancamento.exercicio&#xd;&#xa;			                         AND lancamento_empenho.tipo         &#x3d; lancamento.tipo&#xd;&#xa;			                         AND lancamento_empenho.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;			                         AND lancamento_empenho.cod_lote     &#x3d; lancamento.cod_lote&#xd;&#xa;			                         AND lancamento_empenho.sequencia    &#x3d; lancamento.sequencia&#xd;&#xa;			                   LEFT JOIN orcamento.conta_receita&#xd;&#xa;			                          ON conta_receita.exercicio &#x3d; receita.exercicio&#xd;&#xa;			                         AND conta_receita.cod_conta &#x3d; receita.cod_conta&#xd;&#xa;			                   LEFT JOIN tcemg.receita_indentificadores_peculiar_receita&#xd;&#xa;			                          ON receita_indentificadores_peculiar_receita.exercicio   &#x3d; receita.exercicio&#xd;&#xa;			                         AND receita_indentificadores_peculiar_receita.cod_receita &#x3d; receita.cod_conta&#xd;&#xa;			                   LEFT JOIN tesouraria.transferencia&#xd;&#xa;			                          ON transferencia.cod_lote     &#x3d; lo.cod_lote&#xd;&#xa;			                         AND transferencia.tipo         &#x3d; lo.tipo&#xd;&#xa;			                         AND transferencia.exercicio    &#x3d; lo.exercicio&#xd;&#xa;			                         AND transferencia.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;			                   LEFT JOIN tesouraria.transferencia_estornada&#xd;&#xa;			                          ON transferencia_estornada.cod_lote     &#x3d; lo.cod_lote&#xd;&#xa;			                         AND transferencia_estornada.tipo         &#x3d; lo.tipo&#xd;&#xa;			                         AND transferencia_estornada.exercicio    &#x3d; lo.exercicio&#xd;&#xa;			                         AND transferencia_estornada.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;		&#xd;&#xa;			                   LEFT JOIN &#x28;&#xd;&#xa;			                                SELECT conta_credito.cod_lote&#xd;&#xa;			                                     , conta_credito.tipo&#xd;&#xa;			                                     , conta_credito.exercicio&#xd;&#xa;			                                     , conta_credito.cod_entidade&#xd;&#xa;			                                     , CASE&#xd;&#xa;			                                        WHEN &#x28;conta_bancaria.cod_ctb_anterior is null&#x29;&#xd;&#xa;			                                            THEN transferencia.cod_plano_debito&#xd;&#xa;			                                        Else conta_bancaria.cod_ctb_anterior&#xd;&#xa;			                                        END AS cod_ctb_anterior&#xd;&#xa;			                                     , transferencia.cod_plano_credito&#xd;&#xa;			                                     , transferencia.cod_plano_debito&#xd;&#xa;			                                     , conta_credito.sequencia&#xd;&#xa;			                                     , REPLACE&#x28;pc.cod_estrutural,&#x27;.&#x27;, &#x27;&#x27;&#x29; AS estrutural_ctb_transfer&#xd;&#xa;			                                  FROM contabilidade.conta_credito&#xd;&#xa;						                INNER JOIN contabilidade.lote AS lo&#xd;&#xa;							                    ON conta_credito.cod_lote     &#x3d; lo.cod_lote&#xd;&#xa;			                                   AND  lo.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;			                                   AND conta_credito.exercicio    &#x3d; lo.exercicio&#xd;&#xa;			                                   AND conta_credito.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;						                INNER JOIN tesouraria.transferencia&#xd;&#xa;							                    ON transferencia.cod_plano_credito &#x3d; conta_credito.cod_plano&#xd;&#xa;						                       AND lo.cod_lote &#x3d; transferencia.cod_lote&#xd;&#xa;						                       AND transferencia.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;						                       AND transferencia.tipo &#x3d; &#x27;T&#x27;&#xd;&#xa;			                                   AND transferencia.exercicio &#x3d; conta_credito.exercicio&#xd;&#xa;						                INNER JOIN contabilidade.plano_analitica&#xd;&#xa;							                    ON plano_analitica.cod_plano &#x3d; transferencia.cod_plano_debito&#xd;&#xa;						                       AND plano_analitica.natureza_saldo &#x3d; &#x27;D&#x27;&#xd;&#xa;			                                   AND plano_analitica.exercicio &#x3d; conta_credito.exercicio&#xd;&#xa;						                 LEFT JOIN tcemg.conta_bancaria&#xd;&#xa;							                    ON conta_bancaria.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;						                       AND conta_bancaria.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;			                            INNER JOIN contabilidade.plano_conta AS pc&#xd;&#xa;			                                    ON pc.cod_conta &#x3d; plano_analitica.cod_conta&#xd;&#xa;			                                   AND pc.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;						                     WHERE conta_credito.exercicio &#x3d; stExercicio&#xd;&#xa;						                       AND conta_credito.cod_entidade IN &#x28;reRecPar.ParEntidadeLoop&#x3a;&#x3a;int&#x29;&#xd;&#xa;			                                   AND  lo.dt_lote BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;     --&#x27;01&#x2f;02&#x2f;2015&#x27; &#x27;28&#x2f;02&#x2f;2015&#x27;&#xd;&#xa;			                                   AND conta_credito.tipo         &#x3d; &#x27;T&#x27;&#xd;&#xa;			                            &#x29; AS cod_ctb_transferencia&#xd;&#xa;			                          ON cod_ctb_transferencia.exercicio &#x3d; cc.exercicio&#xd;&#xa;			                         AND cod_ctb_transferencia.sequencia &#x3d; cc.sequencia&#xd;&#xa;			                         AND cod_ctb_transferencia.cod_lote &#x3d; cc.cod_lote&#xd;&#xa;			                         AND cod_ctb_transferencia.tipo &#x3d; cc.tipo&#xd;&#xa;			                         AND cod_ctb_transferencia.cod_plano_credito &#x3d; cc.cod_plano&#xd;&#xa;			                   LEFT JOIN tesouraria.arrecadacao_receita_dedutora AS RD&#xd;&#xa;			                          ON RD.cod_receita_dedutora &#x3d; lancamento_receita.cod_receita&#xd;&#xa;			                         AND RD.vl_deducao &#x3d; vl.vl_lancamento&#xd;&#xa;			                         AND TO_DATE&#x28;RD.timestamp_arrecadacao&#x3a;&#x3a;VARCHAR,&#x27;yyyy-mm-dd&#x27;&#x29; &#x3d; lo.dt_lote&#xd;&#xa;			                   LEFT JOIN tesouraria.arrecadacao_receita_dedutora_estornada AS RDE&#xd;&#xa;			                          ON RDE.cod_receita_dedutora &#x3d; RD.cod_receita_dedutora&#xd;&#xa;			                         AND RDE.cod_arrecadacao &#x3d; RD.cod_arrecadacao&#xd;&#xa;			                   LEFT JOIN tesouraria.arrecadacao_receita AS ARR&#xd;&#xa;			                          ON ARR.cod_receita &#x3d; RD.cod_receita_dedutora&#xd;&#xa;			                         AND TO_DATE&#x28;ARR.timestamp_arrecadacao&#x3a;&#x3a;VARCHAR,&#x27;yyyy-mm-dd&#x27;&#x29; &#x3d; lo.dt_lote&#xd;&#xa;			                   LEFT JOIN tesouraria.arrecadacao AS AR&#xd;&#xa;			                          ON AR.cod_arrecadacao &#x3d; ARR.cod_arrecadacao&#xd;&#xa;			                         AND AR.timestamp_arrecadacao &#x3d; ARR.timestamp_arrecadacao&#xd;&#xa;			                       WHERE pc.exercicio   &#x3d; stExercicio&#xd;&#xa;			                         AND plano_banco.cod_entidade IN &#x28;reRecPar.ParEntidadeLoop&#x3a;&#x3a;int&#x29;&#xd;&#xa;			                         AND SUBSTR&#x28;REPLACE&#x28;pc.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 7&#x29; &#x3c;&#x3e; &#x27;1111101&#x27;&#xd;&#xa;			                         AND vl.tipo &#x3c;&#x3e; &#x27;I&#x27;&#xd;&#xa;			                    GROUP BY tipo_registro&#xd;&#xa;			                           , cod_ctb&#xd;&#xa;					                   , conta_bancaria.tipo_aplicacao&#xd;&#xa;					                   , tipo_conta&#xd;&#xa;			                           , plano_banco.cod_entidade&#xd;&#xa;			                           , plano_recurso.cod_recurso&#xd;&#xa;			                           , pa.exercicio&#xd;&#xa;			                           , tipo_entr_saida&#xd;&#xa;			                           , cod_ctb_transf&#xd;&#xa;			                           , cod_fonte_ctb_transf&#xd;&#xa;			                        &#x29; AS b&#xd;&#xa;			                 GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12,13&#xd;&#xa;			                 ORDER BY  cod_ctb,tipo_entr_saida, tipo_movimentacao&#x3b;&#xd;&#xa;&#xd;&#xa;				            --&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;  22  &#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#xd;&#xa;             	           insert into prestacao_contas.tabctb_22&#xd;&#xa;						   SELECT    c.tipo_registro&#xd;&#xa;				              , &#x27;&#x27; AS cod_reduzido_mov&#xd;&#xa;				              , c.e_deducao_de_receita&#xd;&#xa;				              , c.identificador_deducao&#xd;&#xa;				              , c.natureza_receita&#xd;&#xa;				              , c.cod_ctb&#xd;&#xa;				              , LPAD&#x28;c.cod_ctb&#x7c;&#x7c;c.tipo_entr_saida&#x7c;&#x7c;c.tipo_movimentacao&#x7c;&#x7c;c.cod_fonte_recursos&#x7c;&#x7c;&#x27;000&#x27;,17,&#x27;0&#x27;&#x29;  AS cod_ctb_view&#xd;&#xa;				              , c.tipo_aplicacao&#xd;&#xa;				              , c.tipo_conta&#xd;&#xa;				              , c.tipo&#xd;&#xa;				              , tipo_entr_saida&#xd;&#xa;				              , c.tipo_movimentacao&#xd;&#xa;				              , c.cod_fonte_recursos&#xd;&#xa;				              , ABS&#x28;SUM&#x28;c.vlr_receita_cont&#x29;&#x29; AS vlr_receita_cont&#xd;&#xa;				           FROM &#x28; SELECT &#x27;22&#x27;&#x3a;&#x3a;int  AS  tipo_registro&#xd;&#xa;				                       , replace&#x28;pc.cod_estrutural,&#x27;.&#x27;,&#x27;&#x27;&#x29; as cod_reduzido_mov&#xd;&#xa;				                       , CASE WHEN &#x28;substr&#x28;conta_receita.cod_estrutural,1,1&#x29; &#x3d; &#x27;9&#x27;&#x29; THEN&#xd;&#xa;				                          &#x27;1&#x27;&#x3a;&#x3a;INTEGER&#xd;&#xa;				                         ELSE&#xd;&#xa;				                          &#x27;2&#x27;&#x3a;&#x3a;INTEGER&#xd;&#xa;				                         END AS e_deducao_de_receita&#xd;&#xa;				                       , receita_indentificadores_peculiar_receita.cod_identificador as identificador_deducao&#xd;&#xa;				                       , CASE WHEN SUBSTR&#x28;conta_receita.cod_estrutural, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;				                           THEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 2, 8&#x29;&#x3a;&#x3a;integer&#xd;&#xa;				                           ELSE CASE WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;&#x3a;&#x3a;INTEGER &#x3d; 172401&#xd;&#xa;				                                       OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;&#x3a;&#x3a;INTEGER &#x3d; 172199&#xd;&#xa;				                                       OR SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;&#x3a;&#x3a;INTEGER &#x3d; 193199&#xd;&#xa;				                                     THEN RPAD&#x28;SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 6&#x29;, 8, &#x27;0&#x27;&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;			&#xd;&#xa;				                                     ELSE SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 8&#x29;&#x3a;&#x3a;INTEGER&#xd;&#xa;				                                 END&#xd;&#xa;				                           END AS natureza_receita&#xd;&#xa;				                       , SUM&#x28;vl.vl_lancamento&#x29; as vlr_receita_cont&#xd;&#xa;				                       , conta_bancaria.cod_ctb&#xd;&#xa;				                       , conta_bancaria.tipo_aplicacao&#xd;&#xa;				                       , conta_bancaria.tipo_conta&#x3a;&#x3a;VARCHAR&#xd;&#xa;				                       , lo.tipo&#xd;&#xa;				                       , CASE&#xd;&#xa;				                                  WHEN lo.tipo &#x3d; &#x27;A&#x27; AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 1&#x29; &#x3c;&#x3e; &#x27;9&#x27; AND lancamento_receita.estorno &#x3d; false&#xd;&#xa;				                                        AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 4&#x29; &#x3c;&#x3e; &#x27;1325&#x27; THEN &#x27;01&#x27;&#xd;&#xa;				                                  WHEN lo.tipo &#x3d; &#x27;A&#x27; AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 1&#x29;&#x3d; &#x27;9&#x27;&#xd;&#xa;				                                        AND lancamento_receita.estorno &#x3d; false AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 4&#x29; &#x3c;&#x3e; &#x27;1325&#x27;&#xd;&#xa;				                                        AND  &#x28;RDE.vl_estornado IS NULL &#x29; AND &#x28;&#x28;ARR.vl_arrecadacao IS NULL &#x29; OR &#x28;AR.devolucao &#x3d; true&#x29;&#x29; THEN &#x27;02&#x27;&#xd;&#xa;				                                  WHEN lo.tipo &#x3d; &#x27;A&#x27; AND lancamento_receita.estorno &#x3d; true AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 1&#x29; &#x3c;&#x3e; &#x27;9&#x27; THEN &#x27;03&#x27;&#xd;&#xa;				                                  WHEN SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 4&#x29; &#x3d; &#x27;1325&#x27; THEN &#x27;04&#x27;&#xd;&#xa;				                                  WHEN lo.tipo &#x3d; &#x27;A&#x27; AND SUBSTR&#x28;REPLACE&#x28;conta_receita.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 1, 1&#x29; &#x3d; &#x27;9&#x27;&#xd;&#xa;				                                        AND &#x28; &#x28;RDE.vl_estornado IS NOT NULL&#x29; OR &#x28;ARR.vl_arrecadacao IS NOT NULL AND AR.devolucao &#x3d; false&#x29; &#x29; THEN &#x27;16&#x27;&#xd;&#xa;				                              ELSE &#x27;99&#x27;&#xd;&#xa;				                              END AS tipo_entr_saida&#xd;&#xa;				                      , conta_debito_credito.tipo_movimentacao&#xd;&#xa;				                      , plano_recurso.cod_recurso AS cod_fonte_recursos&#xd;&#xa;				                    FROM contabilidade.plano_conta AS pc&#xd;&#xa;				              INNER JOIN contabilidade.plano_analitica AS pa&#xd;&#xa;				                      ON pc.cod_conta &#x3d; pa.cod_conta&#xd;&#xa;				                     AND pc.exercicio &#x3d; pa.exercicio&#xd;&#xa;				              INNER JOIN contabilidade.plano_banco&#xd;&#xa;				                      ON plano_banco.cod_plano &#x3d; pa.cod_plano&#xd;&#xa;				                     AND plano_banco.exercicio &#x3d; pa.exercicio&#xd;&#xa;				               LEFT JOIN tcemg.contasCTB&#x28;stExercicio, reRecPar.ParEntidadeLoop&#x29; as conta_bancaria&#xd;&#xa;				                                           &#x28;  cod_conta                          INTEGER&#xd;&#xa;									                        , tipo_aplicacao                    VARCHAR&#xd;&#xa;									                        , cod_ctb                           INTEGER&#xd;&#xa;									                        , tipo_conta                        INTEGER&#xd;&#xa;									                        , exercicio                         CHAR&#x28;4&#x29;&#xd;&#xa;									                        , conta                             TEXT&#xd;&#xa;				                                            , conta_bancaria                    TEXT&#xd;&#xa;				                                            , conta_corrente                    TEXT&#xd;&#xa;				                                            , cod_orgao                         INTEGER&#xd;&#xa;				                                            , banco                             VARCHAR&#xd;&#xa;				                                            , agencia             		TEXT&#xd;&#xa;				                                            , digito_verificador_agencia        TEXT&#xd;&#xa;				                                            , digito_verificador_conta_bancaria TEXT&#xd;&#xa;				                                            , desc_conta_bancaria               VARCHAR&#xd;&#xa;				                                            --, cod_plano                         INTEGER&#xd;&#xa;				                                           &#x29;&#xd;&#xa;				                      ON conta_bancaria.cod_conta &#x3d; pc.cod_conta&#xd;&#xa;				                     AND conta_bancaria.exercicio &#x3d; pc.exercicio&#xd;&#xa;				              INNER JOIN &#x28;&#xd;&#xa;				                           SELECT cod_plano&#xd;&#xa;				                                , exercicio&#xd;&#xa;				                                , cod_lote&#xd;&#xa;				                                , tipo&#xd;&#xa;				                                , sequencia&#xd;&#xa;				                                , tipo_valor&#xd;&#xa;				                                , cod_entidade&#xd;&#xa;				                                , &#x27;1&#x27;&#x3a;&#x3a;VARCHAR AS tipo_movimentacao&#xd;&#xa;				                             FROM contabilidade.conta_debito&#xd;&#xa;			&#xd;&#xa;				                        UNION ALL&#xd;&#xa;			&#xd;&#xa;				                           SELECT cod_plano&#xd;&#xa;				                                , exercicio&#xd;&#xa;				                                , cod_lote&#xd;&#xa;				                                , tipo&#xd;&#xa;				                                , sequencia&#xd;&#xa;				                                , tipo_valor&#xd;&#xa;				                                , cod_entidade&#xd;&#xa;				                                , &#x27;2&#x27;&#x3a;&#x3a;VARCHAR AS tipo_movimentacao&#xd;&#xa;				                             FROM contabilidade.conta_credito&#xd;&#xa;				                       &#x29; AS conta_debito_credito&#xd;&#xa;				                      ON pa.cod_plano &#x3d; conta_debito_credito.cod_plano&#xd;&#xa;				                     AND pa.exercicio &#x3d; conta_debito_credito.exercicio&#xd;&#xa;				              INNER JOIN contabilidade.valor_lancamento AS vl&#xd;&#xa;				                      ON conta_debito_credito.cod_lote     &#x3d; vl.cod_lote&#xd;&#xa;				                     AND conta_debito_credito.tipo         &#x3d; vl.tipo&#xd;&#xa;				                     AND conta_debito_credito.sequencia    &#x3d; vl.sequencia&#xd;&#xa;				                     AND conta_debito_credito.exercicio    &#x3d; vl.exercicio&#xd;&#xa;				                     AND conta_debito_credito.tipo_valor   &#x3d; vl.tipo_valor&#xd;&#xa;				                     AND conta_debito_credito.cod_entidade &#x3d; vl.cod_entidade&#xd;&#xa;				              INNER JOIN contabilidade.lancamento&#xd;&#xa;				                      ON lancamento.exercicio    &#x3d; vl.exercicio&#xd;&#xa;				                     AND lancamento.cod_entidade &#x3d; vl.cod_entidade&#xd;&#xa;				                     AND lancamento.tipo         &#x3d; vl.tipo&#xd;&#xa;				                     AND lancamento.cod_lote     &#x3d; vl.cod_lote&#xd;&#xa;				                     AND lancamento.sequencia    &#x3d; vl.sequencia&#xd;&#xa;				               LEFT JOIN contabilidade.lancamento_receita&#xd;&#xa;				                      ON lancamento_receita.exercicio    &#x3d; lancamento.exercicio&#xd;&#xa;				                     AND lancamento_receita.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;				                     AND lancamento_receita.tipo         &#x3d; lancamento.tipo&#xd;&#xa;				                     AND lancamento_receita.cod_lote     &#x3d; lancamento.cod_lote&#xd;&#xa;				                     AND lancamento_receita.sequencia    &#x3d; lancamento.sequencia&#xd;&#xa;				              INNER JOIN contabilidade.lote AS lo&#xd;&#xa;				                      ON vl.cod_lote     &#x3d; lo.cod_lote&#xd;&#xa;				                     AND vl.exercicio    &#x3d; lo.exercicio&#xd;&#xa;				                     AND vl.cod_entidade &#x3d; lo.cod_entidade&#xd;&#xa;				                     AND vl.tipo &#x3d; lo.tipo&#xd;&#xa;				               LEFT JOIN orcamento.receita&#xd;&#xa;				                      ON receita.cod_receita &#x3d; lancamento_receita.cod_receita&#xd;&#xa;				                     AND receita.exercicio   &#x3d; lancamento_receita.exercicio&#xd;&#xa;				               LEFT JOIN contabilidade.plano_recurso&#xd;&#xa;				                      ON pa.cod_plano &#x3d; plano_recurso.cod_plano&#xd;&#xa;				                     AND pa.exercicio &#x3d; plano_recurso.exercicio&#xd;&#xa;				               LEFT JOIN orcamento.recurso&#xd;&#xa;				                      ON recurso.exercicio   &#x3d; plano_recurso.exercicio&#xd;&#xa;				                     AND recurso.cod_recurso &#x3d; plano_recurso.cod_recurso&#xd;&#xa;				               LEFT JOIN contabilidade.lancamento_empenho&#xd;&#xa;				                      ON lancamento_empenho.exercicio    &#x3d; lancamento.exercicio&#xd;&#xa;				                     AND lancamento_empenho.tipo         &#x3d; lancamento.tipo&#xd;&#xa;				                     AND lancamento_empenho.cod_entidade &#x3d; lancamento.cod_entidade&#xd;&#xa;				                     AND lancamento_empenho.cod_lote     &#x3d; lancamento.cod_lote&#xd;&#xa;				                     AND lancamento_empenho.sequencia    &#x3d; lancamento.sequencia&#xd;&#xa;				               LEFT JOIN orcamento.conta_receita&#xd;&#xa;				                      ON conta_receita.exercicio &#x3d; receita.exercicio&#xd;&#xa;				                     AND conta_receita.cod_conta &#x3d; receita.cod_conta&#xd;&#xa;				               LEFT JOIN tcemg.receita_indentificadores_peculiar_receita&#xd;&#xa;				                      ON receita_indentificadores_peculiar_receita.exercicio   &#x3d; receita.exercicio&#xd;&#xa;				                     AND receita_indentificadores_peculiar_receita.cod_receita &#x3d; receita.cod_receita&#xd;&#xa;				               LEFT JOIN tesouraria.arrecadacao_receita_dedutora AS RD&#xd;&#xa;				                      ON RD.cod_receita_dedutora &#x3d; lancamento_receita.cod_receita&#xd;&#xa;				                     AND RD.vl_deducao &#x3d; vl.vl_lancamento&#xd;&#xa;				                     AND TO_DATE&#x28;RD.timestamp_arrecadacao&#x3a;&#x3a;VARCHAR,&#x27;yyyy-mm-dd&#x27;&#x29; &#x3d; lo.dt_lote&#xd;&#xa;				               LEFT JOIN tesouraria.arrecadacao_receita_dedutora_estornada AS RDE&#xd;&#xa;				                      ON RDE.cod_receita_dedutora &#x3d; RD.cod_receita_dedutora&#xd;&#xa;				                     AND RDE.cod_arrecadacao &#x3d; RD.cod_arrecadacao&#xd;&#xa;				               LEFT JOIN tesouraria.arrecadacao_receita AS ARR&#xd;&#xa;				                      ON ARR.cod_receita &#x3d; RD.cod_receita_dedutora&#xd;&#xa;				                     AND TO_DATE&#x28;ARR.timestamp_arrecadacao&#x3a;&#x3a;VARCHAR,&#x27;yyyy-mm-dd&#x27;&#x29; &#x3d; lo.dt_lote&#xd;&#xa;				               LEFT JOIN tesouraria.arrecadacao AS AR&#xd;&#xa;				                      ON AR.cod_arrecadacao &#x3d; ARR.cod_arrecadacao&#xd;&#xa;				                     AND AR.timestamp_arrecadacao &#x3d; ARR.timestamp_arrecadacao&#xd;&#xa;				                   WHERE pc.exercicio &#x3d; stExercicio&#xd;&#xa;				                     AND plano_banco.cod_entidade IN &#x28;reRecPar.ParEntidadeLoop&#x3a;&#x3a;int&#x29;&#xd;&#xa;				                     AND lo.dt_lote BETWEEN TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;      --&#x27;01&#x2f;02&#x2f;2015&#x27;   &#x27;28&#x2f;02&#x2f;2015&#x27;&#xd;&#xa;			&#xd;&#xa;				                GROUP BY 2,3,4,5,7,8,9,10,11,12,13&#xd;&#xa;				              &#x29; AS c&#xd;&#xa;				          WHERE tipo_entr_saida &#x21;&#x3d; &#x27;99&#x27;&#xd;&#xa;				       GROUP BY c.tipo_registro&#xd;&#xa;				              , c.cod_ctb&#xd;&#xa;					          , c.tipo_aplicacao&#xd;&#xa;					          , c.tipo_conta&#xd;&#xa;					          , c.e_deducao_de_receita&#xd;&#xa;					          , c.identificador_deducao&#xd;&#xa;					          , c.natureza_receita&#xd;&#xa;					          , c.tipo&#xd;&#xa;				              , tipo_entr_saida&#xd;&#xa;				              , c.tipo_movimentacao&#xd;&#xa;				              , c.cod_fonte_recursos&#xd;&#xa;			&#xd;&#xa;				       ORDER BY c.cod_ctb, c.natureza_receita&#x3b;&#xd;&#xa;				             &#xd;&#xa;    		END LOOP&#x3b;&#xd;&#xa;    		&#xd;&#xa;			       -- &#x2a;&#x2a;&#x2a;&#x2a;&#x2a;     Gera&#xe7;&#xe3;o da sa&#xed;da a partir das tabelas intermedi&#xe1;rias     &#x2a;&#x2a;&#x2a;&#x2a;&#x2a;			&#xd;&#xa;    				with ctb10 as&#xd;&#xa;					&#x28;&#xd;&#xa;						SELECT &#xd;&#xa;								  tipo_registro&#xd;&#xa;								 , ano&#xd;&#xa;								 , mes&#xd;&#xa;								 , cod_ctb&#xd;&#xa;								 , cod_ctb_view&#xd;&#xa;								 , cod_orgao&#xd;&#xa;								 , banco&#xd;&#xa;								 , agencia&#xd;&#xa;								 , digito_verificador_agencia&#xd;&#xa;								 , digito_verificador_conta_bancaria&#xd;&#xa;								 , conta_bancaria&#xd;&#xa;								 , conta_corrente&#xd;&#xa;								 , tipo_conta&#xd;&#xa;								 , tipo_aplicacao&#xd;&#xa;								 , nro_seq_aplicacao&#xd;&#xa;								 , desc_conta_bancaria&#xd;&#xa;								 , conta_convenio&#xd;&#xa;								 , num_convenio&#xd;&#xa;								 , dt_assinatura&#xd;&#xa;						  FROM prestacao_contas.tabctb_10&#xd;&#xa;					&#x29;,&#xd;&#xa;					 ctb20 as&#xd;&#xa;					&#x28;&#xd;&#xa;						SELECT &#xd;&#xa;									  tipo_registro&#xd;&#xa;									, cod_ctb&#xd;&#xa;									, cod_ctb_view&#xd;&#xa;									, tipo_aplicacao&#xd;&#xa;									, tipo_conta&#xd;&#xa;									, cod_orgao&#xd;&#xa;									, cod_fonte_recursos&#xd;&#xa;									, vl_saldo_inicial_fonte&#xd;&#xa;									, vl_saldo_final_fonte&#xd;&#xa;						  FROM 		  prestacao_contas.tabctb_20&#xd;&#xa;					&#x29;,   &#xd;&#xa;					ctb21 as&#xd;&#xa;					&#x28;&#xd;&#xa;						SELECT &#xd;&#xa;							  		  tipo_registro&#xd;&#xa;							  		, cod_reduzido_mov&#xd;&#xa;							  		, cod_orgao&#xd;&#xa;							  		, cod_ctb&#xd;&#xa;							  		, cod_ctb_view&#xd;&#xa;							  		, cod_fonte_recursos&#xd;&#xa;							  		, exercicio&#xd;&#xa;							  		, tipo_movimentacao&#xd;&#xa;							  		, tipo_entr_saida&#xd;&#xa;							  		, cod_ctb_transf&#xd;&#xa;							  		, cod_ctb_transf_view&#xd;&#xa;							  		, cod_fonte_ctb_transf&#xd;&#xa;							  		, tipo_conta&#xd;&#xa;							  		, valor_entr_saida&#xd;&#xa;						FROM   		  prestacao_contas.tabctb_21&#xd;&#xa;					&#x29;,&#xd;&#xa;					 ctb22 as&#xd;&#xa;					&#x28;&#xd;&#xa;						SELECT &#xd;&#xa;									  tipo_registro&#xd;&#xa;									, cod_reduzido_mov&#xd;&#xa;									, e_deducao_de_receita&#xd;&#xa;									, identificador_deducao&#xd;&#xa;									, natureza_receita&#xd;&#xa;									, cod_ctb&#xd;&#xa;									, cod_ctb_view&#xd;&#xa;									, tipo_aplicacao&#xd;&#xa;									, tipo_conta&#xd;&#xa;									, tipo&#xd;&#xa;									, tipo_entr_saida&#xd;&#xa;									, tipo_movimentacao&#xd;&#xa;									, cod_fonte_recursos&#xd;&#xa;									, vlr_receita_cont &#xd;&#xa;						FROM 		  prestacao_contas.tabctb_22&#xd;&#xa;					&#x29;,       &#xd;&#xa;					  ctb_format as&#xd;&#xa;					&#x28;&#xd;&#xa;						select&#xd;&#xa;									tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;									cod_ctb,&#xd;&#xa;							        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_ctb&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					        &#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;banco&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;agencia&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;digito_verificador_agencia&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;conta_bancaria&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;digito_verificador_conta_bancaria&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipo_conta&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipo_aplicacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_seq_aplicacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;substring&#x28;replace&#x28;desc_conta_bancaria&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,50&#x29;,&#x27; &#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;conta_convenio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;num_convenio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_assinatura&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;							as d&#xd;&#xa;						from ctb10&#xd;&#xa;						union all&#xd;&#xa;						select&#xd;&#xa;									tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;									cod_ctb,&#xd;&#xa;							        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_ctb&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_fonte_recursos&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;					&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_saldo_inicial_fonte&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vl_saldo_final_fonte&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;							as d&#xd;&#xa;						from ctb20  &#xd;&#xa;						union all&#xd;&#xa;						select&#xd;&#xa;									tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;									cod_ctb,&#xd;&#xa;							        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_ctb&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;					        &#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_fonte_recursos&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_reduzido_mov&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_movimentacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipo_entr_saida&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;valor_entr_saida&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;					&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_ctb_transf&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_fonte_ctb_transf&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;					&#xd;&#xa;							as d&#xd;&#xa;						from ctb21&#xd;&#xa;						union all&#xd;&#xa;						select&#xd;&#xa;									tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;									cod_ctb,&#xd;&#xa;							        tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_reduzido_mov&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;e_deducao_de_receita&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;identificador_deducao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;natureza_receita&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 8, &#x27;0&#x27;&#x29;&#xd;&#xa;							&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vlr_receita_cont&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;&#xd;&#xa;							as d&#xd;&#xa;						from ctb22   &#xd;&#xa;					&#x29;&#xd;&#xa;					insert into tmp_table_acomp &#x28;arquivo,content&#x29; &#xd;&#xa;					select  &#x27;CTB.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;					from &#xd;&#xa;					&#x28;&#xd;&#xa;						select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from ctb_format order by cod_ctb, tipo_registro&#xd;&#xa;					&#x29; x&#x3b;&#xd;&#xa;					&#xd;&#xa;				    -- &#x2a;&#x2a;&#x2a;&#x2a;&#x2a;     Exclus&#xe3;o das tabelas intermedi&#xe1;rias     &#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#xd;&#xa;					DROP TABLE prestacao_contas.tabctb_10&#x3b;&#xd;&#xa;					DROP TABLE prestacao_contas.tabctb_20&#x3b;&#xd;&#xa;					DROP TABLE prestacao_contas.tabctb_21&#x3b;&#xd;&#xa;					DROP TABLE prestacao_contas.tabctb_22&#x3b;	&#xd;&#xa;    		&#xd;&#xa;	end if&#x3b;			&#xd;&#xa;&#xd;&#xa;    update prestacao_contas.fila_relatorio &#xd;&#xa;    	set &#xd;&#xa;    		  resposta &#x3d; &#x28;select  json_object_agg&#x28;t.arquivo,t.content&#x29; from tmp_table_acomp t&#x29;&#xd;&#xa;      	where id &#x3d; inId&#x3b;&#xd;&#xa;    		&#xd;&#xa;    DROP TABLE tmp_table_acomp&#x3b;&#xd;&#xa;    &#xd;&#xa;    return stResultado&#x3b;&#xd;&#xa;&#xd;&#xa; EXCEPTION  &#xd;&#xa;   	when others then&#xd;&#xa;   	    &#xd;&#xa;	    stError &#x3a;&#x3d; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;SQLErro&#x27;, REPLACE&#x28; SQLERRM, &#x27;&#x22;&#x27;, &#x27;&#x2a;&#x27;&#x29;&#x29;&#x3b;&#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Exercicio&#x27;, COALESCE&#x28;stExercicio&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;&#x29;&#x3b;&#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Mes&#x27;, COALESCE&#x28;stMes&#x3a;&#x3a;text,&#x27;&#x27;&#x29;&#x29;&#x3b;	    &#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Entidade&#x27;, COALESCE&#x28;stEntidade&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;&#x29;&#x3b;	    &#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Dtinicio&#x27;, COALESCE&#x28;stDtinicio&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;&#x29;&#x3b;  &#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Dtfim&#x27;, COALESCE&#x28;stDtfim&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;&#x29;&#x3b;  &#xd;&#xa;   		stResultado &#x3a;&#x3d; &#x27;nok&#x27;&#x3b;&#xd;&#xa;   		&#xd;&#xa;   		stError &#x3a;&#x3d; prestacao_contas.processa_status_erro&#x28;inId, stError&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;   		Return stResultado&#x3b;	    	&#xd;&#xa;  &#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;function&#x24;&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>urbem</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>224</yloc>
    </entry>
    <entry>
      <name>BI_CONTROLE_FUNCOES_GLOBAIS</name>
      <description/>
      <type>JOB</type>
      <specification_method>rep_name</specification_method>
      <job_object_id/>
      <filename/>
      <jobname>BI_CONTROLE_FUNCOES_GLOBAIS</jobname>
      <directory>&#x2f;COMPARTILHADO</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Nothing</loglevel>
      <slave_server_name/>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <expand_remote_job>N</expand_remote_job>
      <create_parent_folder>N</create_parent_folder>
      <pass_export>N</pass_export>
      <parameters>        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>      <set_append_logfile>N</set_append_logfile>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>128</yloc>
    </entry>
  </entries>
  <hops>
    <hop>
      <from>SJ_020_ESS_UPD_STATUS_PROCESSANDO</from>
      <to>SJ_030_ESS_EXEC_FUNCTION</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_030_ESS_EXEC_FUNCTION</from>
      <to>SJ_040_ESS_UPD_STATUS_PRONTO</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_040_ESS_UPD_STATUS_PRONTO</from>
      <to>Success</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_010_ESS_CREATE_SCHEMA_FUNCTION</from>
      <to>SJ_020_ESS_UPD_STATUS_PROCESSANDO</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>BI_CONTROLE_FUNCOES_GLOBAIS</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>BI_CONTROLE_FUNCOES_GLOBAIS</from>
      <to>SJ_010_ESS_CREATE_SCHEMA_FUNCTION</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
  </hops>
  <notepads>
  </notepads>
</job>
