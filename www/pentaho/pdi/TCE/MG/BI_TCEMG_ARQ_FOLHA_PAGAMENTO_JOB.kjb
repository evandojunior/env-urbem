<job>
  <name>BI_TCEMG_ARQ_FOLHA_PAGAMENTO_JOB</name>
  <description/>
  <extended_description/>
  <job_version/>
  <job_status>0</job_status>
  <directory>&#x2f;TCE&#x2f;MG</directory>
  <created_user>-</created_user>
  <created_date>2017&#x2f;04&#x2f;04 14&#x3a;17&#x3a;24.036</created_date>
  <modified_user>-</modified_user>
  <modified_date>2017&#x2f;09&#x2f;12 10&#x3a;18&#x3a;21.201</modified_date>
    <parameters>
      <parameter>
        <name>CLIENTE_ID</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>CLIENTE_NOME</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>CLIENTE_UF</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>DB_HOST_NAME</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>DB_NAME</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>DB_PASSWORD</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>DB_PORT</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>DB_USER_NAME</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>EXERCIO</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>ID</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>JOB_NOME</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>MES</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>PERIODO_FINAL</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>PERIODO_INICIAL</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>REPROC_PRE_BALANCETE_EXERCICIO</name>
        <default_value/>
        <description/>
      </parameter>
    </parameters>
  <connection>
    <name>urbem</name>
    <server>&#x24;&#x7b;DB_HOST_NAME&#x7d;</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>&#x24;&#x7b;DB_NAME&#x7d;</database>
    <port>&#x24;&#x7b;DB_PORT&#x7d;</port>
    <username>&#x24;&#x7b;DB_USER_NAME&#x7d;</username>
    <password>&#x24;&#x7b;DB_PASSWORD&#x7d;</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>&#x24;&#x7b;DB_PORT&#x7d;</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
    <slaveservers>
    </slaveservers>
      <job-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_JOB</id>
          <enabled>Y</enabled>
          <name>ID_JOB</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>JOBNAME</id>
          <enabled>Y</enabled>
          <name>JOBNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>START_JOB_ENTRY</id>
          <enabled>N</enabled>
          <name>START_JOB_ENTRY</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </job-log-table>
      <jobentry-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>JOBNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>JOBENTRYNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>RESULT</id>
          <enabled>Y</enabled>
          <name>RESULT</name>
        </field>
        <field>
          <id>NR_RESULT_ROWS</id>
          <enabled>Y</enabled>
          <name>NR_RESULT_ROWS</name>
        </field>
        <field>
          <id>NR_RESULT_FILES</id>
          <enabled>Y</enabled>
          <name>NR_RESULT_FILES</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>COPY_NR</id>
          <enabled>N</enabled>
          <name>COPY_NR</name>
        </field>
      </jobentry-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
   <pass_batchid>N</pass_batchid>
   <shared_objects_file/>
  <entries>
    <entry>
      <name>START</name>
      <description/>
      <type>SPECIAL</type>
      <start>Y</start>
      <dummy>N</dummy>
      <repeat>N</repeat>
      <schedulerType>1</schedulerType>
      <intervalSeconds>10</intervalSeconds>
      <intervalMinutes>0</intervalMinutes>
      <hour>12</hour>
      <minutes>0</minutes>
      <weekDay>1</weekDay>
      <DayOfMonth>1</DayOfMonth>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>32</yloc>
    </entry>
    <entry>
      <name>Success</name>
      <description/>
      <type>SUCCESS</type>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>512</yloc>
    </entry>
    <entry>
      <name>SJ_020_ESS_UPD_STATUS_PROCESSANDO</name>
      <description/>
      <type>SQL</type>
      <sql>&#x2f;&#x2a;update prestacao_contas.fila_relatorio &#xd;&#xa;set &#xd;&#xa; status &#x3d; &#x27;PROCESSANDO&#x27;&#xd;&#xa;,relatorio_log &#x3d; 	&#x28;	&#xd;&#xa;						select json_agg&#x28;value&#x29; from &#x28;&#xd;&#xa;						select &#x2a; from json_array_elements&#x28;&#x28;select relatorio_log from prestacao_contas.fila_relatorio where id &#x3d; &#x24;&#x7b;ID&#x7d;&#x29;&#x3a;&#x3a;json&#x29; &#xd;&#xa;						union all&#xd;&#xa;						select &#x28;&#x27;&#x7b;&#x22;from&#x22;&#x3a;&#x22;ENVIADO&#x22;,&#x22;to&#x22;&#x3a;&#x22;PROCESSANDO&#x22;,&#x22;at&#x22;&#x3a;&#x22;&#x27; &#x7c;&#x7c; to_char&#x28;now&#x28;&#x29;,&#x27;yyyy-mm-dd HH24&#x3a;MI&#x3a;SS&#x27;&#x29; &#x7c;&#x7c;&#x27;&#x22;,&#x22;message&#x22;&#x3a;null&#x7d;&#x27;&#x29;&#x3a;&#x3a;json&#xd;&#xa;													&#x29; x &#xd;&#xa;					&#x29;&#xd;&#xa;where id &#x3d; &#x24;&#x7b;ID&#x7d;&#x3b;&#x2a;&#x2f;&#xd;&#xa;&#xd;&#xa;SELECT prestacao_contas.processa_status_processando&#x28;&#x24;&#x7b;ID&#x7d;&#x29;&#x3b;&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>urbem</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>320</yloc>
    </entry>
    <entry>
      <name>SJ_030_ESS_EXEC_FUNCTION</name>
      <description/>
      <type>SQL</type>
      <sql>SELECT prestacao_contas.tcemg_sicom_arq_fol_pagto&#x28;&#x24;&#x7b;ID&#x7d;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>urbem</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>384</yloc>
    </entry>
    <entry>
      <name>SJ_040_ESS_UPD_STATUS_PRONTO</name>
      <description/>
      <type>SQL</type>
      <sql>&#x2f;&#x2a;update prestacao_contas.fila_relatorio &#xd;&#xa;set &#xd;&#xa; status &#x3d; &#x27;PRONTO&#x27;&#xd;&#xa;,data_resposta &#x3d; now&#x28;&#x29;&#x3a;&#x3a;timestamp&#x28;0&#x29;&#xd;&#xa;,relatorio_log &#x3d; 	&#x28;	&#xd;&#xa;						select json_agg&#x28;value&#x29; from &#x28;&#xd;&#xa;						select &#x2a; from json_array_elements&#x28;&#x28;select relatorio_log from prestacao_contas.fila_relatorio where id &#x3d; &#x24;&#x7b;ID&#x7d;&#x29;&#x3a;&#x3a;json&#x29; &#xd;&#xa;						union all&#xd;&#xa;						select &#x28;&#x27;&#x7b;&#x22;from&#x22;&#x3a;&#x22;PROCESSANDO&#x22;,&#x22;to&#x22;&#x3a;&#x22;PRONTO&#x22;,&#x22;at&#x22;&#x3a;&#x22;&#x27; &#x7c;&#x7c; to_char&#x28;now&#x28;&#x29;,&#x27;yyyy-mm-dd HH24&#x3a;MI&#x3a;SS&#x27;&#x29; &#x7c;&#x7c;&#x27;&#x22;,&#x22;message&#x22;&#x3a;null&#x7d;&#x27;&#x29;&#x3a;&#x3a;json&#xd;&#xa;													&#x29; x &#xd;&#xa;					&#x29;&#xd;&#xa;where id &#x3d; &#x24;&#x7b;ID&#x7d; and status &#x3d; &#x27;PROCESSANDO&#x27;&#x3b;&#x2a;&#x2f;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;SELECT prestacao_contas.processa_status_pronto&#x28;&#x24;&#x7b;ID&#x7d;&#x29;&#x3b;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>urbem</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>448</yloc>
    </entry>
    <entry>
      <name>SJ_010_ESS_CREATE_SCHEMA_FUNCTION</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;SET search_path &#x3d; &#x27;prestacao_contas&#x27;, pg_catalog&#x3b;&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION prestacao_contas.tcemg_sicom_arq_fol_pagto&#x28;bigint&#x29;&#xd;&#xa; RETURNS text&#xd;&#xa; LANGUAGE plpgsql&#xd;&#xa;AS &#x24;function&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    inId ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stParametros 	VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stExercicio		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stMes			VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stEntidade		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stTipo			VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stPeriodo		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;	&#xd;&#xa;	stDtinicio		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stDtfim			VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stModSicom		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stCodPerMov		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;	&#xd;&#xa;	stArquivos 		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stSql     		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stSql2 			VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa; 	reRegistro      RECORD&#x3b;	&#xd;&#xa; 	stResultado		VARCHAR &#x3a;&#x3d; &#x27;ok&#x27;&#x3b;&#xd;&#xa; 	stError			VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa; 	reRecPar		RECORD&#x3b;&#xd;&#xa; 	stSchemaEntPes	VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa; 	stSchemaEntFol	VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b; 	&#xd;&#xa;	stParEntUnica	VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa; 	&#xd;&#xa;&#xd;&#xa;begin&#xd;&#xa;	&#xd;&#xa;	select &#xd;&#xa;		valor &#xd;&#xa;	into stParametros &#xd;&#xa;	from prestacao_contas.fila_relatorio &#xd;&#xa;	where id &#x3d; inId&#x3b;&#xd;&#xa;	&#xd;&#xa;	stSql &#x3a;&#x3d; &#x27;select &#x2a; from json_to_record&#x28;&#x27;&#x27;&#x27;&#x7c;&#x7c;stParametros&#x7c;&#x7c;&#x27;	&#x27;&#x27;&#x29;  as x&#x28;exercicio int, mes int, entidade text, tipo text, periodo text ,data_inicio text, data_fim text, modulo_sicom text, codpermov text, arquivo text&#x29;&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;	FOR reRegistro IN EXECUTE stSql&#xd;&#xa;    LOOP		&#xd;&#xa;		stExercicio	&#x3a;&#x3d; reRegistro.exercicio&#x3b;&#xd;&#xa;		stMes		&#x3a;&#x3d; reRegistro.mes&#x3b;		&#xd;&#xa;    	stEntidade	&#x3a;&#x3d; reRegistro.entidade&#x3b;&#xd;&#xa;    	stTipo		&#x3a;&#x3d; reRegistro.tipo&#x3b;&#xd;&#xa;    	stPeriodo	&#x3a;&#x3d; reRegistro.periodo&#x3b;    	&#xd;&#xa;		stDtinicio	&#x3a;&#x3d; reRegistro.data_inicio&#x3b;		&#xd;&#xa;		stDtfim		&#x3a;&#x3d; reRegistro.data_fim&#x3b;&#xd;&#xa;		stModSicom	&#x3a;&#x3d; reRegistro.modulo_sicom&#x3b;&#xd;&#xa;		stCodPerMov	&#x3a;&#x3d; reRegistro.codpermov&#x3b;		&#xd;&#xa;		stArquivos 	&#x3a;&#x3d; reRegistro.arquivo&#x3b;&#xd;&#xa;    END LOOP&#x3b;&#xd;&#xa;    &#xd;&#xa;    CREATE TEMPORARY TABLE tmp_table_folpagto &#x28;arquivo varchar&#x28;200&#x29;, content json&#x29;&#x3b;&#xd;&#xa;    &#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;CONSID.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			&#xd;&#xa;			CREATE TABLE prestacao_contas.consid10 &#x28;&#xd;&#xa;						tipo_registro 	int4 NULL,&#xd;&#xa;						nom_arquivo 	varchar NULL,&#xd;&#xa;						consideracoes 	varchar&#x28;3000&#x29; NULL&#xd;&#xa;					&#x29;&#xd;&#xa;					WITH &#x28;&#xd;&#xa;						OIDS&#x3d;FALSE&#xd;&#xa;					&#x29;&#x3b;&#xd;&#xa;		    &#xd;&#xa;&#xd;&#xa;			&#xd;&#xa;			&#xd;&#xa;			FOR reRecPar IN select &#x28;UNNEST&#x28;ARRAY&#x5b;string_to_array&#x28;stEntidade, &#x27;,&#x27;&#x29;&#x5d;&#x29;&#x3a;&#x3a;VARCHAR&#x29; as ParEntidadeLoop&#xd;&#xa;		    LOOP&#xd;&#xa;							&#xd;&#xa;		    				insert into prestacao_contas.consid10&#xd;&#xa;				            SELECT 10 as tipo_registro&#xd;&#xa;				                  , &#x27;FLPGO&#x27; AS nom_arquivo&#xd;&#xa;				                  , CAD.descricao as consideracoes&#xd;&#xa;				              FROM tcemg.consideracao_arquivo&#xd;&#xa;				              JOIN tcemg.consideracao_arquivo_descricao as CAD&#xd;&#xa;				                ON CAD.cod_arquivo &#x3d; consideracao_arquivo.cod_arquivo&#xd;&#xa;				               AND CAD.descricao &#x21;&#x3d; &#x27;&#x27;&#xd;&#xa;				             WHERE CAD.periodo      &#x3d; stPeriodo&#x3a;&#x3a;int                   &#xd;&#xa;				               AND CAD.cod_entidade in  &#x28;reRecPar.ParEntidadeLoop&#x3a;&#x3a;int&#x29;     &#xd;&#xa;				               AND CAD.modulo_sicom &#x3d;  stModSicom                      &#xd;&#xa;				          ORDER BY consideracao_arquivo.cod_arquivo&#x3b;&#xd;&#xa;&#xd;&#xa;    		END LOOP&#x3b;&#xd;&#xa;    		&#xd;&#xa;    		&#xd;&#xa;    		if prestacao_contas.tcemg_sicom_export_folha&#x28;stExercicio, stEntidade&#x29;  &#x3d; &#x27;ok&#x27; then&#xd;&#xa;    		&#xd;&#xa;					&#xd;&#xa;    				with consid10 as&#xd;&#xa;					&#x28;&#xd;&#xa;				    		SELECT 		  tipo_registro&#xd;&#xa;										, nom_arquivo&#xd;&#xa;										, consideracoes&#xd;&#xa;							FROM &#xd;&#xa;										  prestacao_contas.consid10					&#xd;&#xa;					&#x29;,&#xd;&#xa;					 export as&#xd;&#xa;					&#x28;&#xd;&#xa;						SELECT &#xd;&#xa;									  codmunicipio&#xd;&#xa;									, opcaosemestralidade&#xd;&#xa;									, datageracao&#xd;&#xa;									, exercicio&#xd;&#xa;									, cnpjmunicipio&#xd;&#xa;									, codorgao&#xd;&#xa;									, tipoorgao&#xd;&#xa;									, exercicioreferencialoa&#xd;&#xa;									, exercicioinicialppa&#xd;&#xa;									, exerciciofinalppa&#xd;&#xa;									, codcontroleremessa&#xd;&#xa;						FROM &#xd;&#xa;									 prestacao_contas.folpagto_export1&#xd;&#xa;					&#x29;,   &#xd;&#xa;					  consid_format as&#xd;&#xa;					&#x28;&#xd;&#xa;							select&#xd;&#xa;								 		  tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;								 		  tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; trim&#x28;coalesce&#x28;substring&#x28;replace&#x28;nom_arquivo&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,20&#x29;,&#x27; &#x27;&#x29;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; trim&#x28;coalesce&#x28;substring&#x28;replace&#x28;consideracoes&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,4000&#x29;,&#x27; &#x27;&#x29;&#x29;&#xd;&#xa;								  as d								 &#xd;&#xa;							FROM  consid10&#xd;&#xa;							union all&#xd;&#xa;							SELECT &#xd;&#xa;										  &#x27;0&#x27; as tipo_registro,&#xd;&#xa;										  lpad&#x28;coalesce&#x28;codmunicipio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;opcaosemestralidade&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;datageracao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cnpjmunicipio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 14, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipoorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicioreferencialoa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicioinicialppa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exerciciofinalppa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;							  							   &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codcontroleremessa&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;     &#xd;&#xa;								  as d &#xd;&#xa;							FROM  export&#xd;&#xa;					&#x29;&#xd;&#xa;					insert into tmp_table_folpagto &#x28;arquivo,content&#x29; &#xd;&#xa;					select  &#x27;CONSID.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;					from &#xd;&#xa;					&#x28;&#xd;&#xa;						select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from consid_format order by tipo_registro&#xd;&#xa;					&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;			  	    &#xd;&#xa;					DROP TABLE prestacao_contas.consid10 &#x3b;  &#xd;&#xa;					DROP TABLE prestacao_contas.folpagto_export1&#x3b;&#xd;&#xa;&#xd;&#xa;    		end if&#x3b;&#xd;&#xa;    		&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;IDE.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			&#xd;&#xa;			CREATE TABLE prestacao_contas.ide &#x28;&#xd;&#xa;				cnpj_municipio 		 varchar&#x28;14&#x29; NULL,&#xd;&#xa;				cod_municipio 		 int4 		 NULL,&#xd;&#xa;				cod_orgao 			 text 		 NULL,&#xd;&#xa;				tipo_orgao 			 text 		 NULL,&#xd;&#xa;				exercicio_referencia text 		 NULL,&#xd;&#xa;				mes_referencia 		 text 		 NULL,&#xd;&#xa;				data_geracao 		 text 		 NULL,&#xd;&#xa;				cod_remessa 		 text 		 NULL&#xd;&#xa;			&#x29;&#xd;&#xa;			WITH &#x28;&#xd;&#xa;				OIDS&#x3d;FALSE&#xd;&#xa;			&#x29; &#x3b;&#xd;&#xa;		    &#xd;&#xa;&#xd;&#xa;			&#xd;&#xa;			&#xd;&#xa;			FOR reRecPar IN select &#x28;UNNEST&#x28;ARRAY&#x5b;string_to_array&#x28;stEntidade, &#x27;,&#x27;&#x29;&#x5d;&#x29;&#x3a;&#x3a;VARCHAR&#x29; as ParEntidadeLoop&#xd;&#xa;		    LOOP&#xd;&#xa;							&#xd;&#xa;							  insert into prestacao_contas.ide&#xd;&#xa;								SELECT     &#x28;&#xd;&#xa;									              SELECT cnpj&#xd;&#xa;									                FROM sw_cgm_pessoa_juridica&#xd;&#xa;									           LEFT JOIN administracao.configuracao&#xd;&#xa;									                  ON parametro &#x3d; &#x27;cod_entidade_prefeitura&#x27;&#xd;&#xa;									                 AND configuracao.exercicio &#x3d; stExercicio         &#xd;&#xa;									           LEFT JOIN orcamento.entidade&#xd;&#xa;									                  ON cod_entidade&#x3d;configuracao.valor&#x3a;&#x3a;integer&#xd;&#xa;									                 AND entidade.exercicio &#x3d; configuracao.exercicio&#xd;&#xa;									               WHERE sw_cgm_pessoa_juridica.numcgm&#x3d;entidade.numcgm&#xd;&#xa;								           &#x29; AS cnpj_municipio&#xd;&#xa;								         , &#x28; SELECT DISTINCT cod_municipio&#xd;&#xa;								                 FROM tcemg.configurar_ide&#xd;&#xa;								           &#x29; AS cod_municipio&#xd;&#xa;								           , LPAD&#x28;&#x28;&#xd;&#xa;								                   SELECT valor&#xd;&#xa;								                     FROM tcemg.orgao&#xd;&#xa;								               INNER JOIN administracao.configuracao_entidade&#xd;&#xa;								                       ON configuracao_entidade.valor&#x3a;&#x3a;integer &#x3d; orgao.num_orgao&#xd;&#xa;								                    WHERE configuracao_entidade.exercicio   &#x3d; ACE.exercicio&#xd;&#xa;								                      AND configuracao_entidade.cod_entidade &#x3d; ACE.cod_entidade&#xd;&#xa;								                      AND parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;								             	   &#x29;, 2, &#x27;0&#x27;&#xd;&#xa;								             	  &#x29; AS cod_orgao&#xd;&#xa;								           , &#x28;&#xd;&#xa;										              SELECT valor&#xd;&#xa;										                FROM tcemg.orgao&#xd;&#xa;										          INNER JOIN administracao.configuracao_entidade&#xd;&#xa;										                  ON configuracao_entidade.valor&#x3a;&#x3a;integer &#x3d; orgao.num_orgao&#xd;&#xa;										               WHERE configuracao_entidade.exercicio    &#x3d; ACE.exercicio&#xd;&#xa;										                 AND configuracao_entidade.cod_entidade &#x3d; ACE.cod_entidade&#xd;&#xa;										                 AND parametro &#x3d; &#x27;tcemg_tipo_orgao_entidade_sicom&#x27;&#xd;&#xa;								             &#x29; AS tipo_orgao&#xd;&#xa;								           , stExercicio&#x3a;&#x3a;text AS exercicio_referencia           &#xd;&#xa;								           , lpad&#x28;stMes,2,&#x27;0&#x27;&#x29;&#x3a;&#x3a;text AS mes_referencia           &#xd;&#xa;								           , to_char&#x28;CURRENT_DATE&#x3a;&#x3a;timestamp,&#x27;ddmmyyyy&#x27;&#x29; as data_geracao&#xd;&#xa;								           , to_char&#x28;CURRENT_DATE&#x3a;&#x3a;timestamp,&#x27;yyyymmdd&#x27;&#x29;&#x7c;&#x7c;&#x27;&#x27;&#x7c;&#x7c; stExercicio &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; as cod_remessa   &#xd;&#xa;								        FROM administracao.configuracao_entidade AS ACE&#xd;&#xa;								       WHERE ACE.exercicio &#x3d; stExercicio                             &#xd;&#xa;								         AND ACE.cod_entidade IN &#x28;reRecPar.ParEntidadeLoop&#x3a;&#x3a;int&#x29;          &#xd;&#xa;								         AND ACE.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    		END LOOP&#x3b;&#xd;&#xa;    		&#xd;&#xa;    		&#xd;&#xa;    		if prestacao_contas.tcemg_sicom_export_folha&#x28;stExercicio, stEntidade&#x29;  &#x3d; &#x27;ok&#x27; then&#xd;&#xa;    		&#xd;&#xa;					&#xd;&#xa;    				with ide as&#xd;&#xa;					&#x28;&#xd;&#xa;						SELECT 	  cod_municipio&#xd;&#xa;								, cnpj_municipio&#xd;&#xa;								, cod_orgao&#xd;&#xa;								, tipo_orgao&#xd;&#xa;								, exercicio_referencia&#xd;&#xa;								, mes_referencia&#xd;&#xa;								, data_geracao, cod_remessa&#xd;&#xa;						FROM 	  prestacao_contas.ide				&#xd;&#xa;					&#x29;,&#xd;&#xa;					 export as&#xd;&#xa;					&#x28;&#xd;&#xa;						SELECT 		  codmunicipio&#xd;&#xa;									, opcaosemestralidade&#xd;&#xa;									, datageracao&#xd;&#xa;									, exercicio&#xd;&#xa;									, cnpjmunicipio&#xd;&#xa;									, codorgao&#xd;&#xa;									, tipoorgao&#xd;&#xa;									, exercicioreferencialoa&#xd;&#xa;									, exercicioinicialppa&#xd;&#xa;									, exerciciofinalppa&#xd;&#xa;									, codcontroleremessa&#xd;&#xa;						FROM 		  prestacao_contas.folpagto_export1&#xd;&#xa;					&#x29;,   &#xd;&#xa;					  ide_format as&#xd;&#xa;					&#x28;&#xd;&#xa;							select&#xd;&#xa;								 		  cod_municipio&#x3a;&#x3a;varchar,&#xd;&#xa;										  lpad&#x28;coalesce&#x28;cod_municipio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cnpj_municipio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 14, &#x27;0&#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipo_orgao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_referencia&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;mes_referencia&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;								  &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_geracao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_remessa&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;								  as d								 &#xd;&#xa;							FROM  ide&#xd;&#xa;							union all&#xd;&#xa;							SELECT &#xd;&#xa;										  codmunicipio&#x3a;&#x3a;varchar as cod_municipio,&#xd;&#xa;										  lpad&#x28;coalesce&#x28;codmunicipio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;opcaosemestralidade&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;datageracao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cnpjmunicipio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 14, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipoorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicioreferencialoa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicioinicialppa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exerciciofinalppa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;							  							   &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codcontroleremessa&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;     &#xd;&#xa;								  as d &#xd;&#xa;							FROM  export&#xd;&#xa;					&#x29;&#xd;&#xa;					insert into tmp_table_folpagto &#x28;arquivo,content&#x29; &#xd;&#xa;					select  &#x27;IDE.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;					from &#xd;&#xa;					&#x28;&#xd;&#xa;						select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from ide_format order by cod_municipio&#xd;&#xa;					&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;			  	    &#xd;&#xa;					DROP TABLE prestacao_contas.ide&#x3b;  &#xd;&#xa;					DROP TABLE prestacao_contas.folpagto_export1&#x3b;&#xd;&#xa;    		end if&#x3b;&#xd;&#xa;    		&#xd;&#xa;	end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;RESPINF.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			&#xd;&#xa;			CREATE TABLE prestacao_contas.respinf &#x28;&#xd;&#xa;				cpf 		varchar&#x28;11&#x29; NULL,&#xd;&#xa;				dt_inicio 	text 		NULL,&#xd;&#xa;				dt_final 	text 		NULL&#xd;&#xa;			&#x29;&#xd;&#xa;			WITH &#x28;&#xd;&#xa;				OIDS&#x3d;FALSE&#xd;&#xa;			&#x29; &#x3b;&#xd;&#xa;		    &#xd;&#xa;&#xd;&#xa;			&#xd;&#xa;			&#xd;&#xa;			FOR reRecPar IN select &#x28;UNNEST&#x28;ARRAY&#x5b;string_to_array&#x28;stEntidade, &#x27;,&#x27;&#x29;&#x5d;&#x29;&#x3a;&#x3a;VARCHAR&#x29; as ParEntidadeLoop&#xd;&#xa;		    LOOP&#xd;&#xa;							&#xd;&#xa;					        insert into prestacao_contas.respinf&#xd;&#xa;							SELECT&#xd;&#xa;					               sw_cgm_pessoa_fisica.cpf AS cpf&#xd;&#xa;					               , to_date&#x28;stDtinicio,&#x27;dd-mm-yyyy&#x27;&#x29;&#x3a;&#x3a;text AS dt_inicio   &#xd;&#xa;					               , to_date&#x28;stDtfim,&#x27;dd-mm-yyyy&#x27;&#x29;&#x3a;&#x3a;text AS dt_final       &#xd;&#xa;					            FROM tcemg.configuracao_orgao&#xd;&#xa;					      INNER JOIN sw_cgm&#xd;&#xa;					              ON sw_cgm.numcgm &#x3d; configuracao_orgao.num_cgm&#xd;&#xa;					      INNER JOIN sw_cgm_pessoa_fisica&#xd;&#xa;					              ON sw_cgm_pessoa_fisica.numcgm &#x3d; sw_cgm.numcgm&#xd;&#xa;					           WHERE configuracao_orgao.dt_inicio &#x3c;&#x3d; TO_DATE&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;      &#xd;&#xa;					             AND configuracao_orgao.dt_fim &#x3e;&#x3d; TO_DATE&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;      &#xd;&#xa;					             AND configuracao_orgao.exercicio &#x3d; stExercicio                         &#xd;&#xa;					             AND configuracao_orgao.cod_entidade IN &#x28;reRecPar.ParEntidadeLoop&#x3a;&#x3a;int&#x29;      &#xd;&#xa;					             &#xd;&#xa;					             AND configuracao_orgao.tipo_responsavel &#x3d; 5&#x3b;&#xd;&#xa;	             &#xd;&#xa;    		END LOOP&#x3b;&#xd;&#xa;    		&#xd;&#xa;    		&#xd;&#xa;    		if prestacao_contas.tcemg_sicom_export_folha&#x28;stExercicio, stEntidade&#x29;  &#x3d; &#x27;ok&#x27; then&#xd;&#xa;    		&#xd;&#xa;					&#xd;&#xa;    				with respinf as&#xd;&#xa;					&#x28;&#xd;&#xa;						SELECT 	  cpf&#xd;&#xa;								, dt_inicio&#xd;&#xa;								, dt_final&#xd;&#xa;						FROM 	  prestacao_contas.respinf				&#xd;&#xa;					&#x29;,&#xd;&#xa;					 export as&#xd;&#xa;					&#x28;&#xd;&#xa;						SELECT 		  codmunicipio&#xd;&#xa;									, opcaosemestralidade&#xd;&#xa;									, datageracao&#xd;&#xa;									, exercicio&#xd;&#xa;									, cnpjmunicipio&#xd;&#xa;									, codorgao&#xd;&#xa;									, tipoorgao&#xd;&#xa;									, exercicioreferencialoa&#xd;&#xa;									, exercicioinicialppa&#xd;&#xa;									, exerciciofinalppa&#xd;&#xa;									, codcontroleremessa&#xd;&#xa;						FROM 		  prestacao_contas.folpagto_export1&#xd;&#xa;					&#x29;,   &#xd;&#xa;					  respinf_format as&#xd;&#xa;					&#x28;&#xd;&#xa;							select&#xd;&#xa;								 		  &#x27;0&#x27; campo_ordem,&#xd;&#xa;										  lpad&#x28;coalesce&#x28;cpf&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 14, &#x27; &#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_inicio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_final&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;								  &#xd;&#xa;								  as d								 &#xd;&#xa;							FROM  respinf&#xd;&#xa;							union all&#xd;&#xa;							SELECT &#xd;&#xa;										  &#x27;0&#x27; campo_ordem,&#xd;&#xa;										  lpad&#x28;coalesce&#x28;codmunicipio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;opcaosemestralidade&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;datageracao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cnpjmunicipio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 14, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipoorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicioreferencialoa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicioinicialppa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exerciciofinalppa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;							  							   &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codcontroleremessa&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;     &#xd;&#xa;								  as d &#xd;&#xa;							FROM  export&#xd;&#xa;					&#x29;&#xd;&#xa;					insert into tmp_table_folpagto &#x28;arquivo,content&#x29; &#xd;&#xa;					select  &#x27;RESPINF.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;					from &#xd;&#xa;					&#x28;&#xd;&#xa;						select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from respinf_format order by campo_ordem&#xd;&#xa;					&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;			  	    &#xd;&#xa;					DROP TABLE prestacao_contas.respinf&#x3b;  &#xd;&#xa;					DROP TABLE prestacao_contas.folpagto_export1&#x3b;&#xd;&#xa;    		end if&#x3b;&#xd;&#xa;    		&#xd;&#xa;	end if&#x3b;	&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;TEREM.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			&#xd;&#xa;			CREATE TABLE prestacao_contas.terem &#x28;&#xd;&#xa;				tipo_registro int4 NULL,&#xd;&#xa;				vlparateto numeric&#x28;14,2&#x29; NULL,&#xd;&#xa;				tipo_cadastro int4 NULL,&#xd;&#xa;				just_alteracao varchar&#x28;100&#x29; NULL,&#xd;&#xa;				dt_inicial text NULL,&#xd;&#xa;				dt_final text NULL,&#xd;&#xa;				cnpj varchar&#x28;14&#x29; NULL&#xd;&#xa;			&#x29;&#xd;&#xa;			WITH &#x28;&#xd;&#xa;				OIDS&#x3d;FALSE&#xd;&#xa;			&#x29; &#x3b;&#xd;&#xa;		    &#xd;&#xa;&#xd;&#xa;			&#xd;&#xa;			&#xd;&#xa;			FOR reRecPar IN select &#x28;UNNEST&#x28;ARRAY&#x5b;string_to_array&#x28;stEntidade, &#x27;,&#x27;&#x29;&#x5d;&#x29;&#x3a;&#x3a;VARCHAR&#x29; as ParEntidadeLoop&#xd;&#xa;		    LOOP&#xd;&#xa;							&#xd;&#xa;			                insert into prestacao_contas.terem&#xd;&#xa;							SELECT 10 AS tipo_registro&#xd;&#xa;					               , teto_remuneratorio.teto AS vlparateto&#xd;&#xa;					               , CASE WHEN teto_remuneratorio_controle.cod_entidade IS NOT NULL&#xd;&#xa;					                      THEN 2&#xd;&#xa;					                      ELSE 1&#xd;&#xa;					                  END AS tipo_cadastro&#xd;&#xa;					               , teto_remuneratorio.justificativa AS just_alteracao&#xd;&#xa;					               , CASE WHEN teto_remuneratorio_controle.cod_entidade IS NULL&#xd;&#xa;					                        THEN TO_CHAR&#x28;teto_remuneratorio.vigencia,&#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;					                        ELSE &#x27;&#x27;&#xd;&#xa;					                 END AS dt_inicial&#xd;&#xa;					               , CASE WHEN teto_remuneratorio_controle.cod_entidade IS NOT NULL&#xd;&#xa;					                        THEN TO_CHAR&#x28;&#x28;teto_remuneratorio.vigencia-1&#x29;,&#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;					                        ELSE &#x27;&#x27;&#xd;&#xa;					                 END AS dt_final&#xd;&#xa;					               , sw_cgm_pessoa_juridica.cnpj&#xd;&#xa;					            FROM tcemg.teto_remuneratorio&#xd;&#xa;					       LEFT JOIN tcemg.teto_remuneratorio_controle&#xd;&#xa;					              ON teto_remuneratorio_controle.cod_entidade &#x3d; teto_remuneratorio.cod_entidade&#xd;&#xa;					             AND teto_remuneratorio_controle.exercicio &#x3d; teto_remuneratorio.exercicio&#xd;&#xa;					      INNER JOIN administracao.configuracao_entidade&#xd;&#xa;					              ON configuracao_entidade.exercicio &#x3d; teto_remuneratorio.exercicio&#xd;&#xa;					             AND configuracao_entidade.cod_entidade &#x3d; teto_remuneratorio.cod_entidade&#xd;&#xa;					             AND configuracao_entidade.parametro &#x3d; &#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#xd;&#xa;					      INNER JOIN orcamento.entidade&#xd;&#xa;					              ON entidade.cod_entidade &#x3d; configuracao_entidade.cod_entidade&#xd;&#xa;					             AND entidade.exercicio &#x3d; configuracao_entidade.exercicio&#xd;&#xa;					      INNER JOIN sw_cgm_pessoa_juridica&#xd;&#xa;					              ON sw_cgm_pessoa_juridica.numcgm &#x3d; entidade.numcgm&#xd;&#xa;					           WHERE teto_remuneratorio.vigencia &#x3c;&#x3d; last_day&#x28;TO_DATE&#x28;&#x27;01&#x2f;&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#x29;  and   &#xd;&#xa;					                 teto_remuneratorio.vigencia &#x3d; &#x28; SELECT MAX&#x28;teto_remuneratorio.vigencia&#x29;&#xd;&#xa;					                                                   FROM tcemg.teto_remuneratorio&#xd;&#xa;					                                                  WHERE teto_remuneratorio.vigencia &#x3c;&#x3d; last_day&#x28;TO_DATE&#x28;&#x27;01&#x2f;&#x27; &#x7c;&#x7c; lpad&#x28;stMes,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#x29;   &#xd;&#xa;					                                               &#x29;&#xd;&#xa;					        GROUP BY tipo_registro&#xd;&#xa;					               , vlparateto&#xd;&#xa;					               , tipo_cadastro&#xd;&#xa;					               , just_alteracao&#xd;&#xa;					               , dt_inicial&#xd;&#xa;					               , dt_final&#xd;&#xa;					               , cnpj&#x3b;&#xd;&#xa;	             &#xd;&#xa;    		END LOOP&#x3b;&#xd;&#xa;    		&#xd;&#xa;    		&#xd;&#xa;    		if prestacao_contas.tcemg_sicom_export_folha&#x28;stExercicio, stEntidade&#x29;  &#x3d; &#x27;ok&#x27; then&#xd;&#xa;    		&#xd;&#xa;					&#xd;&#xa;    				with terem as&#xd;&#xa;					&#x28;&#xd;&#xa;						SELECT 	  tipo_registro&#xd;&#xa;								, vlparateto&#xd;&#xa;								, tipo_cadastro&#xd;&#xa;								, just_alteracao&#xd;&#xa;								, dt_inicial&#xd;&#xa;								, dt_final&#xd;&#xa;								, cnpj&#xd;&#xa;						FROM 	  prestacao_contas.terem	&#xd;&#xa;					&#x29;,&#xd;&#xa;					 export as&#xd;&#xa;					&#x28;&#xd;&#xa;						SELECT 		  codmunicipio&#xd;&#xa;									, opcaosemestralidade&#xd;&#xa;									, datageracao&#xd;&#xa;									, exercicio&#xd;&#xa;									, cnpjmunicipio&#xd;&#xa;									, codorgao&#xd;&#xa;									, tipoorgao&#xd;&#xa;									, exercicioreferencialoa&#xd;&#xa;									, exercicioinicialppa&#xd;&#xa;									, exerciciofinalppa&#xd;&#xa;									, codcontroleremessa&#xd;&#xa;						FROM 		  prestacao_contas.folpagto_export1&#xd;&#xa;					&#x29;,   &#xd;&#xa;					  terem_format as&#xd;&#xa;					&#x28;&#xd;&#xa;							select&#xd;&#xa;								 		  tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;								 		  tipo_registro&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cnpj&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 14, &#x27; &#x27;&#x29;								 		  &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;vlparateto&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;,&#x27;&#x29;,&#x27;0,00&#x27;&#x29;								  &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_cadastro&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_inicial&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_final&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;	&#xd;&#xa;				 				  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; trim&#x28;coalesce&#x28;substring&#x28;replace&#x28;just_alteracao&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,250&#x29;,&#x27; &#x27;&#x29;&#x29;								  &#xd;&#xa;								  as d								 &#xd;&#xa;							FROM  terem&#xd;&#xa;							union all&#xd;&#xa;							SELECT &#xd;&#xa;										  &#x27;0&#x27; tipo_registro,&#xd;&#xa;										  lpad&#x28;coalesce&#x28;codmunicipio&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 5, &#x27;0&#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;opcaosemestralidade&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;datageracao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cnpjmunicipio&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 14, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;codorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipoorgao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 2, &#x27; &#x27;&#x29; &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicioreferencialoa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicioinicialppa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;&#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exerciciofinalppa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 4, &#x27; &#x27;&#x29;							  							   &#xd;&#xa;								  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;codcontroleremessa&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;     &#xd;&#xa;								  as d &#xd;&#xa;							FROM  export&#xd;&#xa;					&#x29;&#xd;&#xa;					insert into tmp_table_folpagto &#x28;arquivo,content&#x29; &#xd;&#xa;					select  &#x27;TEREM.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;					from &#xd;&#xa;					&#x28;&#xd;&#xa;						select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from terem_format order by tipo_registro&#xd;&#xa;					&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;			  	    &#xd;&#xa;					DROP TABLE prestacao_contas.terem&#x3b;  &#xd;&#xa;					DROP TABLE prestacao_contas.folpagto_export1&#x3b;&#xd;&#xa;    		end if&#x3b;&#xd;&#xa;    		&#xd;&#xa;	end if&#x3b;	&#xd;&#xa;	&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;PESSOA.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;			with pessoa as&#xd;&#xa;			&#x28;&#xd;&#xa; 				SELECT &#x2a; FROM tcemg.folha_pagamento_pessoa&#x28;stExercicio, stMes&#x3a;&#x3a;int&#x29;       &#xd;&#xa;							            AS resultado &#x28;  tipo_registro            integer&#xd;&#xa;							                            ,tipo_documento          integer&#xd;&#xa;							                            ,nro_documento           varchar&#xd;&#xa;							                            ,nome                    varchar&#xd;&#xa;							                            ,ind_sexo                text&#xd;&#xa;							                            ,data_nascimento         text&#xd;&#xa;							                            ,tipo_cadastro           varchar&#xd;&#xa;							                            ,justificativa_alteracao varchar&#xd;&#xa;							                            ,numcgm                  integer&#xd;&#xa;							                        &#x29;&#xd;&#xa;	         &#x29;, &#xd;&#xa;			  pessoa_format as&#xd;&#xa;			&#x28;&#xd;&#xa;				select&#xd;&#xa;							numcgm,&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;							tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_documento, &#x27;0&#x27;&#x29;	&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;nro_documento, &#x27; &#x27;&#x29;&#xd;&#xa;				 	&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; trim&#x28;coalesce&#x28;substring&#x28;replace&#x28;nome&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,120&#x29;,&#x27; &#x27;&#x29;&#x29;					&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;ind_sexo, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_nascimento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_cadastro, &#x27; &#x27;&#x29;&#xd;&#xa;				 	&#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; trim&#x28;coalesce&#x28;substring&#x28;replace&#x28;justificativa_alteracao&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,100&#x29;,&#x27; &#x27;&#x29;&#x29;					&#xd;&#xa;					as d&#xd;&#xa;				from pessoa&#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_folpagto &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;PESSOA.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from pessoa_format order by numcgm, tipo_registro&#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;			&#xd;&#xa;	end if&#x3b;&#xd;&#xa;	&#xd;&#xa;	if strpos&#x28;stArquivos,&#x27;&#x22;FLPGO.csv&#x22;&#x27;&#x29; &#x3e; 0&#xd;&#xa;		then&#xd;&#xa;&#xd;&#xa;				&#xd;&#xa;				CREATE TABLE prestacao_contas.flpgo10 &#x28;&#xd;&#xa;					tipo_registro 						int4 		NULL,&#xd;&#xa;					num_cpf 							varchar&#x28;11&#x29; NULL,&#xd;&#xa;					cod_reduzido_pessoa 				text 		NULL,&#xd;&#xa;					regime 								text 		NULL,&#xd;&#xa;					tipo_pagamento 						text 		NULL,&#xd;&#xa;					situacao_servidor_pensionista 		text 		NULL,&#xd;&#xa;					descricao_situacao 					text 		NULL,&#xd;&#xa;					data_concessao_aposentadoria_pensao text 		NULL,&#xd;&#xa;					nome_cargo 							varchar 	NULL,&#xd;&#xa;					sigla_cargo 						text 		NULL,&#xd;&#xa;					descricao_sigla_cargo 				text 		NULL,&#xd;&#xa;					requisito_cargo 					int4 		NULL,&#xd;&#xa;					indicador_cessao 					text 		NULL,&#xd;&#xa;					nome_lotacao 						varchar 	NULL,&#xd;&#xa;					valor_horas_semanais 				text 		NULL,&#xd;&#xa;					data_efetivacao_exercicio_cargo 	text 		NULL,&#xd;&#xa;					data_exclusao 						text 		NULL,&#xd;&#xa;					valor_remuneracao_bruto 			numeric 	NULL,&#xd;&#xa;					natureza_saldo_liquido 				text 		NULL,&#xd;&#xa;					valor_remuneracao_liquida 			numeric 	NULL,&#xd;&#xa;					valor_obrigacoes 					numeric 	NULL&#xd;&#xa;				&#x29;&#xd;&#xa;				WITH &#x28;&#xd;&#xa;					OIDS&#x3d;FALSE&#xd;&#xa;				&#x29; &#x3b;&#xd;&#xa;				&#xd;&#xa;				CREATE TABLE prestacao_contas.flpgo11 &#x28;&#xd;&#xa;					tipo_registro 		int4 		NULL,&#xd;&#xa;					cod_reduzido_pessoa text 		NULL,&#xd;&#xa;					num_cpf 			varchar&#x28;11&#x29; NULL,&#xd;&#xa;					tipo_remuneracao 	text 		NULL,&#xd;&#xa;					descricao_outros 	varchar 	NULL,&#xd;&#xa;					valor_remuneracao 	numeric 	NULL&#xd;&#xa;				&#x29;&#xd;&#xa;				WITH &#x28;&#xd;&#xa;					OIDS&#x3d;FALSE&#xd;&#xa;				&#x29; &#x3b;&#xd;&#xa;		&#xd;&#xa;				CREATE TABLE prestacao_contas.flpgo12 &#x28;&#xd;&#xa;					tipo_registro 		int4 		NULL,&#xd;&#xa;					cod_reduzido_pessoa text 		NULL,&#xd;&#xa;					num_cpf 			varchar&#x28;11&#x29; NULL,&#xd;&#xa;					tipo_desconto 		int4 		NULL,&#xd;&#xa;					valor_desconto 		numeric 	NULL&#xd;&#xa;				&#x29;&#xd;&#xa;				WITH &#x28;&#xd;&#xa;					OIDS&#x3d;FALSE&#xd;&#xa;				&#x29; &#x3b;&#xd;&#xa;				&#xd;&#xa;				CREATE TABLE prestacao_contas.flpgo_extra &#x28;&#xd;&#xa;					cod_periodo_movimentacao int4 NULL,&#xd;&#xa;					dt_inicial text NULL,&#xd;&#xa;					dt_final text NULL,&#xd;&#xa;					situacao bpchar&#x28;1&#x29; NULL,&#xd;&#xa;					timestamp_situacao text NULL&#xd;&#xa;				&#x29;&#xd;&#xa;				WITH &#x28;&#xd;&#xa;					OIDS&#x3d;FALSE&#xd;&#xa;				&#x29; &#x3b;&#xd;&#xa;				&#xd;&#xa; 				&#xd;&#xa; 			&#xd;&#xa;			FOR reRecPar IN select &#x28;UNNEST&#x28;ARRAY&#x5b;string_to_array&#x28;stEntidade, &#x27;,&#x27;&#x29;&#x5d;&#x29;&#x3a;&#x3a;VARCHAR&#x29; as ParEntidadeLoop&#xd;&#xa;		    LOOP&#xd;&#xa;		    &#xd;&#xa;	    				stSchemaEntPes &#x3a;&#x3d; &#x27;pessoal&#x27; &#x7c;&#x7c; &#x27;_&#x27; &#x7c;&#x7c; reRecPar.ParEntidadeLoop&#x3b;&#xd;&#xa;	    				stSchemaEntFol &#x3a;&#x3d; &#x27;folhapagamento&#x27; &#x7c;&#x7c; &#x27;_&#x27; &#x7c;&#x7c; reRecPar.ParEntidadeLoop&#x3b;&#xd;&#xa;	    				stParEntUnica  &#x3a;&#x3d; &#x27;_&#x27; &#x7c;&#x7c; reRecPar.ParEntidadeLoop&#x3b;&#xd;&#xa;&#xd;&#xa;		    			&#xd;&#xa;		    			if &#x28;select exists &#x28;select &#x2a; from pg_catalog.pg_namespace where nspname &#x3d; stSchemaEntPes&#x29;&#x29; &#x3d; true then&#xd;&#xa;&#xd;&#xa;			    			&#xd;&#xa;							stSql &#x3a;&#x3d; &#x27;insert into prestacao_contas.flpgo10 &#xd;&#xa; 				            SELECT &#x2a;&#xd;&#xa;						              FROM &#x28;&#xd;&#xa;						                     SELECT DISTINCT&#xd;&#xa;						                            10 AS tipo_registro&#xd;&#xa;						                          , sw_cgm_pessoa_fisica.cpf AS num_cpf&#xd;&#xa;						                          , CASE WHEN remuneracoes.tipo_calculo &#x3d; &#x27;&#x27;M&#x27;&#x27; THEN&#xd;&#xa;						                                      contrato.registro&#x7c;&#x7c;&#x27;&#x27;&#x27;&#x27;&#x7c;&#x7c;1&#xd;&#xa;						                                 WHEN remuneracoes.tipo_calculo &#x3d; &#x27;&#x27;D&#x27;&#x27; THEN&#xd;&#xa;						                                      contrato.registro&#x7c;&#x7c;&#x27;&#x27;&#x27;&#x27;&#x7c;&#x7c;2&#xd;&#xa;						                                 WHEN remuneracoes.tipo_calculo &#x3d; &#x27;&#x27;E&#x27;&#x27; THEN&#xd;&#xa;						                                      contrato.registro&#x7c;&#x7c;&#x27;&#x27;&#x27;&#x27;&#x7c;&#x7c;3&#xd;&#xa;						                            END as cod_reduzido_pessoa&#xd;&#xa;						                          , &#x27;&#x27;C&#x27;&#x27; AS regime&#xd;&#xa;						                          , remuneracoes.tipo_calculo as tipo_pagamento&#xd;&#xa;						                          , CASE WHEN aposentadoria.cod_contrato IS NULL THEN&#xd;&#xa;						                                      &#x27;&#x27;A&#x27;&#x27;&#xd;&#xa;						                                 ELSE&#xd;&#xa;						                                      &#x27;&#x27;I&#x27;&#x27;&#xd;&#xa;						                            END AS situacao_servidor_pensionista&#xd;&#xa;						                          , &#x27;&#x27;&#x27;&#x27; as descricao_situacao&#xd;&#xa;						                          , TO_CHAR&#x28;aposentadoria.dt_concessao,&#x27;&#x27;ddmmyyyy&#x27;&#x27;&#x29; as data_concessao_aposentadoria_pensao&#xd;&#xa;						                          , remove_acentos&#x28;cargo.descricao&#x29; as nome_cargo&#xd;&#xa;						                          , SUBSTR&#x28;tcemg_entidade_cargo_servidor.descricao,1,3&#x29; as sigla_cargo&#xd;&#xa;						                          , CASE WHEN tcemg_entidade_cargo_servidor.cod_tipo &#x3d; 8&#xd;&#xa;						                                 THEN SUBSTR&#x28;tcemg_entidade_cargo_servidor.descricao,7&#x29;&#xd;&#xa;						                                 ELSE &#x27;&#x27;&#x27;&#x27;&#xd;&#xa;						                            END AS descricao_sigla_cargo&#xd;&#xa;						                          , COALESCE&#x28;tcemg_entidade_requisitos_cargo.cod_tipo,4&#x29; as requisito_cargo&#xd;&#xa;						                          , CASE WHEN adido_cedido.tipo_cedencia &#x3d; &#x27;&#x27;c&#x27;&#x27; AND indicativo_onus &#x3d; &#x27;&#x27;c&#x27;&#x27;&#xd;&#xa;						                                 THEN &#x27;&#x27;SCO&#x27;&#x27;&#xd;&#xa;						                                 WHEN adido_cedido.tipo_cedencia &#x3d; &#x27;&#x27;c&#x27;&#x27; AND indicativo_onus &#x3d; &#x27;&#x27;e&#x27;&#x27;&#xd;&#xa;						                                 THEN &#x27;&#x27;SCS&#x27;&#x27;&#xd;&#xa;						                                 ELSE &#x27;&#x27;&#x27;&#x27;&#xd;&#xa;						                            END AS indicador_cessao&#xd;&#xa;						                          , orgao_descricao.descricao as nome_lotacao&#xd;&#xa;						                          , LPAD&#x28;ultimo_contrato_servidor_salario.horas_semanais&#x3a;&#x3a;integer&#x3a;&#x3a;text, 2, &#x27;&#x27;0&#x27;&#x27;&#x29; as valor_horas_semanais&#xd;&#xa;						                          , TO_CHAR&#x28;contrato_servidor_funcao.vigencia,&#x27;&#x27;ddmmyyyy&#x27;&#x27;&#x29; as data_efetivacao_exercicio_cargo&#xd;&#xa;						                          , CASE WHEN aposentadoria_encerramento.cod_contrato IS NOT NULL&#xd;&#xa;						                                 THEN TO_CHAR&#x28;aposentadoria_encerramento.dt_encerramento,&#x27;&#x27;ddmmyyyy&#x27;&#x27;&#x29;&#xd;&#xa;						                                 ELSE TO_CHAR&#x28;ultimo_contrato_servidor_caso_causa.dt_rescisao,&#x27;&#x27;ddmmyyyy&#x27;&#x27;&#x29;&#xd;&#xa;						                            END AS data_exclusao&#xd;&#xa;						                          , COALESCE&#x28;remuneracoes.valor,0.00&#x29; as valor_remuneracao_bruto&#xd;&#xa;						                          , CASE WHEN &#x28;remuneracoes.valor - COALESCE&#x28;irrf_previdencia.valor,0.00&#x29;&#x29; &#x3e;&#x3d; 0 THEN&#xd;&#xa;						                                      &#x27;&#x27;C&#x27;&#x27;&#xd;&#xa;						                                 ELSE&#xd;&#xa;						                                      &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                            END as natureza_saldo_liquido&#xd;&#xa;						                          , &#x28;&#x28;remuneracoes.valor - COALESCE&#x28;irrf_previdencia.valor,0.00&#x29;&#x29;&#x29; as valor_remuneracao_liquida&#xd;&#xa;						                          , COALESCE&#x28;irrf_previdencia.valor,0.00&#x29; as valor_obrigacoes&#xd;&#xa;					&#xd;&#xa;						                       FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.contrato&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntFol &#x7c;&#x7c; &#x27;.contrato_servidor_periodo&#xd;&#xa;						                         ON contrato_servidor_periodo.cod_contrato &#x3d; contrato.cod_contrato&#xd;&#xa;						                        AND contrato_servidor_periodo.cod_periodo_movimentacao &#x3d; &#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;       &#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.contrato_servidor&#xd;&#xa;						                         ON contrato_servidor.cod_contrato &#x3d; contrato.cod_contrato&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.servidor_contrato_servidor&#xd;&#xa;						                         ON servidor_contrato_servidor.cod_contrato &#x3d; contrato_servidor.cod_contrato&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.servidor&#xd;&#xa;						                         ON servidor.cod_servidor &#x3d; servidor_contrato_servidor.cod_servidor&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN sw_cgm_pessoa_fisica&#xd;&#xa;						                         ON sw_cgm_pessoa_fisica.numcgm &#x3d; servidor.numcgm&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN ultimo_contrato_servidor_funcao&#x28;&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;, &#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x29; as ultimo_contrato_servidor_funcao    &#xd;&#xa;						                         ON contrato_servidor_periodo.cod_contrato &#x3d; ultimo_contrato_servidor_funcao.cod_contrato&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN &#x28; SELECT contrato_servidor_funcao.&#x2a;&#xd;&#xa;						                                FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.contrato_servidor_funcao&#xd;&#xa;						                          INNER JOIN &#x28; SELECT cod_contrato&#xd;&#xa;						                                            , cod_cargo&#xd;&#xa;						                                            , MAX&#x28;timestamp&#x29; as timestamp&#xd;&#xa;						                                         FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.contrato_servidor_funcao&#xd;&#xa;						                                        WHERE timestamp &#x3c;&#x3d; ultimoTimestampPeriodoMovimentacao&#x28;&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;&#x29;&#x3a;&#x3a;TIMESTAMP   &#xd;&#xa;						                                     GROUP BY 1,2&#xd;&#xa;						                                     &#x29; as max&#xd;&#xa;						                                  ON max.cod_contrato    &#x3d; contrato_servidor_funcao.cod_contrato&#xd;&#xa;						                                 AND max.cod_cargo       &#x3d; contrato_servidor_funcao.cod_cargo&#xd;&#xa;						                                 AND max.timestamp       &#x3d; contrato_servidor_funcao.timestamp&#xd;&#xa;						                            &#x29; as contrato_servidor_funcao&#xd;&#xa;						                         ON contrato_servidor_funcao.cod_contrato &#x3d; ultimo_contrato_servidor_funcao.cod_contrato&#xd;&#xa;						                        AND contrato_servidor_funcao.cod_cargo &#x3d; ultimo_contrato_servidor_funcao.cod_cargo&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.cargo&#xd;&#xa;						                         ON cargo.cod_cargo &#x3d; contrato_servidor_funcao.cod_cargo&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN ultimo_contrato_servidor_sub_divisao_funcao&#x28;&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;, &#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x29; as ultimo_contrato_servidor_sub_divisao_funcao    &#xd;&#xa;						                         ON contrato_servidor_periodo.cod_contrato &#x3d; ultimo_contrato_servidor_sub_divisao_funcao.cod_contrato&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN &#x28; SELECT cargo_sub_divisao.&#x2a;&#xd;&#xa;						                                FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.cargo_sub_divisao&#xd;&#xa;						                          INNER JOIN &#x28; SELECT cargo_sub_divisao.cod_cargo&#xd;&#xa;						                                            , cargo_sub_divisao.cod_sub_divisao&#xd;&#xa;						                                            , max&#x28;cargo_sub_divisao.timestamp&#x29; as timestamp&#xd;&#xa;						                                         FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.cargo_sub_divisao&#xd;&#xa;						                                        WHERE cargo_sub_divisao.timestamp &#x3c;&#x3d; ultimoTimestampPeriodoMovimentacao&#x28;&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;&#x29;&#x3a;&#x3a;TIMESTAMP  &#xd;&#xa;						                                     GROUP BY cod_cargo,cod_sub_divisao&#xd;&#xa;						                                     &#x29; as max_cargo_sub_divisao&#xd;&#xa;						                                  ON cargo_sub_divisao.cod_cargo &#x3d; max_cargo_sub_divisao.cod_cargo&#xd;&#xa;						                                 AND cargo_sub_divisao.cod_sub_divisao &#x3d; max_cargo_sub_divisao.cod_sub_divisao&#xd;&#xa;						                                 AND cargo_sub_divisao.timestamp &#x3d; max_cargo_sub_divisao.timestamp&#xd;&#xa;						                            &#x29; as cargo_sub_divisao&#xd;&#xa;						                         ON cargo_sub_divisao.cod_cargo &#x3d; contrato_servidor_funcao.cod_cargo&#xd;&#xa;						                        AND cargo_sub_divisao.cod_sub_divisao &#x3d; ultimo_contrato_servidor_sub_divisao_funcao.cod_sub_divisao_funcao&#xd;&#xa;					&#xd;&#xa;						                  LEFT JOIN &#x28; SELECT tipo_cargo_servidor.descricao&#xd;&#xa;						                                   , tipo_cargo_servidor.cod_tipo&#xd;&#xa;						                                   , tcemg_entidade_cargo_servidor.cod_cargo&#xd;&#xa;						                                   , tcemg_entidade_cargo_servidor.cod_sub_divisao&#xd;&#xa;						                                FROM &#x27; &#x7c;&#x7c; stSchemaEntFol &#x7c;&#x7c; &#x27;.tcemg_entidade_cargo_servidor&#xd;&#xa;						                          INNER JOIN tcemg.tipo_cargo_servidor&#xd;&#xa;						                                  ON tipo_cargo_servidor.cod_tipo &#x3d; tcemg_entidade_cargo_servidor.cod_tipo&#xd;&#xa;						                          INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.sub_divisao&#xd;&#xa;						                                  ON sub_divisao.cod_sub_divisao &#x3d; tcemg_entidade_cargo_servidor.cod_sub_divisao&#xd;&#xa;						                          INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.cargo&#xd;&#xa;						                                  ON cargo.cod_cargo &#x3d; tcemg_entidade_cargo_servidor.cod_cargo&#xd;&#xa;						                               WHERE tcemg_entidade_cargo_servidor.exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27;   &#xd;&#xa;						                            &#x29; as tcemg_entidade_cargo_servidor&#xd;&#xa;						                         ON tcemg_entidade_cargo_servidor.cod_cargo &#x3d; cargo_sub_divisao.cod_cargo&#xd;&#xa;						                        AND tcemg_entidade_cargo_servidor.cod_sub_divisao &#x3d; cargo_sub_divisao.cod_sub_divisao&#xd;&#xa;					&#xd;&#xa;						                  LEFT JOIN &#x28; SELECT tipo_requisitos_cargo.descricao&#xd;&#xa;						                                   , tcemg_entidade_requisitos_cargo.cod_tipo&#xd;&#xa;						                                   , tcemg_entidade_requisitos_cargo.cod_cargo&#xd;&#xa;						                                FROM &#x27; &#x7c;&#x7c; stSchemaEntFol &#x7c;&#x7c; &#x27;.tcemg_entidade_requisitos_cargo&#xd;&#xa;						                          INNER JOIN tcemg.tipo_requisitos_cargo&#xd;&#xa;						                                  ON tipo_requisitos_cargo.cod_tipo &#x3d; tcemg_entidade_requisitos_cargo.cod_tipo&#xd;&#xa;						                          INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.cargo&#xd;&#xa;						                                  ON cargo.cod_cargo &#x3d; tcemg_entidade_requisitos_cargo.cod_cargo&#xd;&#xa;						                               WHERE tcemg_entidade_requisitos_cargo.exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27;&#xd;&#xa;						                            &#x29; as tcemg_entidade_requisitos_cargo&#xd;&#xa;						                         ON tcemg_entidade_requisitos_cargo.cod_cargo &#x3d; contrato_servidor_funcao.cod_cargo&#xd;&#xa;					&#xd;&#xa;						                  LEFT JOIN &#x28; SELECT aposentadoria.&#x2a;&#xd;&#xa;						                                FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.aposentadoria&#xd;&#xa;						                          INNER JOIN &#x28; SELECT cod_contrato&#xd;&#xa;						                                            , max&#x28;timestamp&#x29; as timestamp&#xd;&#xa;						                                         FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.aposentadoria&#xd;&#xa;						                                        WHERE timestamp &#x3c;&#x3d; ultimoTimestampPeriodoMovimentacao&#x28;&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;&#x29;&#x3a;&#x3a;TIMESTAMP   &#xd;&#xa;						                                     GROUP BY 1&#xd;&#xa;						                                     &#x29; as max&#xd;&#xa;						                                  ON max.cod_contrato    &#x3d; aposentadoria.cod_contrato&#xd;&#xa;						                                 AND max.timestamp       &#x3d; aposentadoria.timestamp&#xd;&#xa;						                            &#x29; AS aposentadoria&#xd;&#xa;						                         ON aposentadoria.cod_contrato &#x3d; contrato_servidor_periodo.cod_contrato&#xd;&#xa;					&#xd;&#xa;						                  LEFT JOIN &#x28;SELECT aposentadoria_encerramento.&#x2a;&#xd;&#xa;						                                FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.aposentadoria_encerramento&#xd;&#xa;						                          INNER JOIN &#x28; SELECT aposentadoria_encerramento.cod_contrato&#xd;&#xa;						                                            , MAX&#x28;aposentadoria_encerramento.timestamp&#x29; as timestamp&#xd;&#xa;						                                         FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.aposentadoria_encerramento&#xd;&#xa;						                                        WHERE timestamp &#x3c;&#x3d; ultimoTimestampPeriodoMovimentacao&#x28;&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;&#x29;&#x3a;&#x3a;TIMESTAMP       &#xd;&#xa;						                                     Group BY 1&#xd;&#xa;						                                     &#x29; as max&#xd;&#xa;						                                  ON max.cod_contrato    &#x3d; aposentadoria_encerramento.cod_contrato&#xd;&#xa;						                                 AND max.timestamp       &#x3d; aposentadoria_encerramento.timestamp&#xd;&#xa;						                            &#x29; as aposentadoria_encerramento&#xd;&#xa;						                         ON aposentadoria_encerramento.cod_contrato &#x3d; aposentadoria.cod_contrato&#xd;&#xa;						                        AND aposentadoria_encerramento.timestamp &#x3d; aposentadoria.timestamp&#xd;&#xa;					&#xd;&#xa;						                  LEFT JOIN &#x28; SELECT adido_cedido.&#x2a;&#xd;&#xa;						                                FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.adido_cedido&#xd;&#xa;						                           LEFT JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.adido_cedido_excluido&#xd;&#xa;						                                  ON adido_cedido_excluido.cod_contrato           &#x3d; adido_cedido.cod_contrato&#xd;&#xa;						                                 AND adido_cedido_excluido.cod_norma              &#x3d; adido_cedido.cod_norma&#xd;&#xa;						                                 AND adido_cedido_excluido.timestamp_cedido_adido &#x3d; adido_cedido.timestamp&#xd;&#xa;						                               WHERE adido_cedido_excluido.cod_contrato IS NOT NULL&#xd;&#xa;						                                 AND adido_cedido.timestamp between &#x27;&#x27;&#x27; &#x7c;&#x7c; stDtinicio &#x7c;&#x7c; &#x27;&#x27;&#x27; AND &#x27;&#x27;&#x27; &#x7c;&#x7c; stDtfim &#x7c;&#x7c; &#x27;&#x27;&#x27;&#xd;&#xa;						                            &#x29; as adido_cedido&#xd;&#xa;						                         ON adido_cedido.cod_contrato &#x3d; contrato_servidor.cod_contrato&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN ultimo_contrato_servidor_orgao&#x28;&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;, &#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x29; as ultimo_contrato_servidor_orgao&#xd;&#xa;						                         ON contrato_servidor.cod_contrato &#x3d; ultimo_contrato_servidor_orgao.cod_contrato&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN &#x28; SELECT orgao_descricao.cod_orgao&#xd;&#xa;						                                   , orgao_descricao.descricao&#xd;&#xa;						                                   , orgao_descricao.timestamp&#xd;&#xa;						                                FROM organograma.orgao_descricao&#xd;&#xa;						                          INNER JOIN &#x28; SELECT cod_orgao&#xd;&#xa;						                                            , MAX&#x28;timestamp&#x29; as timestamp&#xd;&#xa;						                                         FROM organograma.orgao_descricao&#xd;&#xa;						                                        WHERE timestamp &#x3c;&#x3d; ultimoTimestampPeriodoMovimentacao&#x28;&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;&#x29;&#x3a;&#x3a;TIMESTAMP   &#xd;&#xa;						                                     Group BY 1&#xd;&#xa;						                                     &#x29; as max&#xd;&#xa;						                                  ON max.cod_orgao &#x3d; orgao_descricao.cod_orgao&#xd;&#xa;						                                 AND max.timestamp &#x3d; orgao_descricao.timestamp&#xd;&#xa;						                            &#x29; as orgao_descricao&#xd;&#xa;						                         ON orgao_descricao.cod_orgao &#x3d; ultimo_contrato_servidor_orgao.cod_orgao&#xd;&#xa;						                        AND orgao_descricao.timestamp &#x3c;&#x3d; ultimoTimestampPeriodoMovimentacao&#x28;&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;&#x29;&#x3a;&#x3a;TIMESTAMP   &#xd;&#xa;					&#xd;&#xa;						                 LEFT JOIN ultimo_contrato_servidor_salario&#x28;&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;, &#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x29; as ultimo_contrato_servidor_salario   &#xd;&#xa;						                         ON contrato_servidor.cod_contrato &#x3d; ultimo_contrato_servidor_salario.cod_contrato&#xd;&#xa;					&#xd;&#xa;						                  LEFT JOIN ultimo_contrato_servidor_caso_causa&#x28;&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;, &#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x29; as ultimo_contrato_servidor_caso_causa   &#xd;&#xa;						                         ON contrato_servidor.cod_contrato &#x3d; ultimo_contrato_servidor_caso_causa.cod_contrato&#xd;&#xa;						                        AND ultimo_contrato_servidor_caso_causa.dt_rescisao &#x3c;&#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stDtfim &#x7c;&#x7c; &#x27;&#x27;&#x27;                                        &#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN &#x28; SELECT cod_contrato&#xd;&#xa;						                                   , tipo_calculo&#xd;&#xa;						                                   , SUM&#x28;valor&#x29; as valor&#xd;&#xa;						                                FROM &#x28; SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;E&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;0,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;1,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;2,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;D&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;3,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;4,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;						                                          AND desdobramento &#x21;&#x3d; &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;D&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;4,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;						                                          AND desdobramento &#x3d; &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                     &#x29; as retorno&#xd;&#xa;						                            GROUP BY 1,2&#xd;&#xa;						                            &#x29; as remuneracoes&#xd;&#xa;						                         ON remuneracoes.cod_contrato &#x3d; contrato_servidor_periodo.cod_contrato&#xd;&#xa;					&#xd;&#xa;						                  LEFT JOIN &#x28; SELECT cod_contrato&#xd;&#xa;						                                   , tipo_calculo&#xd;&#xa;						                                   , SUM&#x28;valor&#x29; as valor&#xd;&#xa;						                                FROM &#x28; SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;E&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;0,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29;&#xd;&#xa;						                                         WHERE natureza &#x3d;&#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;1,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29;&#xd;&#xa;						                                         WHERE natureza &#x3d;&#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;2,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29;&#xd;&#xa;						                                         WHERE natureza &#x3d;&#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;D&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;3,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29;&#xd;&#xa;						                                         WHERE natureza &#x3d;&#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;4,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29;&#xd;&#xa;						                                         WHERE natureza &#x3d;&#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                          AND desdobramento &#x21;&#x3d; &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;D&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;4,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29;&#xd;&#xa;						                                         WHERE natureza &#x3d;&#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                          AND desdobramento &#x3d; &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                     &#x29; as retorno&#xd;&#xa;						                            GROUP BY 1,2&#xd;&#xa;						                            &#x29; as irrf_previdencia&#xd;&#xa;						                         ON irrf_previdencia.cod_contrato &#x3d; contrato_servidor_periodo.cod_contrato&#xd;&#xa;						                        AND irrf_previdencia.tipo_calculo &#x3d; remuneracoes.tipo_calculo&#xd;&#xa;					&#xd;&#xa;						                      UNION&#xd;&#xa;					&#xd;&#xa;						                     --PENSIONISTA&#xd;&#xa;						                     SELECT 10 as tipo_registro&#xd;&#xa;						                          , sw_cgm_pessoa_fisica.cpf AS num_cpf&#xd;&#xa;						                          , CASE WHEN remuneracoes.tipo_calculo &#x3d; &#x27;&#x27;M&#x27;&#x27; THEN&#xd;&#xa;						                                      contrato.registro&#x7c;&#x7c;&#x27;&#x27;&#x27;&#x27;&#x7c;&#x7c;1&#xd;&#xa;						                                 WHEN remuneracoes.tipo_calculo &#x3d; &#x27;&#x27;D&#x27;&#x27; THEN&#xd;&#xa;						                                      contrato.registro&#x7c;&#x7c;&#x27;&#x27;&#x27;&#x27;&#x7c;&#x7c;2&#xd;&#xa;						                                 WHEN remuneracoes.tipo_calculo &#x3d; &#x27;&#x27;E&#x27;&#x27; THEN&#xd;&#xa;						                                      contrato.registro&#x7c;&#x7c;&#x27;&#x27;&#x27;&#x27;&#x7c;&#x7c;3&#xd;&#xa;						                             END as cod_reduzido_pessoa&#xd;&#xa;						                          , &#x27;&#x27;C&#x27;&#x27; as regime&#xd;&#xa;						                          , remuneracoes.tipo_calculo as tipo_calculo&#xd;&#xa;						                          , &#x27;&#x27;P&#x27;&#x27; as situacao_servidor_pensionista&#xd;&#xa;						                          , &#x27;&#x27;&#x27;&#x27; as descricao_situacao&#xd;&#xa;						                          , TO_CHAR&#x28;contrato_pensionista.dt_inicio_beneficio,&#x27;&#x27;ddmmyyyy&#x27;&#x27;&#x29; as data_concessao_aposentadoria_pensao&#xd;&#xa;						                          , &#x27;&#x27;&#x27;&#x27; as nome_cargo&#xd;&#xa;						                          , &#x27;&#x27;&#x27;&#x27; AS sigla_cargo&#xd;&#xa;						                          , &#x27;&#x27;&#x27;&#x27; AS descricao_sigla_cargo&#xd;&#xa;						                          , NULL as requisito_cargo&#xd;&#xa;						                          , CASE WHEN adido_cedido.tipo_cedencia &#x3d; &#x27;&#x27;c&#x27;&#x27; AND indicativo_onus &#x3d; &#x27;&#x27;c&#x27;&#x27;&#xd;&#xa;						                                 THEN &#x27;&#x27;SCO&#x27;&#x27;&#xd;&#xa;						                                 WHEN adido_cedido.tipo_cedencia &#x3d; &#x27;&#x27;c&#x27;&#x27; AND indicativo_onus &#x3d; &#x27;&#x27;e&#x27;&#x27;&#xd;&#xa;						                                 THEN &#x27;&#x27;SCS&#x27;&#x27;&#xd;&#xa;						                                 ELSE &#x27;&#x27;&#x27;&#x27;&#xd;&#xa;						                             END AS indicador_cessao&#xd;&#xa;						                          , &#x27;&#x27;&#x27;&#x27; as nome_lotacao&#xd;&#xa;						                          , &#x27;&#x27;&#x27;&#x27; as valor_horas_semanais&#xd;&#xa;						                          , &#x27;&#x27;&#x27;&#x27; as data_efetivacao_exercicio_cargo&#xd;&#xa;						                          , TO_CHAR&#x28;contrato_pensionista.dt_encerramento,&#x27;&#x27;ddmmyyyy&#x27;&#x27;&#x29; as data_exclusao&#xd;&#xa;						                          , COALESCE&#x28;remuneracoes.valor,0.00&#x29; as valor_remuneracao_bruto&#xd;&#xa;						                          , CASE WHEN &#x28;remuneracoes.valor - COALESCE&#x28;irrf_previdencia.valor,0.00&#x29;&#x29; &#x3e;&#x3d; 0 THEN&#xd;&#xa;						                                      &#x27;&#x27;C&#x27;&#x27;&#xd;&#xa;						                                 ELSE&#xd;&#xa;						                                      &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                             END as natureza_saldo_liquido&#xd;&#xa;						                          , &#x28;&#x28;remuneracoes.valor - COALESCE&#x28;irrf_previdencia.valor,0.00&#x29;&#x29;&#x29; as valor_remuneracao_liquida&#xd;&#xa;						                          , COALESCE&#x28;irrf_previdencia.valor,0.00&#x29; as valor_obrigacoes&#xd;&#xa;					&#xd;&#xa;						                       FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.contrato_pensionista&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.pensionista&#xd;&#xa;						                         ON contrato_pensionista.cod_pensionista &#x3d; pensionista.cod_pensionista&#xd;&#xa;						                        AND contrato_pensionista.cod_contrato_cedente &#x3d; pensionista.cod_contrato_cedente&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.contrato&#xd;&#xa;						                         ON contrato.cod_contrato &#x3d; contrato_pensionista.cod_contrato&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN sw_cgm&#xd;&#xa;						                         ON sw_cgm.numcgm &#x3d; pensionista.numcgm&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN sw_cgm_pessoa_fisica&#xd;&#xa;						                         ON sw_cgm_pessoa_fisica.numcgm &#x3d; sw_cgm.numcgm&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN ultimo_contrato_servidor_funcao&#x28;&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;, &#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x29; as ultimo_contrato_pensionista_funcao&#xd;&#xa;						                         ON contrato_pensionista.cod_contrato_cedente &#x3d; ultimo_contrato_pensionista_funcao.cod_contrato&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN &#x28; SELECT contrato_servidor_funcao.&#x2a;&#xd;&#xa;						                                FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.contrato_servidor_funcao&#xd;&#xa;						                          INNER JOIN &#x28; SELECT cod_contrato&#xd;&#xa;						                                            , cod_cargo&#xd;&#xa;						                                            , MAX&#x28;timestamp&#x29; as timestamp&#xd;&#xa;						                                         FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.contrato_servidor_funcao&#xd;&#xa;						                                        WHERE timestamp &#x3c;&#x3d; ultimoTimestampPeriodoMovimentacao&#x28;&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;&#x29;&#x3a;&#x3a;TIMESTAMP    &#xd;&#xa;						                                     GROUP BY 1,2&#xd;&#xa;						                                     &#x29; as max&#xd;&#xa;						                                  ON max.cod_contrato    &#x3d; contrato_servidor_funcao.cod_contrato&#xd;&#xa;						                                 AND max.cod_cargo       &#x3d; contrato_servidor_funcao.cod_cargo&#xd;&#xa;						                                 AND max.timestamp       &#x3d; contrato_servidor_funcao.timestamp&#xd;&#xa;						                            &#x29; as contrato_pensionista_funcao&#xd;&#xa;						                         ON contrato_pensionista_funcao.cod_contrato &#x3d; ultimo_contrato_pensionista_funcao.cod_contrato&#xd;&#xa;						                        AND contrato_pensionista_funcao.cod_cargo &#x3d; ultimo_contrato_pensionista_funcao.cod_cargo&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.cargo&#xd;&#xa;						                         ON cargo.cod_cargo &#x3d; contrato_pensionista_funcao.cod_cargo&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN ultimo_contrato_servidor_sub_divisao_funcao&#x28;&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;, &#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x29; as ultimo_contrato_pensionista_sub_divisao_funcao&#xd;&#xa;						                         ON contrato_pensionista.cod_contrato_cedente &#x3d; ultimo_contrato_pensionista_sub_divisao_funcao.cod_contrato&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN &#x28; SELECT cargo_sub_divisao.&#x2a;&#xd;&#xa;						                                FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.cargo_sub_divisao&#xd;&#xa;						                          INNER JOIN &#x28; SELECT cargo_sub_divisao.cod_cargo&#xd;&#xa;						                                            , cargo_sub_divisao.cod_sub_divisao&#xd;&#xa;						                                            , max&#x28;cargo_sub_divisao.timestamp&#x29; as timestamp&#xd;&#xa;						                                         FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.cargo_sub_divisao&#xd;&#xa;						                                        WHERE cargo_sub_divisao.timestamp &#x3c;&#x3d; ultimoTimestampPeriodoMovimentacao&#x28;&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;&#x29;&#x3a;&#x3a;TIMESTAMP   &#xd;&#xa;						                                     GROUP BY cod_cargo,cod_sub_divisao&#xd;&#xa;						                                     &#x29; as max_cargo_sub_divisao&#xd;&#xa;						                                  ON cargo_sub_divisao.cod_cargo &#x3d; max_cargo_sub_divisao.cod_cargo&#xd;&#xa;						                                 AND cargo_sub_divisao.cod_sub_divisao &#x3d; max_cargo_sub_divisao.cod_sub_divisao&#xd;&#xa;						                                 AND cargo_sub_divisao.timestamp &#x3d; max_cargo_sub_divisao.timestamp&#xd;&#xa;						                            &#x29; as cargo_sub_divisao&#xd;&#xa;						                         ON cargo_sub_divisao.cod_cargo &#x3d; contrato_pensionista_funcao.cod_cargo&#xd;&#xa;						                        AND cargo_sub_divisao.cod_sub_divisao &#x3d; ultimo_contrato_pensionista_sub_divisao_funcao.cod_sub_divisao_funcao&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN &#x28; SELECT cod_contrato&#xd;&#xa;						                                   , tipo_calculo&#xd;&#xa;						                                   , SUM&#x28;valor&#x29; as valor&#xd;&#xa;						                                FROM &#x28;&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;E&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;0,&#x27;&#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;1,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;2,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;D&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;3,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;4,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;						                                          AND desdobramento &#x21;&#x3d; &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;D&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;4,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;						                                          AND desdobramento &#x3d; &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                     &#x29; as retorno&#xd;&#xa;						                            GROUP BY 1,2&#xd;&#xa;						                            &#x29; as remuneracoes&#xd;&#xa;						                         ON remuneracoes.cod_contrato &#x3d; contrato_pensionista.cod_contrato&#xd;&#xa;					&#xd;&#xa;						                  LEFT JOIN &#x28; SELECT tipo_cargo_servidor.descricao&#xd;&#xa;						                                   , tcemg_entidade_cargo_servidor.cod_cargo&#xd;&#xa;						                                   , tcemg_entidade_cargo_servidor.cod_sub_divisao&#xd;&#xa;						                                FROM &#x27; &#x7c;&#x7c; stSchemaEntFol &#x7c;&#x7c; &#x27;.tcemg_entidade_cargo_servidor&#xd;&#xa;						                          INNER JOIN tcemg.tipo_cargo_servidor&#xd;&#xa;						                                  ON tipo_cargo_servidor.cod_tipo &#x3d; tcemg_entidade_cargo_servidor.cod_tipo&#xd;&#xa;						                          INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.sub_divisao&#xd;&#xa;						                                  ON sub_divisao.cod_sub_divisao &#x3d; tcemg_entidade_cargo_servidor.cod_sub_divisao&#xd;&#xa;						                          INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.cargo&#xd;&#xa;						                                  ON cargo.cod_cargo &#x3d; tcemg_entidade_cargo_servidor.cod_cargo&#xd;&#xa;						                               WHERE tcemg_entidade_cargo_servidor.exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27;&#xd;&#xa;						                            &#x29; as tcemg_entidade_cargo_pensionista&#xd;&#xa;						                         ON tcemg_entidade_cargo_pensionista.cod_cargo &#x3d; contrato_pensionista_funcao.cod_cargo&#xd;&#xa;						                        AND tcemg_entidade_cargo_pensionista.cod_sub_divisao &#x3d; ultimo_contrato_pensionista_sub_divisao_funcao.cod_sub_divisao_funcao&#xd;&#xa;					&#xd;&#xa;						                  LEFT JOIN &#x28; SELECT tipo_requisitos_cargo.descricao&#xd;&#xa;						                                   , tcemg_entidade_requisitos_cargo.cod_tipo&#xd;&#xa;						                                   , tcemg_entidade_requisitos_cargo.cod_cargo&#xd;&#xa;						                                FROM &#x27; &#x7c;&#x7c; stSchemaEntFol &#x7c;&#x7c; &#x27;.tcemg_entidade_requisitos_cargo&#xd;&#xa;						                          INNER JOIN tcemg.tipo_requisitos_cargo&#xd;&#xa;						                                  ON tipo_requisitos_cargo.cod_tipo &#x3d; tcemg_entidade_requisitos_cargo.cod_tipo&#xd;&#xa;						                          INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.cargo&#xd;&#xa;						                                  ON cargo.cod_cargo &#x3d; tcemg_entidade_requisitos_cargo.cod_cargo&#xd;&#xa;						                               WHERE tcemg_entidade_requisitos_cargo.exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27;&#xd;&#xa;						                            &#x29; as tcemg_entidade_requisitos_cargo&#xd;&#xa;						                         ON tcemg_entidade_requisitos_cargo.cod_cargo &#x3d; contrato_pensionista_funcao.cod_cargo&#xd;&#xa;					&#xd;&#xa;						                  LEFT JOIN &#x28; SELECT adido_cedido.&#x2a;&#xd;&#xa;						                                FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.adido_cedido&#xd;&#xa;						                           LEFT JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.adido_cedido_excluido&#xd;&#xa;						                                  ON adido_cedido_excluido.cod_contrato           &#x3d; adido_cedido.cod_contrato&#xd;&#xa;						                                 AND adido_cedido_excluido.cod_norma              &#x3d; adido_cedido.cod_norma&#xd;&#xa;						                                 AND adido_cedido_excluido.timestamp_cedido_adido &#x3d; adido_cedido.timestamp&#xd;&#xa;						                               WHERE adido_cedido_excluido.cod_contrato IS NOT NULL&#xd;&#xa;						                                 AND adido_cedido.timestamp between &#x27;&#x27;&#x27; &#x7c;&#x7c; stDtinicio &#x7c;&#x7c; &#x27;&#x27;&#x27; AND &#x27;&#x27;&#x27; &#x7c;&#x7c; stDtfim &#x7c;&#x7c; &#x27;&#x27;&#x27; &#xd;&#xa;						                            &#x29; as adido_cedido&#xd;&#xa;						                         ON adido_cedido.cod_contrato &#x3d; contrato_pensionista.cod_contrato&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN ultimo_contrato_pensionista_orgao&#x28;&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;, &#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x29; as ultimo_contrato_pensionista_orgao&#xd;&#xa;						                         ON contrato_pensionista.cod_contrato &#x3d; ultimo_contrato_pensionista_orgao.cod_contrato&#xd;&#xa;					&#xd;&#xa;						                 INNER JOIN &#x28; SELECT orgao_descricao.cod_orgao&#xd;&#xa;						                                   , orgao_descricao.descricao&#xd;&#xa;						                                   , orgao_descricao.timestamp&#xd;&#xa;						                                FROM organograma.orgao_descricao&#xd;&#xa;						                          INNER JOIN &#x28; SELECT cod_orgao&#xd;&#xa;						                                            , MAX&#x28;timestamp&#x29; as timestamp&#xd;&#xa;						                                         FROM organograma.orgao_descricao&#xd;&#xa;						                                        WHERE timestamp &#x3c;&#x3d; ultimoTimestampPeriodoMovimentacao&#x28;&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;&#x29;&#x3a;&#x3a;TIMESTAMP   &#xd;&#xa;						                                     GROUP BY 1&#xd;&#xa;						                                     &#x29; as max&#xd;&#xa;						                                  ON max.cod_orgao &#x3d; orgao_descricao.cod_orgao&#xd;&#xa;						                                 AND max.timestamp &#x3d; orgao_descricao.timestamp&#xd;&#xa;						                            &#x29; as orgao_descricao&#xd;&#xa;						                         ON orgao_descricao.cod_orgao &#x3d; ultimo_contrato_pensionista_orgao.cod_orgao&#xd;&#xa;						                        AND orgao_descricao.timestamp &#x3c;&#x3d; ultimoTimestampPeriodoMovimentacao&#x28;&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;&#x29;&#x3a;&#x3a;TIMESTAMP     &#xd;&#xa;					&#xd;&#xa;						                  LEFT JOIN &#x28; SELECT cod_contrato&#xd;&#xa;						                                   , tipo_calculo&#xd;&#xa;						                                   , SUM&#x28;valor&#x29; as valor&#xd;&#xa;						                                FROM &#x28; SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;E&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;0,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29;&#xd;&#xa;						                                         WHERE natureza &#x3d;&#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;1,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29;&#xd;&#xa;						                                         WHERE natureza &#x3d;&#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;2,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29;&#xd;&#xa;						                                         WHERE natureza &#x3d;&#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;D&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;3,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29;&#xd;&#xa;						                                         WHERE natureza &#x3d;&#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;4,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29;&#xd;&#xa;						                                         WHERE natureza &#x3d;&#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                          AND desdobramento &#x21;&#x3d; &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                        UNION&#xd;&#xa;						                                       SELECT &#x2a;&#xd;&#xa;						                                            , &#x27;&#x27;D&#x27;&#x27; as tipo_calculo&#xd;&#xa;						                                         FROM recuperarEventosCalculados&#x28;4,&#x27; &#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;,0,0,&#x27;&#x27;&#x27; &#x7c;&#x7c; stParEntUnica &#x7c;&#x7c; &#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29;&#xd;&#xa;						                                         WHERE natureza &#x3d;&#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                          AND desdobramento &#x3d; &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;						                                     &#x29; as retorno&#xd;&#xa;						                            GROUP BY 1,2&#xd;&#xa;						                            &#x29; as irrf_previdencia&#xd;&#xa;						                         ON irrf_previdencia.cod_contrato &#x3d; contrato_pensionista.cod_contrato&#xd;&#xa;						                        AND irrf_previdencia.tipo_calculo &#x3d; remuneracoes.tipo_calculo&#xd;&#xa;						                   &#x29; as resultado&#x27;&#x3b;&#xd;&#xa;						                   execute stSql&#x3b;&#xd;&#xa;						                   &#xd;&#xa;&#xd;&#xa;			    			&#xd;&#xa;							stSql &#x3a;&#x3d; &#x27;insert into prestacao_contas.flpgo11&#xd;&#xa;				            SELECT &#x2a;&#xd;&#xa;					              FROM &#x28;&#xd;&#xa;					                     SELECT tipo_registro&#xd;&#xa;					                          , cod_reduzido_pessoa&#xd;&#xa;					                          , num_cpf&#xd;&#xa;					                          , LPAD&#x28;tipo_remuneracao&#x3a;&#x3a;varchar,2,&#x27;&#x27;0&#x27;&#x27;&#x29; as tipo_remuneracao&#xd;&#xa;					                          , descricao_outros&#xd;&#xa;					                          , SUM&#x28;valor_remuneracao&#x29; as valor_remuneracao&#xd;&#xa;					                          &#xd;&#xa;					                       FROM &#x28; SELECT DISTINCT&#xd;&#xa;					                                     11 as tipo_registro&#xd;&#xa;					                                   , CASE WHEN remuneracoes.tipo_calculo &#x3d; &#x27;&#x27;M&#x27;&#x27; THEN&#xd;&#xa;					                                               contrato.registro&#x7c;&#x7c;&#x27;&#x27;&#x27;&#x27;&#x7c;&#x7c;1&#xd;&#xa;					                                          WHEN remuneracoes.tipo_calculo &#x3d; &#x27;&#x27;D&#x27;&#x27; THEN&#xd;&#xa;					                                               contrato.registro&#x7c;&#x7c;&#x27;&#x27;&#x27;&#x27;&#x7c;&#x7c;2&#xd;&#xa;					                                          WHEN remuneracoes.tipo_calculo &#x3d; &#x27;&#x27;E&#x27;&#x27; THEN&#xd;&#xa;					                                               contrato.registro&#x7c;&#x7c;&#x27;&#x27;&#x27;&#x27;&#x7c;&#x7c;3&#xd;&#xa;					                                     END as cod_reduzido_pessoa&#xd;&#xa;					                                   , sw_cgm_pessoa_fisica.cpf AS num_cpf&#xd;&#xa;					                                   , tcemg_entidade_remuneracao.cod_tipo as tipo_remuneracao&#xd;&#xa;					                                   , CASE WHEN tcemg_entidade_remuneracao.cod_tipo &#x3d; 99 OR tcemg_entidade_remuneracao.cod_tipo &#x3d; 09&#xd;&#xa;					                                          THEN remuneracoes.descricao&#xd;&#xa;					                                          ELSE &#x27;&#x27;&#x27;&#x27;&#xd;&#xa;					                                     END AS descricao_outros&#xd;&#xa;					                                   , COALESCE&#x28;remuneracoes.valor,0.00&#x29; as valor_remuneracao&#xd;&#xa;					                                   ,remuneracoes.cod_evento&#xd;&#xa;				&#xd;&#xa;					                                FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.contrato&#xd;&#xa;				&#xd;&#xa;					                          INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntFol &#x7c;&#x7c; &#x27;.contrato_servidor_periodo&#xd;&#xa;					                                  ON contrato_servidor_periodo.cod_contrato &#x3d; contrato.cod_contrato&#xd;&#xa;					                                 AND contrato_servidor_periodo.cod_periodo_movimentacao &#x3d; &#x27; &#x7c;&#x7c; stCodPerMov&#x3a;&#x3a;int &#x7c;&#x7c; &#x27;&#xd;&#xa;				&#xd;&#xa;					                          INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.contrato_servidor&#xd;&#xa;					                                  ON contrato_servidor.cod_contrato &#x3d; contrato.cod_contrato&#xd;&#xa;				&#xd;&#xa;					                          INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.servidor_contrato_servidor&#xd;&#xa;					                                  ON servidor_contrato_servidor.cod_contrato &#x3d; contrato_servidor.cod_contrato&#xd;&#xa;				&#xd;&#xa;					                          INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.servidor&#xd;&#xa;					                                  ON servidor.cod_servidor &#x3d; servidor_contrato_servidor.cod_servidor&#xd;&#xa;				&#xd;&#xa;					                          INNER JOIN sw_cgm_pessoa_fisica&#xd;&#xa;					                                  ON sw_cgm_pessoa_fisica.numcgm &#x3d; servidor.numcgm&#xd;&#xa;				&#xd;&#xa;					                          INNER JOIN &#x28; SELECT cod_contrato&#xd;&#xa;					                                            , tipo_calculo&#xd;&#xa;					                                            , cod_evento&#xd;&#xa;					                                            , descricao&#xd;&#xa;					                                            , SUM&#x28;valor&#x29; as valor&#xd;&#xa;					                                         FROM &#x28; SELECT &#x2a;&#xd;&#xa;					                                                     , &#x27;&#x27;E&#x27;&#x27; as tipo_calculo&#xd;&#xa;					                                                  FROM recuperarEventosCalculados&#x28;0,&#x27;&#x27;&#x27;&#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x27;&#x27;,0,0,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;					                                                 UNION&#xd;&#xa;					                                                SELECT &#x2a;&#xd;&#xa;					                                                     , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;					                                                  FROM recuperarEventosCalculados&#x28;1,&#x27;&#x27;&#x27;&#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x27;&#x27;,0,0,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;					                                                 UNION&#xd;&#xa;					                                                SELECT &#x2a;&#xd;&#xa;					                                                     , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;					                                                  FROM recuperarEventosCalculados&#x28;2,&#x27;&#x27;&#x27;&#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x27;&#x27;,0,0,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;					                                                 UNION&#xd;&#xa;					                                                SELECT &#x2a;&#xd;&#xa;					                                                     , &#x27;&#x27;D&#x27;&#x27; as tipo_calculo&#xd;&#xa;					                                                  FROM recuperarEventosCalculados&#x28;3,&#x27;&#x27;&#x27;&#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x27;&#x27;,0,0,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;					                                                 UNION&#xd;&#xa;					                                                SELECT &#x2a;&#xd;&#xa;					                                                     , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;					                                                  FROM recuperarEventosCalculados&#x28;4,&#x27;&#x27;&#x27;&#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x27;&#x27;,0,0,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;					                                                   AND desdobramento &#x21;&#x3d; &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;					                                                 UNION&#xd;&#xa;					                                                SELECT &#x2a;&#xd;&#xa;					                                                     , &#x27;&#x27;D&#x27;&#x27; as tipo_calculo&#xd;&#xa;					                                                  FROM recuperarEventosCalculados&#x28;4,&#x27;&#x27;&#x27;&#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x27;&#x27;,0,0,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;					                                                   AND desdobramento &#x3d; &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;					                                              &#x29; as retorno&#xd;&#xa;					                                     GROUP BY 1,2,3,4&#xd;&#xa;					                                     &#x29; as remuneracoes&#xd;&#xa;					                                  ON remuneracoes.cod_contrato &#x3d; contrato_servidor_periodo.cod_contrato&#xd;&#xa;				&#xd;&#xa;					                           LEFT JOIN &#x27; &#x7c;&#x7c; stSchemaEntFol &#x7c;&#x7c; &#x27;.tcemg_entidade_remuneracao&#xd;&#xa;					                                  ON tcemg_entidade_remuneracao.cod_evento &#x3d; remuneracoes.cod_evento&#xd;&#xa;					                                 AND tcemg_entidade_remuneracao.exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27;&#xd;&#xa;					                            &#x29; as servidor&#xd;&#xa;					                   GROUP BY 1,2,3,4,5&#xd;&#xa;				&#xd;&#xa;					                      UNION ALL&#xd;&#xa;				&#xd;&#xa;					                     SELECT tipo_registro&#xd;&#xa;					                          , cod_reduzido_pessoa&#xd;&#xa;					                          , num_cpf&#xd;&#xa;					                          , LPAD&#x28;tipo_remuneracao&#x3a;&#x3a;varchar,2,&#x27;&#x27;0&#x27;&#x27;&#x29; as tipo_remuneracao&#xd;&#xa;					                          , descricao_outros&#xd;&#xa;					                          , SUM&#x28;valor_remuneracao&#x29; as valor_remuneracao&#xd;&#xa;					                       FROM &#x28; SELECT DISTINCT&#xd;&#xa;					                                     11 as tipo_registro&#xd;&#xa;					                                   , CASE WHEN remuneracoes.tipo_calculo &#x3d; &#x27;&#x27;M&#x27;&#x27; THEN&#xd;&#xa;					                                               contrato.registro&#x7c;&#x7c;&#x27;&#x27;&#x27;&#x27;&#x7c;&#x7c;1&#xd;&#xa;					                                          WHEN remuneracoes.tipo_calculo &#x3d; &#x27;&#x27;D&#x27;&#x27; THEN&#xd;&#xa;					                                               contrato.registro&#x7c;&#x7c;&#x27;&#x27;&#x27;&#x27;&#x7c;&#x7c;2&#xd;&#xa;					                                          WHEN remuneracoes.tipo_calculo &#x3d; &#x27;&#x27;E&#x27;&#x27; THEN&#xd;&#xa;					                                               contrato.registro&#x7c;&#x7c;&#x27;&#x27;&#x27;&#x27;&#x7c;&#x7c;3&#xd;&#xa;					                                     END as cod_reduzido_pessoa&#xd;&#xa;					                                   , sw_cgm_pessoa_fisica.cpf AS num_cpf&#xd;&#xa;					                                   , 02 as tipo_remuneracao&#xd;&#xa;					                                   , &#x27;&#x27;&#x27;&#x27; AS descricao_outros&#xd;&#xa;					                                   , COALESCE&#x28;remuneracoes.valor,0.00&#x29; as valor_remuneracao&#xd;&#xa;					                                   ,remuneracoes.cod_evento&#xd;&#xa;				&#xd;&#xa;					                                FROM &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.contrato_pensionista&#xd;&#xa;				&#xd;&#xa;					                          INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.pensionista&#xd;&#xa;					                                  ON contrato_pensionista.cod_pensionista &#x3d; pensionista.cod_pensionista&#xd;&#xa;					                                 AND contrato_pensionista.cod_contrato_cedente &#x3d; pensionista.cod_contrato_cedente&#xd;&#xa;				&#xd;&#xa;					                          INNER JOIN &#x27; &#x7c;&#x7c; stSchemaEntPes &#x7c;&#x7c; &#x27;.contrato&#xd;&#xa;					                                  ON contrato.cod_contrato &#x3d; contrato_pensionista.cod_contrato&#xd;&#xa;				&#xd;&#xa;					                          INNER JOIN sw_cgm&#xd;&#xa;					                                  ON sw_cgm.numcgm &#x3d; pensionista.numcgm&#xd;&#xa;				&#xd;&#xa;					                          INNER JOIN sw_cgm_pessoa_fisica&#xd;&#xa;					                                  ON sw_cgm_pessoa_fisica.numcgm &#x3d; sw_cgm.numcgm&#xd;&#xa;				&#xd;&#xa;					                          INNER JOIN &#x28; SELECT cod_contrato&#xd;&#xa;					                                            , tipo_calculo&#xd;&#xa;					                                            , cod_evento&#xd;&#xa;					                                            , descricao&#xd;&#xa;					                                            , SUM&#x28;valor&#x29; as valor&#xd;&#xa;					                                         FROM &#x28; SELECT &#x2a;&#xd;&#xa;					                                                     , &#x27;&#x27;E&#x27;&#x27; as tipo_calculo&#xd;&#xa;					                                                  FROM recuperarEventosCalculados&#x28;0,&#x27;&#x27;&#x27;&#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x27;&#x27;,0,0,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;					                                                 UNION&#xd;&#xa;					                                                SELECT &#x2a;&#xd;&#xa;					                                                     , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;					                                                  FROM recuperarEventosCalculados&#x28;1,&#x27;&#x27;&#x27;&#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x27;&#x27;,0,0,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;					                                                 UNION&#xd;&#xa;					                                                SELECT &#x2a;&#xd;&#xa;					                                                     , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;					                                                  FROM recuperarEventosCalculados&#x28;2,&#x27;&#x27;&#x27;&#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x27;&#x27;,0,0,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;					                                                 UNION&#xd;&#xa;					                                                SELECT &#x2a;&#xd;&#xa;					                                                     , &#x27;&#x27;D&#x27;&#x27; as tipo_calculo&#xd;&#xa;					                                                  FROM recuperarEventosCalculados&#x28;3,&#x27;&#x27;&#x27;&#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x27;&#x27;,0,0,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;					                                                 UNION&#xd;&#xa;					                                                SELECT &#x2a;&#xd;&#xa;					                                                     , &#x27;&#x27;M&#x27;&#x27; as tipo_calculo&#xd;&#xa;					                                                  FROM recuperarEventosCalculados&#x28;4,&#x27;&#x27;&#x27;&#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x27;&#x27;,0,0,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;					                                                   AND desdobramento &#x21;&#x3d; &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;					                                                 UNION&#xd;&#xa;					                                                SELECT &#x2a;&#xd;&#xa;					                                                     , &#x27;&#x27;D&#x27;&#x27; as tipo_calculo&#xd;&#xa;					                                                  FROM recuperarEventosCalculados&#x28;4,&#x27;&#x27;&#x27;&#x7c;&#x7c; stCodPerMov &#x7c;&#x7c; &#x27;&#x27;&#x27;,0,0,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; WHERE natureza &#x3d;&#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;					                                                   AND desdobramento &#x3d; &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;					                                              &#x29; as retorno&#xd;&#xa;					                                     GROUP BY 1,2,3,4&#xd;&#xa;					                                     &#x29; as remuneracoes&#xd;&#xa;					                                  ON remuneracoes.cod_contrato &#x3d; contrato_pensionista.cod_contrato&#xd;&#xa;					                            &#x29; as pensionistas&#xd;&#xa;					                   GROUP BY 1,2,3,4,5&#xd;&#xa;					                   &#x29; as resultado&#xd;&#xa;					          ORDER BY tipo_remuneracao&#x3a;&#x3a;INTEGER&#x27;&#x3b;	&#xd;&#xa;						      execute stSql&#x3b;&#xd;&#xa;						      &#xd;&#xa;						      &#xd;&#xa;			    			&#xd;&#xa;							insert into prestacao_contas.flpgo12&#xd;&#xa;		                    SELECT &#x2a;&#xd;&#xa;		                    FROM tcemg.arquivo_folhapagamento_12&#x28;  stCodPerMov, &#x27;_&#x27; &#x7c;&#x7c; reRecPar.ParEntidadeLoop, reRecPar.ParEntidadeLoop&#x3a;&#x3a;int, stMes, stExercicio&#x29;    &#xd;&#xa;		                    AS retorno &#x28;&#xd;&#xa;		                         tipo_registro          INTEGER&#xd;&#xa;		                        ,cod_reduzido_pessoa    TEXT&#xd;&#xa;		                        ,num_cpf                VARCHAR&#x28;11&#x29;&#xd;&#xa;		                        ,tipo_desconto          INTEGER&#xd;&#xa;		                        ,valor_desconto         NUMERIC&#xd;&#xa;		                    &#x29;&#xd;&#xa;		                    ORDER BY cod_reduzido_pessoa&#x3b;&#xd;&#xa;&#xd;&#xa;						                   &#xd;&#xa;			    			&#xd;&#xa;			    			stSql &#x3a;&#x3d; &#x27;insert into prestacao_contas.flpgo_extra		                    &#xd;&#xa;		                    SELECT&#xd;&#xa;								   FPM.cod_periodo_movimentacao,&#xd;&#xa;								   to_char&#x28;FPM.dt_inicial, &#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29; as dt_inicial,&#xd;&#xa;								   to_char&#x28;FPM.dt_final, &#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29; as dt_final,&#xd;&#xa;								   FPMS.situacao,&#xd;&#xa;								   to_char&#x28;FPMS.timestamp, &#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29; as timestamp_situacao&#xd;&#xa;								 FROM&#xd;&#xa;								     folhapagamento.periodo_movimentacao FPM,&#xd;&#xa;								     folhapagamento.periodo_movimentacao_situacao FPMS,&#xd;&#xa;								     &#x28;SELECT&#xd;&#xa;								         cod_periodo_movimentacao,&#xd;&#xa;								         MAX&#x28;timestamp&#x29; as timestamp&#xd;&#xa;								     FROM folhapagamento.periodo_movimentacao_situacao&#xd;&#xa;								     GROUP BY cod_periodo_movimentacao&#x29; as MAX_FPMS&#xd;&#xa;								 WHERE FPM.cod_periodo_movimentacao &#x3d; FPMS.cod_periodo_movimentacao&#xd;&#xa;								 AND   FPM.cod_periodo_movimentacao &#x3d; MAX_FPMS.cod_periodo_movimentacao&#xd;&#xa;								 AND   FPMS.timestamp               &#x3d; MAX_FPMS.timestamp&#xd;&#xa;								 AND dt_final BETWEEN TO_DATE&#x28;&#x27;&#x27;&#x27; &#x7c;&#x7c; stDtinicio &#x7c;&#x7c; &#x27;&#x27;&#x27;, &#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29; and TO_DATE&#x28; &#x27;&#x27;&#x27; &#x7c;&#x7c; stDtfim &#x7c;&#x7c; &#x27;&#x27;&#x27;, &#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29;&#x27;&#x3b;&#xd;&#xa;						    execute stSql&#x3b;&#xd;&#xa;&#xd;&#xa;		                end if&#x3b;&#xd;&#xa;&#xd;&#xa;    		END LOOP&#x3b;&#xd;&#xa;    		&#xd;&#xa;			with flpgo10 as&#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT    tipo_registro&#xd;&#xa;						, num_cpf&#xd;&#xa;						, cod_reduzido_pessoa&#xd;&#xa;						, regime&#xd;&#xa;						, tipo_pagamento&#xd;&#xa;						, situacao_servidor_pensionista&#xd;&#xa;						, descricao_situacao&#xd;&#xa;						, data_concessao_aposentadoria_pensao&#xd;&#xa;						, nome_cargo&#xd;&#xa;						, sigla_cargo&#xd;&#xa;						, descricao_sigla_cargo&#xd;&#xa;						, requisito_cargo&#xd;&#xa;						, indicador_cessao&#xd;&#xa;						, nome_lotacao&#xd;&#xa;						, valor_horas_semanais&#xd;&#xa;						, data_efetivacao_exercicio_cargo&#xd;&#xa;						, data_exclusao&#xd;&#xa;						, valor_remuneracao_bruto&#xd;&#xa;						, natureza_saldo_liquido&#xd;&#xa;						, valor_remuneracao_liquida&#xd;&#xa;						, valor_obrigacoes&#xd;&#xa;				FROM 	  prestacao_contas.flpgo10					&#xd;&#xa;			&#x29;,&#xd;&#xa;			flpgo11 as&#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT    tipo_registro&#xd;&#xa;						, cod_reduzido_pessoa&#xd;&#xa;						, num_cpf&#xd;&#xa;						, tipo_remuneracao&#xd;&#xa;						, descricao_outros&#xd;&#xa;						, valor_remuneracao&#xd;&#xa;				FROM 	  prestacao_contas.flpgo11&#xd;&#xa;			&#x29;,  &#xd;&#xa;			flpgo12 as&#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT 	  tipo_registro&#xd;&#xa;						, cod_reduzido_pessoa&#xd;&#xa;						, num_cpf, tipo_desconto&#xd;&#xa;						, valor_desconto&#xd;&#xa;				FROM 	  prestacao_contas.flpgo12&#xd;&#xa;			&#x29;, &#xd;&#xa;			flpgoExtra as&#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT    cod_periodo_movimentacao&#xd;&#xa;						, dt_inicial&#xd;&#xa;						, dt_final&#xd;&#xa;						, situacao&#xd;&#xa;						, timestamp_situacao&#xd;&#xa;				FROM 	  prestacao_contas.flpgo_extra&#xd;&#xa;			&#x29;,       &#xd;&#xa;			flpgo_format as&#xd;&#xa;			&#x28;&#xd;&#xa;					select&#xd;&#xa;						 		  tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;						 		  tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;num_cpf&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 14, &#x27; &#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_reduzido_pessoa&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;regime&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_pagamento&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;situacao_servidor_pensionista&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;								  &#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; trim&#x28;coalesce&#x28;substring&#x28;replace&#x28;descricao_situacao&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,150&#x29;,&#x27; &#x27;&#x29;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_concessao_aposentadoria_pensao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; trim&#x28;coalesce&#x28;substring&#x28;replace&#x28;nome_cargo&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,120&#x29;,&#x27; &#x27;&#x29;&#x29;						  &#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;sigla_cargo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;,3, &#x27;0&#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; trim&#x28;coalesce&#x28;substring&#x28;replace&#x28;descricao_sigla_cargo&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,150&#x29;,&#x27; &#x27;&#x29;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;requisito_cargo&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;indicador_cessao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; trim&#x28;coalesce&#x28;substring&#x28;replace&#x28;nome_lotacao&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,250&#x29;,&#x27; &#x27;&#x29;&#x29;						  &#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;valor_horas_semanais&#x3a;&#x3a;varchar,&#x27;0,00&#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_efetivacao_exercicio_cargo&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;data_exclusao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;valor_remuneracao_bruto&#x3a;&#x3a;varchar,&#x27;0,00&#x27;&#x29;								  &#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;natureza_saldo_liquido&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;valor_remuneracao_liquida&#x3a;&#x3a;varchar,&#x27;0,00&#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;valor_obrigacoes&#x3a;&#x3a;varchar,&#x27;0,00&#x27;&#x29;								  &#xd;&#xa;						  as d								 &#xd;&#xa;					FROM  flpgo10  &#xd;&#xa;					union all&#xd;&#xa;					select&#xd;&#xa;						 		  tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;						 		  tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;num_cpf&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 14, &#x27; &#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_reduzido_pessoa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;			&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_remuneracao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; trim&#x28;coalesce&#x28;substring&#x28;replace&#x28;descricao_outros&#x3a;&#x3a;varchar,&#x27;&#x3b;&#x27;,&#x27;&#x7c;&#x27;&#x29;,1,150&#x29;,&#x27; &#x27;&#x29;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;valor_remuneracao&#x3a;&#x3a;varchar,&#x27;0,00&#x27;&#x29;&#xd;&#xa;						  as d								 &#xd;&#xa;					FROM  flpgo11&#xd;&#xa;					union all &#xd;&#xa;					select&#xd;&#xa;						 		  tipo_registro&#x3a;&#x3a;varchar,&#xd;&#xa;						 		  tipo_registro&#x3a;&#x3a;varchar&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;num_cpf&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;, 14, &#x27; &#x27;&#x29;						 		  &#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_reduzido_pessoa&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;			&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;tipo_desconto&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;valor_desconto&#x3a;&#x3a;varchar,&#x27;0,00&#x27;&#x29;&#xd;&#xa;						  as d								 &#xd;&#xa;					FROM  flpgo12   &#xd;&#xa;					union all&#xd;&#xa;					SELECT &#xd;&#xa;								  &#x27;90&#x27; as tipo_registro,&#xd;&#xa;						 		  &#x27;90&#x27; &#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;cod_periodo_movimentacao&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28; replace&#x28;coalesce&#x28;replace&#x28;dt_inicial&#x3a;&#x3a;varchar,&#x27;&#x2f;&#x27;,&#x27;&#x27;&#x29;, &#x27; &#x27;&#x29;, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;						  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; lpad&#x28;coalesce&#x28;replace&#x28;dt_final&#x3a;&#x3a;varchar,&#x27;&#x2f;&#x27;,&#x27;&#x27;&#x29;, &#x27; &#x27;&#x29;, 8, &#x27; &#x27;&#x29;&#xd;&#xa;					 	  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;situacao&#x3a;&#x3a;varchar, &#x27; &#x27;&#x29;&#xd;&#xa;					 	  &#x7c;&#x7c;&#x27;&#x3b;&#x27;&#x7c;&#x7c; coalesce&#x28;replace&#x28;timestamp_situacao&#x3a;&#x3a;varchar,&#x27;&#x2f;&#x27;,&#x27;&#x27;&#x29;, &#x27; &#x27;&#x29;    &#xd;&#xa;						  as d &#xd;&#xa;					FROM  flpgoExtra       &#xd;&#xa;			&#x29;&#xd;&#xa;			insert into tmp_table_folpagto &#x28;arquivo,content&#x29; &#xd;&#xa;			select  &#x27;FLPGO.csv&#x27;, json_agg&#x28;d&#x29;&#xd;&#xa;			from &#xd;&#xa;			&#x28;&#xd;&#xa;				select regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;regexp_replace&#x28;  d  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;,&#x27;&#x5e;&#x3b;&#x27;,&#x27; &#x3b;&#x27;&#x29;,&#x27;&#x3b;&#x3b;&#x27;,&#x27;&#x3b; &#x3b;&#x27;,&#x27;g&#x27;&#x29;,&#x27;&#x3b;&#x24;&#x27;,&#x27;&#x3b; &#x27;&#x29; as d from flpgo_format &#xd;&#xa;			&#x29; x&#x3b;&#xd;&#xa;&#xd;&#xa;			DROP TABLE prestacao_contas.flpgo10&#x3b;&#xd;&#xa;			DROP TABLE prestacao_contas.flpgo11&#x3b;&#xd;&#xa;			DROP TABLE prestacao_contas.flpgo12&#x3b;  &#xd;&#xa;			DROP TABLE prestacao_contas.flpgo_extra&#x3b;  &#xd;&#xa;    		&#xd;&#xa;	end if&#x3b;&#xd;&#xa;	&#xd;&#xa;	update prestacao_contas.fila_relatorio &#xd;&#xa;	set &#xd;&#xa;		  resposta &#x3d; &#x28;select  json_object_agg&#x28;t.arquivo,t.content&#x29; from tmp_table_folpagto t&#x29;&#xd;&#xa;  	where id &#x3d; inId&#x3b;&#xd;&#xa;	&#xd;&#xa;	&#xd;&#xa;    DROP TABLE tmp_table_folpagto&#x3b;&#xd;&#xa;    &#xd;&#xa;    return stResultado&#x3b;&#xd;&#xa;&#xd;&#xa; EXCEPTION  &#xd;&#xa;   	when others then&#xd;&#xa;   	    &#xd;&#xa;	    stError &#x3a;&#x3d; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;SQLErro&#x27;, REPLACE&#x28; SQLERRM, &#x27;&#x22;&#x27;, &#x27;&#x2a;&#x27;&#x29;&#x29;&#x3b;&#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Exercicio&#x27;, COALESCE&#x28;stExercicio&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;&#x29;&#x3b;&#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Mes&#x27;, COALESCE&#x28;stMes&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;&#x29;&#x3b;	    &#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Entidade&#x27;, COALESCE&#x28;stEntidade&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;&#x29;&#x3b;&#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Periodo&#x27;, COALESCE&#x28;stPeriodo&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;&#x29;&#x3b;&#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;ModuloSicom&#x27;, COALESCE&#x28;stModSicom&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;&#x29;&#x3b;&#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;CodPerMov&#x27;, COALESCE&#x28;stCodPerMov&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;&#x29;&#x3b;	    &#xd;&#xa;   		stResultado &#x3a;&#x3d; &#x27;nok&#x27;&#x3b;&#xd;&#xa;   		&#xd;&#xa;   		stError &#x3a;&#x3d; prestacao_contas.processa_status_erro&#x28;inId, stError&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;   		Return stResultado&#x3b;	    	&#xd;&#xa;    &#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;function&#x24;&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>urbem</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>256</yloc>
    </entry>
    <entry>
      <name>BI_CONTROLE_FUNCOES_GLOBAIS</name>
      <description/>
      <type>JOB</type>
      <specification_method>rep_name</specification_method>
      <job_object_id/>
      <filename/>
      <jobname>BI_CONTROLE_FUNCOES_GLOBAIS</jobname>
      <directory>&#x2f;COMPARTILHADO</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Nothing</loglevel>
      <slave_server_name/>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <expand_remote_job>N</expand_remote_job>
      <create_parent_folder>N</create_parent_folder>
      <pass_export>N</pass_export>
      <parameters>        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>      <set_append_logfile>N</set_append_logfile>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>128</yloc>
    </entry>
    <entry>
      <name>SJ_009_ESS_CREATE_SCHEMA_FUNCTION</name>
      <description/>
      <type>SQL</type>
      <sql>--&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#xd;&#xa;--&#x2a;&#x2a; FUN&#xc7;&#xc3;O DE APOIO &#x28;GEN&#xc9;RICA&#x29;  &#x2a;&#x2a;&#xd;&#xa;--&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#xd;&#xa;&#xd;&#xa;SET search_path &#x3d; &#x27;prestacao_contas&#x27;, pg_catalog&#x3b;&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION prestacao_contas.tcemg_sicom_export_folha&#x28;character varying, character varying&#x29;&#xd;&#xa; RETURNS text&#xd;&#xa; LANGUAGE plpgsql&#xd;&#xa;AS &#x24;function&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    inExercicio ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    inEntidade ALIAS FOR &#x24;2&#x3b;    &#xd;&#xa; 	stResultado		VARCHAR &#x3a;&#x3d; &#x27;ok&#x27;&#x3b;&#xd;&#xa; 	stError			VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;begin&#xd;&#xa;	&#xd;&#xa;    	--&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;  tabelas intermedi&#xe1;rias  &#x28;no final elas s&#xe3;o exclu&#xed;das&#x29; &#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#xd;&#xa;	    CREATE TABLE prestacao_contas.folpagto_export1 &#x28;&#xd;&#xa;					codmunicipio 			int4 		NULL,&#xd;&#xa;					opcaosemestralidade 	int4 		NULL,&#xd;&#xa;					datageracao 			text 		NULL,&#xd;&#xa;					exercicio 				bpchar&#x28;4&#x29; 	NULL,&#xd;&#xa;					cnpjmunicipio 			varchar&#x28;14&#x29; NULL,&#xd;&#xa;					codorgao 				text 		NULL,&#xd;&#xa;					tipoorgao 				int4 		NULL,&#xd;&#xa;					exercicioreferencialoa 	bpchar 		NULL,&#xd;&#xa;					exercicioinicialppa 	bpchar&#x28;4&#x29; 	NULL,&#xd;&#xa;					exerciciofinalppa 		bpchar&#x28;4&#x29; 	NULL,&#xd;&#xa;					codcontroleremessa 		text 		NULL&#xd;&#xa;		&#x29;&#xd;&#xa;		WITH &#x28;&#xd;&#xa;			OIDS&#x3d;FALSE&#xd;&#xa;		&#x29; &#x3b;&#xd;&#xa;		--&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#xd;&#xa;    &#xd;&#xa;	    if strpos&#x28;inEntidade,&#x27;,&#x27;&#x29; &#x3e; 0 then   --significa que tem mais que uma entidade&#xd;&#xa;	    			  insert into prestacao_contas.folpagto_export1&#xd;&#xa;		              SELECT configurar_ide.cod_municipio AS codmunicipio&#xd;&#xa;		                   , configurar_ide.opcao_semestralidade AS opcaosemestralidade&#xd;&#xa;		                   , TO_CHAR&#x28;NOW&#x28;&#x29;,&#x27;ddmmyyyy&#x27;&#x29; AS datageracao&#xd;&#xa;		                   , configurar_ide.exercicio&#xd;&#xa;		                   , tabela.cnpj AS cnpjmunicipio&#xd;&#xa;		                   , tabela.cod_orgao AS codorgao&#xd;&#xa;		                   , tabela.tipo_orgao AS tipoorgao&#xd;&#xa;		                   , tabela.exercicio_loa AS exercicioreferencialoa&#xd;&#xa;		                   , &#x28;SELECT ano_inicio from ppa.ppa WHERE inExercicio between ano_inicio AND ano_final&#x29; AS exercicioinicialppa    --&#x27;2016&#x27;&#xd;&#xa;		                   , &#x28;SELECT ano_final from ppa.ppa WHERE inExercicio between ano_inicio AND ano_final&#x29; AS exerciciofinalppa       --&#x27;2016&#x27;&#xd;&#xa;		                   , TO_CHAR&#x28;NOW&#x28;&#x29;,&#x27;yyyymmdd&#x27;&#x29;&#x7c;&#x7c; inExercicio &#x7c;&#x7c;&#x27;&#x27; AS codcontroleremessa      --&#x27;2016&#x27;&#xd;&#xa;		                FROM tcemg.configurar_ide&#xd;&#xa;		          INNER JOIN &#x28;&#xd;&#xa;		                      SELECT sw_cgm_pessoa_juridica.cnpj&#xd;&#xa;		                           , config_entidade.valor AS cod_orgao&#xd;&#xa;		                           , 2 AS tipo_orgao&#xd;&#xa;		                           , entidade.exercicio&#xd;&#xa;		                           , CASE WHEN entidade.cod_entidade &#x3d; &#x28;SELECT valor  FROM administracao.configuracao WHERE parametro &#x3d; &#x27;cod_entidade_prefeitura&#x27; AND exercicio &#x3d; inExercicio&#x29;&#x3a;&#x3a;integer    --&#x27;2016&#x27;&#xd;&#xa;		                                  THEN &#x28;SELECT configuracao_loa.exercicio&#xd;&#xa;		                                          FROM normas.norma&#xd;&#xa;		                                    INNER JOIN tcemg.configuracao_loa&#xd;&#xa;		                                            ON configuracao_loa.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;		                                         WHERE configuracao_loa.exercicio &#x3d; entidade.exercicio&#x29;&#xd;&#xa;		                                  ELSE &#x27;&#x27;&#xd;&#xa;		                              END AS exercicio_loa&#xd;&#xa;		                        FROM sw_cgm_pessoa_juridica&#xd;&#xa;		                  INNER JOIN orcamento.entidade&#xd;&#xa;		                          ON entidade.numcgm &#x3d; sw_cgm_pessoa_juridica.numcgm&#xd;&#xa;		                  INNER JOIN &#x28;&#xd;&#xa;		                              SELECT valor&#xd;&#xa;		                                   , cod_entidade&#xd;&#xa;		                                   , exercicio&#xd;&#xa;		                                FROM administracao.configuracao_entidade&#xd;&#xa;		                               WHERE parametro &#x3d; &#x27;tcemg_tipo_orgao_entidade_sicom&#x27;&#xd;&#xa;		                             &#x29; AS config_entidade&#xd;&#xa;		                          ON config_entidade.exercicio &#x3d; entidade.exercicio&#xd;&#xa;		                         AND config_entidade.cod_entidade &#x3d; entidade.cod_entidade&#xd;&#xa;							   ----&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;    s&#xf3; o muda entre uma e outra query &#xe9; a clausula where&#xd;&#xa;		                       WHERE entidade.cod_entidade &#x3d; &#x28;SELECT valor&#xd;&#xa;		                                                        FROM administracao.configuracao&#xd;&#xa;		                                                       WHERE parametro &#x3d; &#x27;cod_entidade_prefeitura&#x27;&#xd;&#xa;		                                                         AND exercicio &#x3d; inExercicio         --&#x27;2016&#x27;&#xd;&#xa;		                                                     &#x29;&#x3a;&#x3a;integer&#xd;&#xa;		               &#x29; as tabela&#xd;&#xa;		               		  ----&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a; &#xd;&#xa;		                   ON tabela.exercicio &#x3d; configurar_ide.exercicio&#xd;&#xa;		                WHERE configurar_ide.exercicio &#x3d; inExercicio&#x3b;      --&#x27;2016&#x27;    &#xd;&#xa;	    &#xd;&#xa;	    else   --significa que tem apenas uma entidade&#xd;&#xa;	    &#xd;&#xa;	    			insert into prestacao_contas.folpagto_export1&#xd;&#xa;			    	SELECT configurar_ide.cod_municipio AS codmunicipio&#xd;&#xa;		                   , configurar_ide.opcao_semestralidade AS opcaosemestralidade&#xd;&#xa;		                   , TO_CHAR&#x28;NOW&#x28;&#x29;,&#x27;ddmmyyyy&#x27;&#x29; AS datageracao&#xd;&#xa;		                   , configurar_ide.exercicio&#xd;&#xa;		                   , tabela.cnpj AS cnpjmunicipio&#xd;&#xa;		                   , tabela.cod_orgao AS codorgao&#xd;&#xa;		                   , tabela.tipo_orgao AS tipoorgao&#xd;&#xa;		                   , tabela.exercicio_loa AS exercicioreferencialoa&#xd;&#xa;		                   , &#x28;SELECT ano_inicio from ppa.ppa WHERE inExercicio between ano_inicio AND ano_final&#x29; AS exercicioinicialppa    --&#x27;2016&#x27;&#xd;&#xa;		                   , &#x28;SELECT ano_final from ppa.ppa WHERE inExercicio between ano_inicio AND ano_final&#x29; AS exerciciofinalppa       --&#x27;2016&#x27;&#xd;&#xa;		                   , TO_CHAR&#x28;NOW&#x28;&#x29;,&#x27;yyyymmdd&#x27;&#x29;&#x7c;&#x7c; inExercicio &#x7c;&#x7c;&#x27;&#x27; AS codcontroleremessa               --&#x27;2016&#xd;&#xa;		                FROM tcemg.configurar_ide&#xd;&#xa;		          INNER JOIN &#x28;&#xd;&#xa;		                      SELECT sw_cgm_pessoa_juridica.cnpj&#xd;&#xa;		                           , config_entidade.valor AS cod_orgao&#xd;&#xa;		                           , 2 AS tipo_orgao&#xd;&#xa;		                           , entidade.exercicio&#xd;&#xa;		                           , CASE WHEN entidade.cod_entidade &#x3d; &#x28;SELECT valor&#xd;&#xa;		                                                                  FROM administracao.configuracao&#xd;&#xa;		                                                                 WHERE parametro &#x3d; &#x27;cod_entidade_prefeitura&#x27;&#xd;&#xa;		                                                                   AND exercicio &#x3d; inExercicio            --&#x27;2016&#x27;&#xd;&#xa;		                                                               &#x29;&#x3a;&#x3a;integer&#xd;&#xa;		                                  THEN &#x28;SELECT configuracao_loa.exercicio&#xd;&#xa;		                                          FROM normas.norma&#xd;&#xa;		                                    INNER JOIN tcemg.configuracao_loa&#xd;&#xa;		                                            ON configuracao_loa.cod_norma &#x3d; norma.cod_norma&#xd;&#xa;		                                         WHERE configuracao_loa.exercicio &#x3d; entidade.exercicio&#x29;&#xd;&#xa;		                                  ELSE &#x27;&#x27;&#xd;&#xa;		                              END AS exercicio_loa&#xd;&#xa;		                        FROM sw_cgm_pessoa_juridica&#xd;&#xa;		                  INNER JOIN orcamento.entidade&#xd;&#xa;		                          ON entidade.numcgm &#x3d; sw_cgm_pessoa_juridica.numcgm&#xd;&#xa;		                  INNER JOIN &#x28;&#xd;&#xa;		                              SELECT valor&#xd;&#xa;		                                   , cod_entidade&#xd;&#xa;		                                   , exercicio&#xd;&#xa;		                                FROM administracao.configuracao_entidade&#xd;&#xa;		                               WHERE parametro &#x3d; &#x27;tcemg_tipo_orgao_entidade_sicom&#x27;&#xd;&#xa;		                             &#x29; AS config_entidade&#xd;&#xa;		                          ON config_entidade.exercicio &#x3d; entidade.exercicio&#xd;&#xa;		                         AND config_entidade.cod_entidade &#x3d; entidade.cod_entidade&#xd;&#xa;					----&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;    s&#xf3; o muda entre uma e outra query &#xe9; a clausula where&#xd;&#xa;		        	WHERE entidade.cod_entidade IN &#x28;inEntidade&#x3a;&#x3a;int&#x29;   &#x29; as tabela       --&#x28;2&#x29;&#xd;&#xa;		        	----&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#x2a;&#xd;&#xa;		                   ON tabela.exercicio &#x3d; configurar_ide.exercicio&#xd;&#xa;		                WHERE configurar_ide.exercicio &#x3d; inExercicio&#x3b;   --&#x27;2016&#x27;&#xd;&#xa;		                &#xd;&#xa;	    end if&#x3b;&#xd;&#xa;	    &#xd;&#xa;	    return stResultado&#x3b;&#xd;&#xa;&#xd;&#xa; EXCEPTION  &#xd;&#xa;   	when others then&#xd;&#xa;   	    &#xd;&#xa;	    stError &#x3a;&#x3d; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;SQLErro&#x27;, REPLACE&#x28; SQLERRM, &#x27;&#x22;&#x27;, &#x27;&#x2a;&#x27;&#x29;&#x29;&#x3b;&#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Exercicio&#x27;, COALESCE&#x28;inExercicio&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;&#x29;&#x3b;&#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Entidade&#x27;, COALESCE&#x28;inEntidade&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;&#x29;&#x3b;	    &#xd;&#xa;   		stResultado &#x3a;&#x3d; &#x27;nok&#x27;&#x3b;&#xd;&#xa;   		&#xd;&#xa;   		stError &#x3a;&#x3d; prestacao_contas.processa_status_erro&#x28;inEntidade, stError&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;   		Return stResultado&#x3b;	    	&#xd;&#xa;    &#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;function&#x24;&#xd;&#xa;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection/>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>192</yloc>
    </entry>
  </entries>
  <hops>
    <hop>
      <from>SJ_020_ESS_UPD_STATUS_PROCESSANDO</from>
      <to>SJ_030_ESS_EXEC_FUNCTION</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_030_ESS_EXEC_FUNCTION</from>
      <to>SJ_040_ESS_UPD_STATUS_PRONTO</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_040_ESS_UPD_STATUS_PRONTO</from>
      <to>Success</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_010_ESS_CREATE_SCHEMA_FUNCTION</from>
      <to>SJ_020_ESS_UPD_STATUS_PROCESSANDO</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>BI_CONTROLE_FUNCOES_GLOBAIS</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>BI_CONTROLE_FUNCOES_GLOBAIS</from>
      <to>SJ_009_ESS_CREATE_SCHEMA_FUNCTION</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>SJ_009_ESS_CREATE_SCHEMA_FUNCTION</from>
      <to>SJ_010_ESS_CREATE_SCHEMA_FUNCTION</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
  </hops>
  <notepads>
  </notepads>
</job>
