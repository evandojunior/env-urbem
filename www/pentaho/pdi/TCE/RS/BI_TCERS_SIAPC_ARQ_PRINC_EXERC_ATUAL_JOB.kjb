<job>
  <name>BI_TCERS_SIAPC_ARQ_PRINC_EXERC_ATUAL_JOB</name>
  <description/>
  <extended_description/>
  <job_version/>
  <job_status>0</job_status>
  <directory>&#x2f;TCE&#x2f;RS</directory>
  <created_user>-</created_user>
  <created_date>2017&#x2f;04&#x2f;04 14&#x3a;17&#x3a;24.036</created_date>
  <modified_user>-</modified_user>
  <modified_date>2017&#x2f;08&#x2f;22 10&#x3a;58&#x3a;09.530</modified_date>
    <parameters>
      <parameter>
        <name>CLIENTE_ID</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>CLIENTE_NOME</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>CLIENTE_UF</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>DB_HOST_NAME</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>DB_NAME</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>DB_PASSWORD</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>DB_PORT</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>DB_USER_NAME</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>EXERCIO</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>JOB_NOME</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>MES</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>PERIODO_FINAL</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>PERIODO_INICIAL</name>
        <default_value/>
        <description/>
      </parameter>
      <parameter>
        <name>REPROC_PRE_BALANCETE_EXERCICIO</name>
        <default_value/>
        <description/>
      </parameter>
    </parameters>
  <connection>
    <name>urbem</name>
    <server>&#x24;&#x7b;DB_HOST_NAME&#x7d;</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>&#x24;&#x7b;DB_NAME&#x7d;</database>
    <port>&#x24;&#x7b;DB_PORT&#x7d;</port>
    <username>&#x24;&#x7b;DB_USER_NAME&#x7d;</username>
    <password>&#x24;&#x7b;DB_PASSWORD&#x7d;</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>&#x24;&#x7b;DB_PORT&#x7d;</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
    <slaveservers>
    </slaveservers>
      <job-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_JOB</id>
          <enabled>Y</enabled>
          <name>ID_JOB</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>JOBNAME</id>
          <enabled>Y</enabled>
          <name>JOBNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>START_JOB_ENTRY</id>
          <enabled>N</enabled>
          <name>START_JOB_ENTRY</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </job-log-table>
      <jobentry-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>JOBNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>JOBENTRYNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>RESULT</id>
          <enabled>Y</enabled>
          <name>RESULT</name>
        </field>
        <field>
          <id>NR_RESULT_ROWS</id>
          <enabled>Y</enabled>
          <name>NR_RESULT_ROWS</name>
        </field>
        <field>
          <id>NR_RESULT_FILES</id>
          <enabled>Y</enabled>
          <name>NR_RESULT_FILES</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>COPY_NR</id>
          <enabled>N</enabled>
          <name>COPY_NR</name>
        </field>
      </jobentry-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
   <pass_batchid>N</pass_batchid>
   <shared_objects_file/>
  <entries>
    <entry>
      <name>START</name>
      <description/>
      <type>SPECIAL</type>
      <start>Y</start>
      <dummy>N</dummy>
      <repeat>N</repeat>
      <schedulerType>1</schedulerType>
      <intervalSeconds>10</intervalSeconds>
      <intervalMinutes>0</intervalMinutes>
      <hour>12</hour>
      <minutes>0</minutes>
      <weekDay>1</weekDay>
      <DayOfMonth>1</DayOfMonth>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>32</yloc>
    </entry>
    <entry>
      <name>Success</name>
      <description/>
      <type>SUCCESS</type>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>448</yloc>
    </entry>
    <entry>
      <name>SJ_020_ESS_UPD_STATUS_PROCESSANDO</name>
      <description/>
      <type>SQL</type>
      <sql>&#x2f;&#x2a;&#xd;&#xa;update prestacao_contas.fila_relatorio &#xd;&#xa;set &#xd;&#xa; status &#x3d; &#x27;PROCESSANDO&#x27;&#xd;&#xa;,relatorio_log &#x3d; 	&#x28;	&#xd;&#xa;						select json_agg&#x28;value&#x29; from &#x28;&#xd;&#xa;						select &#x2a; from json_array_elements&#x28;&#x28;select relatorio_log from prestacao_contas.fila_relatorio where id &#x3d; &#x24;&#x7b;ID&#x7d;&#x29;&#x3a;&#x3a;json&#x29; &#xd;&#xa;						union all&#xd;&#xa;						select &#x28;&#x27;&#x7b;&#x22;from&#x22;&#x3a;&#x22;ENVIADO&#x22;,&#x22;to&#x22;&#x3a;&#x22;PROCESSANDO&#x22;,&#x22;at&#x22;&#x3a;&#x22;&#x27; &#x7c;&#x7c; to_char&#x28;now&#x28;&#x29;,&#x27;yyyy-mm-dd HH24&#x3a;MI&#x3a;SS&#x27;&#x29; &#x7c;&#x7c;&#x27;&#x22;,&#x22;message&#x22;&#x3a;null&#x7d;&#x27;&#x29;&#x3a;&#x3a;json&#xd;&#xa;													&#x29; x &#xd;&#xa;					&#x29;&#xd;&#xa;where id &#x3d; &#x24;&#x7b;ID&#x7d;&#x3b;&#xd;&#xa;&#x2a;&#x2f;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;SELECT prestacao_contas.processa_status_processando&#x28;&#x24;&#x7b;ID&#x7d;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>urbem</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>256</yloc>
    </entry>
    <entry>
      <name>SJ_030_ESS_EXEC_FUNCTION</name>
      <description/>
      <type>SQL</type>
      <sql>SELECT prestacao_contas.tcers_siapc_arq_princ_exerc_atual&#x28;&#x24;&#x7b;ID&#x7d;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>urbem</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>320</yloc>
    </entry>
    <entry>
      <name>SJ_040_ESS_UPD_STATUS_PRONTO</name>
      <description/>
      <type>SQL</type>
      <sql>&#x2f;&#x2a;&#xd;&#xa;update prestacao_contas.fila_relatorio &#xd;&#xa;set &#xd;&#xa; status &#x3d; &#x27;PRONTO&#x27;&#xd;&#xa;,data_resposta &#x3d; now&#x28;&#x29;&#x3a;&#x3a;timestamp&#x28;0&#x29;&#xd;&#xa;,relatorio_log &#x3d; 	&#x28;	&#xd;&#xa;						select json_agg&#x28;value&#x29; from &#x28;&#xd;&#xa;						select &#x2a; from json_array_elements&#x28;&#x28;select relatorio_log from prestacao_contas.fila_relatorio where id &#x3d; &#x24;&#x7b;ID&#x7d;&#x29;&#x3a;&#x3a;json&#x29; &#xd;&#xa;						union all&#xd;&#xa;						select &#x28;&#x27;&#x7b;&#x22;from&#x22;&#x3a;&#x22;PROCESSANDO&#x22;,&#x22;to&#x22;&#x3a;&#x22;PRONTO&#x22;,&#x22;at&#x22;&#x3a;&#x22;&#x27; &#x7c;&#x7c; to_char&#x28;now&#x28;&#x29;,&#x27;yyyy-mm-dd HH24&#x3a;MI&#x3a;SS&#x27;&#x29; &#x7c;&#x7c;&#x27;&#x22;,&#x22;message&#x22;&#x3a;null&#x7d;&#x27;&#x29;&#x3a;&#x3a;json&#xd;&#xa;													&#x29; x &#xd;&#xa;					&#x29;&#xd;&#xa;where id &#x3d; &#x24;&#x7b;ID&#x7d; and status &#x3d; &#x27;PROCESSANDO&#x27;&#x3b;&#xd;&#xa;&#x2a;&#x2f;&#xd;&#xa;&#xd;&#xa;SELECT prestacao_contas.processa_status_pronto&#x28;&#x24;&#x7b;ID&#x7d;&#x29;&#x3b;&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>urbem</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>384</yloc>
    </entry>
    <entry>
      <name>SJ_010_ESS_CREATE_SCHEMA_FUNCTION</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;SET search_path &#x3d; &#x27;prestacao_contas&#x27;, pg_catalog&#x3b;&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION prestacao_contas.tcers_siapc_arq_princ_exerc_atual&#x28;bigint&#x29;&#xd;&#xa; RETURNS text&#xd;&#xa; LANGUAGE plpgsql&#xd;&#xa;AS &#x24;function&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    inId            ALIAS FOR &#x24;1 &#x3b;&#xd;&#xa;    stParametros 	VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stEntidade		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stEntidade_bdsp	VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stEntidade_bver	VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stExercicio		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stMes			VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	jbArquivos 		JSONB        &#x3b;&#xd;&#xa;	stSql     		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stSql2 			VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stDtinicio		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stDtfim			VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stCnpjSetor		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;	stNomeSetor		VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa; 	reRegistro      RECORD       &#x3b;&#xd;&#xa;	stOrgao			VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa; 	stResultado		VARCHAR &#x3a;&#x3d; &#x27;ok&#x27;&#x3b;&#xd;&#xa; 	stError			VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;begin&#xd;&#xa;	&#xd;&#xa;	select &#xd;&#xa;		valor &#xd;&#xa;	into stParametros &#xd;&#xa;	from prestacao_contas.fila_relatorio &#xd;&#xa;	where id &#x3d; inId&#x3b;&#xd;&#xa;	&#xd;&#xa;	&#xd;&#xa;	stSql &#x3a;&#x3d; &#x27;select &#x2a; from json_to_record&#x28;&#x27;&#x27;&#x27;&#x7c;&#x7c;stParametros&#x7c;&#x7c;&#x27;	&#x27;&#x27;&#x29;  as x&#x28;entidade text, mes int, exercicio text, arquivo text, data_inicio text, data_fim text, cnpjsetor text, st_cnpj_setor text, orgao text &#x29;&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	FOR reRegistro IN EXECUTE stSql&#xd;&#xa;    LOOP		&#xd;&#xa;		stEntidade	&#x3a;&#x3d; reRegistro.entidade&#x3b;&#xd;&#xa;		stExercicio	&#x3a;&#x3d; reRegistro.exercicio&#x3b;&#xd;&#xa;		stMes		&#x3a;&#x3d; reRegistro.mes&#x3b;&#xd;&#xa;		jbArquivos 	&#x3a;&#x3d; &#x28;upper&#x28;reRegistro.arquivo&#x29;&#x29;&#x3a;&#x3a;jsonb&#x3b;&#xd;&#xa;		stDtinicio	&#x3a;&#x3d; reRegistro.data_inicio&#x3b;		&#xd;&#xa;		stDtfim		&#x3a;&#x3d; reRegistro.data_fim&#x3b;&#xd;&#xa;		stCnpjSetor	&#x3a;&#x3d; reRegistro.cnpjsetor&#x3b;&#xd;&#xa;		stNomeSetor	&#x3a;&#x3d; reRegistro.st_cnpj_setor&#x3b;&#xd;&#xa;		stOrgao		&#x3a;&#x3d; reRegistro.orgao&#x3b;&#xd;&#xa;    END LOOP&#x3b;&#xd;&#xa;    &#xd;&#xa;    CREATE TEMPORARY TABLE tmp_table &#x28;arquivo varchar&#x28;200&#x29;, content json&#x29;&#x3b;&#xd;&#xa;    &#xd;&#xa;    &#xd;&#xa;  &#xd;&#xa;    if jbArquivos &#x40;&#x3e; &#x27;&#x22;EMPENHO.TXT&#x22;&#x27;&#x3a;&#x3a;jsonb&#xd;&#xa;	 	then  &#xd;&#xa;	 		&#xd;&#xa;			&#xd;&#xa;			with empenho as&#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT                                                           &#xd;&#xa;				        tabela.num_orgao                                                &#xd;&#xa;				        ,tabela.num_unidade                                              &#xd;&#xa;				        ,tabela.cod_funcao                                               &#xd;&#xa;				        ,tabela.cod_subfuncao                                            &#xd;&#xa;				        ,tabela.cod_programa                                             &#xd;&#xa;				        ,0 as cod_subprograma                                            &#xd;&#xa;				        ,tabela.num_pao                                                  &#xd;&#xa;				        ,replace&#x28;tabela.cod_estrutural,&#x27;.&#x27;,&#x27;&#x27;&#x29; as cod_estrutural       &#xd;&#xa;				        ,tabela.cod_recurso                                              &#xd;&#xa;				        ,0 as contrapartida                                              &#xd;&#xa;				        ,&#x28;tabela.exercicio &#x7c;&#x7c; LPAD&#x28;tabela.cod_entidade&#x3a;&#x3a;varchar,2,&#x27;0&#x27;&#x29; &#x7c;&#x7c; LPAD&#x28;tabela.cod_empenho&#x3a;&#x3a;varchar,7,&#x27;0&#x27;&#x29;&#x29; as num_empenho  &#xd;&#xa;				        ,to_char&#x28;tabela.dt_empenho,&#x27;ddmmyyyy&#x27;&#x29;   as dt_empenho   &#xd;&#xa;				        ,replace&#x28;cast&#x28;tabela.vl_empenhado as varchar&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29; as vl_empenhado    &#xd;&#xa;				        ,tabela.sinal                                                    &#xd;&#xa;				        ,tabela.cgm                                                      &#xd;&#xa;				        ,tabela.exercicio                                                &#xd;&#xa;				        ,tabela.cod_empenho                                              &#xd;&#xa;				        ,tabela.ordem                                                    &#xd;&#xa;				        ,tabela.historico                                                &#xd;&#xa;				        ,tabela.caracteristica                                           &#xd;&#xa;				        ,tabela.modalidade                                               &#xd;&#xa;				        ,tabela.nro_licitacao                                            &#xd;&#xa;				        ,tabela.outras_modalidades&#xd;&#xa;				        ,tabela.preco             &#xd;&#xa;				        ,&#x27;&#x27; as branco&#xd;&#xa;				        ,modalidade_licitacao&#xd;&#xa;				FROM                                                             &#xd;&#xa;				    &#xd;&#xa;				    tcers.exportacaoEmpenho&#x28;stExercicio,stDtinicio,stDtfim,stEntidade&#x29;				    &#xd;&#xa;				    AS tabela&#xd;&#xa;				    &#x28;                                            &#xd;&#xa;				        num_orgao               integer                 &#xd;&#xa;				        ,num_unidade            integer                 &#xd;&#xa;				        ,cod_funcao             integer                 &#xd;&#xa;				        ,cod_subfuncao          integer                 &#xd;&#xa;				        ,cod_programa           integer                 &#xd;&#xa;				        ,num_pao                integer                 &#xd;&#xa;				        ,cod_recurso            integer                 &#xd;&#xa;				        ,cod_estrutural         varchar                 &#xd;&#xa;				        ,cod_empenho            integer                 &#xd;&#xa;				        ,dt_empenho             date                    &#xd;&#xa;				        ,vl_empenhado           numeric                 &#xd;&#xa;				        ,sinal                  varchar                 &#xd;&#xa;				        ,cgm                    integer                 &#xd;&#xa;				        ,historico              varchar                 &#xd;&#xa;				        ,cod_pre_empenho        integer                 &#xd;&#xa;				        ,exercicio              char&#x28;4&#x29;                 &#xd;&#xa;				        ,cod_entidade           integer                 &#xd;&#xa;				        ,ordem                  integer                 &#xd;&#xa;				        ,oid                    oid                     &#xd;&#xa;				        ,caracteristica         integer                 &#xd;&#xa;				        ,modalidade             integer                 &#xd;&#xa;				        ,nro_licitacao          text                    &#xd;&#xa;				        ,outras_modalidades     text                &#xd;&#xa;				        ,preco                  text                  &#xd;&#xa;				        ,modalidade_licitacao   text               &#xd;&#xa;				    &#x29;                                            &#xd;&#xa;				ORDER BY tabela.exercicio&#xd;&#xa;				        ,tabela.cod_empenho&#xd;&#xa;				        ,tabela.ordem&#xd;&#xa;			&#x29;&#xd;&#xa;			,empenho_format as &#x28;			&#xd;&#xa;				select &#xd;&#xa;					   &#x28;stCnpjSetor    &#xd;&#xa;					&#x7c;&#x7c;  replace&#x28;stDtinicio, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29; &#xd;&#xa;					&#x7c;&#x7c;  replace&#x28;stDtfim, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;  to_char&#x28;now&#x28;&#x29;, &#x27;ddmmyyyy&#x27;&#x29;					   &#xd;&#xa;					&#x7c;&#x7c;  rpad&#x28; upper&#x28;stNomeSetor&#x29;, 80, &#x27; &#x27;&#x29; &#x29;  as registro_empenho					&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					   lpad&#x28;coalesce&#x28;num_orgao&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,2,&#x27;0&#x27;&#x29;           &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;num_unidade&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,2,&#x27;0&#x27;&#x29;         &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_funcao&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,2,&#x27;0&#x27;&#x29;          &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_subfuncao&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,3,&#x27;0&#x27;&#x29;       &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_programa&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,4,&#x27;0&#x27;&#x29;        &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;&#x27;&#x27;,3,&#x27;0&#x27;&#x29; &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;num_pao&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,5,&#x27;0&#x27;&#x29;             &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_estrutural&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,15,&#x27;0&#x27;&#x29;     &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_recurso&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,4,&#x27;0&#x27;&#x29;         &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;contrapartida&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,4,&#x27;0&#x27;&#x29;       &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;num_empenho&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;		 &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;dt_empenho,&#x27;&#x27;&#x29;,8, &#x27; &#x27;&#x29;				     &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;vl_empenhado&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;		 &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;sinal&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,1,&#x27;0&#x27;&#x29;               &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cgm&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,10,&#x27;0&#x27;&#x29;				 &#xd;&#xa;					&#x7c;&#x7c; rpad&#x28;&#x27;&#x27;,165,&#x27; &#x27;&#x29; &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;caracteristica&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,3,&#x27;0&#x27;&#x29;      &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;&#x27;&#x27;,2,&#x27; &#x27;&#x29; &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;preco&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,1,&#x27; &#x27;&#x29;               &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;&#x27;&#x27;,20,&#x27; &#x27;&#x29; &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;nro_licitacao&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,20,&#x27;0&#x27;&#x29;      &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,4,&#x27; &#x27;&#x29;		     &#xd;&#xa;					&#x7c;&#x7c; rpad&#x28;coalesce&#x28;historico&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,400,&#x27; &#x27;&#x29;		 &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;modalidade_licitacao&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,3,&#x27; &#x27;&#x29; as registro_empenho &#xd;&#xa;					&#xd;&#xa;				from empenho&#xd;&#xa;				union all&#xd;&#xa;				select &#x27;FINALIZADOR&#x27;&#x7c;&#x7c;&#x28;select lpad&#x28;count&#x28;&#x2a;&#x29;&#x3a;&#x3a;varchar,10,&#x27;0&#x27;&#x29; from empenho&#x29;		&#xd;&#xa;		    &#x29; &#xd;&#xa;			insert into tmp_table &#x28;arquivo,content&#x29; &#xd;&#xa;				select  &#x27;EMPENHO.TXT&#x27;, json_agg&#x28;     regexp_replace&#x28;  registro_empenho  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;     &#x29; from empenho_format&#x3b;   &#xd;&#xa;    end if&#x3b;		&#xd;&#xa;&#xd;&#xa;    if jbArquivos &#x40;&#x3e; &#x27;&#x22;BAL_REC.TXT&#x22;&#x27;&#x3a;&#x3a;jsonb&#xd;&#xa;	 	then      &#xd;&#xa;	 		&#xd;&#xa;			&#xd;&#xa;			with bal_rec as&#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT&#xd;&#xa;			        replace&#x28;tabela.cod_estrutural,&#x27;.&#x27;,&#x27;&#x27;&#x29; as cod_estrutural,&#xd;&#xa;			        replace&#x28;tabela.vl_original&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;&#x27;&#x29; as vl_original,&#xd;&#xa;			        replace&#x28;tabela.totalizado&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;&#x27;&#x29; as totalizado,&#xd;&#xa;			        tabela.cod_recurso,&#xd;&#xa;			        regexp_replace&#x28;sem_acentos&#x28;tabela.descricao&#x29;, &#x27;&#x5b;&#xb0;&#x7c;&#xba;&#x7c;&#x5c;&#x2f;&#x5d;&#x27;, &#x27; &#x27;, &#x27;g&#x27;&#x29; AS descricao,&#xd;&#xa;			        tabela.tipo,&#xd;&#xa;			        tabela.nivel,&#xd;&#xa;			        tabela.cod_caracteristica,&#xd;&#xa;			        replace&#x28;tabela.vl_original&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;&#x27;&#x29; as vl_atualizado&#xd;&#xa;			    FROM&#xd;&#xa;			     &#xd;&#xa;			     tcers.fn_exportacao_balancete_receita&#x28;stExercicio, stEntidade,  stDtinicio, stDtfim&#x29;			     &#xd;&#xa;			    AS tabela              &#x28;   cod_estrutural     varchar,&#xd;&#xa;			                               cod_recurso        varchar&#x28;13&#x29;,&#xd;&#xa;			                               descricao          varchar,&#xd;&#xa;			                               vl_original        numeric,&#xd;&#xa;			                               totalizado         numeric,&#xd;&#xa;			                               tipo               varchar,&#xd;&#xa;			                               nivel              integer,&#xd;&#xa;			                               cod_caracteristica integer&#x29;&#xd;&#xa;			    WHERE tabela.nivel&#x3c;&#x3e;0&#xd;&#xa;			    ORDER BY tabela.cod_estrutural&#xd;&#xa;			&#x29;&#xd;&#xa;			, bal_rec_format as &#xd;&#xa;			&#x28;			&#xd;&#xa;				select &#xd;&#xa;					   &#x28;stCnpjSetor    &#xd;&#xa;					&#x7c;&#x7c;  replace&#x28;stDtinicio, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29; &#xd;&#xa;					&#x7c;&#x7c;  replace&#x28;stDtfim, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;  to_char&#x28;now&#x28;&#x29;, &#x27;ddmmyyyy&#x27;&#x29;					   &#xd;&#xa;					&#x7c;&#x7c;  rpad&#x28; upper&#x28;stNomeSetor&#x29;, 80, &#x27; &#x27;&#x29; &#x29;  as registro_bal_rec					&#xd;&#xa;				union all&#xd;&#xa;				select&#xd;&#xa;					   lpad&#x28;coalesce&#x28;cod_estrutural&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,20,&#x27;0&#x27;&#x29;       &#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;stOrgao, 4, &#x27;0&#x27;&#x29;		  &#xd;&#xa;					&#x7c;&#x7c; case &#xd;&#xa;								&#xd;&#xa;								when coalesce&#x28;vl_original&#x3a;&#x3a;numeric,0&#x29; &#x3e;&#x3d; 0 then lpad&#x28;coalesce&#x28; vl_original&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;&#xd;&#xa;								else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;coalesce&#x28;&#x28;vl_original&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,12,&#x27;0&#x27;&#x29; end    &#xd;&#xa;					&#x7c;&#x7c; case &#xd;&#xa;								&#xd;&#xa;								when coalesce&#x28;totalizado&#x3a;&#x3a;numeric,0&#x29; &#x3e;&#x3d; 0 then lpad&#x28;coalesce&#x28; totalizado&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;								&#xd;&#xa;								else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;coalesce&#x28;&#x28;totalizado&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,12,&#x27;0&#x27;&#x29; end     &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_recurso&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,4,&#x27;0&#x27;&#x29;         &#xd;&#xa;					&#x7c;&#x7c; rpad&#x28;coalesce&#x28;descricao&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,170,&#x27; &#x27;&#x29;         &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipo&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,1,&#x27; &#x27;&#x29;                &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;nivel&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,2,&#x27;0&#x27;&#x29;               &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_caracteristica&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,3,&#x27;0&#x27;&#x29;  &#xd;&#xa;					&#x7c;&#x7c; case&#xd;&#xa;								&#xd;&#xa;								when coalesce&#x28;vl_atualizado&#x3a;&#x3a;numeric,0&#x29; &#x3e;&#x3d; 0 then lpad&#x28;coalesce&#x28; vl_atualizado&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;&#xd;&#xa;								else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;coalesce&#x28;&#x28;vl_atualizado&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,12,&#x27;0&#x27;&#x29; end  as registro_bal_rec &#xd;&#xa;				from bal_rec		&#xd;&#xa;				union all&#xd;&#xa;				select &#x27;FINALIZADOR&#x27;&#x7c;&#x7c;&#x28;select lpad&#x28;count&#x28;&#x2a;&#x29;&#x3a;&#x3a;varchar,10,&#x27;0&#x27;&#x29; from bal_rec&#x29;&#xd;&#xa;			&#x29; &#xd;&#xa;			insert into tmp_table &#x28;arquivo,content&#x29; &#xd;&#xa;				select  &#x27;BAL_REC.TXT&#x27;, json_agg&#x28;     regexp_replace&#x28;  registro_bal_rec  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;     &#x29; from bal_rec_format&#x3b;   &#xd;&#xa;    end if&#x3b;		&#xd;&#xa;&#xd;&#xa;    stEntidade_bdsp &#x3a;&#x3d; &#x27; AND OD.cod_entidade IN &#x28;&#x27; &#x7c;&#x7c; stEntidade &#x7c;&#x7c; &#x27;&#x29;&#x27;&#x3b;&#xd;&#xa;    if jbArquivos &#x40;&#x3e; &#x27;&#x22;BAL_DESP.TXT&#x22;&#x27;&#x3a;&#x3a;jsonb&#xd;&#xa;	 	then      			&#xd;&#xa;	 		&#xd;&#xa;			&#xd;&#xa;			with bal_desp as&#xd;&#xa;			&#x28;&#xd;&#xa;				 SELECT                                                                       &#xd;&#xa;					    cod_despesa                  ,                                            &#xd;&#xa;					    num_orgao                    ,                                            &#xd;&#xa;					    num_unidade                  ,                                            &#xd;&#xa;					    cod_funcao                   ,                                     &#xd;&#xa;					    cod_subfuncao                ,                                            &#xd;&#xa;					    cod_programa                 ,                                            &#xd;&#xa;					    cod_subprograma              ,                                            &#xd;&#xa;					    num_pao                      ,                                            &#xd;&#xa;					    cod_subelemento              ,                                            &#xd;&#xa;					    cod_recurso                  ,                                            &#xd;&#xa;					    saldo_inicial                ,                                            &#xd;&#xa;					    atualizacao                  ,                                            &#xd;&#xa;					    credito_suplementar          ,                                            &#xd;&#xa;					    credito_especial             ,                                            &#xd;&#xa;					    credito_extraordinario       ,                                            &#xd;&#xa;					    reducoes                     ,                                            &#xd;&#xa;					    suplementacao                ,                                            &#xd;&#xa;					    reducao                      ,                                            &#xd;&#xa;					    &#x28;empenho_per - anulado_per&#x29; as vl_empenhado                  ,                                            &#xd;&#xa;					    liquidado_per                ,                                            &#xd;&#xa;					    pago_per                     ,                                            &#xd;&#xa;					    valor_liquidado              ,                                            &#xd;&#xa;					    recomposicao                 ,                                            &#xd;&#xa;					    previsao                                                                  &#xd;&#xa;					FROM                                                                             &#xd;&#xa;					 &#xd;&#xa;					 tcers.fn_exportacao_balancete_despesa&#x28; stExercicio, stEntidade_bdsp,    stDtinicio,  stDtfim&#x29; AS tabela&#x28;&#xd;&#xa;					cod_despesa                  integer,                                            &#xd;&#xa;					num_orgao                    integer,                                            &#xd;&#xa;					num_unidade                  integer,                                            &#xd;&#xa;					cod_funcao                   integer,                                            &#xd;&#xa;					cod_subfuncao                integer,                                            &#xd;&#xa;					cod_programa                 integer,                                            &#xd;&#xa;					cod_subprograma              integer,                                            &#xd;&#xa;					num_pao                      integer,                                            &#xd;&#xa;					cod_subelemento              integer,                                            &#xd;&#xa;					cod_recurso                  integer,                                            &#xd;&#xa;					saldo_inicial                numeric,                                            &#xd;&#xa;					atualizacao                  integer,                                            &#xd;&#xa;					credito_suplementar          numeric,                                            &#xd;&#xa;					credito_especial             numeric,                                            &#xd;&#xa;					credito_extraordinario       numeric,                                            &#xd;&#xa;					reducoes                     numeric,                                            &#xd;&#xa;					suplementacao                numeric,                                            &#xd;&#xa;					reducao                      numeric,                                            &#xd;&#xa;					empenho_per                  numeric,                                            &#xd;&#xa;					anulado_per                  numeric,                                            &#xd;&#xa;					liquidado_per                numeric,                                            &#xd;&#xa;					pago_per                     numeric,                                            &#xd;&#xa;					total_creditos               numeric,                                            &#xd;&#xa;					valor_liquidado              numeric,                                            &#xd;&#xa;					recomposicao                 numeric,                                            &#xd;&#xa;					previsao                     numeric&#x29;                                             &#xd;&#xa;	        &#x29;                                      &#xd;&#xa;			, bal_desp_format as &#xd;&#xa;			&#x28;			&#xd;&#xa;				select &#xd;&#xa;					   &#x28;stCnpjSetor    &#xd;&#xa;					&#x7c;&#x7c;  replace&#x28;stDtinicio, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29; &#xd;&#xa;					&#x7c;&#x7c;  replace&#x28;stDtfim, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;  to_char&#x28;now&#x28;&#x29;, &#x27;ddmmyyyy&#x27;&#x29;					   &#xd;&#xa;					&#x7c;&#x7c;  rpad&#x28; upper&#x28;stNomeSetor&#x29;, 80, &#x27; &#x27;&#x29; &#x29;  as registro_bal_desp					&#xd;&#xa;				union all			&#xd;&#xa;				select &#xd;&#xa;					   lpad&#x28;coalesce&#x28;num_orgao&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,2,&#x27;0&#x27;&#x29;     &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;num_unidade&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,2,&#x27;0&#x27;&#x29;   &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_funcao&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,2,&#x27;0&#x27;&#x29;    &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_subfuncao&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,3,&#x27;0&#x27;&#x29; &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_programa&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,4,&#x27;0&#x27;&#x29;  &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;&#x27;&#x27;,3,&#x27;0&#x27;&#x29;                                  &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;num_pao&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,5,&#x27;0&#x27;&#x29;       &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_subelemento&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,6,&#x27;0&#x27;&#x29;  &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_recurso&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,4,&#x27;0&#x27;&#x29;      &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;to_char&#x28;saldo_inicial,&#x27;FM99999999999V99&#x27;&#x29;,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;          &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;to_char&#x28;atualizacao,&#x27;FM99999999999V99&#x27;&#x29;,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;            &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;to_char&#x28;credito_suplementar,&#x27;FM99999999999V99&#x27;&#x29;,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;    &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;to_char&#x28;credito_especial,&#x27;FM99999999999V99&#x27;&#x29;,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;       &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;to_char&#x28;credito_extraordinario,&#x27;FM99999999999V99&#x27;&#x29;,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29; &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;to_char&#x28;reducoes,&#x27;FM99999999999V99&#x27;&#x29;,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;               &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;to_char&#x28;suplementacao,&#x27;FM99999999999V99&#x27;&#x29;,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;          &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;to_char&#x28;reducao,&#x27;FM99999999999V99&#x27;&#x29;,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;                &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;to_char&#x28;vl_empenhado,&#x27;FM99999999999V99&#x27;&#x29;,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;           &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;to_char&#x28;pago_per,&#x27;FM99999999999V99&#x27;&#x29;,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;               &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;to_char&#x28;liquidado_per,&#x27;FM99999999999V99&#x27;&#x29;,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;          &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;to_char&#x28;valor_liquidado,&#x27;FM99999999999V99&#x27;&#x29;,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;        &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;to_char&#x28;recomposicao,&#x27;FM99999999999V99&#x27;&#x29;,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;           &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;to_char&#x28;previsao,&#x27;FM99999999999V99&#x27;&#x29;,&#x27;&#x27;&#x29;,13,&#x27;0&#x27;&#x29;	             as registro_bal_desp &#xd;&#xa;				from bal_desp		&#xd;&#xa;				union all&#xd;&#xa;				select &#x27;FINALIZADOR&#x27;&#x7c;&#x7c;&#x28;select lpad&#x28;count&#x28;&#x2a;&#x29;&#x3a;&#x3a;varchar,10,&#x27;0&#x27;&#x29; from bal_desp&#x29;&#xd;&#xa;			&#x29; &#xd;&#xa;			insert into tmp_table &#x28;arquivo,content&#x29; &#xd;&#xa;				select  &#x27;BAL_DESP.TXT&#x27;, json_agg&#x28;     regexp_replace&#x28;  registro_bal_desp  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;     &#x29; from bal_desp_format&#x3b;   &#xd;&#xa;    end if&#x3b;		&#xd;&#xa;&#xd;&#xa;    &#xd;&#xa;    if jbArquivos &#x40;&#x3e; &#x27;&#x22;RECEITA.TXT&#x22;&#x27;&#x3a;&#x3a;jsonb&#xd;&#xa;	 	then      &#xd;&#xa;			&#xd;&#xa;			&#xd;&#xa;			with rec as&#xd;&#xa;			&#x28;&#xd;&#xa;				select                                                               &#xd;&#xa;				&#x2a;                                                                    &#xd;&#xa;				from                                                                 &#xd;&#xa;				 tcers.fn_exportacao_receita&#x28;stExercicio, stEntidade,  3,    2&#x29;				 &#xd;&#xa;				AS tabela              &#x28; cod_estrutural varchar,                     &#xd;&#xa;				                         receita_mes1 numeric,                       &#xd;&#xa;				                         receita_mes2 numeric,                       &#xd;&#xa;				                         receita_mes3 numeric,                       &#xd;&#xa;				                         receita_mes4 numeric,                       &#xd;&#xa;				                         receita_mes5 numeric,                       &#xd;&#xa;				                         receita_mes6 numeric,                       &#xd;&#xa;				                         receita_mes7 numeric,                       &#xd;&#xa;				                         receita_mes8 numeric,                       &#xd;&#xa;				                         receita_mes9 numeric,                       &#xd;&#xa;				                         receita_mes10 numeric,                      &#xd;&#xa;				                         receita_mes11 numeric,                      &#xd;&#xa;				                         receita_mes12 numeric,                      &#xd;&#xa;				                         meta_arrecadacao1 numeric,                  &#xd;&#xa;				                         meta_arrecadacao2 numeric,                  &#xd;&#xa;				                         meta_arrecadacao3 numeric,                  &#xd;&#xa;				                         meta_arrecadacao4 numeric,                  &#xd;&#xa;				                         meta_arrecadacao5 numeric,                  &#xd;&#xa;				                         meta_arrecadacao6 numeric,                  &#xd;&#xa;				                         cod_caracteristica integer,                 &#xd;&#xa;				                         cod_recurso integer                         &#xd;&#xa;				&#x29;         &#xd;&#xa;			&#x29;&#xd;&#xa;			, rec_format as &#xd;&#xa;			&#x28;&#xd;&#xa;				  select &#xd;&#xa;					   &#x28;stCnpjSetor    &#xd;&#xa;					&#x7c;&#x7c;  replace&#x28;stDtinicio, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29; &#xd;&#xa;					&#x7c;&#x7c;  replace&#x28;stDtfim, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;  to_char&#x28;now&#x28;&#x29;, &#x27;ddmmyyyy&#x27;&#x29;					   &#xd;&#xa;					&#x7c;&#x7c;  rpad&#x28; upper&#x28;stNomeSetor&#x29;, 80, &#x27; &#x27;&#x29; &#x29;  as registro_rec					&#xd;&#xa;				  union all&#xd;&#xa;				  select &#xd;&#xa;				       &#xd;&#xa;				        lpad&#x28;replace&#x28;cod_estrutural&#x3a;&#x3a;varchar,&#x27;.&#x27;,&#x27;&#x27;&#x29;, 20, &#x27;0&#x27;&#x29;&#xd;&#xa;				  	 &#x7c;&#x7c; lpad&#x28;stOrgao, 4, &#x27;0&#x27;&#x29;	  &#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;receita_mes1, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; receita_mes1&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      13,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;receita_mes1&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,12,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;receita_mes2, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; receita_mes2&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      13,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;receita_mes2&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,12,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;receita_mes3, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; receita_mes3&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      13,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;receita_mes3&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,12,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;receita_mes4, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; receita_mes4&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      13,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;receita_mes4&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,12,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;receita_mes5, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; receita_mes5&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      13,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;receita_mes5&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,12,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;receita_mes6, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; receita_mes6&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      13,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;receita_mes6&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,12,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;receita_mes7, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; receita_mes7&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      13,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;receita_mes7&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,12,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;receita_mes8, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; receita_mes8&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      13,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;receita_mes8&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,12,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;receita_mes9, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; receita_mes9&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      13,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;receita_mes9&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,12,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;receita_mes10, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; receita_mes10&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      13,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;receita_mes10&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,12,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;receita_mes11, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; receita_mes11&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      13,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;receita_mes11&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,12,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;receita_mes12, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; receita_mes12&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      13,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;receita_mes12&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,12,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;meta_arrecadacao1, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; meta_arrecadacao1&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      12,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;meta_arrecadacao1&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,11,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;meta_arrecadacao2, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; meta_arrecadacao2&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      12,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;meta_arrecadacao2&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,11,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;meta_arrecadacao3, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; meta_arrecadacao3&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      12,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;meta_arrecadacao3&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,11,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;meta_arrecadacao4, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; meta_arrecadacao4&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      12,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;meta_arrecadacao4&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,11,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;meta_arrecadacao5, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; meta_arrecadacao5&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      12,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;meta_arrecadacao5&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,11,&#x27;0&#x27;&#x29; end&#xd;&#xa; 		  	  	     &#x7c;&#x7c; case &#xd;&#xa;					 	when coalesce&#x28;meta_arrecadacao6, 0&#x29;&#x3a;&#x3a;numeric &#x3e;&#x3d; 0 then lpad&#x28;        replace&#x28;  coalesce&#x28; meta_arrecadacao6&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,  &#x27;.&#x27;,&#x27;&#x27;&#x29;,      12,&#x27;0&#x27;&#x29; &#xd;&#xa;					 	else &#x27;-&#x27; &#x7c;&#x7c; lpad&#x28;replace&#x28;coalesce&#x28;&#x28;meta_arrecadacao6&#x3a;&#x3a;numeric &#x2a; -1&#x29;&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;,&#x27;.&#x27;,&#x27;&#x27;&#x29;,11,&#x27;0&#x27;&#x29; end					 	&#xd;&#xa;				     &#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_caracteristica&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 3, &#x27;0&#x27;&#x29; &#xd;&#xa;				     &#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_recurso&#x3a;&#x3a;varchar, &#x27;0&#x27;&#x29;, 4, &#x27;0&#x27;&#x29; 	   &#xd;&#xa;				     as registro_rec&#xd;&#xa;			    from rec&#xd;&#xa;			    union all&#xd;&#xa; 		        select &#x27;FINALIZADOR&#x27;  &#x7c;&#x7c; lpad&#x28;&#x28;&#x28;select COUNT&#x28;&#x2a;&#x29;&#x3a;&#x3a;varchar  from rec&#x29;&#x3a;&#x3a;varchar&#x29;, 10, &#x27;0&#x27;&#x29;  as registro_rec&#xd;&#xa;			&#x29; &#xd;&#xa;			insert into tmp_table &#x28;arquivo,content&#x29; &#xd;&#xa;				select  &#x27;RECEITA.TXT&#x27;, json_agg&#x28;     regexp_replace&#x28;  registro_rec  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;     &#x29; from rec_format&#x3b;   &#xd;&#xa;    end if&#x3b;		&#xd;&#xa;&#xd;&#xa;		&#xd;&#xa;    if jbArquivos &#x40;&#x3e; &#x27;&#x22;PAGAMENT.TXT&#x22;&#x27;&#x3a;&#x3a;jsonb&#xd;&#xa;	 	then      &#xd;&#xa;			&#xd;&#xa;			&#xd;&#xa;			with pagament as&#xd;&#xa;			&#x28;&#xd;&#xa;				select                                                                    &#xd;&#xa;                    lpad&#x28;tabela.exercicio_empenho,4,&#x27;0&#x27;&#x29; as exercicio_empenho      &#xd;&#xa;                    , lpad&#x28;tabela.cod_empenho&#x3a;&#x3a;varchar,7,&#x27;0&#x27;&#x29; as cod_empenho       &#xd;&#xa;                    , lpad&#x28;tabela.cod_entidade&#x3a;&#x3a;varchar,2,&#x27;0&#x27;&#x29; as cod_entidade        &#xd;&#xa;                    , cod_ordem                                                       &#xd;&#xa;                    , vl_pago                                                          &#xd;&#xa;                    , CASE WHEN &#x28;observacao &#x3c;&#x3e; &#x27;&#x27;&#x29; THEN                                    &#xd;&#xa;                            remove_acentos&#x28;replace&#x28;observacao,&#x27;&#x27;&#x27;&#x27;,&#x27;&#x27;&#x29;&#x29;                                                   &#xd;&#xa;                         ELSE                                                            &#xd;&#xa;                            &#x27;PAGAMENTO DE EMPENHO&#x27;                                       &#xd;&#xa;                    END as observacao                                      &#xd;&#xa;                    , to_char&#x28;data_pagamento,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; as data_pagamento           &#xd;&#xa;                    , sinal_valor                                                      &#xd;&#xa;                    , cod_operacao                                                       &#xd;&#xa;                    , debito_codigo_conta_verificacao                                    &#xd;&#xa;                    , credito_codigo_conta_verificacao                                   &#xd;&#xa;                    , &#x27;&#x27; as branco&#xd;&#xa;                    , cod_nota AS numero_liquidacao&#xd;&#xa;                  &#xd;&#xa;                  from tcers.fn_exportacao_pagamento_novo&#x28; stExercicio,  stEntidade,  stDtinicio,   stDtfim,    &#x27;&#x27;                  &#xd;&#xa;                                                          &#x29; as                                    &#xd;&#xa;                        tabela&#x28;&#xd;&#xa;                                cod_nota                                integer,&#xd;&#xa;                                exercicio_empenho                       char&#x28;4&#x29;,                     &#xd;&#xa;                                cod_empenho                             integer,                     &#xd;&#xa;                                cod_entidade                            integer,                     &#xd;&#xa;                                cod_ordem                               integer,                     &#xd;&#xa;                                vl_pago                                 numeric,                     &#xd;&#xa;                                observacao                              varchar,                     &#xd;&#xa;                                data_pagamento                          date,                        &#xd;&#xa;                                sinal_valor                             text,                        &#xd;&#xa;                                cod_operacao                            integer,                     &#xd;&#xa;                                debito_codigo_conta_verificacao         varchar,                     &#xd;&#xa;                                credito_codigo_conta_verificacao        varchar,                     &#xd;&#xa;                                oid                                     oid                          &#xd;&#xa;                               &#x29;                                                         &#xd;&#xa;			&#x29;&#xd;&#xa;			, pag_format as &#xd;&#xa;			&#x28;&#xd;&#xa;				  select &#xd;&#xa;					   &#x28;stCnpjSetor    &#xd;&#xa;					&#x7c;&#x7c;  replace&#x28;stDtinicio, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29; &#xd;&#xa;					&#x7c;&#x7c;  replace&#x28;stDtfim, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;  to_char&#x28;now&#x28;&#x29;, &#x27;ddmmyyyy&#x27;&#x29;					   &#xd;&#xa;					&#x7c;&#x7c;  rpad&#x28; upper&#x28;stNomeSetor&#x29;, 80, &#x27; &#x27;&#x29; &#x29;  as registro_pag					&#xd;&#xa;				  union all	   &#xd;&#xa;				  select&#xd;&#xa;					  lpad&#x28;coalesce&#x28;exercicio_empenho&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 8, &#x27;0&#x27;&#x29; &#x7c;&#x7c; lpad&#x28;coalesce&#x28;&#x28;cod_empenho&#x3a;&#x3a;int&#x29;&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 5, &#x27;0&#x27; &#x29;  &#xd;&#xa;				      &#xd;&#xa;				      &#xd;&#xa;					  &#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_ordem&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 20, &#x27;0&#x27;&#x29;&#xd;&#xa;					  &#x7c;&#x7c; to_char&#x28;data_pagamento&#x3a;&#x3a;date, &#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;					  &#x7c;&#x7c; lpad&#x28;replace&#x28;vl_pago&#x3a;&#x3a;varchar, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 13, &#x27;0&#x27;&#x29;&#xd;&#xa;					  &#x7c;&#x7c; sinal_valor&#x3a;&#x3a;varchar&#xd;&#xa;					  &#x7c;&#x7c; lpad&#x28;&#x27; &#x27;, 120, &#x27; &#x27;&#x29;&#xd;&#xa;					  &#x7c;&#x7c; lpad&#x28;coalesce&#x28;replace&#x28;cod_operacao&#x3a;&#x3a;varchar, &#x27;0&#x27;, &#x27; &#x27;&#x29;, &#x27; &#x27;&#x29;, 30, &#x27; &#x27;&#x29;&#xd;&#xa;					  &#x7c;&#x7c; lpad&#x28;&#x28;&#x28;coalesce&#x28;debito_codigo_conta_verificacao, &#x27;&#x27;&#x29;&#x3a;&#x3a;int&#x29;&#x3a;&#x3a;varchar&#x29;, 20, &#x27;0&#x27;&#x29; &#xd;&#xa;				  	  &#x7c;&#x7c; lpad&#x28;stOrgao, 4, &#x27;0&#x27;&#x29;		  &#xd;&#xa;					  &#x7c;&#x7c; lpad&#x28;&#x28;&#x28;coalesce&#x28;credito_codigo_conta_verificacao, &#x27;&#x27;&#x29;&#x3a;&#x3a;int&#x29;&#x3a;&#x3a;varchar&#x29;, 20, &#x27;0&#x27;&#x29;&#xd;&#xa;				  	  &#x7c;&#x7c; lpad&#x28;stOrgao, 4, &#x27;0&#x27;&#x29;		  &#xd;&#xa;					  &#x7c;&#x7c; rpad&#x28;regexp_replace&#x28;coalesce&#x28;observacao, &#x27;&#x27;&#x29;,&#x27;&#x5c;r&#x7c;&#x5c;n&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;, 400, &#x27; &#x27;&#x29;&#xd;&#xa;					  &#x7c;&#x7c; lpad&#x28;coalesce&#x28;numero_liquidacao&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 20, &#x27;0&#x27;&#x29;&#xd;&#xa;					  as registro_pag&#xd;&#xa;				  from pagament&#xd;&#xa;			      union all&#xd;&#xa;			      select &#x27;FINALIZADOR&#x27;  &#x7c;&#x7c; lpad&#x28;&#x28;&#x28;select COUNT&#x28;&#x2a;&#x29;&#x3a;&#x3a;varchar  from pagament&#x29;&#x3a;&#x3a;varchar&#x29;, 10, &#x27;0&#x27;&#x29;  as registro_pag&#xd;&#xa;			&#x29; &#xd;&#xa;			insert into tmp_table &#x28;arquivo,content&#x29; &#xd;&#xa;				select  &#x27;PAGAMENT.TXT&#x27;, json_agg&#x28;     regexp_replace&#x28;  registro_pag  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;     &#x29; from pag_format&#x3b;   &#xd;&#xa;    end if&#x3b;	  &#xd;&#xa;&#xd;&#xa;&#xd;&#xa;    if jbArquivos &#x40;&#x3e; &#x27;&#x22;LIQUIDAC.TXT&#x22;&#x27;&#x3a;&#x3a;jsonb&#xd;&#xa;	 	then      &#xd;&#xa;			&#xd;&#xa;			&#xd;&#xa;			with liquidac as&#xd;&#xa;			&#x28;&#xd;&#xa;				select &#xd;&#xa;					&#x2a;&#xd;&#xa;					,CASE &#xd;&#xa;						WHEN resultado.cod_contrato IS NOT NULL THEN &#x27;S&#x27;&#xd;&#xa;					 	WHEN resultado.cod_estrutural LIKE &#x28;&#x27;3190&#x25;&#x27;&#x29; THEN &#x27;X&#x27;&#xd;&#xa;					 	ELSE &#x27;N&#x27;&#xd;&#xa;					 	END AS existe_contrato&#xd;&#xa;				FROM &#xd;&#xa;				&#x28;&#xd;&#xa;						SELECT                                                               &#xd;&#xa;							LPAD&#x28;tabela.exercicio,4,&#x27;0&#x27;&#x29; AS exercicio&#xd;&#xa;							, LPAD&#x28;tabela.cod_empenho&#x3a;&#x3a;VARCHAR,7,&#x27;0&#x27;&#x29; AS cod_empenho&#xd;&#xa;							, LPAD&#x28;tabela.cod_entidade&#x3a;&#x3a;VARCHAR,2,&#x27;0&#x27;&#x29; AS cod_entidade&#xd;&#xa;							, tabela.cod_nota&#xd;&#xa;							, TO_CHAR&#x28;tabela.data_pagamento,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AS data_pagamento&#xd;&#xa;							, REPLACE&#x28;tabela.valor_liquidacao&#x3a;&#x3a;VARCHAR,&#x27;.&#x27;,&#x27;&#x27;&#x29; AS valor_liquidacao&#xd;&#xa;							, tabela.sinal_valor&#xd;&#xa;							, tabela.observacao&#xd;&#xa;							, tabela.ordem&#xd;&#xa;							, &#x27; &#x27; AS codigo_operacao&#xd;&#xa;					     	, contratos_liquidacao.cod_contrato_tce&#xd;&#xa;					 		, contratos_liquidacao.cod_contrato&#xd;&#xa;					  		, contratos_liquidacao.exercicio AS exercicio_contrato&#xd;&#xa;					    	, despesa.cod_estrutural&#xd;&#xa;					    	, CASE WHEN nota_fiscal.cod_nota IS NOT NULL THEN &#x27;S&#x27; ELSE &#x27;N&#x27; END AS existe_nf&#xd;&#xa;					   		, nota_fiscal.nro_nota AS num_nota&#xd;&#xa;					  		, nota_fiscal.nro_serie AS num_serie&#xd;&#xa;						FROM                                                                 &#xd;&#xa;					        &#xd;&#xa;					        tcers.fn_exportacao_liquidacao&#x28;stExercicio, stDtinicio, stDtfim, stEntidade, &#x27;&#x27;					        &#xd;&#xa;					                                 		&#x29;    &#xd;&#xa;					                            AS tabela &#x28; exercicio char&#x28;4&#x29;&#xd;&#xa;					                                      , cod_empenho integer&#xd;&#xa;					                                      , cod_entidade integer&#xd;&#xa;					                                      , cod_nota integer&#xd;&#xa;					                                      , data_pagamento date&#xd;&#xa;					                                      , valor_liquidacao numeric&#xd;&#xa;					                                      , sinal_valor text&#xd;&#xa;					                                      , observacao varchar&#xd;&#xa;					                                      , ordem integer&#xd;&#xa;					                                      , oid oid&#xd;&#xa;					                                      &#x29;&#xd;&#xa;	                    INNER JOIN empenho.empenho&#xd;&#xa;	                            ON empenho.exercicio &#x3d; tabela.exercicio&#xd;&#xa;	                           AND empenho.cod_entidade &#x3d; tabela.cod_entidade&#xd;&#xa;	                           AND empenho.cod_empenho &#x3d; tabela.cod_empenho&#xd;&#xa;	                    INNER JOIN empenho.pre_empenho&#xd;&#xa;	                            ON pre_empenho.exercicio &#x3d; empenho.exercicio&#xd;&#xa;	                           AND pre_empenho.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;	                    INNER JOIN &#x28;  &#xd;&#xa;	                    				SELECT&#xd;&#xa;	                                          pre_empenho.exercicio&#xd;&#xa;	                                        , pre_empenho.cod_pre_empenho&#xd;&#xa;	                                        , CASE &#xd;&#xa;	                                        		WHEN &#x28; pre_empenho.implantado &#x3d; true &#x29;&#xd;&#xa;	                                               		THEN restos_pre_empenho.cod_estrutural&#xd;&#xa;	                                               	ELSE replace&#x28;conta_despesa.cod_estrutural, &#x27;.&#x27;, &#x27;&#x27;&#x29;&#xd;&#xa;	                                        		END as cod_estrutural&#xd;&#xa;		                          		FROM empenho.pre_empenho&#xd;&#xa;		                               	LEFT 	JOIN empenho.restos_pre_empenho&#xd;&#xa;		                                		ON restos_pre_empenho.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;		                               			AND restos_pre_empenho.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;		                               	LEFT 	JOIN empenho.pre_empenho_despesa&#xd;&#xa;		                                      	ON pre_empenho_despesa.exercicio &#x3d; pre_empenho.exercicio&#xd;&#xa;		                                     	AND pre_empenho_despesa.cod_pre_empenho &#x3d; pre_empenho.cod_pre_empenho&#xd;&#xa;		                               	LEFT 	JOIN orcamento.conta_despesa&#xd;&#xa;		                                      	ON conta_despesa.exercicio &#x3d; pre_empenho_despesa.exercicio&#xd;&#xa;		                                     	AND conta_despesa.cod_conta &#x3d; pre_empenho_despesa.cod_conta&#xd;&#xa;	                               &#x29; AS despesa&#xd;&#xa;	                            ON despesa.exercicio &#x3d; empenho.exercicio&#xd;&#xa;	                           AND despesa.cod_pre_empenho &#x3d; empenho.cod_pre_empenho&#xd;&#xa;	                     LEFT JOIN tcers.nota_fiscal&#xd;&#xa;	                            ON nota_fiscal.cod_nota &#x3d; tabela.cod_nota&#xd;&#xa;	                           AND nota_fiscal.exercicio &#x3d; TO_CHAR&#x28;tabela.data_pagamento, &#x27;yyyy&#x27;&#x29;&#xd;&#xa;	                           AND nota_fiscal.cod_entidade &#x3d; tabela.cod_entidade&#xd;&#xa;	                     LEFT JOIN tcers.contratos_liquidacao&#xd;&#xa;	                            ON contratos_liquidacao.cod_liquidacao &#x3d; tabela.cod_nota&#xd;&#xa;	                           AND contratos_liquidacao.exercicio &#x3d; TO_CHAR&#x28;tabela.data_pagamento, &#x27;yyyy&#x27;&#x29;&#xd;&#xa;	          	&#x29; as resultado&#xd;&#xa;	           	ORDER BY resultado.exercicio, resultado.cod_entidade, resultado.cod_empenho, resultado.ordem&#xd;&#xa;			&#x29;&#xd;&#xa;			, liq_format as &#xd;&#xa;			&#x28;&#xd;&#xa;				select &#xd;&#xa;					   &#x28;stCnpjSetor    &#xd;&#xa;					&#x7c;&#x7c;  replace&#x28;stDtinicio, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29; &#xd;&#xa;					&#x7c;&#x7c;  replace&#x28;stDtfim, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;  to_char&#x28;now&#x28;&#x29;, &#x27;ddmmyyyy&#x27;&#x29;					   &#xd;&#xa;					&#x7c;&#x7c;  rpad&#x28; upper&#x28;stNomeSetor&#x29;, 80, &#x27; &#x27;&#x29; &#x29;  as registro_liq					&#xd;&#xa;			 	union all	   &#xd;&#xa;		  		select&#xd;&#xa;					     	lpad&#x28;coalesce&#x28;exercicio&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 8, &#x27;0&#x27;&#x29; &#x7c;&#x7c; lpad&#x28;coalesce&#x28;&#x28;cod_empenho&#x3a;&#x3a;int&#x29;&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 5, &#x27;0&#x27; &#x29;  &#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;ordem&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 20, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c; to_char&#x28;data_pagamento&#x3a;&#x3a;date, &#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;replace&#x28;valor_liquidacao&#x3a;&#x3a;varchar, &#x27;.&#x27;, &#x27;&#x27;&#x29;, 13, &#x27;0&#x27;&#x29;&#xd;&#xa;				 	&#x7c;&#x7c; sinal_valor&#x3a;&#x3a;varchar&#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;&#x27; &#x27;, 165, &#x27; &#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;replace&#x28;codigo_operacao&#x3a;&#x3a;varchar, &#x27;0&#x27;, &#x27; &#x27;&#x29;, &#x27; &#x27;&#x29;, 30, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c; rpad&#x28;regexp_replace&#x28;coalesce&#x28;observacao, &#x27;&#x27;&#x29;,&#x27;&#x5c;r&#x7c;&#x5c;n&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;, 400, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c; coalesce&#x28;existe_contrato&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_contrato_tce&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 20, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_contrato&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 20, &#x27; &#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;exercicio_contrato&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c; coalesce&#x28;existe_nf&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;num_nota&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 9 , &#x27;0&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c; lpad&#x28;coalesce&#x28;num_serie&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 3 , &#x27; &#x27;&#x29;&#xd;&#xa;					as registro_liq&#xd;&#xa;				from liquidac&#xd;&#xa;			 	union all&#xd;&#xa;				select &#x27;FINALIZADOR&#x27;  &#x7c;&#x7c; lpad&#x28;&#x28;&#x28;select COUNT&#x28;&#x2a;&#x29;&#x3a;&#x3a;varchar  from liquidac&#x29;&#x3a;&#x3a;varchar&#x29;, 10, &#x27;0&#x27;&#x29;  as registro_liq&#xd;&#xa;			&#x29; &#xd;&#xa;			insert into tmp_table &#x28;arquivo,content&#x29; &#xd;&#xa;				select  &#x27;LIQUIDAC.TXT&#x27;, json_agg&#x28;     regexp_replace&#x28;  registro_liq  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;     &#x29; from liq_format&#x3b;   &#xd;&#xa;    end if&#x3b;&#xd;&#xa;	&#xd;&#xa;&#xd;&#xa;    if jbArquivos &#x40;&#x3e; &#x27;&#x22;DECRETO.TXT&#x22;&#x27;&#x3a;&#x3a;jsonb&#xd;&#xa;	 	then      &#xd;&#xa;			&#xd;&#xa;			&#xd;&#xa;			with decreto as&#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT&#xd;&#xa;                    numero_da_lei,&#xd;&#xa;                    substr&#x28;data_da_lei,7,8&#x29; as exercicio_da_lei,&#xd;&#xa;                    data_da_lei,&#xd;&#xa;                    num_norma as cod_norma,&#xd;&#xa;                    exercicio,&#xd;&#xa;                    dt_publicacao,&#xd;&#xa;                    valor_credito_adicional,&#xd;&#xa;                    valor_reducao_dotacoes,&#xd;&#xa;                    tipo_credito_adicional,&#xd;&#xa;                    origem_do_recurso&#xd;&#xa;				FROM &#x28;&#xd;&#xa;						SELECT DISTINCT&#xd;&#xa;	                 		suplementacao.cod_suplementacao,&#xd;&#xa;	                       	norma.num_norma,&#xd;&#xa;	                       	norma.exercicio,&#xd;&#xa;	                       	to_char&#x28;norma.dt_publicacao,&#x27;ddmmyyyy&#x27;&#x29;as dt_publicacao,&#xd;&#xa;	                       	CASE WHEN norma.cod_tipo_norma&#x3d;1 THEN&#xd;&#xa;	                           tcers.fn_retorno_atributo_normas&#x28;norma.cod_tipo_norma,norma.cod_norma,&#x27;N&#xfa;mero da Lei&#x27;&#x29;&#xd;&#xa;	                           ELSE&#xd;&#xa;	                           CAST&#x28;norma.num_norma as varchar&#x29;&#xd;&#xa;	                       	END as numero_da_lei,&#xd;&#xa;	                       	CASE WHEN norma.cod_tipo_norma&#x3d;1 THEN&#xd;&#xa;	                           tcers.fn_retorno_atributo_normas&#x28;norma.cod_tipo_norma,norma.cod_norma,&#x27;Data da Lei&#x27;&#x29;&#xd;&#xa;	                           ELSE&#xd;&#xa;	                           to_char&#x28;norma.dt_publicacao,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;	                       	END as data_da_lei,&#xd;&#xa;	                       	norma.dt_publicacao as dt_order,&#xd;&#xa;	                       	&#xd;&#xa;	                       	tcers.fn_total_valor_credito&#x28;stExercicio,suplementacao.cod_suplementacao, stEntidade&#x29; as valor_credito_adicional,	                       	&#xd;&#xa;	                       	&#xd;&#xa;							tcers.fn_total_valor_reducao&#x28;stExercicio,suplementacao.cod_suplementacao, stEntidade&#x29; as valor_reducao_dotacoes,&#xd;&#xa;	                       	CASE&#xd;&#xa;	                               WHEN suplementacao.cod_tipo IN &#x28;1,2,3,4,5,13,14,15&#x29; THEN 1&#xd;&#xa;	                               WHEN suplementacao.cod_tipo IN &#x28;6,7,8,9,10&#x29;         THEN 2&#xd;&#xa;	                               WHEN suplementacao.cod_tipo IN &#x28;11&#x29;                 THEN 3&#xd;&#xa;	                       	END AS tipo_credito_adicional,&#xd;&#xa;	                       	CASE&#xd;&#xa;	                               WHEN suplementacao.cod_tipo IN &#x28;5,10&#x29;              THEN 1&#xd;&#xa;	                               WHEN suplementacao.cod_tipo IN &#x28;4,9&#x29;               THEN 2&#xd;&#xa;	                               WHEN suplementacao.cod_tipo IN &#x28;2,7&#x29;               THEN 3&#xd;&#xa;	                               WHEN suplementacao.cod_tipo IN &#x28;3,8&#x29;               THEN 4&#xd;&#xa;	                               WHEN suplementacao.cod_tipo IN &#x28;1,6,13&#x29;            THEN 5&#xd;&#xa;	                               WHEN suplementacao.cod_tipo IN &#x28;14,15&#x29;             THEN 6&#xd;&#xa;	                       	END AS origem_do_recurso&#xd;&#xa;						FROM&#xd;&#xa;                       	normas.norma,&#xd;&#xa;                       	orcamento.suplementacao,&#xd;&#xa;                       	contabilidade.transferencia_despesa,&#xd;&#xa;                       	contabilidade.lote&#xd;&#xa;				       	WHERE&#xd;&#xa;				        	transferencia_despesa.cod_suplementacao     &#x3d; suplementacao.cod_suplementacao&#xd;&#xa;	                       	AND transferencia_despesa.exercicio             &#x3d; suplementacao.exercicio&#xd;&#xa;	                       	AND transferencia_despesa.cod_lote              &#x3d; lote.cod_lote&#xd;&#xa;	                       	AND suplementacao.cod_tipo              not in &#x28;12,16&#x29;&#xd;&#xa;	                       	AND transferencia_despesa.exercicio             &#x3d; lote.exercicio&#xd;&#xa;	                       	AND transferencia_despesa.tipo                  &#x3d; lote.tipo&#xd;&#xa;	                       	AND transferencia_despesa.cod_entidade          &#x3d; lote.cod_entidade&#xd;&#xa;	                       	AND lote.dt_lote between to_date&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND to_date&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;	                       	AND suplementacao.dt_suplementacao between to_date&#x28;stDtinicio,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29; AND to_date&#x28;stDtfim,&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;&#xd;&#xa;	                       	AND transferencia_despesa.cod_entidade          IN &#x28; select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int &#x29;   &#xd;&#xa;	                       	AND norma.cod_norma             &#x3d; suplementacao.cod_norma&#xd;&#xa;	                       	AND suplementacao.cod_suplementacao &#x7c;&#x7c; suplementacao.exercicio NOT IN &#x28;&#xd;&#xa;				                          SELECT&#xd;&#xa;				                             cod_suplementacao &#x7c;&#x7c; exercicio&#xd;&#xa;				                          FROM&#xd;&#xa;				                             orcamento.suplementacao_anulada&#xd;&#xa;				                          WHERE&#xd;&#xa;				                             exercicio   &#x3d; stExercicio   &#xd;&#xa;				                       &#x29;&#xd;&#xa;				         	AND suplementacao.cod_suplementacao &#x7c;&#x7c; suplementacao.exercicio NOT IN &#x28;&#xd;&#xa;				                          SELECT&#xd;&#xa;				                            cod_suplementacao_anulacao &#x7c;&#x7c; exercicio&#xd;&#xa;				                          FROM&#xd;&#xa;				                            orcamento.suplementacao_anulada&#xd;&#xa;				                          WHERE&#xd;&#xa;				                            exercicio   &#x3d; stExercicio  &#xd;&#xa;				          	 			&#x29;&#xd;&#xa;				&#x29; as tabela&#xd;&#xa;				ORDER BY exercicio, dt_order, numero_da_lei &#xd;&#xa;			&#x29;&#xd;&#xa;			, dec_format as &#xd;&#xa;			&#x28;&#xd;&#xa;				select &#xd;&#xa;					   &#x28;stCnpjSetor    &#xd;&#xa;					&#x7c;&#x7c;  replace&#x28;stDtinicio, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29; &#xd;&#xa;					&#x7c;&#x7c;  replace&#x28;stDtfim, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;  to_char&#x28;now&#x28;&#x29;, &#x27;ddmmyyyy&#x27;&#x29;					   &#xd;&#xa;					&#x7c;&#x7c;  rpad&#x28; upper&#x28;stNomeSetor&#x29;, 80, &#x27; &#x27;&#x29; &#x29;  as registro_dec					&#xd;&#xa;				union all	   &#xd;&#xa;				select&#xd;&#xa;				       lpad&#x28;coalesce&#x28;numero_da_lei&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 20, &#x27;0&#x27;&#x29;   &#xd;&#xa;					&#x7c;&#x7c; to_char&#x28;to_date&#x28;data_da_lei, &#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x29;,&#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_norma&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 20, &#x27;0&#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; to_char&#x28;to_date&#x28;dt_publicacao, &#x27;ddmmyyyy&#x27;&#x29;,&#x27;ddmmyyyy&#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;replace&#x28;valor_credito_adicional&#x3a;&#x3a;varchar, &#x27;.&#x27;,&#x27;&#x27;&#x29;, &#x27;0&#x27;&#x29;, 13, &#x27;0&#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;replace&#x28;valor_reducao_dotacoes&#x3a;&#x3a;varchar, &#x27;.&#x27;,&#x27;&#x27;&#x29;, &#x27;0&#x27;&#x29;, 13, &#x27;0&#x27;&#x29; &#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipo_credito_adicional&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 1, &#x27;0&#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;origem_do_recurso&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 1, &#x27;0&#x27;&#x29;&#xd;&#xa;				  	as registro_dec&#xd;&#xa;				from decreto&#xd;&#xa;				union all&#xd;&#xa;			  	select &#x27;FINALIZADOR&#x27;  &#x7c;&#x7c; lpad&#x28;&#x28;&#x28;select COUNT&#x28;&#x2a;&#x29;&#x3a;&#x3a;varchar  from decreto&#x29;&#x3a;&#x3a;varchar&#x29;, 10, &#x27;0&#x27;&#x29;  as registro_dec&#xd;&#xa;			&#x29; &#xd;&#xa;			insert into tmp_table &#x28;arquivo,content&#x29; &#xd;&#xa;				select  &#x27;DECRETO.TXT&#x27;, json_agg&#x28;     regexp_replace&#x28;  registro_dec  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;     &#x29; from dec_format&#x3b;   &#xd;&#xa;    end if&#x3b;&#xd;&#xa;&#xd;&#xa;    stEntidade_bver &#x3a;&#x3d;  &#x27;cod_entidade IN &#x28;&#x27; &#x7c;&#x7c; stEntidade &#x7c;&#x7c; &#x27;&#x29;&#x27;&#x3b;&#xd;&#xa;    if jbArquivos &#x40;&#x3e; &#x27;&#x22;BAL_VER.TXT&#x22;&#x27;&#x3a;&#x3a;jsonb&#xd;&#xa;	 	then      &#xd;&#xa;			&#xd;&#xa;			&#xd;&#xa;			with balver as&#xd;&#xa;			&#x28;&#xd;&#xa;				SELECT &#xd;&#xa;					REPLACE&#x28;tabela.cod_estrutural,&#x27;.&#x27;,&#x27;&#x27;&#x29; AS cod_estrutural                                                                                                                   &#xd;&#xa;	                 , cod_entidade&#xd;&#xa;	                 , SUBSTR&#x28;nom_sistema,1,1&#x29; AS natureza_informacao                                                                                                                             &#xd;&#xa;	                 , nivel                                                                                                                                                              &#xd;&#xa;	                 , tabela.nom_conta                                                                                                                                                          &#xd;&#xa;	                 , CASE WHEN   vl_saldo_anterior &#x3e;&#x3d;0 THEN                                                                                                                                &#xd;&#xa;	                                    replace&#x28;vl_saldo_anterior&#x3a;&#x3a;varchar,&#x27;-&#x27;,&#x27;&#x27;&#x29;                                                                                                                                    &#xd;&#xa;	                                ELSE                                                                                                                                                    &#xd;&#xa;	                                    &#x27;0&#x27;                                                                                                                                                  &#xd;&#xa;	                                END AS  saldo_anterior_devedora                                                                                                                        &#xd;&#xa;	                 , CASE WHEN vl_saldo_anterior &#x3c;0 THEN                                                                                                                                 &#xd;&#xa;	                                replace&#x28;vl_saldo_anterior&#x3a;&#x3a;varchar,&#x27;-&#x27;,&#x27;&#x27;&#x29;                                                                                                                                    &#xd;&#xa;	                            ELSE                                                                                                                                                    &#xd;&#xa;	                                &#x27;0&#x27;                                                                                                                                                  &#xd;&#xa;	                            END as  saldo_anterior_credora                                                                                                                         &#xd;&#xa;	                 , vl_saldo_debitos                                                                                                                                                   &#xd;&#xa;	                 , vl_saldo_creditos &#x2a; -1 as vl_saldo_creditos                                                                                                                                        &#xd;&#xa;	                 , CASE WHEN vl_saldo_atual &#x3e;&#x3d;0 THEN                                                                                                                                   &#xd;&#xa;	                                 replace&#x28;vl_saldo_atual&#x3a;&#x3a;varchar,&#x27;-&#x27;,&#x27;&#x27;&#x29;                                                                                                                                       &#xd;&#xa;	                             ELSE                                                                                                                                                    &#xd;&#xa;	                                 &#x27;0&#x27;                                                                                                                                                  &#xd;&#xa;	                             END as  saldo_atual_devedora                                                                                                                           &#xd;&#xa;	                 , CASE WHEN vl_saldo_atual &#x3c;0 THEN                                                                                                                                    &#xd;&#xa;	                                 replace&#x28;vl_saldo_atual&#x3a;&#x3a;varchar,&#x27;-&#x27;,&#x27;&#x27;&#x29;                                                                                                                                       &#xd;&#xa;	                             ELSE                                                                                                                                                    &#xd;&#xa;	                                 &#x27;0&#x27;                                                                                                                                                  &#xd;&#xa;	                             END as  saldo_atual_credora                                                                                                                            &#xd;&#xa;	                 , CASE WHEN trim&#x28;both &#x27; &#x27; from nom_sistema&#x29; &#x3d; &#x27;N&#xe3;o Informado&#x27; THEN                                                                                                                     &#xd;&#xa;	                             &#x27;&#x27;                                                                                                                                                    &#xd;&#xa;	                             ELSE nom_sistema                                                                                                                                &#xd;&#xa;	                             END as nom_sistema                                                                                                                                                   &#xd;&#xa;	                 , CASE WHEN tabela.escrituracao &#x3d; &#x27;analitica&#x27; THEN                                                                                                                        &#xd;&#xa;	                             &#x27;S&#x27;                                                                                                                                                   &#xd;&#xa;	                     WHEN tabela.escrituracao &#x3d; &#x27;sintetica&#x27; THEN                                                                                                                        &#xd;&#xa;	                             &#x27;N&#x27;                                                                                                                                                   &#xd;&#xa;	                             END as escrituracao                                                                                                                                                   &#xd;&#xa;	                 , CASE WHEN tabela.indicador_superavit &#x3d; &#x27;permanente&#x27; THEN                                                                                                                        &#xd;&#xa;	                             &#x27;P&#x27;                                                                                                                                                   &#xd;&#xa;	                         WHEN tabela.indicador_superavit &#x3d; &#x27;financeiro&#x27; THEN                                                                                                                        &#xd;&#xa;	                             &#x27;F&#x27;                                                                                                                                                   &#xd;&#xa;	                             END as indicador_superavit                                                                                                                                                   &#xd;&#xa;	                 , tipo_conta                                                                                                                                                         &#xd;&#xa;	                 , tabela.cod_recurso                                                                                                                                                 &#xd;&#xa;				FROM &#xd;&#xa;				&#x28;&#xd;&#xa;				                    SELECT &#x2a;&#xd;&#xa;				                   	FROM &#xd;&#xa;				                   	&#x28; &#xd;&#xa;				                        SELECT&#xd;&#xa;				                            tabela.cod_estrutural&#xd;&#xa;				                            , CASE WHEN pce.cod_entidade IS NOT NULL&#xd;&#xa;				                                        THEN pce.cod_entidade&#xd;&#xa;				                                ELSE pba.cod_entidade&#xd;&#xa;				                              END AS cod_entidade&#xd;&#xa;				                            , nivel&#xd;&#xa;				                            , tabela.nom_conta&#xd;&#xa;				                            , vl_saldo_anterior&#xd;&#xa;				                            , vl_saldo_debitos&#xd;&#xa;				                            , vl_saldo_creditos&#xd;&#xa;				                            , vl_saldo_atual &#xd;&#xa;				                            , contabilidade.fn_tipo_conta_plano&#x28;pc.exercicio, tabela.cod_estrutural&#x29; AS tipo_conta&#xd;&#xa;				                            , sc.nom_sistema&#xd;&#xa;				                            , escrituracao&#xd;&#xa;				                            , tabela.indicador_superavit&#xd;&#xa;				                            , CASE WHEN tabela.cod_estrutural LIKE &#x27;8.2.1.1.1&#x25;&#x27;&#xd;&#xa;				                                   THEN COALESCE&#x28;plano_recurso.cod_recurso, 0&#x29;&#xd;&#xa;				                                   ELSE 0&#xd;&#xa;				                              END AS cod_recurso&#xd;&#xa;				                        &#xd;&#xa;				                        FROM contabilidade.fn_rl_balancete_verificacao&#x28;  stExercicio , stEntidade_bver  ,stDtinicio  ,stDtfim , &#x27;A&#x27;&#x3a;&#x3a;char&#x29;				                        &#xd;&#xa;				                        AS tabela &#x28;cod_estrutural VARCHAR&#xd;&#xa;				                                        , nivel INTEGER&#xd;&#xa;				                                        , nom_conta VARCHAR&#xd;&#xa;				                                        , cod_sistema INTEGER&#xd;&#xa;				                                        , indicador_superavit CHAR&#x28;12&#x29;&#xd;&#xa;				                                        , vl_saldo_anterior NUMERIC&#xd;&#xa;				                                        , vl_saldo_debitos NUMERIC&#xd;&#xa;				                                        , vl_saldo_creditos NUMERIC&#xd;&#xa;				                                        , vl_saldo_atual NUMERIC&#xd;&#xa;				                                        &#x29; &#xd;&#xa;				                            , contabilidade.plano_conta as pc &#xd;&#xa;				                    	LEFT JOIN contabilidade.plano_analitica &#xd;&#xa;				                           ON plano_analitica.cod_conta &#x3d; pc.cod_conta&#xd;&#xa;				                          AND plano_analitica.exercicio &#x3d; pc.exercicio&#xd;&#xa;				                    	LEFT JOIN contabilidade.plano_recurso&#xd;&#xa;				                           ON plano_recurso.cod_plano &#x3d; plano_analitica.cod_plano&#xd;&#xa;				                          AND plano_recurso.exercicio &#x3d; plano_analitica.exercicio&#xd;&#xa;				                    	LEFT JOIN &#x28; &#xd;&#xa;				                               SELECT&#xd;&#xa;				                                     pb.cod_entidade               &#xd;&#xa;				                                    , pa.cod_conta               &#xd;&#xa;				                                    , pa.exercicio               &#xd;&#xa;				                                 FROM               &#xd;&#xa;				                                    contabilidade.plano_banco as pb,               &#xd;&#xa;				                                    contabilidade.plano_analitica as pa               &#xd;&#xa;				                               WHERE               &#xd;&#xa;				                                    pb.cod_plano    &#x3d; pa.cod_plano AND               &#xd;&#xa;				                                    pb.exercicio    &#x3d; pa.exercicio               &#xd;&#xa;				                      	&#x29; as pba&#xd;&#xa;				                        	ON &#x28;  pc.cod_conta   &#x3d; pba.cod_conta AND               &#xd;&#xa;				                                pc.exercicio   &#x3d; pba.exercicio &#x29;               &#xd;&#xa;				                    	LEFT JOIN tcers.plano_conta_entidade as pce               &#xd;&#xa;				                           ON &#x28; pc.cod_conta   &#x3d; pce.cod_conta AND               &#xd;&#xa;				                                 pc.exercicio   &#x3d; pce.exercicio &#x29;,               &#xd;&#xa;				                        		contabilidade.sistema_contabil as sc &#xd;&#xa;				                    	WHERE &#xd;&#xa;				                    		&#x27;2017&#x27; &#x3d; pc.exercicio&#xd;&#xa;				                      		AND tabela.cod_estrutural &#x3d; pc.cod_estrutural&#xd;&#xa;				                      		AND pc.exercicio &#x3d; sc.exercicio&#xd;&#xa;				                      		AND pc.cod_sistema &#x3d; sc.cod_sistema &#xd;&#xa;				                    &#x29; AS tabela&#xd;&#xa;				                	WHERE &#xd;&#xa;				                		cod_entidade IS NULL&#xd;&#xa;				                   		OR cod_entidade IN &#x28;select  unnest&#x28;regexp_split_to_array&#x28;stEntidade, E&#x27;&#x5c;,&#x27;&#x29;&#x29;&#x3a;&#x3a;int&#x29;   &#xd;&#xa;				&#x29; AS tabela&#xd;&#xa;				WHERE &#x28;vl_saldo_debitos &#x3c;&#x3e; 0.00 or vl_saldo_creditos &#x3c;&#x3e; 0.00 or vl_saldo_anterior &#x3c;&#x3e; 0.00 &#x29;&#xd;&#xa;				ORDER BY cod_estrutural &#xd;&#xa;			&#x29;&#xd;&#xa;			, balver_format as &#xd;&#xa;			&#x28;&#xd;&#xa;				select &#xd;&#xa;					   &#x28;stCnpjSetor    &#xd;&#xa;					&#x7c;&#x7c;  replace&#x28;stDtinicio, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29; &#xd;&#xa;					&#x7c;&#x7c;  replace&#x28;stDtfim, &#x27;&#x2f;&#x27;, &#x27;&#x27;&#x29;&#xd;&#xa;					&#x7c;&#x7c;  to_char&#x28;now&#x28;&#x29;, &#x27;ddmmyyyy&#x27;&#x29;					   &#xd;&#xa;					&#x7c;&#x7c;  rpad&#x28; upper&#x28;stNomeSetor&#x29;, 80, &#x27; &#x27;&#x29; &#x29;  as registro_balver					&#xd;&#xa;				union all	   &#xd;&#xa;				select&#xd;&#xa;							lpad&#x28;coalesce&#x28;cod_estrutural&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 20, &#x27;0&#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;stOrgao, 4, &#x27;0&#x27;&#x29;		  &#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;replace&#x28;saldo_anterior_devedora&#x3a;&#x3a;varchar, &#x27;.&#x27;,&#x27;&#x27;&#x29;, &#x27;0&#x27;&#x29;, 13, &#x27;0&#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;replace&#x28;saldo_anterior_credora&#x3a;&#x3a;varchar, &#x27;.&#x27;,&#x27;&#x27;&#x29;, &#x27;0&#x27;&#x29;, 13, &#x27;0&#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;replace&#x28;vl_saldo_debitos&#x3a;&#x3a;varchar, &#x27;.&#x27;,&#x27;&#x27;&#x29;, &#x27;0&#x27;&#x29;, 13, &#x27;0&#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;replace&#x28;vl_saldo_creditos&#x3a;&#x3a;varchar, &#x27;.&#x27;,&#x27;&#x27;&#x29;, &#x27;0&#x27;&#x29;, 13, &#x27;0&#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;replace&#x28;saldo_atual_devedora&#x3a;&#x3a;varchar, &#x27;.&#x27;,&#x27;&#x27;&#x29;, &#x27;0&#x27;&#x29;, 13, &#x27;0&#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;replace&#x28;saldo_atual_credora&#x3a;&#x3a;varchar, &#x27;.&#x27;,&#x27;&#x27;&#x29;, &#x27;0&#x27;&#x29;, 13, &#x27;0&#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; rpad&#x28;coalesce&#x28;nom_conta&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 148, &#x27; &#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;tipo_conta&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 1, &#x27; &#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;nivel&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 2, &#x27;0&#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; &#x27; &#x27;    &#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;escrituracao&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 1, &#x27; &#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;natureza_informacao&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 1, &#x27; &#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;indicador_superavit&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 1, &#x27; &#x27;&#x29;&#xd;&#xa;				  	&#x7c;&#x7c; lpad&#x28;coalesce&#x28;cod_recurso&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;, 4, &#x27;0&#x27;&#x29;&#xd;&#xa;				  	as registro_balver&#xd;&#xa;				from balver&#xd;&#xa;			   	union all&#xd;&#xa;			   	select &#x27;FINALIZADOR&#x27;  &#x7c;&#x7c; lpad&#x28;&#x28;&#x28;select COUNT&#x28;&#x2a;&#x29;&#x3a;&#x3a;varchar  from balver&#x29;&#x3a;&#x3a;varchar&#x29;, 10, &#x27;0&#x27;&#x29;  as registro_balver&#xd;&#xa;			&#x29; &#xd;&#xa;			insert into tmp_table &#x28;arquivo,content&#x29; &#xd;&#xa;				select  &#x27;BAL_VER.TXT&#x27;, json_agg&#x28;     regexp_replace&#x28;  registro_balver  ,&#x27;&#x5c;r&#x7c;&#x5c;n&#x7c;&#x5c;f&#x7c;&#x5c;t&#x27;,&#x27; &#x27;, &#x27;g&#x27;&#x29;     &#x29; from balver_format&#x3b;   &#xd;&#xa;    end if&#x3b;&#xd;&#xa;			&#xd;&#xa;    &#xd;&#xa;    update prestacao_contas.fila_relatorio &#xd;&#xa;    	set &#xd;&#xa;    		  resposta &#x3d; &#x28;select  json_object_agg&#x28;t.arquivo,t.content&#x29; from tmp_table t&#x29;&#xd;&#xa;      	where id &#x3d; inId&#x3b;&#xd;&#xa;    &#xd;&#xa;    &#xd;&#xa;    DROP TABLE tmp_table&#x3b;&#xd;&#xa;    &#xd;&#xa;    &#xd;&#xa;    return stResultado&#x3b;&#xd;&#xa;&#xd;&#xa;   &#xd;&#xa; EXCEPTION  &#xd;&#xa;   	when others then&#xd;&#xa;   	    &#xd;&#xa;	    stError &#x3a;&#x3d; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;SQLErro&#x27;, REPLACE&#x28; SQLERRM, &#x27;&#x22;&#x27;, &#x27;&#x2a;&#x27;&#x29;&#x29;&#x3b;&#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Entidade&#x27;, COALESCE&#x28;stEntidade&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;&#x29;&#x3b;&#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Exercicio&#x27;, COALESCE&#x28;stExercicio&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;&#x29;&#x3b;&#xd;&#xa;	    --stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Mes&#x27;, COALESCE&#x28;CAST&#x28;stMes as text&#x29;, &#x27;&#x27;&#x29;&#x29;&#x3b;&#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Mes&#x27;, &#x27;N_UTIL&#x27;&#x29;&#x3b;&#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Dtinicio&#x27;, COALESCE&#x28;stDtinicio&#x3a;&#x3a;varchar,&#x27;&#x27;&#x29;&#x29;&#x3b;&#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Dtfim&#x27;, COALESCE&#x28;stDtfim&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;&#x29;&#x3b;&#xd;&#xa;	    stError &#x3a;&#x3d; &#x27;&#x27; &#x7c;&#x7c; stError &#x7c;&#x7c; prestacao_contas.getVariablesKeyAndValue&#x28;&#x27;Orgao&#x27;, COALESCE&#x28;stOrgao&#x3a;&#x3a;varchar, &#x27;&#x27;&#x29;&#x29;&#x3b;&#xd;&#xa;    &#xd;&#xa;   		stResultado &#x3a;&#x3d;  &#x27;nok&#x27;&#x3b;&#xd;&#xa;   		&#xd;&#xa;   		stError &#x3a;&#x3d; prestacao_contas.processa_status_erro&#x28;inId, stError&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;   		Return stResultado&#x3b;	    	&#xd;&#xa;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;function&#x24;&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>urbem</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>192</yloc>
    </entry>
    <entry>
      <name>BI_CONTROLE_FUNCOES_GLOBAIS</name>
      <description/>
      <type>JOB</type>
      <specification_method>rep_name</specification_method>
      <job_object_id/>
      <filename/>
      <jobname>BI_CONTROLE_FUNCOES_GLOBAIS</jobname>
      <directory>&#x2f;COMPARTILHADO</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Nothing</loglevel>
      <slave_server_name/>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <expand_remote_job>N</expand_remote_job>
      <create_parent_folder>N</create_parent_folder>
      <pass_export>N</pass_export>
      <parameters>        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>      <set_append_logfile>N</set_append_logfile>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>128</yloc>
    </entry>
  </entries>
  <hops>
    <hop>
      <from>SJ_020_ESS_UPD_STATUS_PROCESSANDO</from>
      <to>SJ_030_ESS_EXEC_FUNCTION</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_030_ESS_EXEC_FUNCTION</from>
      <to>SJ_040_ESS_UPD_STATUS_PRONTO</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_040_ESS_UPD_STATUS_PRONTO</from>
      <to>Success</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_010_ESS_CREATE_SCHEMA_FUNCTION</from>
      <to>SJ_020_ESS_UPD_STATUS_PROCESSANDO</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>BI_CONTROLE_FUNCOES_GLOBAIS</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>BI_CONTROLE_FUNCOES_GLOBAIS</from>
      <to>SJ_010_ESS_CREATE_SCHEMA_FUNCTION</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
  </hops>
  <notepads>
  </notepads>
</job>
