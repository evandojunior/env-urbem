<job>
  <name>BI_BALANCETE_CONTABIL_JOB_PRE_BALANCETE_ARQ</name>
  <description/>
  <extended_description/>
  <job_version/>
  <job_status>0</job_status>
  <directory>&#x2f;BALANCETE_CONTABIL</directory>
  <created_user>-</created_user>
  <created_date>2017&#x2f;04&#x2f;04 12&#x3a;26&#x3a;13.494</created_date>
  <modified_user>-</modified_user>
  <modified_date>2017&#x2f;05&#x2f;04 15&#x3a;46&#x3a;34.872</modified_date>
    <parameters>
    </parameters>
  <connection>
    <name>urbem</name>
    <server>&#x24;&#x7b;DB_HOST_NAME&#x7d;</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>&#x24;&#x7b;DB_NAME&#x7d;</database>
    <port>&#x24;&#x7b;DB_PORT&#x7d;</port>
    <username>&#x24;&#x7b;DB_USER_NAME&#x7d;</username>
    <password>&#x24;&#x7b;DB_PASSWORD&#x7d;</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>&#x24;&#x7b;DB_PORT&#x7d;</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>urbem-etl</name>
    <server>&#x24;&#x7b;DB_ETL_HOST_NAME&#x7d;</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>&#x24;&#x7b;DB_ETL_NAME&#x7d;</database>
    <port>&#x24;&#x7b;DB_ETL_PORT&#x7d;</port>
    <username>&#x24;&#x7b;DB_ETL_USER_NAME&#x7d;</username>
    <password>&#x24;&#x7b;DB_ETL_PASSWORD&#x7d;</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>&#x24;&#x7b;DB_ETL_PORT&#x7d;</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
    <slaveservers>
    </slaveservers>
      <job-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_JOB</id>
          <enabled>Y</enabled>
          <name>ID_JOB</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>JOBNAME</id>
          <enabled>Y</enabled>
          <name>JOBNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>START_JOB_ENTRY</id>
          <enabled>N</enabled>
          <name>START_JOB_ENTRY</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </job-log-table>
      <jobentry-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>JOBNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>JOBENTRYNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>RESULT</id>
          <enabled>Y</enabled>
          <name>RESULT</name>
        </field>
        <field>
          <id>NR_RESULT_ROWS</id>
          <enabled>Y</enabled>
          <name>NR_RESULT_ROWS</name>
        </field>
        <field>
          <id>NR_RESULT_FILES</id>
          <enabled>Y</enabled>
          <name>NR_RESULT_FILES</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>COPY_NR</id>
          <enabled>N</enabled>
          <name>COPY_NR</name>
        </field>
      </jobentry-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
   <pass_batchid>N</pass_batchid>
   <shared_objects_file/>
  <entries>
    <entry>
      <name>START</name>
      <description/>
      <type>SPECIAL</type>
      <start>Y</start>
      <dummy>N</dummy>
      <repeat>N</repeat>
      <schedulerType>0</schedulerType>
      <intervalSeconds>0</intervalSeconds>
      <intervalMinutes>60</intervalMinutes>
      <hour>12</hour>
      <minutes>0</minutes>
      <weekDay>1</weekDay>
      <DayOfMonth>1</DayOfMonth>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>224</xloc>
      <yloc>64</yloc>
    </entry>
    <entry>
      <name>Success</name>
      <description/>
      <type>SUCCESS</type>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>672</xloc>
      <yloc>768</yloc>
    </entry>
    <entry>
      <name>SJ_010_BI_BALANCETE_CONTABIL_TRF_PLANO_CONTA</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>BI_BALANCETE_CONTABIL_TRF_PLANO_CONTA</transname>
      <directory>&#x2f;BALANCETE_CONTABIL</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>672</xloc>
      <yloc>288</yloc>
    </entry>
    <entry>
      <name>SJ_020_BI_BALANCETE_CONTABIL_TRF_LANCAMENTO</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>BI_BALANCETE_CONTABIL_TRF_LANCAMENTO</transname>
      <directory>&#x2f;BALANCETE_CONTABIL</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>672</xloc>
      <yloc>352</yloc>
    </entry>
    <entry>
      <name>SJ_030_BI_BALANCETE_CONTABIL_TRF_BALANCETE</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>BI_BALANCETE_CONTABIL_TRF_BALANCETE</transname>
      <directory>&#x2f;BALANCETE_CONTABIL</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>672</xloc>
      <yloc>416</yloc>
    </entry>
    <entry>
      <name>SJ_040_BI_BALANCETE_CONTABIL_TRF_BALANCETE_VALORES</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>BI_BALANCETE_CONTABIL_TRF_BALANCETE_VALORES</transname>
      <directory>&#x2f;BALANCETE_CONTABIL</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>672</xloc>
      <yloc>480</yloc>
    </entry>
    <entry>
      <name>SJ_050_BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_11</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_11</transname>
      <directory>&#x2f;BALANCETE_CONTABIL</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>672</xloc>
      <yloc>544</yloc>
    </entry>
    <entry>
      <name>SJ_060_BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_12</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_12</transname>
      <directory>&#x2f;BALANCETE_CONTABIL</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>672</xloc>
      <yloc>608</yloc>
    </entry>
    <entry>
      <name>SJ_070_BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_14</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_14</transname>
      <directory>&#x2f;BALANCETE_CONTABIL</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>672</xloc>
      <yloc>672</yloc>
    </entry>
    <entry>
      <name>SJ_010_ABT</name>
      <description/>
      <type>ABORT</type>
      <message>SJ_010_BI_BALANCETE_CONTABIL_TRF_PLANO_CONTA</message>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>1056</xloc>
      <yloc>288</yloc>
    </entry>
    <entry>
      <name>SJ_020_ABT</name>
      <description/>
      <type>ABORT</type>
      <message>SJ_020_BI_BALANCETE_CONTABIL_TRF_LANCAMENTO</message>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>1056</xloc>
      <yloc>352</yloc>
    </entry>
    <entry>
      <name>SJ_030_ABT</name>
      <description/>
      <type>ABORT</type>
      <message>SJ_030_BI_BALANCETE_CONTABIL_TRF_BALANCETE</message>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>1056</xloc>
      <yloc>416</yloc>
    </entry>
    <entry>
      <name>SJ_040_ABT</name>
      <description/>
      <type>ABORT</type>
      <message>SJ_040_BI_BALANCETE_CONTABIL_TRF_BALANCETE_VALORES</message>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>1056</xloc>
      <yloc>480</yloc>
    </entry>
    <entry>
      <name>SJ_050_ABT</name>
      <description/>
      <type>ABORT</type>
      <message>SJ_050_BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_11</message>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>1056</xloc>
      <yloc>544</yloc>
    </entry>
    <entry>
      <name>SJ_060_ABT</name>
      <description/>
      <type>ABORT</type>
      <message>SJ_060_BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_12</message>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>1056</xloc>
      <yloc>608</yloc>
    </entry>
    <entry>
      <name>SJ_070_ABT</name>
      <description/>
      <type>ABORT</type>
      <message>SJ_070_BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_14</message>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>1056</xloc>
      <yloc>672</yloc>
    </entry>
    <entry>
      <name>SJ_005_BI_BALANCETE_CONTABIL_TRF_EXEC_PRE_BALANCETE</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>BI_BALANCETE_CONTABIL_TRF_EXEC_PRE_BALANCETE</transname>
      <directory>&#x2f;BALANCETE_CONTABIL</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>224</xloc>
      <yloc>224</yloc>
    </entry>
    <entry>
      <name>SJ_007_SEV_VALIDACAO</name>
      <description/>
      <type>SIMPLE_EVAL</type>
      <valuetype>variable</valuetype>
      <fieldname>EXEC_PRE_BALANCETE</fieldname>
      <variablename>EXEC_PRE_BALANCETE</variablename>
      <fieldtype>boolean</fieldtype>
      <mask/>
      <comparevalue/>
      <minvalue/>
      <maxvalue/>
      <successcondition>equal</successcondition>
      <successnumbercondition>equal</successnumbercondition>
      <successbooleancondition>true</successbooleancondition>
      <successwhenvarset>N</successwhenvarset>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>224</xloc>
      <yloc>288</yloc>
    </entry>
    <entry>
      <name>SJ_003_ESS_SCRIPT_CRIACAO</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;DO &#x24;&#x24;&#xd;&#xa;&#xd;&#xa;-- &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;-- BI      &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;-- &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;&#xd;&#xa;BEGIN&#xd;&#xa;	IF  &#x28;select count&#x28;&#x2a;&#x29; from pg_catalog.pg_namespace where nspname &#x3d; &#x27;bi&#x27;&#x29; &#x3c; 1&#xd;&#xa;	then &#xd;&#xa;	CREATE SCHEMA  bi&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;SET search_path &#x3d; &#x27;bi&#x27;, pg_catalog&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;&#xd;&#xa;-- &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;-- TYPES   &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;-- &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;&#xd;&#xa;if	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_type.typname&#xd;&#xa;		from pg_catalog.pg_type&#xd;&#xa;		inner join pg_catalog.pg_namespace&#xd;&#xa;			on &#x28;pg_type.typnamespace &#x3d; pg_namespace.oid&#x29; &#xd;&#xa;		where &#xd;&#xa;		pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;		and pg_type.typcategory &#x3d; &#x27;C&#x27;&#xd;&#xa;		and pg_type.typname &#x3d; &#x27;balancete_contabil_registro_10&#x27;&#xd;&#xa;	&#x29; IS NULL&#xd;&#xa;THEN&#xd;&#xa;CREATE TYPE balancete_contabil_registro_10 AS&#xd;&#xa;&#x28;&#xd;&#xa;    tipo_registro integer,&#xd;&#xa;    conta_contabil character varying,&#xd;&#xa;    saldo_inicial numeric,&#xd;&#xa;    natureza_saldo_inicial character&#x28;1&#x29;,&#xd;&#xa;    total_debitos numeric,&#xd;&#xa;    total_creditos numeric,&#xd;&#xa;    saldo_final numeric,&#xd;&#xa;    natureza_saldo_final character&#x28;1&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;if	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_type.typname&#xd;&#xa;		from pg_catalog.pg_type&#xd;&#xa;		inner join pg_catalog.pg_namespace&#xd;&#xa;			on &#x28;pg_type.typnamespace &#x3d; pg_namespace.oid&#x29; &#xd;&#xa;		where &#xd;&#xa;		pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;		and pg_type.typcategory &#x3d; &#x27;C&#x27;&#xd;&#xa;		and pg_type.typname &#x3d; &#x27;balancete_contabil_registro_11&#x27;&#xd;&#xa;	&#x29; IS NULL&#xd;&#xa;THEN&#xd;&#xa;CREATE TYPE balancete_contabil_registro_11 AS &#x28;&#xd;&#xa;	tipo_registro integer,&#xd;&#xa;	cod_entidade integer,&#xd;&#xa;	conta_contabil character varying,&#xd;&#xa;	cod_orgao character varying,&#xd;&#xa;	num_orgao integer,&#xd;&#xa;	num_unidade integer,&#xd;&#xa;	cod_funcao integer,&#xd;&#xa;	cod_sub_funcao integer,&#xd;&#xa;	cod_programa integer,&#xd;&#xa;	id_acao integer,&#xd;&#xa;	id_sub_acao character varying,&#xd;&#xa;	natureza_despesa character varying,&#xd;&#xa;	sub_elemento character varying,&#xd;&#xa;	cod_fonte_recursos integer,&#xd;&#xa;	saldo_inicial_cd numeric,&#xd;&#xa;	natureza_saldo_inicial_cd character&#x28;1&#x29;,&#xd;&#xa;	total_debitos_cd numeric,&#xd;&#xa;	total_creditos_cd numeric,&#xd;&#xa;	saldo_final_cd numeric,&#xd;&#xa;	natureza_saldo_final_cd character&#x28;1&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;if	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_type.typname&#xd;&#xa;		from pg_catalog.pg_type&#xd;&#xa;		inner join pg_catalog.pg_namespace&#xd;&#xa;			on &#x28;pg_type.typnamespace &#x3d; pg_namespace.oid&#x29; &#xd;&#xa;		where &#xd;&#xa;		pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;		and pg_type.typcategory &#x3d; &#x27;C&#x27;&#xd;&#xa;		and pg_type.typname &#x3d; &#x27;balancete_contabil_registro_12&#x27;&#xd;&#xa;	&#x29; IS NULL&#xd;&#xa;THEN&#xd;&#xa;CREATE TYPE balancete_contabil_registro_12 AS&#xd;&#xa;&#x28;&#xd;&#xa;    tipo_registro integer,&#xd;&#xa;    conta_contabil character varying,&#xd;&#xa;    natureza_receita character varying,&#xd;&#xa;    cod_fonte_recursos integer,&#xd;&#xa;    saldo_inicial_cr numeric,&#xd;&#xa;    natureza_saldo_inicial_cr character&#x28;1&#x29;,&#xd;&#xa;    total_debitos_cr numeric,&#xd;&#xa;    total_creditos_cr numeric,&#xd;&#xa;    saldo_final_cr numeric,&#xd;&#xa;    natureza_saldo_final_cr character&#x28;1&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;if	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_type.typname&#xd;&#xa;		from pg_catalog.pg_type&#xd;&#xa;		inner join pg_catalog.pg_namespace&#xd;&#xa;			on &#x28;pg_type.typnamespace &#x3d; pg_namespace.oid&#x29; &#xd;&#xa;		where &#xd;&#xa;		pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;		and pg_type.typcategory &#x3d; &#x27;C&#x27;&#xd;&#xa;		and pg_type.typname &#x3d; &#x27;balancete_contabil_registro_13&#x27;&#xd;&#xa;	&#x29; IS NULL&#xd;&#xa;THEN&#xd;&#xa;CREATE TYPE balancete_contabil_registro_13 AS&#xd;&#xa;&#x28;&#xd;&#xa;    tipo_registro integer,&#xd;&#xa;    conta_contabil character varying,&#xd;&#xa;    cod_programa integer,&#xd;&#xa;    id_acao integer,&#xd;&#xa;    id_sub_acao character varying,&#xd;&#xa;    saldo_inicial_pa numeric,&#xd;&#xa;    natureza_saldo_inicial_pa character&#x28;1&#x29;,&#xd;&#xa;    total_debitos_pa numeric,&#xd;&#xa;    total_creditos_pa numeric,&#xd;&#xa;    saldo_final_pa numeric,&#xd;&#xa;    natureza_saldo_final_pa character&#x28;1&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;if	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_type.typname&#xd;&#xa;		from pg_catalog.pg_type&#xd;&#xa;		inner join pg_catalog.pg_namespace&#xd;&#xa;			on &#x28;pg_type.typnamespace &#x3d; pg_namespace.oid&#x29; &#xd;&#xa;		where &#xd;&#xa;		pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;		and pg_type.typcategory &#x3d; &#x27;C&#x27;&#xd;&#xa;		and pg_type.typname &#x3d; &#x27;balancete_contabil_registro_14&#x27;&#xd;&#xa;	&#x29; IS NULL&#xd;&#xa;THEN&#xd;&#xa;CREATE TYPE balancete_contabil_registro_14 AS &#x28;&#xd;&#xa;	tipo_registro integer,&#xd;&#xa;	conta_contabil character varying,&#xd;&#xa;	cod_orgao character varying,&#xd;&#xa;	num_orgao integer,&#xd;&#xa;	num_unidade integer,&#xd;&#xa;	cod_funcao integer,&#xd;&#xa;	cod_sub_funcao integer,&#xd;&#xa;	cod_programa integer,&#xd;&#xa;	id_acao integer,&#xd;&#xa;	natureza_despesa character varying,&#xd;&#xa;	sub_elemento character varying,&#xd;&#xa;	cod_fonte_recursos integer,&#xd;&#xa;	numero_empenho integer,&#xd;&#xa;	ano_inscricao character varying,&#xd;&#xa;	id_sub_acao character varying,&#xd;&#xa;	cod_unidade_sub character varying,&#xd;&#xa;	cod_unidade_sub_orig character varying,&#xd;&#xa;	saldo_inicial_rsp numeric,&#xd;&#xa;	natureza_saldo_inicial_rsp character&#x28;1&#x29;,&#xd;&#xa;	total_debitos_rsp numeric,&#xd;&#xa;	total_creditos_rsp numeric,&#xd;&#xa;	saldo_final_rsp numeric,&#xd;&#xa;	natureza_saldo_final_rsp character&#x28;1&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;if	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_type.typname&#xd;&#xa;		from pg_catalog.pg_type&#xd;&#xa;		inner join pg_catalog.pg_namespace&#xd;&#xa;			on &#x28;pg_type.typnamespace &#x3d; pg_namespace.oid&#x29; &#xd;&#xa;		where &#xd;&#xa;		pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;		and pg_type.typcategory &#x3d; &#x27;C&#x27;&#xd;&#xa;		and pg_type.typname &#x3d; &#x27;balancete_contabil_registro_15&#x27;&#xd;&#xa;	&#x29; IS NULL&#xd;&#xa;THEN&#xd;&#xa;CREATE TYPE balancete_contabil_registro_15 AS&#xd;&#xa;&#x28;&#xd;&#xa;    tipo_registro integer,&#xd;&#xa;    conta_contabil character varying,&#xd;&#xa;    atributo_sf character varying,&#xd;&#xa;    saldo_inicial_sf numeric,&#xd;&#xa;    natureza_saldo_inicial_sf character&#x28;1&#x29;,&#xd;&#xa;    total_debitos_sf numeric,&#xd;&#xa;    total_creditos_sf numeric,&#xd;&#xa;    saldo_final_sf numeric,&#xd;&#xa;    natureza_saldo_final_sf character&#x28;1&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;if	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_type.typname&#xd;&#xa;		from pg_catalog.pg_type&#xd;&#xa;		inner join pg_catalog.pg_namespace&#xd;&#xa;			on &#x28;pg_type.typnamespace &#x3d; pg_namespace.oid&#x29; &#xd;&#xa;		where &#xd;&#xa;		pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;		and pg_type.typcategory &#x3d; &#x27;C&#x27;&#xd;&#xa;		and pg_type.typname &#x3d; &#x27;balancete_contabil_registro_16&#x27;&#xd;&#xa;	&#x29; IS NULL&#xd;&#xa;THEN&#xd;&#xa;CREATE TYPE balancete_contabil_registro_16 AS&#xd;&#xa;&#x28;&#xd;&#xa;    tipo_registro integer,&#xd;&#xa;    conta_contabil character varying,&#xd;&#xa;    atributo_sf character varying,&#xd;&#xa;    cod_fonte_recursos integer,&#xd;&#xa;    saldo_inicial_fonte_sf numeric,&#xd;&#xa;    natureza_saldo_inicial_fonte_sf character&#x28;1&#x29;,&#xd;&#xa;    total_debitos_fonte_sf numeric,&#xd;&#xa;    total_creditos_fonte_sf numeric,&#xd;&#xa;    saldo_final_fonte_sf numeric,&#xd;&#xa;    natureza_saldo_final_fonte_sf character&#x28;1&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;if	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_type.typname&#xd;&#xa;		from pg_catalog.pg_type&#xd;&#xa;		inner join pg_catalog.pg_namespace&#xd;&#xa;			on &#x28;pg_type.typnamespace &#x3d; pg_namespace.oid&#x29; &#xd;&#xa;		where &#xd;&#xa;		pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;		and pg_type.typcategory &#x3d; &#x27;C&#x27;&#xd;&#xa;		and pg_type.typname &#x3d; &#x27;balancete_contabil_registro_17&#x27;&#xd;&#xa;	&#x29; IS NULL&#xd;&#xa;THEN&#xd;&#xa;CREATE TYPE balancete_contabil_registro_17 AS&#xd;&#xa;&#x28;&#xd;&#xa;    tipo_registro integer,&#xd;&#xa;    conta_contabil character varying,&#xd;&#xa;    atributo_sf character varying,&#xd;&#xa;    cod_ctb integer,&#xd;&#xa;    cod_fonte_recursos integer,&#xd;&#xa;    saldo_inicial_ctb numeric,&#xd;&#xa;    natureza_saldo_inicial_ctb character&#x28;1&#x29;,&#xd;&#xa;    total_debitos_ctb numeric,&#xd;&#xa;    total_creditos_ctb numeric,&#xd;&#xa;    saldo_final_ctb numeric,&#xd;&#xa;    natureza_saldo_final_ctb character&#x28;1&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;if	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_type.typname&#xd;&#xa;		from pg_catalog.pg_type&#xd;&#xa;		inner join pg_catalog.pg_namespace&#xd;&#xa;			on &#x28;pg_type.typnamespace &#x3d; pg_namespace.oid&#x29; &#xd;&#xa;		where &#xd;&#xa;		pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;		and pg_type.typcategory &#x3d; &#x27;C&#x27;&#xd;&#xa;		and pg_type.typname &#x3d; &#x27;balancete_contabil_registro_18&#x27;&#xd;&#xa;	&#x29; IS NULL&#xd;&#xa;THEN&#xd;&#xa;CREATE TYPE balancete_contabil_registro_18 AS&#xd;&#xa;&#x28;&#xd;&#xa;    tipo_registro integer,&#xd;&#xa;    conta_contabil character varying,&#xd;&#xa;    cod_fonte_recursos integer,&#xd;&#xa;    saldo_inicial_fr numeric,&#xd;&#xa;    natureza_saldo_inicial_fr character&#x28;1&#x29;,&#xd;&#xa;    total_debitos_fr numeric,&#xd;&#xa;    total_creditos_fr numeric,&#xd;&#xa;    saldo_final_fr numeric,&#xd;&#xa;    natureza_saldo_final_fr character&#x28;1&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;if	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_type.typname&#xd;&#xa;		from pg_catalog.pg_type&#xd;&#xa;		inner join pg_catalog.pg_namespace&#xd;&#xa;			on &#x28;pg_type.typnamespace &#x3d; pg_namespace.oid&#x29; &#xd;&#xa;		where &#xd;&#xa;		pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;		and pg_type.typcategory &#x3d; &#x27;C&#x27;&#xd;&#xa;		and pg_type.typname &#x3d; &#x27;balancete_contabil_registro_22&#x27;&#xd;&#xa;	&#x29; IS NULL&#xd;&#xa;THEN&#xd;&#xa;CREATE TYPE balancete_contabil_registro_22 AS&#xd;&#xa;&#x28;&#xd;&#xa;    tipo_registro integer,&#xd;&#xa;    conta_contabil character varying,&#xd;&#xa;    atributo_sf character varying,&#xd;&#xa;    cod_ctb integer,&#xd;&#xa;    saldo_inicial_ctb_sf numeric,&#xd;&#xa;    natureza_saldo_inicial_ctb_sf character&#x28;1&#x29;,&#xd;&#xa;    total_debitos_ctb_sf numeric,&#xd;&#xa;    total_creditos_ctb_sf numeric,&#xd;&#xa;    saldo_final_ctb_sf numeric,&#xd;&#xa;    natureza_saldo_final_ctb_sf character&#x28;1&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;if	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_type.typname&#xd;&#xa;		from pg_catalog.pg_type&#xd;&#xa;		inner join pg_catalog.pg_namespace&#xd;&#xa;			on &#x28;pg_type.typnamespace &#x3d; pg_namespace.oid&#x29; &#xd;&#xa;		where &#xd;&#xa;		pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;		and pg_type.typcategory &#x3d; &#x27;C&#x27;&#xd;&#xa;		and pg_type.typname &#x3d; &#x27;gera_csv&#x27;&#xd;&#xa;	&#x29; IS NULL&#xd;&#xa;THEN&#xd;&#xa;CREATE TYPE gera_csv AS&#xd;&#xa;&#x28;&#xd;&#xa;	linha character varying&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;-- &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;-- Funcoes   &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;-- &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_10&#x28;character varying, character varying, character varying&#x29; RETURNS SETOF balancete_contabil_registro_10&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;2&#x3b;&#xd;&#xa;    stFiltro            ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stSql               VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento    VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    reRegistro          RECORD&#x3b;&#xd;&#xa;    arRetorno           NUMERIC&#x5b;&#x5d;&#x3b;&#xd;&#xa;BEGIN&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;&#xd;&#xa;           SELECT 10&#x3a;&#x3a;INTEGER AS tipo_registro&#xd;&#xa;                , pc.cod_estrutural&#xd;&#xa;                , 0.00 as vl_saldo_inicial&#xd;&#xa;                --, &#x27;&#x27; &#x27;&#x27;&#x3a;&#x3a;CHAR&#x28;1&#x29; AS natureza_saldo_incial&#xd;&#xa;                , natureza_saldo AS natureza_saldo_incial&#xd;&#xa;                , 0.00 as vl_saldo_debitos&#xd;&#xa;                , 0.00 as vl_saldo_creditos&#xd;&#xa;                , 0.00 as vl_saldo_final&#xd;&#xa;                --, &#x27;&#x27; &#x27;&#x27;&#x3a;&#x3a;CHAR&#x28;1&#x29; AS natureza_saldo_final&#xd;&#xa;                , natureza_saldo AS natureza_saldo_final&#xd;&#xa;             FROM bi.plano_conta as pc&#xd;&#xa;            WHERE pc.exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;              AND pc.escrituracao_pcasp &#x3d; &#x27;&#x27;S&#x27;&#x27;&#xd;&#xa;         ORDER BY cod_estrutural ASC&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    FOR reRegistro IN EXECUTE stSql&#xd;&#xa;    LOOP&#xd;&#xa;        arRetorno &#x3a;&#x3d; bi.fn_totaliza_balancete_verificacao&#x28;publico.fn_mascarareduzida&#x28;reRegistro.cod_estrutural&#x29;, stExercicio, stMes, stFiltro&#x29;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_inicial  &#x3a;&#x3d; arRetorno&#x5b;1&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_debitos  &#x3a;&#x3d; arRetorno&#x5b;2&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_creditos &#x3a;&#x3d; arRetorno&#x5b;3&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_final    &#x3a;&#x3d; arRetorno&#x5b;4&#x5d;&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;1&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;1&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; reRegistro.natureza_saldo_incial&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;4&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;4&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; reRegistro.natureza_saldo_final&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;        &#xd;&#xa;        IF  &#x28; reRegistro.vl_saldo_inicial  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_debitos  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_creditos &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_final    &#x3d; 0.00 &#x29;&#xd;&#xa;        THEN&#xd;&#xa;        &#xd;&#xa;        ELSE&#xd;&#xa;            RETURN NEXT reRegistro&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;    END LOOP&#x3b;&#xd;&#xa;&#xd;&#xa;    RETURN&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5276 &#x28;class 1255 OID 7485703&#x29;&#xd;&#xa;-- Name&#x3a; fn_balancete_contabil_11&#x28;character varying, character varying, character varying&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_11&#x28;character varying, character varying, character varying&#x29; RETURNS SETOF balancete_contabil_registro_11&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;2&#x3b;&#xd;&#xa;    stFiltro            ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stSql            VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    reRegistro       RECORD&#x3b;&#xd;&#xa;    arRetorno        NUMERIC&#x5b;&#x5d;&#x3b;&#xd;&#xa;BEGIN&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;select &#x2a; from &#x28;&#xd;&#xa;            SELECT 11&#x3a;&#x3a;INTEGER AS tipo_registro&#xd;&#xa;            , tmp_contas_utilizadas.cod_entidade&#xd;&#xa;            , plano_conta.cod_estrutural_contabil AS conta_contabil&#xd;&#xa;            , LPAD&#x28;COALESCE&#x28;configuracao_entidade.valor, &#x27;&#x27;0&#x27;&#x27;&#x29;&#x3a;&#x3a;VARCHAR, 2, &#x27;&#x27;0&#x27;&#x27;&#x29;&#x3a;&#x3a;VARCHAR AS cod_orgao&#xd;&#xa;            , COALESCE&#x28;tmp_contas_utilizadas.num_orgao, 0&#x29; AS num_orgao&#xd;&#xa;            , COALESCE&#x28;tmp_contas_utilizadas.num_unidade, 0&#x29; AS num_unidade&#xd;&#xa;            , COALESCE&#x28;tmp_contas_utilizadas.cod_funcao, 0&#x29; AS cod_funcao&#xd;&#xa;            , COALESCE&#x28;tmp_contas_utilizadas.cod_subfuncao, 0&#x29; AS cod_subfuncao&#xd;&#xa;            , COALESCE&#x28;tmp_contas_utilizadas.num_programa, 0&#x29; AS num_programa&#xd;&#xa;            , COALESCE&#x28;tmp_contas_utilizadas.num_acao, 0&#x29; AS num_acao&#xd;&#xa;            , &#x27;&#x27;0&#x27;&#x27;&#x3a;&#x3a;VARCHAR AS id_sub_acao&#xd;&#xa;            , SUBSTR&#x28;RPAD&#x28;COALESCE&#x28;tmp_contas_utilizadas.natureza_despesa, &#x27;&#x27;0&#x27;&#x27;&#x29;, 8, &#x27;&#x27;0&#x27;&#x27;&#x29;&#x3a;&#x3a;VARCHAR, 1, 6&#x29;&#x3a;&#x3a;VARCHAR AS natureza_despesa&#xd;&#xa;            , SUBSTR&#x28;RPAD&#x28;COALESCE&#x28;tmp_contas_utilizadas.natureza_despesa, &#x27;&#x27;0&#x27;&#x27;&#x29;, 8, &#x27;&#x27;0&#x27;&#x27;&#x29;&#x3a;&#x3a;VARCHAR, 7, 2&#x29;&#x3a;&#x3a;VARCHAR AS sub_elemento&#xd;&#xa;            , COALESCE&#x28;tmp_contas_utilizadas.cod_recurso, 0&#x29; AS cod_recurso&#xd;&#xa;            , 0.00 as vl_saldo_inicial&#xd;&#xa;            , tmp_contas_utilizadas.natureza_saldo AS natureza_saldo_incial&#xd;&#xa;            , 0.00 as vl_saldo_debitos&#xd;&#xa;            , 0.00 as vl_saldo_creditos&#xd;&#xa;            , 0.00 as vl_saldo_final&#xd;&#xa;            , tmp_contas_utilizadas.natureza_saldo AS natureza_saldo_final&#xd;&#xa;        --                , plano_conta.atributo_tcemg&#xd;&#xa;         FROM &#x28;SELECT publico.fn_mascarareduzida&#x28;plano_conta.cod_estrutural&#x29;&#x7c;&#x7c;&#x27;&#x27;&#x25;&#x27;&#x27; AS cod_estrutural_reduzido&#xd;&#xa;                    , plano_conta.cod_estrutural AS cod_estrutural_contabil&#xd;&#xa;                    , plano_conta.atributo_tcemg&#xd;&#xa;                 FROM bi.plano_conta&#xd;&#xa;                WHERE plano_conta.escrituracao_pcasp &#x3d; &#x27;&#x27;S&#x27;&#x27;&#xd;&#xa;                  AND plano_conta.atributo_tcemg &#x3d; 11&#xd;&#xa;                  AND plano_conta.exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;                  &#x29; AS plano_conta&#xd;&#xa;        LEFT JOIN bi.balancete_11 as tmp_contas_utilizadas&#xd;&#xa;               ON tmp_contas_utilizadas.cod_estrutural ILIKE plano_conta.cod_estrutural_reduzido&#xd;&#xa;        LEFT JOIN administracao.configuracao_entidade&#xd;&#xa;               ON configuracao_entidade.exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;          AND configuracao_entidade.cod_entidade &#x3d; tmp_contas_utilizadas.cod_entidade&#xd;&#xa;          AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;          AND configuracao_entidade.parametro &#x3d; &#x27;&#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#x27;&#xd;&#xa;        --where&#xd;&#xa;          --tmp_contas_utilizadas.exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;            --and EXTRACT&#x28;MONTH from date_trunc&#x28;&#x27;&#x27;month&#x27;&#x27;, tmp_contas_utilizadas.dt_lote&#x29;&#x29; &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27;&#xd;&#xa;         GROUP BY conta_contabil&#xd;&#xa;                , cod_orgao&#xd;&#xa;                , tmp_contas_utilizadas.num_orgao&#xd;&#xa;                , tmp_contas_utilizadas.num_unidade&#xd;&#xa;                , tmp_contas_utilizadas.cod_funcao&#xd;&#xa;                , tmp_contas_utilizadas.cod_subfuncao&#xd;&#xa;                , tmp_contas_utilizadas.num_programa&#xd;&#xa;                , tmp_contas_utilizadas.num_acao&#xd;&#xa;                , tmp_contas_utilizadas.cod_entidade&#xd;&#xa;                , id_sub_acao&#xd;&#xa;                , tmp_contas_utilizadas.natureza_despesa&#xd;&#xa;                , tmp_contas_utilizadas.cod_recurso&#xd;&#xa;                , plano_conta.atributo_tcemg&#xd;&#xa;			    , tmp_contas_utilizadas.natureza_saldo&#xd;&#xa;        &#x29; as tabela&#xd;&#xa;        where&#xd;&#xa;          &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27;&#xd;&#xa;          ORDER BY conta_contabil ASC&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    FOR reRegistro IN EXECUTE stSql&#xd;&#xa;    LOOP&#xd;&#xa;        arRetorno &#x3a;&#x3d; bi.fn_balancete_contabil_totaliza_despesa&#x28; publico.fn_mascarareduzida&#x28;reRegistro.conta_contabil&#x29; , reRegistro.num_orgao, reRegistro.num_unidade, reRegistro.cod_funcao, reRegistro.cod_subfuncao, reRegistro.num_programa, reRegistro.num_acao, reRegistro.cod_recurso, reRegistro.natureza_despesa&#x7c;&#x7c;reRegistro.sub_elemento, reRegistro.cod_entidade, stExercicio, stMes&#x29;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_inicial  &#x3a;&#x3d; arRetorno&#x5b;1&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_debitos  &#x3a;&#x3d; arRetorno&#x5b;2&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_creditos &#x3a;&#x3d; arRetorno&#x5b;3&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_final    &#x3a;&#x3d; arRetorno&#x5b;4&#x5d;&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;1&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;1&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; reRegistro.natureza_saldo_incial&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;4&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;4&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; reRegistro.natureza_saldo_final&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;&#xd;&#xa;        IF  &#x28; reRegistro.vl_saldo_inicial  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_debitos  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_creditos &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_final    &#x3d; 0.00 &#x29;&#xd;&#xa;        THEN&#xd;&#xa;&#xd;&#xa;        ELSE&#xd;&#xa;            RETURN NEXT reRegistro&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;    END LOOP&#x3b;&#xd;&#xa;&#xd;&#xa;    RETURN&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5277 &#x28;class 1255 OID 7485704&#x29;&#xd;&#xa;-- Name&#x3a; fn_balancete_contabil_12&#x28;character varying, character varying, character varying&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_12&#x28;character varying, character varying, character varying&#x29; RETURNS SETOF balancete_contabil_registro_12&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    stExercicio      ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stMes            ALIAS FOR &#x24;2&#x3b;    &#xd;&#xa;    stFiltro         ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stSql            VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    reRegistro       RECORD&#x3b;&#xd;&#xa;    arRetorno        NUMERIC&#x5b;&#x5d;&#x3b;&#xd;&#xa;BEGIN&#xd;&#xa;&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;&#xd;&#xa;           SELECT 12&#x3a;&#x3a;INTEGER AS tipo_registro&#xd;&#xa;                , plano_conta.cod_estrutural_contabil AS conta_contabil&#xd;&#xa;                , RPAD&#x28;COALESCE&#x28;tmp_contas_utilizadas.natureza_receita, &#x27;&#x27;0&#x27;&#x27;&#x29;&#x3a;&#x3a;VARCHAR, 8, &#x27;&#x27;0&#x27;&#x27;&#x29;&#x3a;&#x3a;VARCHAR AS natureza_receita_reduzida&#xd;&#xa;                , COALESCE&#x28;tmp_contas_utilizadas.cod_recurso, 0&#x29; AS cod_recurso&#xd;&#xa;                , 0.00 as vl_saldo_inicial&#xd;&#xa;                , tmp_contas_utilizadas.natureza_saldo AS natureza_saldo_incial&#xd;&#xa;                , 0.00 as vl_saldo_debitos&#xd;&#xa;                , 0.00 as vl_saldo_creditos&#xd;&#xa;                , 0.00 as vl_saldo_final&#xd;&#xa;                , tmp_contas_utilizadas.natureza_saldo AS natureza_saldo_final&#xd;&#xa;             FROM &#x28;SELECT publico.fn_mascarareduzida&#x28;plano_conta.cod_estrutural&#x29;&#x7c;&#x7c;&#x27;&#x27;&#x25;&#x27;&#x27; AS cod_estrutural_reduzido&#xd;&#xa;                        , plano_conta.cod_estrutural AS cod_estrutural_contabil&#xd;&#xa;                        , plano_conta.atributo_tcemg&#xd;&#xa;                     FROM bi.plano_conta&#xd;&#xa;                    WHERE plano_conta.escrituracao_pcasp &#x3d; &#x27;&#x27;S&#x27;&#x27;&#xd;&#xa;                      AND plano_conta.atributo_tcemg &#x3d; 12&#xd;&#xa;                      AND plano_conta.exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;                  &#x29; AS plano_conta&#xd;&#xa;        LEFT JOIN bi.balancete_12 as tmp_contas_utilizadas&#xd;&#xa;               ON tmp_contas_utilizadas.cod_estrutural ILIKE plano_conta.cod_estrutural_reduzido&#xd;&#xa;         GROUP BY conta_contabil&#xd;&#xa;                , natureza_receita_reduzida&#xd;&#xa;                , tmp_contas_utilizadas.cod_recurso&#xd;&#xa;			    , tmp_contas_utilizadas.natureza_saldo&#xd;&#xa;          ORDER BY conta_contabil ASC&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;          --where tmp_contas_utilizadas.exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;          --    and tmp_contas_utilizadas.&#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27;&#xd;&#xa;            &#xd;&#xa;    FOR reRegistro IN EXECUTE stSql&#xd;&#xa;    LOOP&#xd;&#xa;        arRetorno &#x3a;&#x3d; bi.fn_balancete_contabil_totaliza_receita&#x28; publico.fn_mascarareduzida&#x28;reRegistro.conta_contabil&#x29;, stExercicio, stMes, stFiltro, reRegistro.cod_recurso, reRegistro.natureza_receita_reduzida&#x29;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_inicial  &#x3a;&#x3d; arRetorno&#x5b;1&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_debitos  &#x3a;&#x3d; arRetorno&#x5b;2&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_creditos &#x3a;&#x3d; arRetorno&#x5b;3&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_final    &#x3a;&#x3d; arRetorno&#x5b;4&#x5d;&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;1&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;1&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; reRegistro.natureza_saldo_incial&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;4&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;4&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; reRegistro.natureza_saldo_final&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;        &#xd;&#xa;        IF  &#x28; reRegistro.vl_saldo_inicial  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_debitos  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_creditos &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_final    &#x3d; 0.00 &#x29;&#xd;&#xa;        THEN&#xd;&#xa;        &#xd;&#xa;        ELSE&#xd;&#xa;            RETURN NEXT reRegistro&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;    END LOOP&#x3b;&#xd;&#xa;&#xd;&#xa;    RETURN&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5278 &#x28;class 1255 OID 7485705&#x29;&#xd;&#xa;-- Name&#x3a; fn_balancete_contabil_13&#x28;character varying, character varying, character varying&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_13&#x28;character varying, character varying, character varying&#x29; RETURNS SETOF balancete_contabil_registro_13&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    stExercicio      ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stMes            ALIAS FOR &#x24;2&#x3b;&#xd;&#xa;    stFiltro         ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stSql            VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    reRegistro       RECORD&#x3b;&#xd;&#xa;    arRetorno        NUMERIC&#x5b;&#x5d;&#x3b;&#xd;&#xa;BEGIN&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;select &#x2a; from &#x28;&#xd;&#xa;           SELECT 13&#x3a;&#x3a;INTEGER AS tipo_registro&#xd;&#xa;				, tmp_contas_utilizadas.cod_entidade&#xd;&#xa;                , plano_conta.cod_estrutural_contabil AS conta_contabil&#xd;&#xa;                , COALESCE&#x28;tmp_contas_utilizadas.num_programa, 0&#x29; AS num_programa&#xd;&#xa;                , COALESCE&#x28;tmp_contas_utilizadas.num_acao, 0&#x29; AS num_acao&#xd;&#xa;                , &#x27;&#x27; &#x27;&#x27;&#x3a;&#x3a;VARCHAR AS id_sub_acao&#xd;&#xa;                , 0.00 as vl_saldo_inicial&#xd;&#xa;                , tmp_contas_utilizadas.natureza_saldo AS natureza_saldo_incial&#xd;&#xa;                , 0.00 as vl_saldo_debitos&#xd;&#xa;                , 0.00 as vl_saldo_creditos&#xd;&#xa;                , 0.00 as vl_saldo_final&#xd;&#xa;                , tmp_contas_utilizadas.natureza_saldo AS natureza_saldo_final&#xd;&#xa;             FROM &#x28;SELECT publico.fn_mascarareduzida&#x28;plano_conta.cod_estrutural&#x29;&#x7c;&#x7c;&#x27;&#x27;&#x25;&#x27;&#x27; AS cod_estrutural_reduzido&#xd;&#xa;                        , plano_conta.cod_estrutural AS cod_estrutural_contabil&#xd;&#xa;                        , plano_conta.atributo_tcemg&#xd;&#xa;                     FROM bi.plano_conta&#xd;&#xa;                    WHERE plano_conta.escrituracao_pcasp &#x3d; &#x27;&#x27;S&#x27;&#x27;&#xd;&#xa;                      AND plano_conta.atributo_tcemg &#x3d; 13&#xd;&#xa;                      AND plano_conta.exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;                  &#x29; AS plano_conta&#xd;&#xa;        LEFT JOIN bi.balancete_11 as tmp_contas_utilizadas&#xd;&#xa;               ON tmp_contas_utilizadas.cod_estrutural ILIKE plano_conta.cod_estrutural_reduzido&#xd;&#xa;         GROUP BY conta_contabil&#xd;&#xa;                , tmp_contas_utilizadas.num_programa&#xd;&#xa;                , tmp_contas_utilizadas.num_acao&#xd;&#xa;                , tmp_contas_utilizadas.cod_entidade&#xd;&#xa;				, id_sub_acao&#xd;&#xa;                , tmp_contas_utilizadas.natureza_saldo&#xd;&#xa;        &#x29; as tabela&#xd;&#xa;        where&#xd;&#xa;          &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27;&#xd;&#xa;          ORDER BY conta_contabil ASC&#x27;&#x3b;&#xd;&#xa;          &#xd;&#xa;          &#xd;&#xa;    FOR reRegistro IN EXECUTE stSql&#xd;&#xa;    LOOP&#xd;&#xa;        arRetorno &#x3a;&#x3d; bi.fn_balancete_contabil_totaliza_programa_acao&#x28; publico.fn_mascarareduzida&#x28;reRegistro.conta_contabil&#x29; , reRegistro.num_programa, reRegistro.num_acao&#x29;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_inicial  &#x3a;&#x3d; arRetorno&#x5b;1&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_debitos  &#x3a;&#x3d; arRetorno&#x5b;2&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_creditos &#x3a;&#x3d; arRetorno&#x5b;3&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_final    &#x3a;&#x3d; arRetorno&#x5b;4&#x5d;&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;1&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;1&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; reRegistro.natureza_saldo_incial&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;4&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;4&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; reRegistro.natureza_saldo_final&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;        &#xd;&#xa;        IF  &#x28; reRegistro.vl_saldo_inicial  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_debitos  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_creditos &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_final    &#x3d; 0.00 &#x29;&#xd;&#xa;        THEN&#xd;&#xa;        &#xd;&#xa;        ELSE&#xd;&#xa;            RETURN NEXT reRegistro&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;    END LOOP&#x3b;&#xd;&#xa;&#xd;&#xa;    RETURN&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5279 &#x28;class 1255 OID 7485706&#x29;&#xd;&#xa;-- Name&#x3a; fn_balancete_contabil_14&#x28;character varying, character varying, character varying&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_14&#x28;character varying, character varying, character varying&#x29; RETURNS SETOF balancete_contabil_registro_14&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;2&#x3b;    &#xd;&#xa;    stFiltro            ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stSql               VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento    VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stExercicioAnterior VARCHAR &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    reRegistro          RECORD&#x3b;&#xd;&#xa;    arRetorno           NUMERIC&#x5b;&#x5d;&#x3b;&#xd;&#xa;BEGIN&#xd;&#xa;    &#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;&#xd;&#xa;  		   SELECT 14&#x3a;&#x3a;INTEGER AS tipo_registro&#xd;&#xa;                , plano_conta.cod_estrutural_contabil AS conta_contabil&#xd;&#xa;                , LPAD&#x28;COALESCE&#x28;configuracao_entidade.valor, &#x27;&#x27;0&#x27;&#x27;&#x29;&#x3a;&#x3a;VARCHAR, 2, &#x27;&#x27;0&#x27;&#x27;&#x29;&#x3a;&#x3a;VARCHAR AS cod_orgao&#xd;&#xa;                , COALESCE&#x28;tmp_contas_utilizadas.num_orgao, 0&#x29; AS num_orgao_rsp&#xd;&#xa;                , COALESCE&#x28;tmp_contas_utilizadas.num_unidade, 0&#x29; AS num_unidade_rsp&#xd;&#xa;                , COALESCE&#x28;tmp_contas_utilizadas.cod_funcao, 0&#x29; AS cod_funcao_rsp&#xd;&#xa;                , COALESCE&#x28;tmp_contas_utilizadas.cod_subfuncao, 0&#x29; AS cod_subfuncao_rsp&#xd;&#xa;                , COALESCE&#x28;tmp_contas_utilizadas.num_programa, 0&#x29; AS num_programa_rsp&#xd;&#xa;                , COALESCE&#x28;tmp_contas_utilizadas.num_acao, 0&#x29; AS num_acao_rsp&#xd;&#xa;                , SUBSTR&#x28;RPAD&#x28;COALESCE&#x28;tmp_contas_utilizadas.natureza_despesa, &#x27;&#x27;0&#x27;&#x27;&#x29;, 8, &#x27;&#x27;0&#x27;&#x27;&#x29;&#x3a;&#x3a;VARCHAR, 1, 6&#x29;&#x3a;&#x3a;VARCHAR AS natureza_despesa_reduzida&#xd;&#xa;                , SUBSTR&#x28;RPAD&#x28;COALESCE&#x28;tmp_contas_utilizadas.natureza_despesa, &#x27;&#x27;0&#x27;&#x27;&#x29;, 8, &#x27;&#x27;0&#x27;&#x27;&#x29;&#x3a;&#x3a;VARCHAR, 7, 2&#x29;&#x3a;&#x3a;VARCHAR AS sub_elemento&#xd;&#xa;                , COALESCE&#x28;tmp_contas_utilizadas.cod_recurso, 0&#x29; AS cod_recurso_rsp&#xd;&#xa;                , COALESCE&#x28;tmp_contas_utilizadas.cod_empenho, 0&#x29; AS cod_empenho_rsp&#xd;&#xa;                , COALESCE&#x28;tmp_contas_utilizadas.exercicio_empenho, &#x27;&#x27;0&#x27;&#x27;&#x29;&#x3a;&#x3a;VARCHAR AS exercicio_empenho_rsp&#xd;&#xa;                , &#x27;&#x27;0&#x27;&#x27;&#x3a;&#x3a;VARCHAR AS id_sub_acao&#xd;&#xa;				, &#x27;&#x27;0&#x27;&#x27;&#x3a;&#x3a;VARCHAR AS cod_unidade_sub&#xd;&#xa;				, &#x27;&#x27;0&#x27;&#x27;&#x3a;&#x3a;VARCHAR AS cod_unidade_sub_orig&#xd;&#xa;                , 0.00 as vl_saldo_inicial&#xd;&#xa;                , tmp_contas_utilizadas.natureza_saldo AS natureza_saldo_incial&#xd;&#xa;                , 0.00 as vl_saldo_debitos&#xd;&#xa;                , 0.00 as vl_saldo_creditos&#xd;&#xa;                , 0.00 as vl_saldo_final&#xd;&#xa;                , tmp_contas_utilizadas.natureza_saldo AS natureza_saldo_final&#xd;&#xa;             FROM &#x28;SELECT publico.fn_mascarareduzida&#x28;plano_conta.cod_estrutural&#x29;&#x7c;&#x7c;&#x27;&#x27;&#x25;&#x27;&#x27; AS cod_estrutural_reduzido&#xd;&#xa;                        , plano_conta.cod_estrutural AS cod_estrutural_contabil&#xd;&#xa;                        , plano_conta.atributo_tcemg&#xd;&#xa;                     FROM bi.plano_conta&#xd;&#xa;                    WHERE plano_conta.escrituracao_pcasp &#x3d; &#x27;&#x27;S&#x27;&#x27;&#xd;&#xa;                      AND plano_conta.atributo_tcemg &#x3d; 14&#xd;&#xa;                      AND plano_conta.exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;                  &#x29; AS plano_conta&#xd;&#xa;        LEFT JOIN bi.balancete_14 as tmp_contas_utilizadas&#xd;&#xa;               ON tmp_contas_utilizadas.cod_estrutural ILIKE plano_conta.cod_estrutural_reduzido&#xd;&#xa;        LEFT JOIN administracao.configuracao_entidade&#xd;&#xa;               ON configuracao_entidade.exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;              AND configuracao_entidade.cod_entidade &#x3d; tmp_contas_utilizadas.cod_entidade&#xd;&#xa;              AND configuracao_entidade.cod_modulo &#x3d; 55&#xd;&#xa;              AND configuracao_entidade.parametro &#x3d; &#x27;&#x27;tcemg_codigo_orgao_entidade_sicom&#x27;&#x27;&#xd;&#xa;         GROUP BY conta_contabil&#xd;&#xa;                , cod_orgao&#xd;&#xa;                , num_orgao_rsp&#xd;&#xa;                , num_unidade_rsp&#xd;&#xa;                , cod_funcao_rsp&#xd;&#xa;                , cod_subfuncao_rsp&#xd;&#xa;                , num_programa_rsp&#xd;&#xa;                , num_acao_rsp&#xd;&#xa;                , natureza_despesa_reduzida&#xd;&#xa;                , sub_elemento&#xd;&#xa;                , cod_recurso_rsp&#xd;&#xa;                , cod_empenho_rsp&#xd;&#xa;                , exercicio_empenho_rsp&#xd;&#xa;                , natureza_saldo&#xd;&#xa;          ORDER BY conta_contabil ASC&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa; &#xd;&#xa;    FOR reRegistro IN EXECUTE stSql&#xd;&#xa;    LOOP&#xd;&#xa;        arRetorno &#x3a;&#x3d; bi.fn_balancete_contabil_totaliza_restos_pagar&#x28; publico.fn_mascarareduzida&#x28;reRegistro.conta_contabil&#x29;, stExercicio, stMes, stFiltro, reRegistro.num_orgao_rsp, reRegistro.num_unidade_rsp, reRegistro.cod_funcao_rsp, reRegistro.cod_subfuncao_rsp, reRegistro.num_programa_rsp, reRegistro.num_acao_rsp, reRegistro.cod_recurso_rsp, reRegistro.natureza_despesa_reduzida&#x7c;&#x7c;reRegistro.sub_elemento, reRegistro.cod_empenho_rsp, reRegistro.exercicio_empenho_rsp&#x29;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_inicial  &#x3a;&#x3d; arRetorno&#x5b;1&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_debitos  &#x3a;&#x3d; arRetorno&#x5b;2&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_creditos &#x3a;&#x3d; arRetorno&#x5b;3&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_final    &#x3a;&#x3d; arRetorno&#x5b;4&#x5d;&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;1&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;1&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; reRegistro.natureza_saldo_incial&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;4&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;4&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; reRegistro.natureza_saldo_final&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;        &#xd;&#xa;        IF  &#x28; reRegistro.vl_saldo_inicial  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_debitos  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_creditos &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_final    &#x3d; 0.00 &#x29;&#xd;&#xa;        THEN&#xd;&#xa;        &#xd;&#xa;        ELSE&#xd;&#xa;            RETURN NEXT reRegistro&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;    END LOOP&#x3b;&#xd;&#xa;    &#xd;&#xa;    RETURN&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5280 &#x28;class 1255 OID 7485707&#x29;&#xd;&#xa;-- Name&#x3a; fn_balancete_contabil_15&#x28;character varying, character varying, character varying&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_15&#x28;character varying, character varying, character varying&#x29; RETURNS SETOF balancete_contabil_registro_15&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24; &#xd;&#xa;DECLARE&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;2&#x3b;&#xd;&#xa;    stFiltro            ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stSql               VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento    VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    reRegistro          RECORD&#x3b;&#xd;&#xa;    arRetorno           NUMERIC&#x5b;&#x5d;&#x3b;&#xd;&#xa;BEGIN&#xd;&#xa;&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;&#xd;&#xa;            SELECT 15&#x3a;&#x3a;INTEGER AS tipo_registro&#xd;&#xa;                , pc_pcasp.cod_estrutural_contabil&#xd;&#xa;                , CASE pc.indicador_superavit&#xd;&#xa;                       WHEN &#x27;&#x27;permanente&#x27;&#x27; THEN &#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;                       WHEN &#x27;&#x27;financeiro&#x27;&#x27; THEN &#x27;&#x27;F&#x27;&#x27;&#xd;&#xa;                       ELSE pc.indicador_superavit&#xd;&#xa;                   END&#x3a;&#x3a;VARCHAR AS indicador_superavit&#xd;&#xa;                , 0.00 as vl_saldo_inicial&#xd;&#xa;                , natureza_saldo AS natureza_saldo_incial&#xd;&#xa;                , 0.00 as vl_saldo_debitos&#xd;&#xa;                , 0.00 as vl_saldo_creditos&#xd;&#xa;                , 0.00 as vl_saldo_final&#xd;&#xa;                , natureza_saldo AS natureza_saldo_final&#xd;&#xa;             FROM bi.plano_conta as pc&#xd;&#xa;        LEFT JOIN &#x28;SELECT publico.fn_mascarareduzida&#x28;pc.cod_estrutural&#x29;&#x7c;&#x7c;&#x27;&#x27;&#x25;&#x27;&#x27; AS cod_estrutural_reduzido&#xd;&#xa;                        , pc.cod_estrutural AS cod_estrutural_contabil&#xd;&#xa;                        , pc.atributo_tcemg&#xd;&#xa;                     FROM bi.plano_conta pc&#xd;&#xa;                    WHERE pc.exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c;stExercicio&#x7c;&#x7c; &#x27;&#x27;&#x27;&#xd;&#xa;                      AND pc.escrituracao_pcasp &#x3d; &#x27;&#x27;S&#x27;&#x27;&#xd;&#xa;                      AND pc.atributo_tcemg &#x3d; 15&#xd;&#xa;                  &#x29; AS pc_pcasp&#xd;&#xa;               ON pc.cod_estrutural ILIKE pc_pcasp.cod_estrutural_reduzido&#xd;&#xa;              AND pc.atributo_tcemg &#x3d; pc_pcasp.atributo_tcemg&#xd;&#xa;            WHERE pc.exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c;stExercicio&#x7c;&#x7c; &#x27;&#x27;&#x27;&#xd;&#xa;              AND pc.atributo_tcemg &#x3d; 15&#xd;&#xa;              AND pc_pcasp.cod_estrutural_contabil IS NOT NULL&#xd;&#xa;              AND escrituracao &#x3d; &#x27;&#x27;analitica&#x27;&#x27;                                 &#xd;&#xa;              AND pc.indicador_superavit &#x3c;&#x3e; &#x27;&#x27;&#x27;&#x27;&#xd;&#xa;         GROUP BY pc_pcasp.cod_estrutural_contabil, pc.indicador_superavit, natureza_saldo&#xd;&#xa;         ORDER BY cod_estrutural_contabil ASC&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    FOR reRegistro IN EXECUTE stSql&#xd;&#xa;    LOOP&#xd;&#xa;        arRetorno &#x3a;&#x3d; bi.fn_totaliza_balancete_verificacao&#x28; publico.fn_mascarareduzida&#x28;reRegistro.cod_estrutural_contabil&#x29;, stExercicio, stMes, stFiltro&#x29;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_inicial  &#x3a;&#x3d; arRetorno&#x5b;1&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_debitos  &#x3a;&#x3d; arRetorno&#x5b;2&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_creditos &#x3a;&#x3d; arRetorno&#x5b;3&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_final    &#x3a;&#x3d; arRetorno&#x5b;4&#x5d;&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;1&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;1&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; reRegistro.natureza_saldo_incial&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;4&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;4&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; reRegistro.natureza_saldo_final&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;        &#xd;&#xa;        &#xd;&#xa;        IF  &#x28; reRegistro.vl_saldo_inicial  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_debitos  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_creditos &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_final    &#x3d; 0.00 &#x29;&#xd;&#xa;        THEN&#xd;&#xa;        &#xd;&#xa;        ELSE&#xd;&#xa;            RETURN NEXT reRegistro&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;    END LOOP&#x3b;&#xd;&#xa;&#xd;&#xa;    RETURN&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5281 &#x28;class 1255 OID 7485708&#x29;&#xd;&#xa;-- Name&#x3a; fn_balancete_contabil_16&#x28;character varying, character varying, character varying&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_16&#x28;character varying, character varying, character varying&#x29; RETURNS SETOF balancete_contabil_registro_16&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24; &#xd;&#xa;DECLARE&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;2&#x3b;&#xd;&#xa;    stFiltro            ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stSql               VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento    VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    reRegistro          RECORD&#x3b;&#xd;&#xa;    arRetorno           NUMERIC&#x5b;&#x5d;&#x3b;&#xd;&#xa;BEGIN&#xd;&#xa;    &#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;&#xd;&#xa;           SELECT 16&#x3a;&#x3a;INTEGER AS tipo_registro&#xd;&#xa;                , pc_pcasp.cod_estrutural_contabil AS cod_contabil&#xd;&#xa;                , CASE pc.indicador_superavit&#xd;&#xa;                       WHEN &#x27;&#x27;permanente&#x27;&#x27; THEN &#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;                       WHEN &#x27;&#x27;financeiro&#x27;&#x27; THEN &#x27;&#x27;F&#x27;&#x27;&#xd;&#xa;                       ELSE pc.indicador_superavit&#xd;&#xa;                   END&#x3a;&#x3a;VARCHAR AS atributo_sf&#xd;&#xa;                , COALESCE&#x28;pc.cod_recurso, 0&#x29;&#x3a;&#x3a;INTEGER AS cod_recurso_sf&#xd;&#xa;                , 0.00 as vl_saldo_inicial&#xd;&#xa;                , natureza_saldo AS natureza_saldo_incial&#xd;&#xa;                , 0.00 as vl_saldo_debitos&#xd;&#xa;                , 0.00 as vl_saldo_creditos&#xd;&#xa;                , 0.00 as vl_saldo_final&#xd;&#xa;                , natureza_saldo AS natureza_saldo_final&#xd;&#xa;             FROM bi.plano_conta as pc&#xd;&#xa;        INNER JOIN &#x28;SELECT publico.fn_mascarareduzida&#x28;pc1.cod_estrutural&#x29;&#x7c;&#x7c;&#x27;&#x27;&#x25;&#x27;&#x27; AS cod_estrutural_reduzido&#xd;&#xa;                        , pc1.cod_estrutural AS cod_estrutural_contabil&#xd;&#xa;                        , pc1.atributo_tcemg&#xd;&#xa;                     FROM bi.plano_conta pc1 &#xd;&#xa;                    WHERE pc1.escrituracao_pcasp &#x3d; &#x27;&#x27;S&#x27;&#x27;&#xd;&#xa;                      AND pc1.atributo_tcemg &#x3d; 16&#xd;&#xa;                      AND pc1.exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio&#x7c;&#x7c; &#x27;&#x27;&#x27; &#x29; AS pc_pcasp&#xd;&#xa;               ON pc.cod_estrutural ILIKE pc_pcasp.cod_estrutural_reduzido&#xd;&#xa;              AND pc.atributo_tcemg &#x3d; pc_pcasp.atributo_tcemg&#xd;&#xa;            WHERE pc.exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c;stExercicio&#x7c;&#x7c; &#x27;&#x27;&#x27;&#xd;&#xa;	          AND pc.indicador_superavit &#x3c;&#x3e; &#x27;&#x27;&#x27;&#x27;&#xd;&#xa;              AND pc.atributo_tcemg &#x3d; 16&#xd;&#xa;          GROUP BY cod_contabil&#xd;&#xa;                --, indicador_superavit_sf&#xd;&#xa;                , cod_recurso_sf &#xd;&#xa;                , natureza_saldo    &#xd;&#xa;                , atributo_sf&#xd;&#xa;         ORDER BY pc_pcasp.cod_estrutural_contabil ASC         &#xd;&#xa;         &#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    FOR reRegistro IN EXECUTE stSql&#xd;&#xa;    LOOP&#xd;&#xa;        arRetorno &#x3a;&#x3d; bi.fn_balancete_contabil_totaliza_recurso_SF&#x28; publico.fn_mascarareduzida&#x28;reRegistro.cod_contabil&#x29;, stExercicio, stMes, stFiltro, reRegistro.cod_recurso_sf&#x29;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_inicial  &#x3a;&#x3d; arRetorno&#x5b;1&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_debitos  &#x3a;&#x3d; arRetorno&#x5b;2&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_creditos &#x3a;&#x3d; arRetorno&#x5b;3&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_final    &#x3a;&#x3d; arRetorno&#x5b;4&#x5d;&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;1&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;1&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; reRegistro.natureza_saldo_incial&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;4&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;4&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; reRegistro.natureza_saldo_final&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;        &#xd;&#xa;        &#xd;&#xa;        IF  &#x28; reRegistro.vl_saldo_inicial  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_debitos  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_creditos &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_final    &#x3d; 0.00 &#x29;&#xd;&#xa;        THEN&#xd;&#xa;        &#xd;&#xa;        ELSE&#xd;&#xa;            RETURN NEXT reRegistro&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;    END LOOP&#x3b;&#xd;&#xa;&#xd;&#xa;    RETURN&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5282 &#x28;class 1255 OID 7485709&#x29;&#xd;&#xa;-- Name&#x3a; fn_balancete_contabil_17&#x28;character varying, character varying, character varying&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_17&#x28;character varying, character varying, character varying&#x29; RETURNS SETOF balancete_contabil_registro_17&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24; &#xd;&#xa;DECLARE&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;2&#x3b;    &#xd;&#xa;    stFiltro            ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stSql               VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento    VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    reRegistro          RECORD&#x3b;&#xd;&#xa;    arRetorno           NUMERIC&#x5b;&#x5d;&#x3b;&#xd;&#xa;BEGIN&#xd;&#xa;&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;&#xd;&#xa;          SELECT 17&#x3a;&#x3a;INTEGER AS tipo_registro&#xd;&#xa;               , pc_pcasp.cod_estrutural_contabil&#xd;&#xa;               , &#x27;&#x27;F&#x27;&#x27;&#x3a;&#x3a;VARCHAR AS atributo_sf&#xd;&#xa;               , CASE WHEN pc.cod_ctb_anterior IS NULL&#xd;&#xa;                      THEN pc.cod_plano &#xd;&#xa;                      ELSE pc.cod_ctb_anterior&#xd;&#xa;                  END AS cod_ctb&#xd;&#xa;               , pc.cod_recurso AS cod_recurso_ctb&#xd;&#xa;               , 0.00 as vl_saldo_inicial&#xd;&#xa;               , natureza_saldo AS natureza_saldo_incial&#xd;&#xa;               , 0.00 as vl_saldo_debitos&#xd;&#xa;               , 0.00 as vl_saldo_creditos&#xd;&#xa;               , 0.00 as vl_saldo_final&#xd;&#xa;               , natureza_saldo AS natureza_saldo_final&#xd;&#xa;            FROM bi.plano_conta pc&#xd;&#xa;	    INNER join &#x28;SELECT publico.fn_mascarareduzida&#x28;pc.cod_estrutural&#x29;&#x7c;&#x7c;&#x27;&#x27;&#x25;&#x27;&#x27; AS cod_estrutural_reduzido&#xd;&#xa;		                  , pc.cod_estrutural AS cod_estrutural_contabil&#xd;&#xa;		                  , pc.atributo_tcemg&#xd;&#xa;		             FROM bi.plano_conta pc&#xd;&#xa;		            WHERE pc.escrituracao_pcasp &#x3d; &#x27;&#x27;S&#x27;&#x27;&#xd;&#xa;		              AND pc.atributo_tcemg &#x3d; 17&#xd;&#xa;		              AND pc.exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c;stExercicio&#x7c;&#x7c; &#x27;&#x27;&#x27;&#x29; as pc_pcasp            &#xd;&#xa;              ON pc.cod_estrutural ILIKE pc_pcasp.cod_estrutural_reduzido&#xd;&#xa;             AND pc.atributo_tcemg &#x3d; pc_pcasp.atributo_tcemg&#xd;&#xa;           WHERE pc.exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c;stExercicio&#x7c;&#x7c; &#x27;&#x27;&#x27;&#xd;&#xa;             AND pc.atributo_tcemg &#x3d; 17&#xd;&#xa;             AND pc.cod_recurso IS NOT NULL&#xd;&#xa; 	    GROUP BY pc_pcasp.cod_estrutural_contabil&#xd;&#xa;                 , atributo_sf&#xd;&#xa;                 , cod_ctb&#xd;&#xa;                 , cod_recurso_ctb    &#xd;&#xa;			     , natureza_saldo&#xd;&#xa;        ORDER BY pc_pcasp.cod_estrutural_contabil, cod_recurso_ctb&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    FOR reRegistro IN EXECUTE stSql&#xd;&#xa;    LOOP&#xd;&#xa;        arRetorno &#x3a;&#x3d; bi.fn_balancete_contabil_totaliza_codigoCTB_recurso&#x28;publico.fn_mascarareduzida&#x28;reRegistro.cod_estrutural_contabil&#x29;, stExercicio, stMes, stFiltro, reRegistro.cod_ctb, reRegistro.cod_recurso_ctb&#x29;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_inicial  &#x3a;&#x3d; arRetorno&#x5b;1&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_debitos  &#x3a;&#x3d; arRetorno&#x5b;2&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_creditos &#x3a;&#x3d; arRetorno&#x5b;3&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_final    &#x3a;&#x3d; arRetorno&#x5b;4&#x5d;&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;1&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;1&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; reRegistro.natureza_saldo_incial&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;4&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;4&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; reRegistro.natureza_saldo_final&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;        &#xd;&#xa;        &#xd;&#xa;        IF  &#x28; reRegistro.vl_saldo_inicial  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_debitos  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_creditos &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_final    &#x3d; 0.00 &#x29;&#xd;&#xa;        THEN&#xd;&#xa;        &#xd;&#xa;        ELSE&#xd;&#xa;            RETURN NEXT reRegistro&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;    END LOOP&#x3b;&#xd;&#xa;&#xd;&#xa;    RETURN&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5283 &#x28;class 1255 OID 7485710&#x29;&#xd;&#xa;-- Name&#x3a; fn_balancete_contabil_18&#x28;character varying, character varying, character varying&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_18&#x28;character varying, character varying, character varying&#x29; RETURNS SETOF balancete_contabil_registro_18&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24; &#xd;&#xa;DECLARE&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;2&#x3b;    &#xd;&#xa;    stFiltro            ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stSql               VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento    VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    reRegistro          RECORD&#x3b;&#xd;&#xa;    arRetorno           NUMERIC&#x5b;&#x5d;&#x3b;&#xd;&#xa;BEGIN&#xd;&#xa; 	stSql &#x3a;&#x3d; &#x27;&#xd;&#xa;		  SELECT   18&#x3a;&#x3a;INTEGER AS tipo_registro&#xd;&#xa;		                 , pc_pcasp.cod_estrutural_contabil &#xd;&#xa;		                 , pc.cod_recurso AS cod_recurso_sf&#xd;&#xa;		                 , 0.00 as vl_saldo_inicial&#xd;&#xa;		                 , natureza_saldo AS natureza_saldo_incial&#xd;&#xa;		                 , 0.00 as vl_saldo_debitos&#xd;&#xa;		                 , 0.00 as vl_saldo_creditos&#xd;&#xa;		                 , 0.00 as vl_saldo_final&#xd;&#xa;		                 , natureza_saldo AS natureza_saldo_final&#xd;&#xa;		            FROM bi.plano_conta pc&#xd;&#xa;		       left join &#x28;SELECT publico.fn_mascarareduzida&#x28;pc.cod_estrutural&#x29;&#x7c;&#x7c;&#x27;&#x27;&#x25;&#x27;&#x27; AS cod_estrutural_reduzido&#xd;&#xa;		                       , pc.cod_estrutural AS cod_estrutural_contabil&#xd;&#xa;		                       , pc.atributo_tcemg&#xd;&#xa;		                    FROM bi.plano_conta pc&#xd;&#xa;		                   WHERE pc.escrituracao_pcasp &#x3d; &#x27;&#x27;S&#x27;&#x27;&#xd;&#xa;		                     AND pc.atributo_tcemg &#x3d; 18&#xd;&#xa;		                     AND pc.exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c;stExercicio&#x7c;&#x7c; &#x27;&#x27;&#x27;&#x29; as pc_pcasp&#xd;&#xa;		                      ON pc.cod_estrutural ILIKE pc_pcasp.cod_estrutural_reduzido&#xd;&#xa;		                     AND pc.atributo_tcemg &#x3d; pc_pcasp.atributo_tcemg      &#xd;&#xa;		           WHERE pc.exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;		             AND pc.atributo_tcemg &#x3d; 18&#xd;&#xa;		             AND pc.cod_recurso IS NOT NULL&#xd;&#xa;		             AND pc_pcasp.cod_estrutural_contabil IS NOT NULL&#xd;&#xa;		        ORDER BY pc_pcasp.cod_estrutural_contabil, cod_recurso_sf&#x3b;&#xd;&#xa;	    &#x27;&#x3b;&#xd;&#xa;	    &#xd;&#xa;    FOR reRegistro IN EXECUTE stSql&#xd;&#xa;    LOOP&#xd;&#xa;        arRetorno &#x3a;&#x3d; bi.fn_balancete_contabil_totaliza_recurso_SF&#x28; publico.fn_mascarareduzida&#x28;reRegistro.cod_estrutural_contabil&#x29;, stExercicio, stMes, stFiltro, reRegistro.cod_recurso_sf&#x29;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_inicial  &#x3a;&#x3d; arRetorno&#x5b;1&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_debitos  &#x3a;&#x3d; arRetorno&#x5b;2&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_creditos &#x3a;&#x3d; arRetorno&#x5b;3&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_final    &#x3a;&#x3d; arRetorno&#x5b;4&#x5d;&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;1&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;1&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; reRegistro.natureza_saldo_incial&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;4&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;4&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; reRegistro.natureza_saldo_final&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;        &#xd;&#xa;        &#xd;&#xa;        IF  &#x28; reRegistro.vl_saldo_inicial  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_debitos  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_creditos &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_final    &#x3d; 0.00 &#x29;&#xd;&#xa;        THEN&#xd;&#xa;        &#xd;&#xa;        ELSE&#xd;&#xa;            RETURN NEXT reRegistro&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;    END LOOP&#x3b;&#xd;&#xa;&#xd;&#xa;    RETURN&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5284 &#x28;class 1255 OID 7485711&#x29;&#xd;&#xa;-- Name&#x3a; fn_balancete_contabil_22&#x28;character varying, character varying, character varying&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_22&#x28;character varying, character varying, character varying&#x29; RETURNS SETOF balancete_contabil_registro_22&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24; &#xd;&#xa;DECLARE&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;2&#x3b;    &#xd;&#xa;    stFiltro            ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stSql               VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento    VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    reRegistro          RECORD&#x3b;&#xd;&#xa;    arRetorno           NUMERIC&#x5b;&#x5d;&#x3b;&#xd;&#xa;BEGIN&#xd;&#xa;&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;&#xd;&#xa;          SELECT 22&#x3a;&#x3a;INTEGER AS tipo_registro&#xd;&#xa;               , pcasp.cod_estrutural_contabil&#xd;&#xa;               , CASE pc.indicador_superavit&#xd;&#xa;                       WHEN &#x27;&#x27;permanente&#x27;&#x27; THEN &#x27;&#x27;P&#x27;&#x27;&#xd;&#xa;                       WHEN &#x27;&#x27;financeiro&#x27;&#x27; THEN &#x27;&#x27;F&#x27;&#x27;&#xd;&#xa;                       ELSE pc.indicador_superavit&#xd;&#xa;                   END&#x3a;&#x3a;VARCHAR AS atributo_sf&#xd;&#xa;               , CASE WHEN pc.cod_ctb_anterior IS NULL&#xd;&#xa;                      THEN pc.cod_plano &#xd;&#xa;                      ELSE pc.cod_ctb_anterior&#xd;&#xa;                  END AS cod_ctb&#xd;&#xa;               , 0.00 as vl_saldo_inicial&#xd;&#xa;               , natureza_saldo AS natureza_saldo_incial&#xd;&#xa;               , 0.00 as vl_saldo_debitos&#xd;&#xa;               , 0.00 as vl_saldo_creditos&#xd;&#xa;               , 0.00 as vl_saldo_final&#xd;&#xa;               , natureza_saldo AS natureza_saldo_final&#xd;&#xa;            FROM bi.plano_conta pc&#xd;&#xa;       INNER JOIN &#x28;SELECT publico.fn_mascarareduzida&#x28;plano_conta.cod_estrutural&#x29;&#x7c;&#x7c;&#x27;&#x27;&#x25;&#x27;&#x27; AS cod_estrutural_reduzido&#xd;&#xa;                         , plano_conta.cod_estrutural AS cod_estrutural_contabil&#xd;&#xa;                         , plano_conta.atributo_tcemg&#xd;&#xa;                    FROM bi.plano_conta&#xd;&#xa;                   WHERE plano_conta.escrituracao_pcasp &#x3d; &#x27;&#x27;S&#x27;&#x27;&#xd;&#xa;                     AND plano_conta.atributo_tcemg &#x3d; 22&#xd;&#xa;                     AND plano_conta.exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c;&#x27;&#x27;&#x27; &#x29; AS pcasp            &#xd;&#xa;              ON  pc.cod_estrutural ILIKE pcasp.cod_estrutural_reduzido&#xd;&#xa;             AND  pc.atributo_tcemg &#x3d; pcasp.atributo_tcemg&#xd;&#xa;            WHERE &#xd;&#xa;                  pc.exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c; &#x27;&#x27;&#x27; &#xd;&#xa;              and pc.atributo_tcemg &#x3d; 22&#xd;&#xa;        ORDER BY pcasp.cod_estrutural_contabil, cod_ctb&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    FOR reRegistro IN EXECUTE stSql&#xd;&#xa;    LOOP&#xd;&#xa;        arRetorno &#x3a;&#x3d; bi.fn_balancete_contabil_totaliza_codigoCTB&#x28; publico.fn_mascarareduzida&#x28;reRegistro.cod_estrutural_contabil&#x29; , stExercicio, stMes, stFiltro, reRegistro.cod_ctb&#x29;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_inicial  &#x3a;&#x3d; arRetorno&#x5b;1&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_debitos  &#x3a;&#x3d; arRetorno&#x5b;2&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_creditos &#x3a;&#x3d; arRetorno&#x5b;3&#x5d;&#x3b;&#xd;&#xa;        reRegistro.vl_saldo_final    &#x3a;&#x3d; arRetorno&#x5b;4&#x5d;&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;1&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;1&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_incial &#x3a;&#x3d; reRegistro.natureza_saldo_incial&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;&#xd;&#xa;        IF arRetorno&#x5b;4&#x5d; &#x3e; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;D&#x27;&#x3b;&#xd;&#xa;        ELSIF arRetorno&#x5b;4&#x5d; &#x3c; 0.00 THEN&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; &#x27;C&#x27;&#x3b;&#xd;&#xa;        ELSE&#xd;&#xa;            reRegistro.natureza_saldo_final &#x3a;&#x3d; reRegistro.natureza_saldo_final&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;        &#xd;&#xa;        &#xd;&#xa;        IF  &#x28; reRegistro.vl_saldo_inicial  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_debitos  &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_creditos &#x3d; 0.00 &#x29; AND&#xd;&#xa;            &#x28; reRegistro.vl_saldo_final    &#x3d; 0.00 &#x29;&#xd;&#xa;        THEN&#xd;&#xa;        &#xd;&#xa;        ELSE&#xd;&#xa;            RETURN NEXT reRegistro&#x3b;&#xd;&#xa;        END IF&#x3b;&#xd;&#xa;    END LOOP&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;    RETURN&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5285 &#x28;class 1255 OID 7485712&#x29;&#xd;&#xa;-- Name&#x3a; fn_balancete_contabil_totaliza_codigoctb&#x28;character varying, character varying, character varying, character varying, integer&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_totaliza_codigoctb&#x28;character varying, character varying, character varying, character varying, integer&#x29; RETURNS numeric&#x5b;&#x5d;&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    stMascaraReduzida   ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;2&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stFiltro            ALIAS FOR &#x24;4&#x3b;&#xd;&#xa;    inCodCtb            ALIAS FOR &#x24;5&#x3b;&#xd;&#xa;    stSql               VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlWhere          VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento    VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    nuSaldoAnterior     NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuDebito            NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuCredito           NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuSaldoAtual        NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    arRetorno           NUMERIC&#x5b;&#x5d; &#x3a;&#x3d; array&#x5b;0&#x5d;&#x3b;&#xd;&#xa;    crCursor            REFCURSOR&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;BEGIN&#xd;&#xa;    --Totaliza o saldo anterior&#xd;&#xa;&#xd;&#xa;    if stMes &#x3d; &#x27;1&#x27; then&#xd;&#xa;		stSqlWhere &#x3a;&#x3d; &#x27;exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27; and tipo &#x3d; &#x27;&#x27;I&#x27;&#x27; and mes &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27; and &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27; and cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#x27;&#x3b;&#xd;&#xa;	else&#xd;&#xa;		stSqlWhere &#x3a;&#x3d; &#x27;dt_lote BETWEEN TO_DATE&#x28;&#x27;&#x27;01&#x2f;01&#x2f;&#x27;&#x7c;&#x7c; stExercicio &#x7c;&#x7c;&#x27;&#x27;&#x27; ,&#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29; &#xd;&#xa;                        AND TO_DATE&#x28;&#x27;&#x27;01&#x2f;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c;&#x27;&#x27;&#x27;,&#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29;-1 and &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27; and cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#x27;&#x3b;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;	&#xd;&#xa;	stSql &#x3a;&#x3d; &#x27;SELECT&#xd;&#xa;                SUM&#x28;vl_lancamento&#x29; as soma&#xd;&#xa;                FROM bi.lancamento&#xd;&#xa;				  WHERE &#x27; &#x7c;&#x7c; stSqlWhere &#x7c;&#x7c; &#x27; &#xd;&#xa;                    AND cod_ctb &#x3d; &#x27; &#x7c;&#x7c; inCodCtb &#xd;&#xa;				  &#x3b;&#xd;&#xa;			  &#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql &#x7c;&#x7c; stSqlComplemento&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuSaldoAnterior&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza a conta d&#xe9;bito&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT&#xd;&#xa;                SUM&#x28;vl_lancamento&#x29; as soma&#xd;&#xa;                FROM bi.lancamento&#xd;&#xa;                WHERE  exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27; &#xd;&#xa;                  AND tipo &#x3c;&#x3e; &#x27;&#x27;I&#x27;&#x27; &#xd;&#xa;                  AND tipo_valor &#x3d; &#x27;&#x27;D&#x27;&#x27;&#x27; &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND mes &#x3d; &#x27; &#x7c;&#x7c; stMes  &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND &#x27; &#x7c;&#x7c; stFiltro  &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#x27;  &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND cod_ctb &#x3d; &#x27; &#x7c;&#x7c; inCodCtb &#xd;&#xa;                   &#x3b;&#xd;&#xa;                &#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql&#x3b;&#xd;&#xa;    	FETCH crCursor INTO nuDebito&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza a conta cr&#xe9;dito&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT&#xd;&#xa;                SUM&#x28;vl_lancamento&#x29; as soma&#xd;&#xa;                FROM bi.lancamento&#xd;&#xa;                WHERE exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27; &#xd;&#xa;                  AND tipo &#x3c;&#x3e; &#x27;&#x27;I&#x27;&#x27; &#xd;&#xa;                  AND tipo_valor &#x3d; &#x27;&#x27;C&#x27;&#x27;&#x27;  &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND mes &#x3d; &#x27; &#x7c;&#x7c; stMes  &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND &#x27; &#x7c;&#x7c; stFiltro  &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#x27;  &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND cod_ctb &#x3d; &#x27; &#x7c;&#x7c; inCodCtb &#xd;&#xa;                   &#x3b;&#xd;&#xa;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql&#x3b;&#xd;&#xa;    	FETCH crCursor INTO nuCredito&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    nuSaldoAnterior &#x3a;&#x3d; coalesce&#x28;nuSaldoAnterior,0.00&#x29;&#x3b;&#xd;&#xa;    nuCredito       &#x3a;&#x3d; coalesce&#x28;nuCredito,0.00&#x29;&#x3b;&#xd;&#xa;    nuDebito        &#x3a;&#x3d; coalesce&#x28;nuDebito,0.00&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza Saldo Atual&#xd;&#xa;    nuSaldoAtual    &#x3a;&#x3d; &#x28; nuSaldoAnterior &#x2b; nuDebito &#x29; &#x2b; nuCredito&#x3b;&#xd;&#xa;    nuSaldoAtual    &#x3a;&#x3d; coalesce&#x28;nuSaldoAtual,0.00&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;    --Preenche array de retorno&#xd;&#xa;    arRetorno&#x5b;1&#x5d; &#x3a;&#x3d; nuSaldoAnterior&#x3b;&#xd;&#xa;    arRetorno&#x5b;2&#x5d; &#x3a;&#x3d; nuDebito&#x3b;&#xd;&#xa;    arRetorno&#x5b;3&#x5d; &#x3a;&#x3d; nuCredito&#x3b;&#xd;&#xa;    arRetorno&#x5b;4&#x5d; &#x3a;&#x3d; nuSaldoAtual&#x3b;&#xd;&#xa;&#xd;&#xa;    RETURN arRetorno&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5286 &#x28;class 1255 OID 7485713&#x29;&#xd;&#xa;-- Name&#x3a; fn_balancete_contabil_totaliza_codigoctb_recurso&#x28;character varying, character varying, character varying, character varying, integer, integer&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_totaliza_codigoctb_recurso&#x28;character varying, character varying, character varying, character varying, integer, integer&#x29; RETURNS numeric&#x5b;&#x5d;&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    stMascaraReduzida   ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;2&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stFiltro            ALIAS FOR &#x24;4&#x3b;&#xd;&#xa;    inCodCtb            ALIAS FOR &#x24;5&#x3b;&#xd;&#xa;    inCodRecurso        ALIAS FOR &#x24;6&#x3b;&#xd;&#xa;    stSql               VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlWhere          VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento    VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    nuSaldoAnterior     NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuDebito            NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuCredito           NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuSaldoAtual        NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    arRetorno           NUMERIC&#x5b;&#x5d; &#x3a;&#x3d; array&#x5b;0&#x5d;&#x3b;&#xd;&#xa;    crCursor            REFCURSOR&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;BEGIN&#xd;&#xa;&#xd;&#xa;--    --Totaliza o saldo anterior&#xd;&#xa;    if stMes &#x3d; &#x27;1&#x27; then&#xd;&#xa;		stSqlWhere &#x3a;&#x3d; &#x27;exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27; and tipo &#x3d; &#x27;&#x27;I&#x27;&#x27; and mes &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27; and &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27; and cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#x27;&#x3b;&#xd;&#xa;	else&#xd;&#xa;		stSqlWhere &#x3a;&#x3d; &#x27;dt_lote BETWEEN TO_DATE&#x28;&#x27;&#x27;01&#x2f;01&#x2f;&#x27;&#x7c;&#x7c; stExercicio &#x7c;&#x7c;&#x27;&#x27;&#x27; ,&#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29; &#xd;&#xa;                        AND TO_DATE&#x28;&#x27;&#x27;01&#x2f;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c;&#x27;&#x27;&#x27;,&#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29;-1 and &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27; and cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#x27;&#x3b;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;	&#xd;&#xa;	stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.lancamento&#xd;&#xa;               WHERE &#x27; &#x7c;&#x7c; stSqlWhere  &#xd;&#xa;                 &#x7c;&#x7c;  &#x27; AND cod_ctb &#x3d; &#x27; &#x7c;&#x7c; inCodCtb&#xd;&#xa;                 &#x7c;&#x7c;  &#x27; AND cod_recurso  &#x3d; &#x27; &#x7c;&#x7c; inCodRecurso&#xd;&#xa;                 &#x3b;&#xd;&#xa;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql &#x7c;&#x7c; stSqlComplemento&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuSaldoAnterior&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza a conta d&#xe9;bito&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.lancamento&#xd;&#xa;                WHERE exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27; &#xd;&#xa;                  AND tipo &#x3c;&#x3e; &#x27;&#x27;I&#x27;&#x27; &#xd;&#xa;                  AND tipo_valor &#x3d; &#x27;&#x27;D&#x27;&#x27;&#x27; &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND mes &#x3d; &#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND &#x27; &#x7c;&#x7c; stFiltro  &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#x27;  &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND cod_ctb &#x3d; &#x27; &#x7c;&#x7c; inCodCtb &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND cod_recurso &#x3d; &#x27; &#x7c;&#x7c; inCodRecurso&#xd;&#xa;                 &#x3b;&#xd;&#xa;                 &#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuDebito&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza a conta cr&#xe9;dito&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.lancamento&#xd;&#xa;               WHERE exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27; &#xd;&#xa;                 AND tipo &#x3c;&#x3e; &#x27;&#x27;I&#x27;&#x27; &#xd;&#xa;                 AND tipo_valor &#x3d; &#x27;&#x27;C&#x27;&#x27;&#x27; &#x7c;&#x7c; &#x27;&#xd;&#xa;                 AND mes &#x3d; &#x27; &#x7c;&#x7c; stMes  &#x7c;&#x7c; &#x27;&#xd;&#xa;                 AND &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27;&#xd;&#xa;                 AND cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#x27; &#x7c;&#x7c; &#x27;&#xd;&#xa;                 AND cod_ctb &#x3d; &#x27; &#x7c;&#x7c; inCodCtb &#x7c;&#x7c; &#x27;&#xd;&#xa;                 AND cod_recurso &#x3d; &#x27; &#x7c;&#x7c; inCodRecurso&#xd;&#xa;                  &#x3b;&#xd;&#xa;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuCredito&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    nuSaldoAnterior &#x3a;&#x3d; coalesce&#x28;nuSaldoAnterior,0.00&#x29;&#x3b;&#xd;&#xa;    nuCredito       &#x3a;&#x3d; coalesce&#x28;nuCredito,0.00&#x29;&#x3b;&#xd;&#xa;    nuDebito        &#x3a;&#x3d; coalesce&#x28;nuDebito,0.00&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza Saldo Atual&#xd;&#xa;    nuSaldoAtual    &#x3a;&#x3d; &#x28; nuSaldoAnterior &#x2b; nuDebito &#x29; &#x2b; nuCredito&#x3b;&#xd;&#xa;    nuSaldoAtual    &#x3a;&#x3d; coalesce&#x28;nuSaldoAtual,0.00&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;    --Preenche array de retorno&#xd;&#xa;    arRetorno&#x5b;1&#x5d; &#x3a;&#x3d; nuSaldoAnterior&#x3b;&#xd;&#xa;    arRetorno&#x5b;2&#x5d; &#x3a;&#x3d; nuDebito&#x3b;&#xd;&#xa;    arRetorno&#x5b;3&#x5d; &#x3a;&#x3d; nuCredito&#x3b;&#xd;&#xa;    arRetorno&#x5b;4&#x5d; &#x3a;&#x3d; nuSaldoAtual&#x3b;&#xd;&#xa;&#xd;&#xa;    RETURN arRetorno&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5287 &#x28;class 1255 OID 7485714&#x29;&#xd;&#xa;-- Name&#x3a; fn_balancete_contabil_totaliza_despesa&#x28;character varying, integer, integer, integer, integer, integer, integer, integer, character varying, integer, character varying, character varying&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_totaliza_despesa&#x28;character varying, integer, integer, integer, integer, integer, integer, integer, character varying, integer, character varying, character varying&#x29; RETURNS numeric&#x5b;&#x5d;&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    stMascaraReduzida   ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    inNumOrgao          ALIAS FOR &#x24;2&#x3b;&#xd;&#xa;    inNumUnidade        ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    inCodFuncao         ALIAS FOR &#x24;4&#x3b;&#xd;&#xa;    inCodSubFuncao      ALIAS FOR &#x24;5&#x3b;&#xd;&#xa;    inNumPrograma       ALIAS FOR &#x24;6&#x3b;&#xd;&#xa;    inNumAcao           ALIAS FOR &#x24;7&#x3b;&#xd;&#xa;    inCodRecurso        ALIAS FOR &#x24;8&#x3b;&#xd;&#xa;    stNaturezaDespesa   ALIAS FOR &#x24;9&#x3b;&#xd;&#xa;    inCodEntidade       ALIAS FOR &#x24;10&#x3b;&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;11&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;12&#x3b;&#xd;&#xa;    stSql               VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento    VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlWhere          VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    nuSaldoAnterior     NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuDebito            NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuCredito           NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuSaldoAtual        NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    arRetorno           NUMERIC&#x5b;&#x5d; &#x3a;&#x3d; array&#x5b;0&#x5d;&#x3b;&#xd;&#xa;    crCursor            REFCURSOR&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;BEGIN&#xd;&#xa;&#xd;&#xa;--    --Totaliza o saldo anterior&#xd;&#xa;    if stMes &#x3d; &#x27;1&#x27; then&#xd;&#xa;        stSqlWhere &#x3a;&#x3d; &#x27;exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27; and tipo &#x3d; &#x27;&#x27;I&#x27;&#x27; and mes &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27;&#x27;&#x3b;&#xd;&#xa;    else&#xd;&#xa;        stSqlWhere &#x3a;&#x3d; &#x27;dt_lote BETWEEN TO_DATE&#x28;&#x27;&#x27;01&#x2f;01&#x2f;&#x27;&#x7c;&#x7c; stExercicio &#x7c;&#x7c;&#x27;&#x27;&#x27; ,&#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29;&#xd;&#xa;                        AND TO_DATE&#x28;&#x27;&#x27;01&#x2f;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c;&#x27;&#x27;&#x27;,&#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29;-1 &#x27;&#x3b;&#xd;&#xa;    end if&#x3b;&#xd;&#xa;&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.balancete_11&#xd;&#xa;               WHERE &#x27;&#x7c;&#x7c;stSqlWhere&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_entidade &#x3d; &#x27; &#x7c;&#x7c; inCodEntidade &#x7c;&#x7c; &#x27;&#xd;&#xa;                 AND cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#xd;&#xa;                 AND num_orgao        &#x3d; &#x27;&#x7c;&#x7c;inNumOrgao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_unidade      &#x3d; &#x27;&#x7c;&#x7c;inNumUnidade&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_funcao       &#x3d; &#x27;&#x7c;&#x7c;inCodFuncao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_subfuncao    &#x3d; &#x27;&#x7c;&#x7c;inCodSubFuncao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_programa     &#x3d; &#x27;&#x7c;&#x7c;inNumPrograma&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_acao         &#x3d; &#x27;&#x7c;&#x7c;inNumAcao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_recurso      &#x3d; &#x27;&#x7c;&#x7c;inCodRecurso&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND natureza_despesa LIKE &#x27;&#x27;&#x27;&#x7c;&#x7c;stNaturezaDespesa&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;             &#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql &#x7c;&#x7c; stSqlComplemento&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuSaldoAnterior&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza a conta d&#xe9;bito&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.balancete_11&#xd;&#xa;               WHERE exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;                 AND mes &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27;&#xd;&#xa;                 AND cod_entidade &#x3d; &#x27; &#x7c;&#x7c; inCodEntidade &#x7c;&#x7c; &#x27;&#xd;&#xa;                 AND tipo &#x3c;&#x3e; &#x27;&#x27;I&#x27;&#x27;&#xd;&#xa;                 AND tipo_valor      &#x3d; &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;                 AND cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#xd;&#xa;                 AND num_orgao        &#x3d; &#x27;&#x7c;&#x7c;inNumOrgao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_unidade      &#x3d; &#x27;&#x7c;&#x7c;inNumUnidade&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_funcao       &#x3d; &#x27;&#x7c;&#x7c;inCodFuncao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_subfuncao    &#x3d; &#x27;&#x7c;&#x7c;inCodSubFuncao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_programa     &#x3d; &#x27;&#x7c;&#x7c;inNumPrograma&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_acao         &#x3d; &#x27;&#x7c;&#x7c;inNumAcao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_recurso      &#x3d; &#x27;&#x7c;&#x7c;inCodRecurso&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND natureza_despesa LIKE &#x27;&#x27;&#x27;&#x7c;&#x7c;stNaturezaDespesa&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;             &#x27;&#x3b;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuDebito&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza a conta cr&#xe9;dito&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.balancete_11&#xd;&#xa;               WHERE exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;                 AND mes &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27;&#xd;&#xa;                 AND cod_entidade &#x3d; &#x27; &#x7c;&#x7c; inCodEntidade &#x7c;&#x7c; &#x27;&#xd;&#xa;                 AND tipo &#x3c;&#x3e; &#x27;&#x27;I&#x27;&#x27;&#xd;&#xa;                 AND tipo_valor      &#x3d; &#x27;&#x27;C&#x27;&#x27;&#xd;&#xa;                 AND cod_estrutural LIKE &#x27;&#x27;&#x27;&#x7c;&#x7c;stMascaraReduzida&#x7c;&#x7c;&#x27;&#x25;&#x27;&#x27;&#xd;&#xa;                 AND num_orgao        &#x3d; &#x27;&#x7c;&#x7c;inNumOrgao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_unidade      &#x3d; &#x27;&#x7c;&#x7c;inNumUnidade&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_funcao       &#x3d; &#x27;&#x7c;&#x7c;inCodFuncao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_subfuncao    &#x3d; &#x27;&#x7c;&#x7c;inCodSubFuncao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_programa     &#x3d; &#x27;&#x7c;&#x7c;inNumPrograma&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_acao         &#x3d; &#x27;&#x7c;&#x7c;inNumAcao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_recurso      &#x3d; &#x27;&#x7c;&#x7c;inCodRecurso&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND natureza_despesa LIKE &#x27;&#x27;&#x27;&#x7c;&#x7c;stNaturezaDespesa&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;             &#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuCredito&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    nuSaldoAnterior &#x3a;&#x3d; coalesce&#x28;nuSaldoAnterior,0.00&#x29;&#x3b;&#xd;&#xa;    nuCredito       &#x3a;&#x3d; coalesce&#x28;nuCredito,0.00&#x29;&#x3b;&#xd;&#xa;    nuDebito        &#x3a;&#x3d; coalesce&#x28;nuDebito,0.00&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza Saldo Atual&#xd;&#xa;    nuSaldoAtual    &#x3a;&#x3d; &#x28; nuSaldoAnterior &#x2b; nuDebito &#x29; &#x2b; nuCredito&#x3b;&#xd;&#xa;    nuSaldoAtual    &#x3a;&#x3d; coalesce&#x28;nuSaldoAtual,0.00&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;    --Preenche array de retorno&#xd;&#xa;    arRetorno&#x5b;1&#x5d; &#x3a;&#x3d; nuSaldoAnterior&#x3b;&#xd;&#xa;    arRetorno&#x5b;2&#x5d; &#x3a;&#x3d; nuDebito&#x3b;&#xd;&#xa;    arRetorno&#x5b;3&#x5d; &#x3a;&#x3d; nuCredito&#x3b;&#xd;&#xa;    arRetorno&#x5b;4&#x5d; &#x3a;&#x3d; nuSaldoAtual&#x3b;&#xd;&#xa;&#xd;&#xa;    RETURN arRetorno&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5288 &#x28;class 1255 OID 7485715&#x29;&#xd;&#xa;-- Name&#x3a; fn_balancete_contabil_totaliza_programa_acao&#x28;character varying, character varying, character varying, character varying, integer, integer&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_totaliza_programa_acao&#x28;character varying, character varying, character varying, character varying, integer, integer&#x29; RETURNS numeric&#x5b;&#x5d;&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    stMascaraReduzida   ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;2&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stFiltro            ALIAS FOR &#x24;4&#x3b;&#xd;&#xa;    inNumPrograma       ALIAS FOR &#x24;5&#x3b;&#xd;&#xa;    inNumAcao           ALIAS FOR &#x24;6&#x3b;&#xd;&#xa;    stSql               VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlWhere          VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento    VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    nuSaldoAnterior     NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuDebito            NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuCredito           NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuSaldoAtual        NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    arRetorno           NUMERIC&#x5b;&#x5d; &#x3a;&#x3d; array&#x5b;0&#x5d;&#x3b;&#xd;&#xa;    crCursor            REFCURSOR&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;BEGIN&#xd;&#xa;&#xd;&#xa;--    --Totaliza o saldo anterior&#xd;&#xa;    if stMes &#x3d; &#x27;1&#x27; then&#xd;&#xa;		stSqlWhere &#x3a;&#x3d; &#x27;exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27; and tipo &#x3d; &#x27;&#x27;I&#x27;&#x27; and mes &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27; and &#x27; &#x7c;&#x7c; stFiltro &#x3b;&#xd;&#xa;	else&#xd;&#xa;		stSqlWhere &#x3a;&#x3d; &#x27;dt_lote BETWEEN TO_DATE&#x28;&#x27;&#x27;01&#x2f;01&#x2f;&#x27;&#x7c;&#x7c; stExercicio &#x7c;&#x7c;&#x27;&#x27;&#x27; ,&#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29; &#xd;&#xa;                        AND TO_DATE&#x28;&#x27;&#x27;01&#x2f;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c;&#x27;&#x27;&#x27;,&#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29;-1 and &#x27; &#x7c;&#x7c; stFiltro &#x3b;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;	&#xd;&#xa;	stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.balancete_11&#xd;&#xa;               WHERE &#x27; &#x7c;&#x7c; stSqlWhere &#x7c;&#x7c; &#x27;&#xd;&#xa;				 AND cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#xd;&#xa;                 AND num_programa     &#x3d; &#x27;&#x7c;&#x7c;inNumPrograma&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_acao         &#x3d; &#x27;&#x7c;&#x7c;inNumAcao&#x7c;&#x7c;&#x27;&#xd;&#xa;             &#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql &#x7c;&#x7c; stSqlComplemento&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuSaldoAnterior&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza a conta d&#xe9;bito&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.balancete_11&#xd;&#xa;               WHERE  exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;                 AND mes &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27;&#xd;&#xa;                 AND tipo &#x3c;&#x3e; &#x27;&#x27;I&#x27;&#x27;&#xd;&#xa;                 AND tipo_valor      &#x3d; &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;				 AND cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#xd;&#xa;                 AND num_programa     &#x3d; &#x27;&#x7c;&#x7c;inNumPrograma&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_acao         &#x3d; &#x27;&#x7c;&#x7c;inNumAcao&#x7c;&#x7c;&#x27;&#xd;&#xa;             &#x27;&#x3b;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuDebito&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza a conta cr&#xe9;dito&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.balancete_11&#xd;&#xa;               WHERE exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;                 AND mes &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27;&#xd;&#xa;                 AND tipo &#x3c;&#x3e; &#x27;&#x27;I&#x27;&#x27; &#xd;&#xa;                 AND tipo_valor      &#x3d; &#x27;&#x27;C&#x27;&#x27;&#xd;&#xa;				 AND cod_estrutural LIKE &#x27;&#x27;&#x27;&#x7c;&#x7c;stMascaraReduzida&#x7c;&#x7c;&#x27;&#x25;&#x27;&#x27;&#xd;&#xa;                 AND num_programa     &#x3d; &#x27;&#x7c;&#x7c;inNumPrograma&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_acao         &#x3d; &#x27;&#x7c;&#x7c;inNumAcao&#x7c;&#x7c;&#x27;&#xd;&#xa;             &#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuCredito&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    nuSaldoAnterior &#x3a;&#x3d; coalesce&#x28;nuSaldoAnterior,0.00&#x29;&#x3b;&#xd;&#xa;    nuCredito       &#x3a;&#x3d; coalesce&#x28;nuCredito,0.00&#x29;&#x3b;&#xd;&#xa;    nuDebito        &#x3a;&#x3d; coalesce&#x28;nuDebito,0.00&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza Saldo Atual&#xd;&#xa;    nuSaldoAtual    &#x3a;&#x3d; &#x28; nuSaldoAnterior &#x2b; nuDebito &#x29; &#x2b; nuCredito&#x3b;&#xd;&#xa;    nuSaldoAtual    &#x3a;&#x3d; coalesce&#x28;nuSaldoAtual,0.00&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;    --Preenche array de retorno&#xd;&#xa;    arRetorno&#x5b;1&#x5d; &#x3a;&#x3d; nuSaldoAnterior&#x3b;&#xd;&#xa;    arRetorno&#x5b;2&#x5d; &#x3a;&#x3d; nuDebito&#x3b;&#xd;&#xa;    arRetorno&#x5b;3&#x5d; &#x3a;&#x3d; nuCredito&#x3b;&#xd;&#xa;    arRetorno&#x5b;4&#x5d; &#x3a;&#x3d; nuSaldoAtual&#x3b;&#xd;&#xa;&#xd;&#xa;    RETURN arRetorno&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5289 &#x28;class 1255 OID 7485716&#x29;&#xd;&#xa;-- Name&#x3a; fn_balancete_contabil_totaliza_receita&#x28;character varying, character varying, character varying, character varying, integer, character varying&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_totaliza_receita&#x28;character varying, character varying, character varying, character varying, integer, character varying&#x29; RETURNS numeric&#x5b;&#x5d;&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    stMascaraReduzida   ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;2&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stFiltro            ALIAS FOR &#x24;4&#x3b;&#xd;&#xa;    inCodRecurso        ALIAS FOR &#x24;5&#x3b;&#xd;&#xa;    stNaturezaReceita   ALIAS FOR &#x24;6&#x3b;&#xd;&#xa;    stSql               VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlWhere          VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;    &#xd;&#xa;    stSqlComplemento    VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    nuSaldoAnterior     NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuDebito            NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuCredito           NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuSaldoAtual        NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    arRetorno           NUMERIC&#x5b;&#x5d; &#x3a;&#x3d; array&#x5b;0&#x5d;&#x3b;&#xd;&#xa;    crCursor            REFCURSOR&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;BEGIN&#xd;&#xa;&#xd;&#xa;--    --Totaliza o saldo anterior&#xd;&#xa;    if stMes &#x3d; &#x27;1&#x27; then&#xd;&#xa;        stSqlWhere &#x3a;&#x3d; &#x27;exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27; and mes &#x3d;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27; AND tipo &#x3d; &#x27;&#x27;I&#x27;&#x27;&#x27; &#x3b;&#xd;&#xa;    else&#xd;&#xa;        stSqlWhere &#x3a;&#x3d; &#x27;dt_lote BETWEEN TO_DATE&#x28;&#x27;&#x27;01&#x2f;01&#x2f;&#x27;&#x7c;&#x7c; stExercicio &#x7c;&#x7c;&#x27;&#x27;&#x27; ,&#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29;&#xd;&#xa;                        AND TO_DATE&#x28;&#x27;&#x27;01&#x2f;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c;&#x27;&#x27;&#x27;,&#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29;-1 &#x27;&#x3b;&#xd;&#xa;    end if&#x3b;&#xd;&#xa;	&#xd;&#xa;	stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.balancete_12&#xd;&#xa;               WHERE &#x27; &#x7c;&#x7c; stSqlWhere  &#x7c;&#x7c; &#x27; AND &#x27; &#x7c;&#x7c; stFiltro&#xd;&#xa;				  &#x7c;&#x7c; &#x27; AND cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#xd;&#xa;                       AND cod_recurso      &#x3d; &#x27;&#x7c;&#x7c;inCodRecurso&#x7c;&#x7c;&#x27;&#xd;&#xa;                       AND natureza_receita LIKE &#x27;&#x27;&#x27;&#x7c;&#x7c;stNaturezaReceita&#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#xd;&#xa;             &#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql &#x7c;&#x7c; stSqlComplemento&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuSaldoAnterior&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza a conta d&#xe9;bito&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;              FROM bi.balancete_12&#xd;&#xa;              WHERE exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27;  &#xd;&#xa;                AND mes &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27;&#xd;&#xa;  			    AND &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27;&#xd;&#xa;                AND tipo &#x3c;&#x3e; &#x27;&#x27;I&#x27;&#x27; &#xd;&#xa;		        AND tipo_valor      &#x3d; &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;				AND cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#xd;&#xa;               	AND cod_recurso      &#x3d; &#x27;&#x7c;&#x7c;inCodRecurso&#x7c;&#x7c;&#x27;&#xd;&#xa;               	AND natureza_receita LIKE &#x27;&#x27;&#x27;&#x7c;&#x7c;stNaturezaReceita&#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#xd;&#xa;                &#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuDebito&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza a conta cr&#xe9;dito&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.balancete_12&#xd;&#xa;               WHERE exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27;  &#xd;&#xa;                   AND mes &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27; &#xd;&#xa;				   AND &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27;&#xd;&#xa;			       AND tipo &#x3c;&#x3e; &#x27;&#x27;I&#x27;&#x27; &#xd;&#xa;				   AND tipo_valor      &#x3d; &#x27;&#x27;C&#x27;&#x27;&#xd;&#xa;				   AND cod_estrutural LIKE &#x27;&#x27;&#x27;&#x7c;&#x7c;stMascaraReduzida&#x7c;&#x7c;&#x27;&#x25;&#x27;&#x27;&#xd;&#xa;		           AND cod_recurso      &#x3d; &#x27;&#x7c;&#x7c;inCodRecurso&#x7c;&#x7c;&#x27;&#xd;&#xa;		           AND natureza_receita LIKE &#x27;&#x27;&#x27;&#x7c;&#x7c;stNaturezaReceita&#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#xd;&#xa;                   &#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuCredito&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    nuSaldoAnterior &#x3a;&#x3d; coalesce&#x28;nuSaldoAnterior,0.00&#x29;&#x3b;&#xd;&#xa;    nuCredito       &#x3a;&#x3d; coalesce&#x28;nuCredito,0.00&#x29;&#x3b;&#xd;&#xa;    nuDebito        &#x3a;&#x3d; coalesce&#x28;nuDebito,0.00&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza Saldo Atual&#xd;&#xa;    nuSaldoAtual    &#x3a;&#x3d; &#x28; nuSaldoAnterior &#x2b; nuDebito &#x29; &#x2b; nuCredito&#x3b;&#xd;&#xa;    nuSaldoAtual    &#x3a;&#x3d; coalesce&#x28;nuSaldoAtual,0.00&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;    --Preenche array de retorno&#xd;&#xa;    arRetorno&#x5b;1&#x5d; &#x3a;&#x3d; nuSaldoAnterior&#x3b;&#xd;&#xa;    arRetorno&#x5b;2&#x5d; &#x3a;&#x3d; nuDebito&#x3b;&#xd;&#xa;    arRetorno&#x5b;3&#x5d; &#x3a;&#x3d; nuCredito&#x3b;&#xd;&#xa;    arRetorno&#x5b;4&#x5d; &#x3a;&#x3d; nuSaldoAtual&#x3b;&#xd;&#xa;&#xd;&#xa;    RETURN arRetorno&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5290 &#x28;class 1255 OID 7485717&#x29;&#xd;&#xa;-- Name&#x3a; fn_balancete_contabil_totaliza_recurso_sf&#x28;character varying, character varying, character varying, character varying, integer&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_totaliza_recurso_sf&#x28;character varying, character varying, character varying, character varying, integer&#x29; RETURNS numeric&#x5b;&#x5d;&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    stMascaraReduzida   ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;2&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stFiltro            ALIAS FOR &#x24;4&#x3b;&#xd;&#xa;    inCodRecurso        ALIAS FOR &#x24;5&#x3b;&#xd;&#xa;    stSql               VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlWhere          VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento    VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    nuSaldoAnterior     NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuDebito            NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuCredito           NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuSaldoAtual        NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    arRetorno           NUMERIC&#x5b;&#x5d; &#x3a;&#x3d; array&#x5b;0&#x5d;&#x3b;&#xd;&#xa;    crCursor            REFCURSOR&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;BEGIN&#xd;&#xa;&#xd;&#xa;--    --Totaliza o saldo anterior&#xd;&#xa;    if stMes &#x3d; &#x27;1&#x27; then&#xd;&#xa;		stSqlWhere &#x3a;&#x3d; &#x27;exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27; and tipo &#x3d; &#x27;&#x27;I&#x27;&#x27; and mes &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27; and &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27; and cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#x27;&#x3b;&#xd;&#xa;	else&#xd;&#xa;		stSqlWhere &#x3a;&#x3d; &#x27;dt_lote BETWEEN TO_DATE&#x28;&#x27;&#x27;01&#x2f;01&#x2f;&#x27;&#x7c;&#x7c; stExercicio &#x7c;&#x7c;&#x27;&#x27;&#x27; ,&#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29; &#xd;&#xa;                        AND TO_DATE&#x28;&#x27;&#x27;01&#x2f;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c;&#x27;&#x27;&#x27;,&#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29;-1 and &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27; and cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#x27;&#x3b;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;	&#xd;&#xa;	stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.lancamento&#xd;&#xa;               WHERE &#x27; &#x7c;&#x7c; stSqlWhere  &#x7c;&#x7c;&#xd;&#xa;                   &#x27; AND cod_recurso  &#x3d; &#x27; &#x7c;&#x7c;inCodRecurso&#xd;&#xa;               &#x3b;&#xd;&#xa;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql &#x7c;&#x7c; stSqlComplemento&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuSaldoAnterior&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza a conta d&#xe9;bito&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.lancamento&#xd;&#xa;                WHERE exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27; &#xd;&#xa;                  AND tipo &#x3c;&#x3e; &#x27;&#x27;I&#x27;&#x27; &#xd;&#xa;                  AND tipo_valor &#x3d; &#x27;&#x27;D&#x27;&#x27;&#x27; &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND mes &#x3d; &#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#x27; &#x7c;&#x7c; &#x27; &#xd;&#xa;                  AND cod_recurso &#x3d; &#x27; &#x7c;&#x7c; inCodRecurso&#xd;&#xa;                 &#x3b;&#xd;&#xa;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuDebito&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza a conta cr&#xe9;dito&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.lancamento&#xd;&#xa;               WHERE exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27; &#xd;&#xa;                 AND tipo &#x3c;&#x3e; &#x27;&#x27;I&#x27;&#x27; &#xd;&#xa;                 AND tipo_valor &#x3d; &#x27;&#x27;C&#x27;&#x27;&#x27; &#x7c;&#x7c; &#x27;&#xd;&#xa;                 AND mes &#x3d; &#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#xd;&#xa;                 AND &#x27; &#x7c;&#x7c; stFiltro  &#x7c;&#x7c; &#x27;&#xd;&#xa;                 AND cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#x27; &#x7c;&#x7c; &#x27;&#xd;&#xa;                 AND cod_recurso &#x3d; &#x27; &#x7c;&#x7c; inCodRecurso&#xd;&#xa;                  &#x3b;&#xd;&#xa;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuCredito&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    nuSaldoAnterior &#x3a;&#x3d; coalesce&#x28;nuSaldoAnterior,0.00&#x29;&#x3b;&#xd;&#xa;    nuCredito       &#x3a;&#x3d; coalesce&#x28;nuCredito,0.00&#x29;&#x3b;&#xd;&#xa;    nuDebito        &#x3a;&#x3d; coalesce&#x28;nuDebito,0.00&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza Saldo Atual&#xd;&#xa;    nuSaldoAtual    &#x3a;&#x3d; &#x28; nuSaldoAnterior &#x2b; nuDebito &#x29; &#x2b; nuCredito&#x3b;&#xd;&#xa;    nuSaldoAtual    &#x3a;&#x3d; coalesce&#x28;nuSaldoAtual,0.00&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;    --Preenche array de retorno&#xd;&#xa;    arRetorno&#x5b;1&#x5d; &#x3a;&#x3d; nuSaldoAnterior&#x3b;&#xd;&#xa;    arRetorno&#x5b;2&#x5d; &#x3a;&#x3d; nuDebito&#x3b;&#xd;&#xa;    arRetorno&#x5b;3&#x5d; &#x3a;&#x3d; nuCredito&#x3b;&#xd;&#xa;    arRetorno&#x5b;4&#x5d; &#x3a;&#x3d; nuSaldoAtual&#x3b;&#xd;&#xa;&#xd;&#xa;    RETURN arRetorno&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5291 &#x28;class 1255 OID 7485718&#x29;&#xd;&#xa;-- Name&#x3a; fn_balancete_contabil_totaliza_restos_pagar&#x28;character varying, character varying, character varying, character varying, integer, integer, integer, integer, integer, integer, integer, character varying, integer, character varying&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_balancete_contabil_totaliza_restos_pagar&#x28;character varying, character varying, character varying, character varying, integer, integer, integer, integer, integer, integer, integer, character varying, integer, character varying&#x29; RETURNS numeric&#x5b;&#x5d;&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    stMascaraReduzida   ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;2&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stFiltro            ALIAS FOR &#x24;4&#x3b;&#xd;&#xa;    inNumOrgao          ALIAS FOR &#x24;5&#x3b;&#xd;&#xa;    inNumUnidade        ALIAS FOR &#x24;6&#x3b;&#xd;&#xa;    inCodFuncao         ALIAS FOR &#x24;7&#x3b;&#xd;&#xa;    inCodSubFuncao      ALIAS FOR &#x24;8&#x3b;&#xd;&#xa;    inNumPrograma       ALIAS FOR &#x24;9&#x3b;&#xd;&#xa;    inNumAcao           ALIAS FOR &#x24;10&#x3b;&#xd;&#xa;    inCodRecurso        ALIAS FOR &#x24;11&#x3b;&#xd;&#xa;    stNaturezaDespesa   ALIAS FOR &#x24;12&#x3b;&#xd;&#xa;    inCodEmpenho        ALIAS FOR &#x24;13&#x3b;&#xd;&#xa;    stExercicioEmpenho  ALIAS FOR &#x24;14&#x3b;&#xd;&#xa;    stSql               VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlWhere          VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento    VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    nuSaldoAnterior     NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuDebito            NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuCredito           NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuSaldoAtual        NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    arRetorno           NUMERIC&#x5b;&#x5d; &#x3a;&#x3d; array&#x5b;0&#x5d;&#x3b;&#xd;&#xa;    crCursor            REFCURSOR&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;BEGIN&#xd;&#xa;&#xd;&#xa;    --Totaliza o saldo anterior&#xd;&#xa;    if stMes &#x3d; &#x27;1&#x27; then&#xd;&#xa;        stSqlWhere &#x3a;&#x3d; &#x27;exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27; and mes &#x3d;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27; AND tipo &#x3d; &#x27;&#x27;I&#x27;&#x27;&#x27; &#x3b;&#xd;&#xa;    else&#xd;&#xa;        stSqlWhere &#x3a;&#x3d; &#x27;dt_lote BETWEEN TO_DATE&#x28;&#x27;&#x27;01&#x2f;01&#x2f;&#x27;&#x7c;&#x7c; stExercicio &#x7c;&#x7c;&#x27;&#x27;&#x27; ,&#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29;&#xd;&#xa;                        AND TO_DATE&#x28;&#x27;&#x27;01&#x2f;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c;&#x27;&#x27;&#x27;,&#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29;-1 &#x27;&#x3b;&#xd;&#xa;    end if&#x3b;&#xd;&#xa;&#xd;&#xa;	&#xd;&#xa;	stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.balancete_14&#xd;&#xa;               WHERE  &#x27; &#x7c;&#x7c; stSqlWhere  &#x7c;&#x7c; &#x27; AND &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27;&#xd;&#xa;                 AND cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#xd;&#xa;                 AND num_orgao        &#x3d; &#x27;&#x7c;&#x7c;inNumOrgao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_unidade      &#x3d; &#x27;&#x7c;&#x7c;inNumUnidade&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_funcao       &#x3d; &#x27;&#x7c;&#x7c;inCodFuncao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_subfuncao    &#x3d; &#x27;&#x7c;&#x7c;inCodSubFuncao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_programa     &#x3d; &#x27;&#x7c;&#x7c;inNumPrograma&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_acao         &#x3d; &#x27;&#x7c;&#x7c;inNumAcao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_recurso      &#x3d; &#x27;&#x7c;&#x7c;inCodRecurso&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND natureza_despesa LIKE &#x27;&#x27;&#x27;&#x7c;&#x7c;stNaturezaDespesa&#x7c;&#x7c;&#x27;&#x25;&#x27;&#x27;&#xd;&#xa;                 AND cod_empenho      &#x3d; &#x27;&#x7c;&#x7c;inCodEmpenho&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND exercicio_empenho &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicioEmpenho&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;             &#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql &#x7c;&#x7c; stSqlComplemento&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuSaldoAnterior&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza a conta d&#xe9;bito&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.balancete_14&#xd;&#xa;               WHERE exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27;  &#xd;&#xa;                 AND mes &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27;&#xd;&#xa;  			     AND &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27;&#xd;&#xa;                 AND tipo &#x3c;&#x3e; &#x27;&#x27;I&#x27;&#x27; &#xd;&#xa;		         AND tipo_valor      &#x3d; &#x27;&#x27;D&#x27;&#x27;&#xd;&#xa;				 AND cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#xd;&#xa;                 AND num_orgao        &#x3d; &#x27;&#x7c;&#x7c;inNumOrgao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_unidade      &#x3d; &#x27;&#x7c;&#x7c;inNumUnidade&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_funcao       &#x3d; &#x27;&#x7c;&#x7c;inCodFuncao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_subfuncao    &#x3d; &#x27;&#x7c;&#x7c;inCodSubFuncao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_programa     &#x3d; &#x27;&#x7c;&#x7c;inNumPrograma&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_acao         &#x3d; &#x27;&#x7c;&#x7c;inNumAcao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_recurso      &#x3d; &#x27;&#x7c;&#x7c;inCodRecurso&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND natureza_despesa LIKE &#x27;&#x27;&#x27;&#x7c;&#x7c;stNaturezaDespesa&#x7c;&#x7c;&#x27;&#x25;&#x27;&#x27;&#xd;&#xa;                 AND cod_empenho      &#x3d; &#x27;&#x7c;&#x7c;inCodEmpenho&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND exercicio_empenho &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicioEmpenho&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;             &#x27;&#x3b;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuDebito&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza a conta cr&#xe9;dito&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT SUM&#x28; vl_lancamento &#x29; as soma&#xd;&#xa;                FROM bi.balancete_14&#xd;&#xa;               WHERE exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27;  &#xd;&#xa;                 AND mes &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27; &#xd;&#xa;				 AND &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27;&#xd;&#xa;			     AND tipo &#x3c;&#x3e; &#x27;&#x27;I&#x27;&#x27; &#xd;&#xa;				 AND tipo_valor      &#x3d; &#x27;&#x27;C&#x27;&#x27;&#xd;&#xa;				 AND cod_estrutural LIKE &#x27;&#x27;&#x27;&#x7c;&#x7c;stMascaraReduzida&#x7c;&#x7c;&#x27;&#x25;&#x27;&#x27;&#xd;&#xa;                 AND num_orgao        &#x3d; &#x27;&#x7c;&#x7c;inNumOrgao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_unidade      &#x3d; &#x27;&#x7c;&#x7c;inNumUnidade&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_funcao       &#x3d; &#x27;&#x7c;&#x7c;inCodFuncao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_subfuncao    &#x3d; &#x27;&#x7c;&#x7c;inCodSubFuncao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_programa     &#x3d; &#x27;&#x7c;&#x7c;inNumPrograma&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND num_acao         &#x3d; &#x27;&#x7c;&#x7c;inNumAcao&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND cod_recurso      &#x3d; &#x27;&#x7c;&#x7c;inCodRecurso&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND natureza_despesa LIKE &#x27;&#x27;&#x27;&#x7c;&#x7c;stNaturezaDespesa&#x7c;&#x7c;&#x27;&#x25;&#x27;&#x27;&#xd;&#xa;                 AND cod_empenho      &#x3d; &#x27;&#x7c;&#x7c;inCodEmpenho&#x7c;&#x7c;&#x27;&#xd;&#xa;                 AND exercicio_empenho &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicioEmpenho&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;             &#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuCredito&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    nuSaldoAnterior &#x3a;&#x3d; coalesce&#x28;nuSaldoAnterior,0.00&#x29;&#x3b;&#xd;&#xa;    nuCredito       &#x3a;&#x3d; coalesce&#x28;nuCredito,0.00&#x29;&#x3b;&#xd;&#xa;    nuDebito        &#x3a;&#x3d; coalesce&#x28;nuDebito,0.00&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza Saldo Atual&#xd;&#xa;    nuSaldoAtual    &#x3a;&#x3d; &#x28; nuSaldoAnterior &#x2b; nuDebito &#x29; &#x2b; nuCredito&#x3b;&#xd;&#xa;    nuSaldoAtual    &#x3a;&#x3d; coalesce&#x28;nuSaldoAtual,0.00&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;    --Preenche array de retorno&#xd;&#xa;    arRetorno&#x5b;1&#x5d; &#x3a;&#x3d; nuSaldoAnterior&#x3b;&#xd;&#xa;    arRetorno&#x5b;2&#x5d; &#x3a;&#x3d; nuDebito&#x3b;&#xd;&#xa;    arRetorno&#x5b;3&#x5d; &#x3a;&#x3d; nuCredito&#x3b;&#xd;&#xa;    arRetorno&#x5b;4&#x5d; &#x3a;&#x3d; nuSaldoAtual&#x3b;&#xd;&#xa;&#xd;&#xa;    RETURN arRetorno&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5292 &#x28;class 1255 OID 7485719&#x29;&#xd;&#xa;-- Name&#x3a; fn_mascarareduzida_regex&#x28;character varying&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_mascarareduzida_regex&#x28;character varying&#x29; RETURNS character varying&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;   stString    ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;   stOut       varchar &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    &#xd;&#xa;BEGIN&#xd;&#xa;        stOut &#x3a;&#x3d; regexp_replace&#x28;stString,&#x27;&#x28;&#x3f;&#x3a;&#x5c;.0.00.00.00.00.00&#x24;&#x7c;.00.00.00.00.00&#x24;&#x7c;.00.00.00.00&#x24;&#x7c;.00.00.00&#x24;&#x7c;.00.00&#x24;&#x7c;.00&#x24;&#x29;&#x27;,&#x27;&#x27;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;   RETURN stOut&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 5293 &#x28;class 1255 OID 7485720&#x29;&#xd;&#xa;-- Name&#x3a; fn_totaliza_balancete_verificacao&#x28;character varying, character varying, character varying, character varying&#x29;&#x3b; Type&#x3a; FUNCTION&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_totaliza_balancete_verificacao&#x28;character varying, character varying, character varying, character varying&#x29; RETURNS numeric&#x5b;&#x5d;&#xd;&#xa;    LANGUAGE plpgsql&#xd;&#xa;    AS &#x24;_&#x24;&#xd;&#xa;DECLARE&#xd;&#xa;    stMascaraReduzida   ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;2&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stFiltro            ALIAS FOR &#x24;4&#x3b;&#xd;&#xa;    stSql               VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlWhere          VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    stSqlComplemento    VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    nuSaldoAnterior     NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuDebito            NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuCredito           NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    nuSaldoAtual        NUMERIC   &#x3a;&#x3d; 0&#x3b;&#xd;&#xa;    arRetorno           NUMERIC&#x5b;&#x5d; &#x3a;&#x3d; array&#x5b;0&#x5d;&#x3b;&#xd;&#xa;    crCursor            REFCURSOR&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;BEGIN&#xd;&#xa;    --Totaliza o saldo anterior&#xd;&#xa;&#xd;&#xa;    if stMes &#x3d; &#x27;1&#x27; then&#xd;&#xa;		stSqlWhere &#x3a;&#x3d; &#x27;exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27; and tipo &#x3d; &#x27;&#x27;I&#x27;&#x27; and mes &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27; and &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27; and cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#x27;&#x3b;&#xd;&#xa;	else&#xd;&#xa;		stSqlWhere &#x3a;&#x3d; &#x27;dt_lote BETWEEN TO_DATE&#x28;&#x27;&#x27;01&#x2f;01&#x2f;&#x27;&#x7c;&#x7c; stExercicio &#x7c;&#x7c;&#x27;&#x27;&#x27; ,&#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29; &#xd;&#xa;                        AND TO_DATE&#x28;&#x27;&#x27;01&#x2f;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x2f;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c;&#x27;&#x27;&#x27;,&#x27;&#x27;dd&#x2f;mm&#x2f;yyyy&#x27;&#x27;&#x29;-1 and &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27; and cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#x27;&#x3b;&#xd;&#xa;	end if&#x3b;&#xd;&#xa;	&#xd;&#xa;	stSql &#x3a;&#x3d; &#x27;SELECT&#xd;&#xa;                SUM&#x28;vl_lancamento&#x29; as soma&#xd;&#xa;                FROM bi.lancamento&#xd;&#xa;				  WHERE &#x27; &#x7c;&#x7c; stSqlWhere&#x3b;&#xd;&#xa;				  &#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql &#x7c;&#x7c; stSqlComplemento&#x3b;&#xd;&#xa;    FETCH crCursor INTO nuSaldoAnterior&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza a conta d&#xe9;bito&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT&#xd;&#xa;                SUM&#x28;vl_lancamento&#x29; as soma&#xd;&#xa;                FROM bi.lancamento&#xd;&#xa;                WHERE  exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27; &#xd;&#xa;                  and tipo &#x3c;&#x3e; &#x27;&#x27;I&#x27;&#x27; &#xd;&#xa;                  and tipo_valor &#x3d; &#x27;&#x27;D&#x27;&#x27; &#xd;&#xa;                  and mes &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27; &#xd;&#xa;                  and &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27; &#xd;&#xa;                  and cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#xd;&#xa;             &#x27;&#x3b;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql&#x3b;&#xd;&#xa;    	FETCH crCursor INTO nuDebito&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza a conta cr&#xe9;dito&#xd;&#xa;    stSql &#x3a;&#x3d; &#x27;SELECT&#xd;&#xa;                SUM&#x28;vl_lancamento&#x29; as soma&#xd;&#xa;                FROM bi.lancamento&#xd;&#xa;                WHERE exercicio &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stExercicio &#x7c;&#x7c; &#x27;&#x27;&#x27; &#xd;&#xa;                  and tipo &#x3c;&#x3e; &#x27;&#x27;I&#x27;&#x27; &#xd;&#xa;                  and tipo_valor &#x3d; &#x27;&#x27;C&#x27;&#x27; &#xd;&#xa;                  and mes &#x3d; &#x27;&#x27;&#x27; &#x7c;&#x7c; stMes &#x7c;&#x7c; &#x27;&#x27;&#x27; &#xd;&#xa;                  and &#x27; &#x7c;&#x7c; stFiltro &#x7c;&#x7c; &#x27; &#xd;&#xa;                  and cod_estrutural LIKE &#x27;&#x27;&#x27; &#x7c;&#x7c; stMascaraReduzida &#x7c;&#x7c; &#x27;&#x25;&#x27;&#x27;&#xd;&#xa;             &#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;    OPEN  crCursor FOR EXECUTE stSql&#x3b;&#xd;&#xa;    	FETCH crCursor INTO nuCredito&#x3b;&#xd;&#xa;    CLOSE crCursor&#x3b;&#xd;&#xa;&#xd;&#xa;    nuSaldoAnterior &#x3a;&#x3d; coalesce&#x28;nuSaldoAnterior,0.00&#x29;&#x3b;&#xd;&#xa;    nuCredito       &#x3a;&#x3d; coalesce&#x28;nuCredito,0.00&#x29;&#x3b;&#xd;&#xa;    nuDebito        &#x3a;&#x3d; coalesce&#x28;nuDebito,0.00&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;    --Totaliza Saldo Atual&#xd;&#xa;    nuSaldoAtual    &#x3a;&#x3d; &#x28; nuSaldoAnterior &#x2b; nuDebito &#x29; &#x2b; nuCredito&#x3b;&#xd;&#xa;    nuSaldoAtual    &#x3a;&#x3d; coalesce&#x28;nuSaldoAtual,0.00&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;    --Preenche array de retorno&#xd;&#xa;    arRetorno&#x5b;1&#x5d; &#x3a;&#x3d; nuSaldoAnterior&#x3b;&#xd;&#xa;    arRetorno&#x5b;2&#x5d; &#x3a;&#x3d; nuDebito&#x3b;&#xd;&#xa;    arRetorno&#x5b;3&#x5d; &#x3a;&#x3d; nuCredito&#x3b;&#xd;&#xa;    arRetorno&#x5b;4&#x5d; &#x3a;&#x3d; nuSaldoAtual&#x3b;&#xd;&#xa;&#xd;&#xa;    RETURN arRetorno&#x3b;&#xd;&#xa;END&#x3b;&#xd;&#xa;&#x24;_&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;--&#xd;&#xa;--&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;CREATE OR REPLACE FUNCTION fn_gera_relatorio_tce&#x28;&#xd;&#xa;    character varying,&#xd;&#xa;    character varying,&#xd;&#xa;    character varying,&#xd;&#xa;    character varying&#x29;&#xd;&#xa;  RETURNS SETOF bi.gera_csv AS&#xd;&#xa;&#x24;BODY&#x24;&#xd;&#xa;declare&#xd;&#xa;    stUF                ALIAS FOR &#x24;1&#x3b;&#xd;&#xa;    stExercicio         ALIAS FOR &#x24;2&#x3b;&#xd;&#xa;    stMes               ALIAS FOR &#x24;3&#x3b;&#xd;&#xa;    stRelatorio         ALIAS FOR &#x24;4&#x3b;&#xd;&#xa;    stSql               VARCHAR   &#x3a;&#x3d; &#x27;&#x27;&#x3b;&#xd;&#xa;    reRegistro          RECORD&#x3b;&#xd;&#xa;begin&#xd;&#xa;	if &#x27;MG&#x27; &#x3d; upper&#x28;stUF&#x29;&#xd;&#xa;	then &#xd;&#xa;		if &#x27;BALANCETE_CONTABIL&#x27; &#x3d; upper&#x28;stRelatorio&#x29;&#xd;&#xa;		then&#xd;&#xa;			if &#x27;2015&#x27; &#x3d; stExercicio&#xd;&#xa;			then &#xd;&#xa;				stSql	&#x3d;&#x27;&#xd;&#xa;					WITH balancete_arq_tratado AS&#xd;&#xa;					&#x28;&#xd;&#xa;						select &#xd;&#xa;							mes,&#xd;&#xa;							cod_entidade,&#xd;&#xa;							to_char&#x28;tipo_registro,&#x27;&#x27;FM99&#x27;&#x27;&#x29; as tipo_registro,&#xd;&#xa;							conta_contabil,&#xd;&#xa;							cod_orgao,&#xd;&#xa;							lpad&#x28;cod_unidade_sub,5,&#x27;&#x27;0&#x27;&#x27;&#x29; as cod_unidade_sub,&#xd;&#xa;							to_char&#x28;cod_funcao,&#x27;&#x27;FM00&#x27;&#x27;&#x29;  as cod_funcao,&#xd;&#xa;							cod_sub_funcao,&#xd;&#xa;							to_char&#x28;cod_programa,&#x27;&#x27;FM0000&#x27;&#x27;&#x29; as cod_programa,&#xd;&#xa;							to_char&#x28;id_acao,&#x27;&#x27;FM0000&#x27;&#x27;&#x29; as id_acao,&#xd;&#xa;							case when replace&#x28;coalesce&#x28;id_sub_acao,&#x27;&#x27;&#x27;&#x27;&#x29;,&#x27;&#x27; &#x27;&#x27;,&#x27;&#x27;&#x27;&#x27;&#x29; &#x3d; &#x27;&#x27;&#x27;&#x27; then &#x27;&#x27; &#x27;&#x27; else lpad&#x28;id_sub_acao,4,&#x27;&#x27;0&#x27;&#x27;&#x29; end as id_sub_acao,&#xd;&#xa;							natureza_despesa,&#xd;&#xa;							sub_elemento,&#xd;&#xa;							cod_fonte_recursos,&#xd;&#xa;							natureza_receita,&#xd;&#xa;							num_orgao,&#xd;&#xa;							num_unidade,&#xd;&#xa;							to_char&#x28;numero_empenho,&#x27;&#x27;FM0000000000000000000000&#x27;&#x27;&#x29; as numero_empenho,&#xd;&#xa;							ano_inscricao,&#xd;&#xa;							atributo_sf,&#xd;&#xa;							to_char&#x28;cod_ctb,&#x27;&#x27;FM00000000000000000000&#x27;&#x27;&#x29; cod_ctb,&#xd;&#xa;							lpad&#x28;cod_unidade_sub_orig,5,&#x27;&#x27;0&#x27;&#x27;&#x29; as cod_unidade_sub_orig,&#xd;&#xa;							replace&#x28;to_char&#x28;saldo_inicial, &#x27;&#x27;FM00000000000D00&#x27;&#x27;&#x29;,&#x27;&#x27;.&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;&#x29; as saldo_inicial,&#xd;&#xa;							coalesce&#x28;natureza_saldo_inicial,&#x27;&#x27;&#x27;&#x27;&#x29; as natureza_saldo_inicial,&#xd;&#xa;							replace&#x28;to_char&#x28;total_debitos, &#x27;&#x27;FM00000000000D00&#x27;&#x27;&#x29;,&#x27;&#x27;.&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;&#x29; as total_debitos,&#xd;&#xa;							replace&#x28;to_char&#x28;total_creditos, &#x27;&#x27;FM00000000000D00&#x27;&#x27;&#x29;,&#x27;&#x27;.&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;&#x29; as total_creditos,&#xd;&#xa;							replace&#x28;to_char&#x28;saldo_final, &#x27;&#x27;FM00000000000D00&#x27;&#x27;&#x29;,&#x27;&#x27;.&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;&#x29; as saldo_final,&#xd;&#xa;							coalesce&#x28;natureza_saldo_final,&#x27;&#x27;&#x27;&#x27;&#x29; as natureza_saldo_final&#xd;&#xa;						from bi.balancete_arq &#xd;&#xa;						where &#xd;&#xa;							exercicio &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stExercicio&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;							and mes &#x3d; &#x27;&#x27;&#x27;&#x7c;&#x7c;stMes&#x7c;&#x7c;&#x27;&#x27;&#x27;&#xd;&#xa;							order by &#xd;&#xa;								conta_contabil,&#xd;&#xa;								tipo_registro&#xd;&#xa;					&#x2f;&#x2a;,&#xd;&#xa;					   			cod_orgao,cod_unidade_sub,cod_sub_funcao,cod_programa,id_acao,cod_fonte_recursos,natureza_despesa,sub_elemento, --11&#xd;&#xa;					            natureza_receita,cod_fonte_recursos, --12&#xd;&#xa;								cod_programa,id_acao,id_sub_acao, -- 13&#xd;&#xa;								cod_orgao,num_orgao,num_unidade,cod_funcao,cod_sub_funcao,cod_programa,id_acao,natureza_despesa,sub_elemento,cod_fonte_recurso,num_empenho,ano_inscricao,id_sub_acao,cod_unidade_sub,cod_unidade_sub_orig, --14&#xd;&#xa;								atributo_sf, --15&#xd;&#xa;								atributo_sf, cod_fonte_recursos, --16&#xd;&#xa;								atributo_sf, cod_fonte_recursos,cod_ctb --17&#xd;&#xa;								cod_fonte_recursos, --18&#xd;&#xa;								atributo_sf, cod_ctb --22&#xd;&#xa;					&#x2a;&#x2f;&#xd;&#xa;					&#x29;&#xd;&#xa;					select &#xd;&#xa;						&#x28;&#xd;&#xa;							case &#xd;&#xa;								when tipo_registro &#x3d; &#x27;&#x27;10&#x27;&#x27; then tipo_registro&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;conta_contabil&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_debitos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_creditos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#xd;&#xa;						     	when tipo_registro &#x3d; &#x27;&#x27;11&#x27;&#x27; then tipo_registro&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;conta_contabil&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_orgao&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_unidade_sub&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_funcao&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_sub_funcao&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_programa&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;id_acao&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;id_sub_acao&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_despesa&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;sub_elemento&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_fonte_recursos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_debitos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_creditos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27; &#xd;&#xa;						     	when tipo_registro &#x3d; &#x27;&#x27;12&#x27;&#x27; then tipo_registro&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;conta_contabil&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_receita&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_fonte_recursos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_debitos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_creditos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#xd;&#xa;						     	when tipo_registro &#x3d; &#x27;&#x27;13&#x27;&#x27; then tipo_registro&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;conta_contabil&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_programa&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;id_acao&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;id_sub_acao&#x7c;&#x7c;natureza_saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_debitos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_creditos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#xd;&#xa;						     	when tipo_registro &#x3d; &#x27;&#x27;14&#x27;&#x27; then tipo_registro&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;conta_contabil&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_orgao&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_unidade_sub&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_unidade_sub_orig&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_funcao&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_sub_funcao&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_programa&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;id_acao&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;id_sub_acao&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_despesa&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;sub_elemento&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_fonte_recursos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;numero_empenho&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;ano_inscricao&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_debitos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_creditos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#xd;&#xa;						     	when tipo_registro &#x3d; &#x27;&#x27;15&#x27;&#x27; then tipo_registro&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;conta_contabil&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;atributo_sf&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_debitos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_creditos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#xd;&#xa;						     	when tipo_registro &#x3d; &#x27;&#x27;16&#x27;&#x27; then tipo_registro&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;conta_contabil&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;atributo_sf&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_fonte_recursos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_debitos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_creditos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#xd;&#xa;						     	when tipo_registro &#x3d; &#x27;&#x27;17&#x27;&#x27; then tipo_registro&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;conta_contabil&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;atributo_sf&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_ctb&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_fonte_recursos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_debitos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_creditos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#xd;&#xa;								when tipo_registro &#x3d; &#x27;&#x27;18&#x27;&#x27; then tipo_registro&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;conta_contabil&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_fonte_recursos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_debitos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_creditos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#xd;&#xa;								when tipo_registro &#x3d; &#x27;&#x27;22&#x27;&#x27; then tipo_registro&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;conta_contabil&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;atributo_sf&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;cod_ctb&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_inicial&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_debitos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;total_creditos&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#x7c;&#x7c;natureza_saldo_final&#x7c;&#x7c;&#x27;&#x27;&#x3b;&#x27;&#x27;&#xd;&#xa;							end&#xd;&#xa;						&#x29;&#x3a;&#x3a;varchar AS linha&#xd;&#xa;					from balancete_arq_tratado&#x27;&#x3b;&#xd;&#xa;								&#xd;&#xa;&#xd;&#xa;			end if&#x3b;&#xd;&#xa;		end if&#x3b;	 &#xd;&#xa;	end if&#x3b; &#xd;&#xa;&#xd;&#xa;	if stSql &#x3c;&#x3e; &#x27;&#x27;&#xd;&#xa;	then &#xd;&#xa;		FOR reRegistro IN EXECUTE stSql&#xd;&#xa;		LOOP&#xd;&#xa;			RETURN NEXT reRegistro&#x3b;&#xd;&#xa;		END LOOP&#x3b;	&#xd;&#xa;	end if&#x3b;	&#xd;&#xa;			&#xd;&#xa;end&#x3b;&#xd;&#xa;&#x24;BODY&#x24;&#xd;&#xa;  LANGUAGE plpgsql VOLATILE&#xd;&#xa;  COST 100&#xd;&#xa;  ROWS 1000&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;-- tabelas &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;-- &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;CREATE TABLE IF NOT EXISTS balancete &#x28;&#xd;&#xa;    cod_plano integer,&#xd;&#xa;    cod_estrutural character varying&#x28;160&#x29; NOT NULL,&#xd;&#xa;    exercicio character varying&#x28;4&#x29;,&#xd;&#xa;    cod_entidade integer,&#xd;&#xa;    mes integer,&#xd;&#xa;    saldo_inicial numeric&#x28;16,2&#x29;,&#xd;&#xa;    natureza_saldo_inicial character varying&#x28;1&#x29;,&#xd;&#xa;    total_debitos numeric&#x28;16,2&#x29;,&#xd;&#xa;    total_creditos numeric&#x28;16,2&#x29;,&#xd;&#xa;    saldo_final numeric&#x28;16,2&#x29;,&#xd;&#xa;    natureza_saldo_final character varying&#x28;1&#x29;,&#xd;&#xa;    escrituracao_pcasp character&#x28;1&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 2694 &#x28;class 1259 OID 7485724&#x29;&#xd;&#xa;-- Name&#x3a; balancete_11&#x3b; Type&#x3a; TABLE&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE TABLE IF NOT EXISTS balancete_11 &#x28;&#xd;&#xa;    cod_estrutural character varying&#x28;160&#x29; NOT NULL,&#xd;&#xa;    cod_plano integer,&#xd;&#xa;    num_orgao integer NOT NULL,&#xd;&#xa;    num_unidade integer NOT NULL,&#xd;&#xa;    cod_funcao integer NOT NULL,&#xd;&#xa;    cod_subfuncao integer NOT NULL,&#xd;&#xa;    num_programa integer NOT NULL,&#xd;&#xa;    num_acao integer NOT NULL,&#xd;&#xa;    cod_recurso integer NOT NULL,&#xd;&#xa;    natureza_despesa character varying&#x28;150&#x29; NOT NULL,&#xd;&#xa;    tipo_valor character varying&#x28;1&#x29;,&#xd;&#xa;    vl_lancamento numeric&#x28;16,2&#x29;,&#xd;&#xa;    cod_entidade integer,&#xd;&#xa;    cod_lote integer,&#xd;&#xa;    dt_lote date,&#xd;&#xa;    exercicio character varying&#x28;4&#x29;,&#xd;&#xa;    mes integer NOT NULL,&#xd;&#xa;    tipo character varying&#x28;1&#x29;,&#xd;&#xa;    sequencia integer,&#xd;&#xa;    oid_temp integer,&#xd;&#xa;    cod_sistema integer,&#xd;&#xa;    escrituracao character&#x28;9&#x29;,&#xd;&#xa;    indicador_superavit character&#x28;12&#x29;,&#xd;&#xa;    natureza_saldo character&#x28;1&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 2695 &#x28;class 1259 OID 7485727&#x29;&#xd;&#xa;-- Name&#x3a; balancete_12&#x3b; Type&#x3a; TABLE&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE TABLE IF NOT EXISTS balancete_12 &#x28;&#xd;&#xa;    cod_estrutural character varying&#x28;160&#x29; NOT NULL,&#xd;&#xa;    cod_plano integer,&#xd;&#xa;    natureza_receita character varying&#x28;150&#x29; NOT NULL,&#xd;&#xa;    cod_recurso integer NOT NULL,&#xd;&#xa;    tipo_valor character varying&#x28;1&#x29;,&#xd;&#xa;    vl_lancamento numeric&#x28;16,2&#x29;,&#xd;&#xa;    cod_entidade integer,&#xd;&#xa;    cod_lote integer,&#xd;&#xa;    dt_lote date,&#xd;&#xa;    exercicio character varying&#x28;4&#x29;,&#xd;&#xa;    mes integer NOT NULL,&#xd;&#xa;    tipo character varying&#x28;1&#x29;,&#xd;&#xa;    sequencia integer,&#xd;&#xa;    oid_temp integer,&#xd;&#xa;    escrituracao character&#x28;9&#x29;,&#xd;&#xa;    indicador_superavit character&#x28;12&#x29;,&#xd;&#xa;    atributo_tcemg integer,&#xd;&#xa;    natureza_saldo character&#x28;1&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 2696 &#x28;class 1259 OID 7485730&#x29;&#xd;&#xa;-- Name&#x3a; balancete_14&#x3b; Type&#x3a; TABLE&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE TABLE IF NOT EXISTS balancete_14 &#x28;&#xd;&#xa;    cod_estrutural character varying&#x28;160&#x29;,&#xd;&#xa;    cod_plano integer,&#xd;&#xa;    num_orgao integer,&#xd;&#xa;    num_unidade integer,&#xd;&#xa;    cod_funcao integer,&#xd;&#xa;    cod_subfuncao integer,&#xd;&#xa;    num_programa integer,&#xd;&#xa;    num_acao integer,&#xd;&#xa;    cod_recurso integer,&#xd;&#xa;    natureza_despesa character varying,&#xd;&#xa;    cod_empenho integer,&#xd;&#xa;    exercicio_empenho character varying,&#xd;&#xa;    tipo_valor character&#x28;1&#x29;,&#xd;&#xa;    vl_lancamento numeric,&#xd;&#xa;    cod_entidade integer,&#xd;&#xa;    cod_lote integer,&#xd;&#xa;    dt_lote date,&#xd;&#xa;    exercicio character&#x28;4&#x29;,&#xd;&#xa;    mes integer,&#xd;&#xa;    tipo character&#x28;1&#x29;,&#xd;&#xa;    sequencia integer,&#xd;&#xa;    oid_temp oid,&#xd;&#xa;    cod_sistema integer,&#xd;&#xa;    escrituracao character&#x28;9&#x29;,&#xd;&#xa;    indicador_superavit character&#x28;12&#x29;,&#xd;&#xa;    natureza_saldo character&#x28;1&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 2697 &#x28;class 1259 OID 7485736&#x29;&#xd;&#xa;-- Name&#x3a; balancete_arq&#x3b; Type&#x3a; TABLE&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE TABLE IF NOT EXISTS balancete_arq &#x28;&#xd;&#xa;    exercicio character varying&#x28;4&#x29; NOT NULL,&#xd;&#xa;    mes integer NOT NULL,&#xd;&#xa;    cod_entidade integer NOT NULL,&#xd;&#xa;    tipo_registro integer NOT NULL,&#xd;&#xa;    conta_contabil character varying&#x28;160&#x29;,&#xd;&#xa;    cod_orgao text,&#xd;&#xa;    cod_unidade_sub character varying,&#xd;&#xa;    cod_funcao integer,&#xd;&#xa;    cod_sub_funcao integer,&#xd;&#xa;    cod_programa integer,&#xd;&#xa;    id_acao integer,&#xd;&#xa;    id_sub_acao character varying&#x28;20&#x29;,&#xd;&#xa;    natureza_despesa character varying&#x28;160&#x29;,&#xd;&#xa;    sub_elemento character varying&#x28;4&#x29;,&#xd;&#xa;    cod_fonte_recursos integer,&#xd;&#xa;    natureza_receita character varying&#x28;160&#x29;,&#xd;&#xa;    num_orgao integer,&#xd;&#xa;    num_unidade integer,&#xd;&#xa;    numero_empenho integer,&#xd;&#xa;    ano_inscricao character varying,&#xd;&#xa;    atributo_sf character&#x28;12&#x29;,&#xd;&#xa;    cod_ctb integer,&#xd;&#xa;    cod_unidade_sub_orig character varying,&#xd;&#xa;    saldo_inicial numeric&#x28;16,2&#x29;,&#xd;&#xa;    natureza_saldo_inicial character varying&#x28;1&#x29;,&#xd;&#xa;    total_debitos numeric&#x28;16,2&#x29;,&#xd;&#xa;    total_creditos numeric&#x28;16,2&#x29;,&#xd;&#xa;    saldo_final numeric&#x28;16,2&#x29;,&#xd;&#xa;    natureza_saldo_final character varying&#x28;1&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 2698 &#x28;class 1259 OID 7485748&#x29;&#xd;&#xa;-- Name&#x3a; balancete_contabil_14_restos_pagar&#x3b; Type&#x3a; TABLE&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE TABLE IF NOT EXISTS balancete_contabil_14_restos_pagar &#x28;&#xd;&#xa;    num_orgao integer,&#xd;&#xa;    num_unidade integer,&#xd;&#xa;    cod_funcao integer,&#xd;&#xa;    cod_subfuncao integer,&#xd;&#xa;    num_programa integer,&#xd;&#xa;    num_acao integer,&#xd;&#xa;    cod_recurso integer,&#xd;&#xa;    natureza_despesa character varying,&#xd;&#xa;    cod_empenho integer,&#xd;&#xa;    exercicio_empenho character varying,&#xd;&#xa;    tipo_valor character&#x28;1&#x29;,&#xd;&#xa;    vl_lancamento_rp_processados numeric,&#xd;&#xa;    vl_lancamento_rp_nao_processados numeric,&#xd;&#xa;    cod_entidade integer,&#xd;&#xa;    cod_lote integer,&#xd;&#xa;    dt_lote date,&#xd;&#xa;    exercicio character varying,&#xd;&#xa;    tipo character&#x28;1&#x29;,&#xd;&#xa;    sequencia integer,&#xd;&#xa;    oid_temp integer,&#xd;&#xa;    cod_sistema integer&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 2699 &#x28;class 1259 OID 7485757&#x29;&#xd;&#xa;-- Name&#x3a; lancamento&#x3b; Type&#x3a; TABLE&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE TABLE IF NOT EXISTS lancamento &#x28;&#xd;&#xa;    cod_estrutural character varying&#x28;160&#x29; NOT NULL,&#xd;&#xa;    cod_plano integer,&#xd;&#xa;    tipo_valor character varying&#x28;1&#x29;,&#xd;&#xa;    vl_lancamento numeric&#x28;16,2&#x29;,&#xd;&#xa;    cod_entidade integer,&#xd;&#xa;    complemento character varying&#x28;400&#x29;,&#xd;&#xa;    cod_lote integer,&#xd;&#xa;    nom_lote character varying&#x28;200&#x29;,&#xd;&#xa;    dt_lote date,&#xd;&#xa;    exercicio character varying&#x28;4&#x29;,&#xd;&#xa;    mes integer NOT NULL,&#xd;&#xa;    tipo character varying&#x28;1&#x29;,&#xd;&#xa;    cod_historico integer,&#xd;&#xa;    nom_historico_consulta text,&#xd;&#xa;    sequencia integer,&#xd;&#xa;    oid_temp integer,&#xd;&#xa;    cod_sistema integer,&#xd;&#xa;    escrituracao character&#x28;9&#x29;,&#xd;&#xa;    indicador_superavit character&#x28;12&#x29;,&#xd;&#xa;    nom_historico text,&#xd;&#xa;    cod_recibo_extra integer,&#xd;&#xa;    cod_ctb integer,&#xd;&#xa;    cod_recurso integer&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 2700 &#x28;class 1259 OID 7485772&#x29;&#xd;&#xa;-- Name&#x3a; parametro_arq&#x3b; Type&#x3a; TABLE&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE TABLE IF NOT EXISTS parametro_arq &#x28;&#xd;&#xa;    exercicio character varying&#x28;4&#x29;,&#xd;&#xa;    mes integer,&#xd;&#xa;    tipo_registro integer,&#xd;&#xa;    dt_inicial date,&#xd;&#xa;    dt_final date,&#xd;&#xa;    flag integer&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 2701 &#x28;class 1259 OID 7485775&#x29;&#xd;&#xa;-- Name&#x3a; parametros_etl&#x3b; Type&#x3a; TABLE&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE TABLE IF NOT EXISTS parametros_etl &#x28;&#xd;&#xa;    exercicio character&#x28;4&#x29; NOT NULL&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 2702 &#x28;class 1259 OID 7485778&#x29;&#xd;&#xa;-- Name&#x3a; plano_conta&#x3b; Type&#x3a; TABLE&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE TABLE IF NOT EXISTS plano_conta &#x28;&#xd;&#xa;    cod_plano integer,&#xd;&#xa;    cod_estrutural character varying&#x28;160&#x29; NOT NULL,&#xd;&#xa;    nom_conta character varying&#x28;200&#x29; NOT NULL,&#xd;&#xa;    cod_conta integer NOT NULL,&#xd;&#xa;    cod_reduzido character varying&#x28;160&#x29; NOT NULL,&#xd;&#xa;    cod_classificacao integer NOT NULL,&#xd;&#xa;    cod_sistema integer NOT NULL,&#xd;&#xa;    exercicio character&#x28;4&#x29; NOT NULL,&#xd;&#xa;    cod_banco integer,&#xd;&#xa;    cod_agencia integer,&#xd;&#xa;    cod_conta_corrente integer,&#xd;&#xa;    conta_corrente character varying&#x28;30&#x29;,&#xd;&#xa;    num_banco character varying&#x28;10&#x29;,&#xd;&#xa;    num_agencia character varying&#x28;10&#x29;,&#xd;&#xa;    natureza_saldo character&#x28;1&#x29;,&#xd;&#xa;    atributo_tcepe integer,&#xd;&#xa;    atributo_tcemg integer,&#xd;&#xa;    nivel integer NOT NULL,&#xd;&#xa;    cod_recurso integer,&#xd;&#xa;    escrituracao_pcasp character&#x28;1&#x29;,&#xd;&#xa;    indicador_superavit character&#x28;12&#x29;,&#xd;&#xa;    cod_ctb_anterior integer,&#xd;&#xa;    escrituracao character&#x28;9&#x29;&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 2703 &#x28;class 1259 OID 7485790&#x29;&#xd;&#xa;-- Name&#x3a; suplementacao_suplementacao&#x3b; Type&#x3a; TABLE&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;CREATE TABLE IF NOT EXISTS suplementacao_suplementacao &#x28;&#xd;&#xa;    exercicio character&#x28;4&#x29; NOT NULL,&#xd;&#xa;    cod_entidade integer NOT NULL,&#xd;&#xa;    tipo character&#x28;1&#x29; NOT NULL,&#xd;&#xa;    cod_lote integer NOT NULL,&#xd;&#xa;    sequencia integer NOT NULL,&#xd;&#xa;    valor numeric&#x28;14,2&#x29; NOT NULL,&#xd;&#xa;    exercicio_despesa character&#x28;4&#x29; NOT NULL,&#xd;&#xa;    cod_despesa integer NOT NULL&#xd;&#xa;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--&#xd;&#xa;-- TOC entry 12192 &#x28;class 1259 OID 7485805&#x29;&#xd;&#xa;-- Name&#x3a; idx1&#x3b; Type&#x3a; INDEX&#x3b; Schema&#x3a; bi&#x3b; Owner&#x3a; -&#xd;&#xa;--&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;-- indices &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;-- &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;idx1&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE INDEX idx1 ON lancamento USING btree &#x28;cod_estrutural varchar_pattern_ops&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;idx1_bal11&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE INDEX idx1_bal11 ON balancete_11 USING btree &#x28;cod_estrutural varchar_pattern_ops&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;idx1_bal14&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE INDEX idx1_bal14 ON balancete_14 USING btree &#x28;cod_estrutural DESC&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;idx2&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE INDEX idx2 ON lancamento USING btree &#x28;exercicio, tipo, mes, cod_entidade, cod_estrutural varchar_pattern_ops&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;idx2_bal11&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE INDEX idx2_bal11 ON balancete_11 USING btree &#x28;exercicio, tipo, mes&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;idx2_bal14&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE INDEX idx2_bal14 ON balancete_14 USING btree &#x28;exercicio DESC, cod_entidade DESC&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;idx3&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE INDEX idx3 ON lancamento USING btree &#x28;dt_lote, cod_entidade, cod_estrutural varchar_pattern_ops&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;idx3_bal11&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE INDEX idx3_bal11 ON balancete_11 USING btree &#x28;exercicio, tipo, mes, cod_entidade, cod_estrutural varchar_pattern_ops, num_orgao, num_unidade, cod_funcao, cod_subfuncao, num_programa, num_acao, cod_recurso, natureza_despesa&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;idx3_bal14&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE INDEX idx3_bal14 ON balancete_14 USING btree &#x28;exercicio DESC, mes DESC, tipo DESC, cod_entidade DESC, cod_estrutural varchar_pattern_ops, num_orgao DESC, num_unidade DESC, cod_funcao DESC, cod_subfuncao DESC, num_programa DESC, num_acao DESC, cod_recurso DESC, natureza_despesa DESC, cod_empenho DESC, exercicio_empenho DESC&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;idx4&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE INDEX idx4 ON lancamento USING btree &#x28;exercicio, tipo, tipo_valor, mes, cod_entidade, cod_estrutural varchar_pattern_ops&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;idx4_bal11&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE INDEX idx4_bal11 ON balancete_11 USING btree &#x28;exercicio, mes, tipo, cod_entidade, tipo_valor, cod_estrutural varchar_pattern_ops, num_orgao, num_unidade, cod_funcao, cod_subfuncao, num_programa, num_acao, cod_recurso, natureza_despesa&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;idx4_bal14&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE INDEX idx4_bal14 ON balancete_14 USING btree &#x28;exercicio DESC, mes DESC, cod_entidade DESC, tipo, tipo_valor DESC, cod_estrutural varchar_pattern_ops, num_orgao DESC, num_unidade DESC, cod_funcao DESC, cod_subfuncao DESC, num_programa DESC, num_acao DESC, cod_recurso DESC, natureza_despesa DESC, cod_empenho DESC, exercicio_empenho DESC&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;parametro_arq_exercicio_idx&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE UNIQUE INDEX parametro_arq_exercicio_idx ON parametro_arq USING btree &#x28;exercicio, mes, tipo_registro&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;pc_exerc_pcasp_idx&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE INDEX pc_exerc_pcasp_idx ON plano_conta USING btree &#x28;exercicio, escrituracao_pcasp&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;unq_bal14&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE INDEX unq_bal14 ON balancete_14 USING btree &#x28;cod_estrutural varchar_pattern_ops, num_orgao DESC, num_unidade DESC, cod_funcao DESC, cod_subfuncao DESC, num_programa DESC, num_acao DESC, cod_recurso DESC, natureza_despesa DESC, oid_temp DESC&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;unq_contas_utilizadas&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE INDEX unq_contas_utilizadas ON balancete_11 USING btree &#x28;cod_estrutural varchar_pattern_ops, num_orgao, num_unidade, cod_funcao, cod_subfuncao, num_programa, num_acao, cod_recurso, natureza_despesa, oid_temp&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;unq_lanc&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE UNIQUE INDEX unq_lanc ON lancamento USING btree &#x28;cod_estrutural varchar_pattern_ops, oid_temp&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;IF 	&#x28;&#xd;&#xa;		select &#xd;&#xa;			pg_class.relname &#xd;&#xa;		FROM pg_index &#xd;&#xa;		JOIN pg_class ON pg_class.oid &#x3d; pg_index.indexrelid&#xd;&#xa;		join pg_catalog.pg_namespace on pg_namespace.oid &#x3d; pg_class.RELNAMESPACE  	&#xd;&#xa;		where &#xd;&#xa;			pg_namespace.nspname &#x3d; &#x27;bi&#x27; &#xd;&#xa;			and pg_class.relname &#x3d;&#x27;unq_suplementacao_suplementacao&#x27;&#xd;&#xa;	&#x29; IS NULL &#xd;&#xa;THEN&#xd;&#xa;	CREATE INDEX unq_suplementacao_suplementacao ON suplementacao_suplementacao USING btree &#x28;tipo, cod_entidade, sequencia&#x29;&#x3b;&#xd;&#xa;END IF&#x3b;&#xd;&#xa;&#xd;&#xa;-- &#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#x23;&#xd;&#xa;&#xd;&#xa;END &#x24;&#x24;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#x2f;&#x2a;&#xd;&#xa;&#xd;&#xa;select &#xd;&#xa;    x.conta_contabil,y.nivel_pai,y.nivel_filho,x.saldo_final_nivel_pai,x.saldo_final_nivel_filho,&#xd;&#xa;    case when x.saldo_final_nivel_pai &#x3d; x.saldo_final_nivel_filho then &#x27;OK&#x27; else &#x27;NOK&#x27; end as status&#xd;&#xa;from &#xd;&#xa;&#x28;&#xd;&#xa;    select conta_contabil,saldo_final_nivel_pai,saldo_final_nivel_filho&#xd;&#xa;    from crosstab&#xd;&#xa;    &#x28;&#xd;&#xa;    &#x27;    select &#x2a; from &#xd;&#xa;        &#x28;&#xd;&#xa;            with&#xd;&#xa;            a as      &#xd;&#xa;            &#x28;&#xd;&#xa;                select &#xd;&#xa;                    conta_contabil,tipo_registro,natureza_saldo_final,saldo_final &#xd;&#xa;                from bi.balancete_arq where exercicio &#x3d; &#x27;&#x27;2015&#x27;&#x27; and mes &#x3d; &#x27;&#x27;1&#x27;&#x27;&#xd;&#xa;            &#x29;,&#xd;&#xa;            b as &#xd;&#xa;            &#x28;&#xd;&#xa;                select &#xd;&#xa;                    conta_contabil,tipo_registro,&#xd;&#xa;                       case when natureza_saldo_final &#x3d; &#x27;&#x27;C&#x27;&#x27; then saldo_final else saldo_final &#x2a; -1 end saldo_final2&#xd;&#xa;                from a&#xd;&#xa;            &#x29;,&#xd;&#xa;            c as&#xd;&#xa;            &#x28;&#xd;&#xa;                select &#xd;&#xa;                    conta_contabil,tipo_registro,sum&#x28;saldo_final2&#x29; as saldo_final2 &#xd;&#xa;                from b&#xd;&#xa;                group by conta_contabil,tipo_registro&#xd;&#xa;            &#x29;,&#xd;&#xa;            d as&#xd;&#xa;            &#x28;&#xd;&#xa;                select &#xd;&#xa;                    conta_contabil,tipo_registro,saldo_final2,&#xd;&#xa;                    row_number&#x28;&#x29; over  &#x28;partition by conta_contabil order by conta_contabil&#x29; as qtd_niveis &#xd;&#xa;                from c&#xd;&#xa;            &#x29; &#xd;&#xa;            select &#xd;&#xa;                conta_contabil,tipo_registro,saldo_final2 &#xd;&#xa;            from d&#xd;&#xa;            order by conta_contabil,tipo_registro&#xd;&#xa;        &#x29; X&#xd;&#xa;    &#x27;&#xd;&#xa;    &#x29; as ct &#x28;conta_contabil varchar&#x28;50&#x29;,saldo_final_nivel_pai numeric,saldo_final_nivel_filho numeric&#x29;&#xd;&#xa;&#x29; x&#xd;&#xa;left join &#xd;&#xa;&#x28;&#xd;&#xa;    with &#xd;&#xa;    conta_tipo as&#xd;&#xa;    &#x28;&#xd;&#xa;        select distinct conta_contabil ,tipo_registro&#xd;&#xa;        from bi.balancete_arq where exercicio &#x3d; &#x27;2015&#x27; and mes &#x3d; &#x27;1&#x27; and tipo_registro &#x3e; 0&#xd;&#xa;        order by 1,2&#xd;&#xa;    &#x29;,&#xd;&#xa;    conta_tipo2 as &#x28;&#xd;&#xa;        select conta_contabil ,min&#x28;tipo_registro&#x29; as nivel_pai,max&#x28;tipo_registro&#x29; as nivel_filho &#xd;&#xa;        from conta_tipo &#xd;&#xa;        group by conta_contabil&#xd;&#xa;    &#x29;&#xd;&#xa;    select conta_contabil,nivel_pai,case when nivel_filho &#x3c;&#x3e; nivel_pai then nivel_filho end nivel_filho&#xd;&#xa;    from conta_tipo2&#xd;&#xa;&#x29; y on x.conta_contabil &#x3d; y.conta_contabil&#xd;&#xa;order by &#xd;&#xa;    x.conta_contabil,&#xd;&#xa;    y.nivel_pai,&#xd;&#xa;    y.nivel_filho&#xd;&#xa;&#xd;&#xa;Pinned by you &#xd;&#xa;April 19th at 3&#x3a;51 PM Pinned by you&#xd;&#xa;marcio.lima &#x5b;3&#x3a;51 PM&#x5d; &#xd;&#xa;Para usar a fun&#xe7;&#xe3;o crosstab &#xe9; necess&#xe1;rio a instala&#xe7;&#xe3;o de um m&#xf3;dulo por database &#x28;n&#xe3;o por instancia de postgres&#x29;.&#xd;&#xa;Segue um comando para a instala&#xe7;&#xe3;o do m&#xf3;dulo&#x3a;&#xd;&#xa;&#xd;&#xa;CREATE EXTENSION tablefunc&#x3b;&#xd;&#xa;&#x2a;&#x2f;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>urbem</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>224</xloc>
      <yloc>160</yloc>
    </entry>
    <entry>
      <name>SJ_005_ABT</name>
      <description/>
      <type>ABORT</type>
      <message>SJ_005_BI_BALANCETE_CONTABIL_TRF_EXEC_PRE_BALANCETE</message>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>672</xloc>
      <yloc>224</yloc>
    </entry>
    <entry>
      <name>SJ_003_ABT</name>
      <description/>
      <type>ABORT</type>
      <message>SJ_003_ESS_SCRIPT_CRIACAO</message>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>672</xloc>
      <yloc>160</yloc>
    </entry>
  </entries>
  <hops>
    <hop>
      <from>SJ_010_BI_BALANCETE_CONTABIL_TRF_PLANO_CONTA</from>
      <to>SJ_020_BI_BALANCETE_CONTABIL_TRF_LANCAMENTO</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_020_BI_BALANCETE_CONTABIL_TRF_LANCAMENTO</from>
      <to>SJ_030_BI_BALANCETE_CONTABIL_TRF_BALANCETE</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_030_BI_BALANCETE_CONTABIL_TRF_BALANCETE</from>
      <to>SJ_040_BI_BALANCETE_CONTABIL_TRF_BALANCETE_VALORES</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_040_BI_BALANCETE_CONTABIL_TRF_BALANCETE_VALORES</from>
      <to>SJ_050_BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_11</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_050_BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_11</from>
      <to>SJ_060_BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_12</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_060_BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_12</from>
      <to>SJ_070_BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_14</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_070_BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_14</from>
      <to>Success</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_010_BI_BALANCETE_CONTABIL_TRF_PLANO_CONTA</from>
      <to>SJ_010_ABT</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_020_BI_BALANCETE_CONTABIL_TRF_LANCAMENTO</from>
      <to>SJ_020_ABT</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_030_BI_BALANCETE_CONTABIL_TRF_BALANCETE</from>
      <to>SJ_030_ABT</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_040_BI_BALANCETE_CONTABIL_TRF_BALANCETE_VALORES</from>
      <to>SJ_040_ABT</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_050_BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_11</from>
      <to>SJ_050_ABT</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_060_BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_12</from>
      <to>SJ_060_ABT</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_070_BI_BALANCETE_CONTABIL_TRF_BALANCETE_AUX_14</from>
      <to>SJ_070_ABT</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_005_BI_BALANCETE_CONTABIL_TRF_EXEC_PRE_BALANCETE</from>
      <to>SJ_007_SEV_VALIDACAO</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_007_SEV_VALIDACAO</from>
      <to>Success</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_007_SEV_VALIDACAO</from>
      <to>SJ_010_BI_BALANCETE_CONTABIL_TRF_PLANO_CONTA</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_003_ESS_SCRIPT_CRIACAO</from>
      <to>SJ_003_ABT</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>SJ_005_BI_BALANCETE_CONTABIL_TRF_EXEC_PRE_BALANCETE</from>
      <to>SJ_005_ABT</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>SJ_003_ESS_SCRIPT_CRIACAO</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>SJ_003_ESS_SCRIPT_CRIACAO</from>
      <to>SJ_005_BI_BALANCETE_CONTABIL_TRF_EXEC_PRE_BALANCETE</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
  </hops>
  <notepads>
  </notepads>
</job>
